{"version":3,"sources":["icons/svg/delapouite/dice-six-faces-six.svg","icons/svg/lorc/emerald.svg","icons/svg/delapouite/sword-brandish.svg","icons/svg/lorc/shard-sword.svg","icons/svg/lorc/spiral-thrust.svg","assets/img/healing1.png","assets/img/fireball.png","assets/img/thunderbolt.png","assets/img/dark-blast.png","assets/img/crippling-blow.png","assets/img/wrath.png","assets/img/charge.png","assets/img/headshot.png","assets/img/shadow-strike.png","assets/img/vanish.png","assets/img/inspect.png","assets/img/weapon-attack.png","icons/svg/lorc/aura.svg","icons/svg/lorc/barbute.svg","icons/svg/delapouite/muscular-torso.svg","icons/svg/sbed/hand.svg","icons/svg/delapouite/ring.svg","icons/svg/lorc/footprint.svg","icons/svg/lorc/quick-slash.svg","icons/svg/lorc/barbed-arrow.svg","icons/svg/carl-olsen/flame.svg","icons/svg/lorc/bleeding-eye.svg","icons/svg/lorc/moebius-trefoil.svg","icons/svg/lorc/triorb.svg","icons/svg/sbed/shield.svg","icons/svg/lorc/book-cover.svg","icons/svg/skoll/fist.svg","icons/svg/lorc/fire-axe.svg","icons/svg/delapouite/war-axe.svg","icons/svg/lorc/stiletto.svg","icons/svg/lorc/croc-sword.svg","icons/svg/delapouite/flail.svg","icons/svg/lorc/crossed-swords.svg","icons/svg/delapouite/katana.svg","icons/svg/lorc/sword-hilt.svg","icons/svg/willdabeast/orb-wand.svg","icons/svg/lorc/wizard-staff.svg","icons/svg/skoll/luger.svg","icons/svg/carl-olsen/crossbow.svg","icons/svg/lorc/bloody-sword.svg","icons/svg/lorc/winged-sword.svg","icons/svg/delapouite/closed-barbute.svg","icons/svg/lorc/hood.svg","icons/svg/delapouite/shoulder-armor.svg","icons/svg/lorc/robe.svg","icons/svg/delapouite/gloves.svg","icons/svg/delapouite/power-ring.svg","icons/svg/lorc/boots.svg","icons/svg/lorc/magnifying-glass.svg","icons/svg/lorc/tombstone.svg","icons/svg/delapouite/pencil.svg","icons/svg/delapouite/save.svg","icons/svg/delapouite/trash-can.svg","assets/img/roll.png","icons/svg/cathelineau/swordman.svg","icons/svg/lorc/swap-bag.svg","icons/svg/delapouite/skills.svg","icons/svg/delapouite/crystal-shrine.svg","icons/svg/lorc/two-shadows.svg","assets/img/23761.jpg","util/getKeys.ts","util/notZero.ts","util/getSign.ts","util/noneg.ts","types/Roll2.ts","types/Damage.ts","util/reduce.ts","types/Events.ts","types/Weapon.ts","objects/util.ts","objects/fists.ts","types/Character.ts","objects/baseCharacter.ts","types/Party.ts","state/util.ts","util/updateIn.ts","util/getRandom.ts","objects/basicShield.ts","objects/basicTome.ts","objects/builders/armor/names.ts","objects/builders/util.ts","objects/builders/armor/stats.ts","objects/builders/armor/uniques/index.ts","objects/builders/armor/mythics/index.ts","objects/builders/armor/sets/index.ts","objects/builders/armor/createArmor.ts","objects/builders/weapons/stats.ts","objects/builders/weapons/createWeapon.ts","objects/builders/makeItem.ts","objects/makeSkill.ts","objects/makeCharacter.ts","objects/builders/weapons/mythics/index.ts","objects/builders/mods/index.tsx","state/parties/index.ts","hooks/useActions.ts","contexts/PartyContext/index.tsx","state/rolls/index.ts","contexts/RollContext/index.tsx","contexts/CharacterContext/index.tsx","elements/flex.ts","icons/maps.tsx","components/Icon/index.tsx","components/Hover/index.tsx","elements/box.tsx","components/ResourceScore/index.tsx","components/AbilityScore/index.tsx","components/StatScore/index.tsx","components/DamageResistanceScore/index.tsx","util/compare.ts","components/TraitScore/index.tsx","util/getValueString.ts","components/CheckPreview/index.tsx","components/ArmorIcon/index.tsx","types/Item.ts","components/ItemIcon/index.tsx","components/ItemPreview/index.tsx","types/Armor.ts","components/WeaponIcon/index.tsx","components/DamageRollScores/index.tsx","components/ModPreview/index.tsx","components/WeaponPreview/index.tsx","components/ItemPreviewSmall/index.tsx","components/ArmorScoreList/index.tsx","components/Gauge/index.tsx","components/CharacterInspect/index.tsx","components/SkillPreview/index.tsx","components/CombatCharacterSkills/index.tsx","objects/makeNpc.ts","objects/makeParty.ts","contexts/CombatContext/log.tsx","contexts/CombatContext/util.tsx","contexts/CombatLogContext/index.tsx","contexts/ModalContext/reducer.ts","contexts/ModalContext/index.tsx","components/CombatVictoryModal/index.tsx","components/CombatLossModal/index.tsx","contexts/CombatContext/index.tsx","hooks/useInterval.ts","components/CombatCharacterTargets/index.tsx","components/CharacterDetails/index.tsx","contexts/UIContext/index.tsx","components/SkillPreviewAlt/index.tsx","domain/Character/index.tsx","components/RollResult/index.tsx","contexts/CompareContext/index.tsx","components/WeaponCompare/index.tsx","components/ItemCompare/index.tsx","components/CharacterItemFilters/index.tsx","components/CharacterItems/index.tsx","components/Sidebar/index.tsx","components/ApplicationLog/index.tsx","components/RollLog/index.tsx","components/AttackLog/index.tsx","components/PartySkills/index.tsx","components/PartyMods/index.tsx","routes/index.tsx","components/AppSidebar/index.tsx","components/CombatParty/index.tsx","types/Skill.ts","domain/Combat/index.tsx","components/AppHeader/index.tsx","App.tsx","serviceWorker.ts","index.tsx","state/index.ts"],"names":["module","exports","getKeys","obj","Object","keys","notZero","value","content","getSign","noneg","THREE_D6_DIST","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","processRollString","rollString","split","map","roll","n","d","parseInt","getModifierString","modifier","Math","abs","resolveRoll","allowNegatives","string","combineRollStrings","result","DiceRoll","id","v4","total","output","criticalSuccess","minTotal","criticalFailure","maxTotal","averageTotal","quickRoll","str","mod","getCheckProbability","check","resolveCheck","rollResult","chance","goal","ZERO_ROLL","THREE_D6","ZERO_CHECK","makeCharacterRoll","makeCharacterCheck","undefined","makeStandardCharacterCheck","rolls","list","filter","r","reduce","p","c","forEach","pRoll","i","combineRolls","combineCharacterRolls","reduceCharacterRoll","character","keyValue","getModifierValueFromKeys","reduceCharacterCheck","resolveCharacterRoll","resolveCharacterCheck","getRollRange","getRollText","length","hasMod","keyString","plus","CharacterKeyMap3","modString","DamageTypeKeyColors","slashing","piercing","fire","blood","light","dark","getDamageTypeKeys","rollDamage","crit","label","key","rollResults","ZERO_DAMAGE_ROLLS","combineDamageTypeRolls","ret","reducer","initialValue","EventsTypeMap","onHit","onCrit","force","traits","combineEvents","events","ZERO_WEAPON_TRAIT","accuracyOffset","damageRolls","combineWeaponTraits","processWeapon","weapon","processed","Error","mods","slots","combinedTrait","accuracyCheck","makeRequirementCheck","BASE_EQUIPPABLE","type","rarity","equippable","name","cost","resource","requirementCheck","duration","healthOffset","focusOffset","abilitiesModifiers","strength","dexterity","intelligence","vigor","statsModifiers","health","focus","will","perception","agility","accuracy","evade","damageResistances","makeTrait","FISTS","weaponType","slotCount","getTraits","armorTraits","armor","item","equippedItemTraits","equippedItems","getAbilities","trait","cur","abilities","getStats","getDamageResistances","a","processCharacter","withWeapon","stats","dead","commitTrait","s","setCharacterAbilityScore","characterPoints","resources","validateCharacter","power","characterAbilityScoreCosts","canEquip","equipable","processedCharacter","unequipItem","validate","itemId","equippables","unequipWeapon","find","unequipArmor","unequipGenericItem","vr","equipGenericItem","resourceValue","equipArmor","equipWeapon","weaponHands","getTraitValue","abilityValue","statValue","combineTraits","current","ar","ac","sr","sc","pc","removedItems","localUpdate","unequipResult","items","BASE_CHARACTER","heads","bodies","hands","fingers","feet","skills","inspected","processParty","party","characters","partyId","makeReducer","core","initialState","state","action","coreFn","upsertIn","updateIn","accessor","getRandom","floor","random","BASIC_SHIELD","BASIC_TOME","ArmorUniqueNames","shuffleArray","array","j","Rarity3d6Map","18","getItemStatRolls","count","requirementScore","offset","statCount","statRolls","ArmorRequirementKeys","helmet","cowl","chestplate","robe","gloves","ring","boots","ArmorCostsT","ArmorResourcesT","armorStatKeysBase","ArmorRarityStatKeys","common","uncommon","rare","legendary","unique","mythic","set","ArmorRarityStatCounts","makeStaticRoll","makeRoll","UNIQUE_ARMORS","MYTHIC_ARMORS","SET_ARMORS","buildArmor","armorType","createArmor","getArmorStatRolls","base","WeaponRequirementKeys","fists","axe","greataxe","flail","daggers","katana","rapier","wand","staff","elementalSword","elementalGreatsword","sword","greatsword","pistol","crossbow","WeaponCosts","weaponStatKeysBase","WeaponRarityStatKeys","WeaponRarityStatCounts","makeDamageRoll","modCoef","buildWeapon","createWeapon","getWeaponStatRolls","element","WeaponDamages","accuracyModifier","rest","ITEM_TYPES","itemCore","makeWeapon","makeArmor","shield","tome","makeSkill","imgSrc","targetTraits","sourceTraits","combineWeaponDamage","checkDodgeForTraits","focusCost","target","BASIC_ATTACK","WeaponAttack","INSPECT","Inspect","FIREBALL","Fireball","CRIPPLING_BLOW","CripplingBlow","THUNDERBOLT","Thunderbolt","DARK_BLAST","DarkBlast","HEALING","Healing","WRATH","Wrath","CHARGE","Charge","SKILL_SHOT","SkillShot","VANISH","Vanish","SHADOW_STRIKE","ShadowStrike","makeCharacter","SWORD_OF_BLOOD_AND_FIRE","SWORD_OF_THE_INFINITE","SLASHING_MOD","actionCreators","payload","characterId","modId","actions","upsertParty","dispatch","upsertCharacter","deleteCharacter","upsertItem","removeItem","upsertMod","deleteMod","equipItem","getState","parties","_character","equipMod","m","unequipMod","console","log","max","katie","milo","PC_PARTY_ID","INITIAL_STATE","Array","fill","makeItem","usePartiesActions","deps","useDispatch","useMemo","bindActionCreators","useActions","defaultContextValue","rawParties","userParty","rawUserParty","activeCharacterId","findCharacter","findRawCharacter","setActiveCharacterId","PartyContext","React","createContext","PartyContextProvider","props","children","useSelector","useState","Provider","usePartyContext","useContext","RollContext","history","execRoll","execCheck","rollCharacter","checkCharacter","getProbability","useRollContext","RollContextProvider","addRoll","characterContext","useCharacterContext","RollStateContextProvider","CharacterContext","rawCharacter","onChange","CharacterContextProvider","CharacterStateContextProvider","FlexContainer","styled","display","flexDirection","$direction","flex","$full","FullContainer","IconCharacterResourceMap","WeaponHands","CharacterPoints","Heads","Bodies","Hands","Finger","Feet","IconDamageTypeMap","Slashing","Piercing","Fire","Blood","Light","Dark","IconItemTypeMap","Shield","Tome","IconWeaponTypeMap","Fists","Axe","GreatAxe","Flail","Daggers","Katana","Rapier","Wand","Staff","FireSword","DarkSword","Sword","Greatsword","Pistol","Crossbow","IconUniqueWeaponMap","BloodSword","LightSword","IconArmorTypeMap","Helmet","Cowl","Armor","Robe","Gloves","Ring","Boots","Icon","src","size","style","onClick","loading","setLoading","svg","setSvg","useEffect","fetch","then","res","text","height","width","dangerouslySetInnerHTML","__html","Hover","delay","internalHovering","setInternalHovering","isHovering","setIsHovering","guid","setGuid","useLayoutEffect","setTimeout","onMouseEnter","e","preventDefault","stopPropagation","onMouseLeave","BoxContainer","substyle","tag","Element","border","boxSizing","background","padding","color","SmallBox","justifyContent","alignItems","BoxButton","margin","borderColor","cursor","disabled","ResourceScore","iconUrl","fontFamily","fontSize","marginRight","AbilityScore","edit","keyName","rawValue","displayValue","points","onIncrement","char","onDecrement","PureAbilityScore","whiteSpace","href","fontWeight","StatScore","displayName","DamageResistanceScore","rollText","ZERO_COMPARE","ONE_COMPARE","BASE_ARGS","getCompareFn","valueA","valueB","args","TraitScore","compareResult","abilityKeys","statKeys","getValueString","CheckPreview","showCheckButton","rollKeys","k","keyStr","rollStr","probability","Dice6","ArmorIcon","ItemRarityColorMap","ItemIcon","ItemPreview","showEquipButton","showRequirementCheck","showCollapseButton","collapsed","setCollapsed","requirementCompare","traitCompare","resistancesCompare","costComare","isArmor","rarityColor","Color","desaturate","fade","rgb","marginTop","flexWrap","lineHeight","ArmorTypeSortKey","WeaponIcon","icon","DamageRollScores","parent","damageRangeText","damageRollText","DamageRollScore","marginBottom","ModPreview","onEquip","weaponTrait","Mod","values","combinedRoll","WeaponPreview","showRequirement","accuracyCompare","damageCompare","_","isOpen","direction","tagName","arrow","ItemPreviewSmall","isEmpty","isWeapon","boxShadow","ArmorScoreList","rings","arr","sort","b","Gauge","hovering","setHovering","percentage","position","left","maxWidth","minWidth","lighten","textShadow","backgroundColor","transition","right","top","overflow","CharacterInspect","SkillPreview","skillId","skill","backgroundSize","CombatCharacterSkills","activeSkillId","active","opacity","CombatCharacterSkill","isDefault","randomNameConfig","dictionaries","adjectives","animals","separator","makeNpc","npc","uniqueNamesGenerator","makeParty","Span","bold","NameSpan","isUser","cz","v","gv","LogAddedTraits","attackResult","source","addLine","gfo","gho","ZERO_RESULT","sourceId","targetId","index","hitSuccess","dodgeSuccess","rawDamage","blockedDamage","totalDamage","cr","getSkillDamageRolls","execSkill","characterSkills","skillCheck","getSkillCheck","skillCheckResult","rr","damageRollsResult","dodgeRoll","damageResult","resistanceCheck","resistanceRoll","damageTotal","resolveRound","rounds","rawEnemyParty","updateCharacter","rawCharacters","updater","round","rawSource","rawTarget","logResult","getTraitUpdates","t","processEvent","event","addedTraits","skillTraits","checkEvent","checkParty","ENEMY_PARTY_ID","CombatLogContext","lines","line","clear","useCombatLogContext","CombatLogContextProvider","setLines","contents","callback","blocking","OPEN","CLOSE","coreFunction","ModalContext","open","close","setBlocking","setPayload","setContents","setCallback","setStyle","useModalContext","getContextValue","Modal","setAppElement","ModalContextProvider","reducerValue","useReducer","context","parentSelector","document","querySelector","onRequestClose","bottom","overlay","CombatVictoryModal","reset","chosenItemId","setChosenItemId","rewardChoices","textAlign","CombatLossModal","wins","useHistory","push","enemyParty","running","done","characterTargets","setCharacterSkill","setCharacterTarget","next","start","stop","CombatContext","useCombatContext","CombatContextProvider","setRounds","setWins","setCharacterSkills","setCharacterTargets","targets","setDone","partyA","partyB","bCharacters","getCombatRecordBuilder","builder","onTick","setRunning","ref","useRef","setInterval","clearInterval","useInterval","finish","didWin","w","activeSkill","checkCharacterActiveSkills","activeTarget","checkCharacterActiveTargets","CombatCharacterTargets","activeTargetId","cc","alt","Roll","CombatCharacterTarget","CharacterDetails","showEdit","showInspect","showWeaponInspect","showSkills","detailsHovering","setDetailsHovering","weaponHovering","setWeaponHovering","isEditing","setIsEditing","setName","Tombstone","Pencil","Save","Delete","borderTop","defaultValue","logKey","sidebarKey","setLogKey","setSidebarKey","UIContext","useUIContext","UIContextProvider","SkillPreviewAlt","Character","useParams","RollResult","isCheck","CompareContext","compareChecks","checkA","checkB","compareRolls","rollA","rollB","compareValues","useCompareContext","CompareContextProvider","EquipedWeaponCompare","WeaponCompareItem","costComapre","weaponRoll","testRoll","weaponValue","testValue","EquipeItemCompare","testItem","ItemCompareItem","itemRoll","itemValue","CharacterItemFilters","CharacterItemFilterButton","hsl","toString","Item","isEquipable","canEquipItem","Sidebar","activeKey","setActiveKey","options","activeOption","o","option","borderBottom","borderRight","borderLeft","Component","setText","submitLog","setSubmitLog","setIndex","submit","alert","Fragment","onKeyDown","keyCode","Attack","scrollRef","scrollIntoView","behavior","overflowY","overflowX","l","Items","itemType","setItemType","itemRarity","setItemRarity","other","weapons","armors","Skills","Mods","AppLog","makeRoute","path","MAIN_OPTIONS","CharactersIcon","AppSidebar","AppSidebarCharacters","to","newCharacter","CombatParty","SelectedDamageRange","range","min","damageResults","resistanceResult","getSkillRange","prob","dodgeProb","Combat","BG","activeStyles","inactiveStyles","AppHeader","paths","chunks","useLocation","pathname","Link","includes","App","Boolean","window","location","hostname","match","engine","Styletron","store","createStore","combineReducers","compose","applyMiddleware","thunk","ReactDOM","render","StrictMode","debug","debugAfterHydration","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"kGAAAA,EAAOC,QAAU,IAA0B,gD,wBCA3CD,EAAOC,QAAU,IAA0B,qC,0BCA3CD,EAAOC,QAAU,IAA0B,4C,sCCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,2C,iECA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,4C,gBCA3CD,EAAOC,QAAU,IAA0B,mC,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,2C,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,qC,gBCA3CD,EAAOC,QAAU,IAA0B,2C,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,qC,gBCA3CD,EAAOC,QAAU,IAA0B,4C,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,uC,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,0C,gBCA3CD,EAAOC,QAAU,IAA0B,mC,gBCA3CD,EAAOC,QAAU,IAA0B,0C,gBCA3CD,EAAOC,QAAU,IAA0B,6C,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,qC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,mC,gBCA3CD,EAAOC,QAAU,IAA0B,4C,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,0C,gBCA3CD,EAAOC,QAAU,IAA0B,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","file":"static/js/main.ec233216.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/dice-six-faces-six.e202d07a.svg\";","module.exports = __webpack_public_path__ + \"static/media/emerald.df0125b6.svg\";","module.exports = __webpack_public_path__ + \"static/media/sword-brandish.a3fe9ae2.svg\";","module.exports = __webpack_public_path__ + \"static/media/shard-sword.23a923d5.svg\";","module.exports = __webpack_public_path__ + \"static/media/spiral-thrust.4b9960c0.svg\";","module.exports = __webpack_public_path__ + \"static/media/healing1.e72c5d2c.png\";","module.exports = __webpack_public_path__ + \"static/media/fireball.267cc34c.png\";","module.exports = __webpack_public_path__ + \"static/media/thunderbolt.bb5d2de7.png\";","module.exports = __webpack_public_path__ + \"static/media/dark-blast.155cdf6e.png\";","module.exports = __webpack_public_path__ + \"static/media/crippling-blow.f9be9048.png\";","module.exports = __webpack_public_path__ + \"static/media/wrath.b68f4b08.png\";","module.exports = __webpack_public_path__ + \"static/media/charge.11d38245.png\";","module.exports = __webpack_public_path__ + \"static/media/headshot.6549c4b8.png\";","module.exports = __webpack_public_path__ + \"static/media/shadow-strike.b9675e5b.png\";","module.exports = __webpack_public_path__ + \"static/media/vanish.670b9e64.png\";","module.exports = __webpack_public_path__ + \"static/media/inspect.af959ce1.png\";","module.exports = __webpack_public_path__ + \"static/media/weapon-attack.1f0b2b4e.png\";","module.exports = __webpack_public_path__ + \"static/media/aura.72475924.svg\";","module.exports = __webpack_public_path__ + \"static/media/barbute.e93dc754.svg\";","module.exports = __webpack_public_path__ + \"static/media/muscular-torso.92dbbc2a.svg\";","module.exports = __webpack_public_path__ + \"static/media/hand.9a950e42.svg\";","module.exports = __webpack_public_path__ + \"static/media/ring.5187be72.svg\";","module.exports = __webpack_public_path__ + \"static/media/footprint.88018ef0.svg\";","module.exports = __webpack_public_path__ + \"static/media/quick-slash.1d87b52f.svg\";","module.exports = __webpack_public_path__ + \"static/media/barbed-arrow.c6c3f6ae.svg\";","module.exports = __webpack_public_path__ + \"static/media/flame.332be8c2.svg\";","module.exports = __webpack_public_path__ + \"static/media/bleeding-eye.12de19c6.svg\";","module.exports = __webpack_public_path__ + \"static/media/moebius-trefoil.d014b37d.svg\";","module.exports = __webpack_public_path__ + \"static/media/triorb.b6fc9ecd.svg\";","module.exports = __webpack_public_path__ + \"static/media/shield.2cc62e8a.svg\";","module.exports = __webpack_public_path__ + \"static/media/book-cover.a02eb2a5.svg\";","module.exports = __webpack_public_path__ + \"static/media/fist.d1b25a44.svg\";","module.exports = __webpack_public_path__ + \"static/media/fire-axe.3106dbae.svg\";","module.exports = __webpack_public_path__ + \"static/media/war-axe.e2df8956.svg\";","module.exports = __webpack_public_path__ + \"static/media/stiletto.ad33f46f.svg\";","module.exports = __webpack_public_path__ + \"static/media/croc-sword.dfa5ecf6.svg\";","module.exports = __webpack_public_path__ + \"static/media/flail.1f360b03.svg\";","module.exports = __webpack_public_path__ + \"static/media/crossed-swords.b7d2c27a.svg\";","module.exports = __webpack_public_path__ + \"static/media/katana.8ca51fab.svg\";","module.exports = __webpack_public_path__ + \"static/media/sword-hilt.409c650d.svg\";","module.exports = __webpack_public_path__ + \"static/media/orb-wand.2f0c673e.svg\";","module.exports = __webpack_public_path__ + \"static/media/wizard-staff.3e6091b9.svg\";","module.exports = __webpack_public_path__ + \"static/media/luger.ec54b497.svg\";","module.exports = __webpack_public_path__ + \"static/media/crossbow.6d23d544.svg\";","module.exports = __webpack_public_path__ + \"static/media/bloody-sword.59d8ca0f.svg\";","module.exports = __webpack_public_path__ + \"static/media/winged-sword.c22831aa.svg\";","module.exports = __webpack_public_path__ + \"static/media/closed-barbute.59102a4b.svg\";","module.exports = __webpack_public_path__ + \"static/media/hood.7b3df127.svg\";","module.exports = __webpack_public_path__ + \"static/media/shoulder-armor.caa17ee9.svg\";","module.exports = __webpack_public_path__ + \"static/media/robe.5b61ecba.svg\";","module.exports = __webpack_public_path__ + \"static/media/gloves.03da1411.svg\";","module.exports = __webpack_public_path__ + \"static/media/power-ring.ed9dcd22.svg\";","module.exports = __webpack_public_path__ + \"static/media/boots.b6910f10.svg\";","module.exports = __webpack_public_path__ + \"static/media/magnifying-glass.ec7b5987.svg\";","module.exports = __webpack_public_path__ + \"static/media/tombstone.31b6aa47.svg\";","module.exports = __webpack_public_path__ + \"static/media/pencil.ac0b4bc7.svg\";","module.exports = __webpack_public_path__ + \"static/media/save.ec2d8043.svg\";","module.exports = __webpack_public_path__ + \"static/media/trash-can.3332c6a4.svg\";","module.exports = __webpack_public_path__ + \"static/media/roll.300ea409.png\";","module.exports = __webpack_public_path__ + \"static/media/swordman.c84cfcb8.svg\";","module.exports = __webpack_public_path__ + \"static/media/swap-bag.df43fabd.svg\";","module.exports = __webpack_public_path__ + \"static/media/skills.60519e24.svg\";","module.exports = __webpack_public_path__ + \"static/media/crystal-shrine.d915d792.svg\";","module.exports = __webpack_public_path__ + \"static/media/two-shadows.3e048aca.svg\";","module.exports = __webpack_public_path__ + \"static/media/23761.e6671090.jpg\";","export const getKeys = <T extends string>(\r\n  obj: Partial<Record<T, any>>,\r\n): T[] => {\r\n  return Object.keys(obj) as T[]\r\n}\r\n","export const notZero = <T = any>(value: number, content: T) =>\r\n  value === 0 ? '' : content\r\n","import { notZero } from './notZero'\r\n\r\nexport const getSign = (value: number): string =>\r\n  notZero(value, value > 0 ? '+' : '-')\r\n","export const noneg = (value: number) => (value > 0 ? value : 0)\r\n","import { DiceRoll } from 'rpg-dice-roller'\r\nimport { getSign } from '../util/getSign'\r\nimport { v4 } from 'uuid'\r\nimport {\r\n  CharacterSkillCheckKeyT,\r\n  ProcessedCharacterT,\r\n  getModifierValueFromKeys,\r\n  CharacterKeyMap3,\r\n} from './Character'\r\nimport { getKeys } from '../util/getKeys'\r\nimport { noneg } from '../util/noneg'\r\n\r\nexport const THREE_D6_DIST: any = {\r\n  3: 0.46,\r\n  4: 1.85,\r\n  5: 4.62,\r\n  6: 9.25,\r\n  7: 16.2,\r\n  8: 25.92,\r\n  9: 37.5,\r\n  10: 50.0,\r\n  11: 62.5,\r\n  12: 74.07,\r\n  13: 83.79,\r\n  14: 90.74,\r\n  15: 95.37,\r\n  16: 98.14,\r\n  17: 99.53,\r\n}\r\nexport const get3d6Probability = (result: number) => {\r\n  if (result < 3) return 0.46\r\n  if (result > 17) return 99.53\r\n  return THREE_D6_DIST[result]\r\n}\r\n\r\ninterface ProcessedRollT {\r\n  n: number\r\n  d: number\r\n}\r\nconst processRollString = (rollString: string): ProcessedRollT[] => {\r\n  const rolls = rollString.split('+')\r\n  return rolls.map((roll) => {\r\n    const [n, d] = roll.split('d')\r\n    return { n: parseInt(n, 10), d: parseInt(d, 10) }\r\n  })\r\n}\r\n\r\nexport interface Roll2T {\r\n  string: string\r\n  modifier: number\r\n}\r\nexport interface Check2T {\r\n  value: number\r\n  roll: Roll2T\r\n}\r\nexport interface Roll2ResultT {\r\n  id: string\r\n  label?: string\r\n  total: number\r\n  output: string\r\n  criticalSuccess: boolean\r\n  criticalFailure: boolean\r\n  minTotal: number\r\n  maxTotal: number\r\n  averageTotal: number\r\n}\r\nexport interface Check2ResultT extends Roll2ResultT {\r\n  result: boolean\r\n  chance: number\r\n  goal: number\r\n}\r\nexport interface CharacterRollT extends Roll2T {\r\n  keys: CharacterSkillCheckKeyT[]\r\n}\r\nexport interface CharacterCheckT extends Check2T {\r\n  keys: CharacterSkillCheckKeyT[]\r\n}\r\n\r\nconst getModifierString = (modifier: number) => {\r\n  if (modifier === 0) return ''\r\n  return `${getSign(modifier)}${Math.abs(modifier)}`\r\n}\r\nexport const resolveRoll = (\r\n  roll: Roll2T,\r\n  allowNegatives: boolean = true,\r\n): Roll2ResultT => {\r\n  const string = combineRollStrings(roll.string) || '1d1-1'\r\n  const result = new DiceRoll(`${string}${getModifierString(roll.modifier)}`)\r\n  return {\r\n    id: v4(),\r\n    total: allowNegatives ? result.total : noneg(result.total),\r\n    output: result.output,\r\n    criticalSuccess: result.total === result.minTotal,\r\n    criticalFailure: result.total === result.maxTotal,\r\n    minTotal: allowNegatives ? result.minTotal : noneg(result.minTotal),\r\n    maxTotal: allowNegatives ? result.maxTotal : noneg(result.maxTotal),\r\n    averageTotal: allowNegatives\r\n      ? result.averageTotal\r\n      : noneg(result.averageTotal),\r\n  }\r\n}\r\nexport const quickRoll = (str: string, mod?: number): number =>\r\n  resolveRoll({ string: str, modifier: mod || 0 }).total\r\n\r\nexport const getCheckProbability = (check: Check2T): number => {\r\n  const { value, roll } = check\r\n  if (roll.string === '3d6' && roll.modifier === 0)\r\n    return get3d6Probability(value)\r\n  if (roll.string === '') {\r\n    return roll.modifier <= value ? 100 : 0\r\n  }\r\n  return 0\r\n}\r\n\r\nexport const resolveCheck = (\r\n  check: Check2T,\r\n  allowNegatives?: boolean,\r\n): Check2ResultT => {\r\n  const { value, roll } = check\r\n  const rollResult = resolveRoll(roll, allowNegatives)\r\n  return {\r\n    ...rollResult,\r\n    result: rollResult.total <= value,\r\n    chance: getCheckProbability(check),\r\n    goal: value,\r\n  }\r\n}\r\n\r\nexport const ZERO_ROLL: Roll2T = {\r\n  string: '',\r\n  modifier: 0,\r\n}\r\nexport const THREE_D6: Roll2T = {\r\n  string: '3d6',\r\n  modifier: 0,\r\n}\r\nexport const ZERO_CHECK: Check2T = {\r\n  value: 0,\r\n  roll: ZERO_ROLL,\r\n}\r\nexport const makeRoll = (str?: string, mod?: number): Roll2T => ({\r\n  string: str || ZERO_ROLL.string,\r\n  modifier: mod || ZERO_ROLL.modifier,\r\n})\r\nexport const makeCheck = (\r\n  value: number,\r\n  str?: string,\r\n  mod?: number,\r\n): Check2T => ({\r\n  value,\r\n  roll: {\r\n    string: str || THREE_D6.string,\r\n    modifier: mod || THREE_D6.modifier,\r\n  },\r\n})\r\nexport const makeCharacterRoll = (\r\n  keys: CharacterSkillCheckKeyT[],\r\n  str?: string,\r\n  mod?: number,\r\n): CharacterRollT => ({\r\n  keys,\r\n  string: str || ZERO_ROLL.string,\r\n  modifier: mod || ZERO_ROLL.modifier,\r\n})\r\nexport const makeCharacterCheck = (\r\n  keys: CharacterSkillCheckKeyT[],\r\n  str?: string,\r\n  mod?: number,\r\n  value?: number,\r\n): CharacterCheckT => ({\r\n  keys,\r\n  value: value || ZERO_CHECK.value,\r\n  roll: {\r\n    string: str === undefined ? THREE_D6.string : str,\r\n    modifier: mod || THREE_D6.modifier,\r\n  },\r\n})\r\nexport const makeStandardCharacterCheck = (\r\n  keys: CharacterSkillCheckKeyT[],\r\n  modifier: number = 0,\r\n) => makeCharacterCheck(keys, undefined, undefined, modifier)\r\nexport const combineRollStrings = (...rolls: string[]): string => {\r\n  const list = rolls\r\n    .filter((r) => r !== '')\r\n    .map((r) => processRollString(r))\r\n    .reduce((p, c) => [...p, ...c], [])\r\n  let result: Record<number, number> = {}\r\n  list.forEach((pRoll) => {\r\n    result[pRoll.d] = (result[pRoll.d] || 0) + pRoll.n\r\n  })\r\n  return getKeys(result)\r\n    .map((d, i) => {\r\n      return `${result[parseInt(d, 10)]}d${d}`\r\n    })\r\n    .reduce((p, c, i) => `${p}${i > 0 ? '+' : ''}${c}`, '')\r\n}\r\nexport const combineRolls = (...rolls: Roll2T[]): Roll2T => {\r\n  return rolls.reduce(\r\n    (p, c) => ({\r\n      string: combineRollStrings(p.string, c.string),\r\n      modifier: p.modifier + c.modifier,\r\n    }),\r\n    ZERO_ROLL,\r\n  )\r\n}\r\nexport const combineChecks = (...checks: Check2T[]): Check2T => {\r\n  return checks.reduce((p, c) => ({\r\n    value: p.value + c.value,\r\n    roll: combineRolls(p.roll, c.roll),\r\n  }))\r\n}\r\nexport const combineCharacterRolls = (\r\n  ...rolls: CharacterRollT[]\r\n): CharacterRollT => {\r\n  return rolls.reduce(\r\n    (p, c) => ({\r\n      ...combineRolls(p, c),\r\n      keys: [...p.keys, ...c.keys],\r\n    }),\r\n    makeCharacterRoll([]),\r\n  )\r\n}\r\nexport const reduceCharacterRoll = (\r\n  roll: CharacterRollT,\r\n  character: ProcessedCharacterT,\r\n): Roll2T => {\r\n  const keyValue = getModifierValueFromKeys(character)(roll.keys || [])\r\n  return {\r\n    string: roll.string,\r\n    modifier: roll.modifier + keyValue,\r\n  }\r\n}\r\nexport const reduceCharacterCheck = (\r\n  check: CharacterCheckT,\r\n  character: ProcessedCharacterT,\r\n): Check2T => {\r\n  const keyValue = getModifierValueFromKeys(character)(check.keys)\r\n  return {\r\n    value: check.value + keyValue,\r\n    roll: check.roll,\r\n  }\r\n}\r\nexport const resolveCharacterRoll = (\r\n  roll: CharacterRollT,\r\n  character: ProcessedCharacterT,\r\n  allowNegatives?: boolean,\r\n) => {\r\n  return resolveRoll(reduceCharacterRoll(roll, character), allowNegatives)\r\n}\r\nexport const resolveCharacterCheck = (\r\n  check: CharacterCheckT,\r\n  character: ProcessedCharacterT,\r\n  allowNegatives?: boolean,\r\n) => {\r\n  return resolveCheck(reduceCharacterCheck(check, character), allowNegatives)\r\n}\r\n\r\n// utils\r\nexport const getRollRange = (roll: Roll2T): string => {\r\n  const result = resolveRoll(roll, false)\r\n  if (result.minTotal === result.maxTotal) return `${result.maxTotal}`\r\n  return `${result.minTotal}-${result.maxTotal}`\r\n}\r\nexport const getRollText = (roll: CharacterRollT) => {\r\n  const hasKeys = roll.keys.length > 0\r\n  const hasMod = roll.modifier !== 0\r\n  const keyString = roll.keys.reduce((p, c, i) => {\r\n    const plus = i === 0 && !roll.string ? '' : '+'\r\n    return `${p}${plus}${CharacterKeyMap3[c]}`\r\n  }, '')\r\n  const modString = hasMod\r\n    ? `${roll.string || keyString ? getSign(roll.modifier) : ''}${Math.abs(\r\n        roll.modifier,\r\n      )}`\r\n    : ''\r\n  return `${roll.string}${keyString}${modString}`\r\n}\r\n","import { getKeys } from '../util/getKeys'\r\nimport {\r\n  CharacterRollT,\r\n  Roll2ResultT,\r\n  makeCharacterRoll,\r\n  combineCharacterRolls,\r\n} from './Roll2'\r\nimport { RollCheckerT } from '../contexts/RollContext'\r\n\r\nexport type DamageElementTypeT = 'fire' | 'blood' | 'light' | 'dark'\r\nexport type DamageTypeKeyT = DamageElementTypeT | 'slashing' | 'piercing'\r\n\r\ntype _DamageTypeRollsT = Record<DamageTypeKeyT, CharacterRollT | undefined>\r\nexport type DamageTypeRollsT = Partial<_DamageTypeRollsT>\r\ntype _DamageTypeResultsT = Record<DamageTypeKeyT, Roll2ResultT | undefined>\r\nexport type DamageTypeResultsT = Partial<_DamageTypeResultsT>\r\n\r\nexport interface DamageRollsResultT {\r\n  total: number\r\n  rollResults: DamageTypeResultsT\r\n}\r\n\r\nexport const DamageTypeKeyColors: Record<DamageTypeKeyT, string> = {\r\n  slashing: 'grey',\r\n  piercing: 'grey',\r\n  fire: 'orange',\r\n  blood: '#cd7474',\r\n  light: 'lemonchiffon',\r\n  dark: 'mediumpurple',\r\n}\r\n\r\nexport const getDamageTypeKeys = (\r\n  obj: DamageTypeRollsT | DamageTypeResultsT,\r\n): DamageTypeKeyT[] => getKeys<DamageTypeKeyT>(obj)\r\n\r\nexport const rollDamage = (\r\n  resolveRoll: RollCheckerT<CharacterRollT, Roll2ResultT>,\r\n) => (\r\n  rolls: DamageTypeRollsT,\r\n  crit: boolean = false,\r\n  label?: string,\r\n): DamageRollsResultT => {\r\n  let total = 0\r\n  const keys: DamageTypeKeyT[] = getKeys(rolls).filter((key) => rolls[key])\r\n  let rollResults: DamageTypeResultsT = {\r\n    slashing: undefined,\r\n    piercing: undefined,\r\n    fire: undefined,\r\n    blood: undefined,\r\n    light: undefined,\r\n    dark: undefined,\r\n  }\r\n  keys.forEach((key) => {\r\n    const roll = rolls[key] as CharacterRollT\r\n    let result = resolveRoll(roll, true, false, label)\r\n    if (crit) {\r\n      result = {\r\n        ...result,\r\n        total: result.maxTotal || result.total,\r\n      }\r\n    }\r\n    total += result.total\r\n    rollResults = { ...rollResults, [key]: result }\r\n  })\r\n  return {\r\n    total,\r\n    rollResults,\r\n  }\r\n}\r\n\r\nexport const ZERO_DAMAGE_ROLLS: DamageTypeRollsT = {\r\n  slashing: makeCharacterRoll([]),\r\n  piercing: makeCharacterRoll([]),\r\n  fire: makeCharacterRoll([]),\r\n  blood: makeCharacterRoll([]),\r\n  light: makeCharacterRoll([]),\r\n  dark: makeCharacterRoll([]),\r\n}\r\nconst force = (roll?: CharacterRollT) => roll as CharacterRollT\r\n\r\nexport const combineDamageTypeRolls = (...rolls: DamageTypeRollsT[]) => {\r\n  return rolls.reduce((p, c) => {\r\n    let ret: DamageTypeRollsT = {}\r\n    getKeys(p).forEach((key) => {\r\n      ret[key] = c[key]\r\n        ? combineCharacterRolls(force(p[key]), force(c[key]))\r\n        : p[key]\r\n    })\r\n    return ret\r\n  }, ZERO_DAMAGE_ROLLS)\r\n}\r\n","export const reduce = <TList, TRestult>(\r\n  list: TList[],\r\n  reducer: (result: TRestult, current: TList, index?: number) => TRestult,\r\n  initialValue: TRestult,\r\n): TRestult => {\r\n  return list.reduce(reducer as any, initialValue as TRestult) as TRestult\r\n}\r\n","import { CharacterTraitT, CharacterT, ProcessedCharacterT } from './Character'\r\nimport { SkillT } from './Skill'\r\nimport { getKeys } from '../util/getKeys'\r\nimport { reduce } from '../util/reduce'\r\n\r\nexport type EventTypeT = 'onHit' | 'onCrit'\r\nexport type EventsT = Partial<Record<EventTypeT, CharacterTraitT[]>>\r\nexport const EventsTypeMap: Record<EventTypeT, string> = {\r\n  onHit: 'on hit',\r\n  onCrit: 'on crit',\r\n}\r\n\r\nexport const checkEvent = (character: CharacterT, skill: SkillT) => (\r\n  event: EventTypeT,\r\n): CharacterTraitT[] | undefined => {\r\n  if ((character as ProcessedCharacterT).processed) {\r\n    throw new Error('No Processed Characters [checkEvent]')\r\n  }\r\n  const skillTraits = skill.events[event]\r\n  if (skill.combineWeaponDamage) {\r\n    const { weapon } = character\r\n    if (!weapon) return skillTraits\r\n    const traits = weapon.events[event]\r\n    if (!traits) return skillTraits\r\n    return [...(skillTraits || []), ...traits]\r\n  }\r\n  return skillTraits\r\n}\r\n\r\nconst force = (traits?: CharacterTraitT[]) => traits || []\r\nexport const combineEvents = (...events: EventsT[]): EventsT => {\r\n  return reduce<EventsT, EventsT>(\r\n    events,\r\n    (p, c) => {\r\n      let ret: EventsT = {}\r\n      getKeys(p).forEach((key) => {\r\n        ret[key] = [...force(p[key]), ...force(c[key])]\r\n      })\r\n      return ret\r\n    },\r\n    {\r\n      onHit: [],\r\n      onCrit: [],\r\n    },\r\n  )\r\n}\r\n","import { EquippableT, ItemRarityT } from './Item'\r\nimport {\r\n  DamageTypeRollsT,\r\n  ZERO_DAMAGE_ROLLS,\r\n  combineDamageTypeRolls,\r\n} from './Damage'\r\nimport { CharacterT, ProcessedCharacterT, CharacterTraitT } from './Character'\r\nimport { CharacterCheckT, makeCharacterRoll } from './Roll2'\r\nimport { EventsT, combineEvents } from './Events'\r\nimport { reduce } from '../util/reduce'\r\n\r\nexport type WeaponTypeT =\r\n  // default\r\n  | 'fists'\r\n  // S\r\n  | 'axe' // s,1\r\n  | 'greataxe' // s,2\r\n  | 'flail' // p,1\r\n  // D\r\n  | 'daggers' // p,2\r\n  | 'katana' // s,1\r\n  | 'rapier' // p,1\r\n  // I\r\n  | 'wand' // e,1\r\n  | 'staff' // e,2\r\n  // S+I\r\n  | 'elementalSword' // s,e,1\r\n  | 'elementalGreatsword' // s,e,2\r\n  // S+D\r\n  | 'sword' // s,1\r\n  | 'greatsword' // s,2\r\n  // D+I\r\n  | 'pistol' // p,e,1\r\n  | 'crossbow' // p,e,2\r\n\r\nexport type WeaponIconKeyT =\r\n  | 'fire-sword'\r\n  | 'blood-sword'\r\n  | 'light-sword'\r\n  | 'dark-sword'\r\nexport interface WeaponT extends EquippableT {\r\n  type: 'weapon'\r\n  weaponType: WeaponTypeT\r\n  accuracyCheck: CharacterCheckT\r\n  damageRolls: DamageTypeRollsT\r\n  events: EventsT\r\n  slotCount: number\r\n  slots: WeaponModT[]\r\n}\r\nexport interface ProcessedWeaponT extends WeaponT {\r\n  processed: true\r\n}\r\n\r\nexport interface WeaponTraitT {\r\n  id: string\r\n  accuracyOffset: number\r\n  damageRolls: DamageTypeRollsT\r\n  events: EventsT\r\n  traits: CharacterTraitT[]\r\n}\r\nexport const ZERO_WEAPON_TRAIT: WeaponTraitT = {\r\n  id: '',\r\n  accuracyOffset: 0,\r\n  damageRolls: ZERO_DAMAGE_ROLLS,\r\n  events: {},\r\n  traits: [],\r\n}\r\nexport interface WeaponModT {\r\n  id: string\r\n  name: string\r\n  icon?: string\r\n  rarity: ItemRarityT\r\n  traits: WeaponTraitT[]\r\n}\r\n\r\nexport const combineWeaponTraits = (\r\n  ...traits: WeaponTraitT[]\r\n): WeaponTraitT => {\r\n  return traits.reduce((p, c) => {\r\n    return {\r\n      id: c.id,\r\n      accuracyOffset: p.accuracyOffset + c.accuracyOffset,\r\n      damageRolls: combineDamageTypeRolls(p.damageRolls, c.damageRolls),\r\n      events: combineEvents(p.events, c.events),\r\n      traits: [...p.traits, ...c.traits],\r\n    }\r\n  }, ZERO_WEAPON_TRAIT)\r\n}\r\n\r\nexport const processWeapon = (weapon: WeaponT): ProcessedWeaponT => {\r\n  if ((weapon as ProcessedWeaponT).processed) {\r\n    throw new Error('No Processed Weapons Allowed')\r\n  }\r\n  const mods = weapon.slots\r\n  const traits = reduce<WeaponModT, WeaponTraitT[]>(\r\n    mods,\r\n    (p, c) => [...p, ...c.traits],\r\n    [],\r\n  )\r\n  const combinedTrait = combineWeaponTraits(...traits)\r\n  const ret: ProcessedWeaponT = {\r\n    ...weapon,\r\n    processed: true,\r\n    accuracyCheck: {\r\n      ...weapon.accuracyCheck,\r\n      value: weapon.accuracyCheck.value + combinedTrait.accuracyOffset,\r\n    },\r\n    damageRolls: combineDamageTypeRolls(\r\n      weapon.damageRolls,\r\n      combinedTrait.damageRolls,\r\n    ),\r\n    traits: [...weapon.traits, ...combinedTrait.traits],\r\n    events: combineEvents(weapon.events, combinedTrait.events),\r\n  }\r\n  return ret\r\n}\r\n","import { EquippableT, ItemTypeT } from '../types/Item'\r\nimport { v4 } from 'uuid'\r\nimport { CharacterSkillCheckKeyT, CharacterTraitT } from '../types/Character'\r\nimport {\r\n  CharacterCheckT,\r\n  makeCharacterCheck,\r\n  makeCharacterRoll,\r\n} from '../types/Roll2'\r\n\r\nexport const makeRequirementCheck = (\r\n  keys: CharacterSkillCheckKeyT[],\r\n  value: number,\r\n): CharacterCheckT => makeCharacterCheck(keys, '', value, undefined)\r\n\r\nexport const BASE_EQUIPPABLE = (type: ItemTypeT): EquippableT => {\r\n  const id = v4()\r\n  return {\r\n    id,\r\n    type,\r\n    rarity: 'common',\r\n    equippable: true,\r\n    name: '',\r\n    cost: 0,\r\n    resource: 'weaponHands',\r\n    requirementCheck: makeRequirementCheck(['intelligence'], 1),\r\n    traits: [\r\n      {\r\n        id: `${id}-0`,\r\n        name: 'Bonus',\r\n        duration: -1,\r\n        healthOffset: 0,\r\n        focusOffset: 0,\r\n        abilitiesModifiers: {\r\n          strength: 0,\r\n          dexterity: 0,\r\n          intelligence: 0,\r\n          vigor: 0,\r\n        },\r\n        statsModifiers: {\r\n          health: 0,\r\n          focus: 0,\r\n          will: 0,\r\n          perception: 0,\r\n          agility: 0,\r\n          accuracy: 0,\r\n          evade: 0,\r\n        },\r\n      },\r\n    ],\r\n    damageResistances: {\r\n      slashing: makeCharacterRoll([]),\r\n      piercing: makeCharacterRoll([]),\r\n      fire: makeCharacterRoll([]),\r\n      blood: makeCharacterRoll([]),\r\n      light: makeCharacterRoll([]),\r\n      dark: makeCharacterRoll([]),\r\n    },\r\n  }\r\n}\r\n\r\nexport const makeTrait = (name: string = ''): CharacterTraitT => {\r\n  return {\r\n    id: v4(),\r\n    name,\r\n    duration: -1,\r\n    healthOffset: 0,\r\n    focusOffset: 0,\r\n    abilitiesModifiers: {\r\n      strength: 0,\r\n      dexterity: 0,\r\n      intelligence: 0,\r\n      vigor: 0,\r\n    },\r\n    statsModifiers: {\r\n      health: 0,\r\n      focus: 0,\r\n      will: 0,\r\n      perception: 0,\r\n      agility: 0,\r\n      accuracy: 0,\r\n      evade: 0,\r\n    },\r\n  }\r\n}\r\n","import { WeaponT } from '../types/Weapon'\r\nimport { v4 } from 'uuid'\r\nimport { BASE_EQUIPPABLE, makeRequirementCheck } from './util'\r\nimport { makeCharacterCheck, makeCharacterRoll } from '../types/Roll2'\r\n\r\nexport const FISTS: WeaponT = {\r\n  ...BASE_EQUIPPABLE('weapon'),\r\n  id: v4(),\r\n  equippable: true,\r\n  type: 'weapon',\r\n  weaponType: 'fists',\r\n  name: 'Unarmed',\r\n  cost: 0,\r\n  resource: 'weaponHands',\r\n  requirementCheck: makeRequirementCheck(['strength'], 1),\r\n  damageRolls: {\r\n    piercing: makeCharacterRoll([], '1d6', -3),\r\n  },\r\n  accuracyCheck: makeCharacterCheck(['dexterity']),\r\n  traits: [],\r\n  events: {},\r\n  slotCount: 0,\r\n  slots: [],\r\n}\r\n","import { WeaponT, ProcessedWeaponT, processWeapon } from './Weapon'\r\nimport { EquippableT } from './Item'\r\nimport { FISTS } from '../objects/fists'\r\nimport { DamageTypeRollsT, getDamageTypeKeys, DamageTypeKeyT } from './Damage'\r\nimport { ArmorT } from './Armor'\r\nimport { reduce } from '../util/reduce'\r\nimport { v4 } from 'uuid'\r\nimport { noneg } from '../util/noneg'\r\nimport { makeTrait } from '../objects/util'\r\nimport {\r\n  combineCharacterRolls,\r\n  CharacterRollT,\r\n  resolveCharacterCheck,\r\n} from './Roll2'\r\nimport { SkillT } from './Skill'\r\n\r\nexport type CharacterAbilityKeyT =\r\n  | 'strength'\r\n  | 'dexterity'\r\n  | 'intelligence'\r\n  | 'vigor'\r\nexport type CharacterAbilitiesT = Record<CharacterAbilityKeyT, number>\r\n\r\nexport type CharacterStatKeyT =\r\n  | 'health'\r\n  | 'focus'\r\n  | 'will'\r\n  | 'perception'\r\n  | 'agility'\r\n  | 'accuracy'\r\n  | 'evade'\r\nexport type CharacterStatsT = Record<CharacterStatKeyT, number>\r\n\r\nexport type CharacterResourceKeyT =\r\n  | 'characterPoints'\r\n  | 'weaponHands'\r\n  | 'heads'\r\n  | 'bodies'\r\n  | 'hands'\r\n  | 'fingers'\r\n  | 'feet'\r\nexport type CharacterResourcesT = Record<CharacterResourceKeyT, number>\r\n\r\nexport type CharacterSkillCheckKeyT = CharacterAbilityKeyT | CharacterStatKeyT\r\n\r\nexport interface CharacterTraitT {\r\n  id: string\r\n  name: string\r\n  healthOffset: number\r\n  focusOffset: number\r\n  abilitiesModifiers: CharacterAbilitiesT\r\n  statsModifiers: CharacterStatsT\r\n  duration: number\r\n}\r\n\r\nexport interface CharacterT {\r\n  name: string\r\n  id: string\r\n  power: number\r\n  resources: CharacterResourcesT\r\n  abilities: CharacterAbilitiesT\r\n  damageResistances: DamageTypeRollsT\r\n  traits: CharacterTraitT[]\r\n  skills: SkillT[]\r\n\r\n  equippedItems: EquippableT[]\r\n  armor: ArmorT[]\r\n  weapon?: WeaponT\r\n\r\n  healthOffset: number\r\n  focusOffset: number\r\n  partyId?: string\r\n  dead: boolean\r\n  inspected: boolean\r\n}\r\nexport interface ProcessedCharacterT extends CharacterT {\r\n  stats: CharacterStatsT\r\n  weapon: ProcessedWeaponT\r\n  processed: true\r\n}\r\n\r\nexport const getTraits = (character: CharacterT): CharacterTraitT[] => {\r\n  const armorTraits: CharacterTraitT[] = reduce<ArmorT, CharacterTraitT[]>(\r\n    character.armor,\r\n    (result, item) => [...result, ...item.traits],\r\n    [],\r\n  )\r\n  const equippedItemTraits: CharacterTraitT[] = reduce<\r\n    EquippableT,\r\n    CharacterTraitT[]\r\n  >(character.equippedItems, (result, item) => [...result, ...item.traits], [])\r\n  return [\r\n    ...character.traits,\r\n    ...processWeapon(character.weapon || FISTS).traits,\r\n    ...equippedItemTraits,\r\n    ...armorTraits,\r\n  ]\r\n}\r\n\r\nexport const getAbilities = (character: CharacterT): CharacterAbilitiesT => {\r\n  return getTraits(character)\r\n    .map((trait) => trait.abilitiesModifiers)\r\n    .reduce(\r\n      (result, cur) => ({\r\n        strength: result.strength + cur.strength,\r\n        dexterity: result.dexterity + cur.dexterity,\r\n        intelligence: result.intelligence + cur.intelligence,\r\n        vigor: result.vigor + cur.vigor,\r\n      }),\r\n      character.abilities,\r\n    )\r\n}\r\n\r\nexport const getStats = (character: CharacterT): CharacterStatsT => {\r\n  const abilities = getAbilities(character)\r\n  return getTraits(character)\r\n    .map((trait) => trait.statsModifiers)\r\n    .reduce(\r\n      (result, cur) => ({\r\n        health: result.health + cur.health,\r\n        focus: result.focus + cur.focus,\r\n        will: result.will + cur.will,\r\n        perception: result.perception + cur.perception,\r\n        agility: result.agility + cur.agility,\r\n        accuracy: result.accuracy + cur.accuracy,\r\n        evade: result.evade + cur.evade,\r\n      }),\r\n      {\r\n        health: abilities.strength * 2 + abilities.vigor,\r\n        focus: abilities.intelligence + abilities.vigor,\r\n        will: abilities.intelligence,\r\n        perception: abilities.intelligence,\r\n        // lift: (abilities.strength * abilities.strength) / 5,\r\n        agility: (abilities.vigor + abilities.dexterity) / 4,\r\n        accuracy: abilities.dexterity - 2,\r\n        evade: abilities.dexterity - 8,\r\n      },\r\n    )\r\n}\r\n\r\nexport const getDamageResistances = (\r\n  character: CharacterT,\r\n): DamageTypeRollsT => {\r\n  const armor = character.armor\r\n  const keys = getDamageTypeKeys(character.damageResistances)\r\n  return reduce<DamageTypeKeyT, DamageTypeRollsT>(\r\n    keys,\r\n    (result, key) => {\r\n      return {\r\n        ...result,\r\n        [key]: combineCharacterRolls(\r\n          result[key] as CharacterRollT,\r\n          ...armor.map((a) => a.damageResistances[key] as CharacterRollT),\r\n        ),\r\n      }\r\n    },\r\n    character.damageResistances,\r\n  )\r\n}\r\n\r\nexport const processCharacter = (\r\n  character: CharacterT,\r\n  withWeapon: boolean = true,\r\n): ProcessedCharacterT => {\r\n  if ((character as ProcessedCharacterT).processed)\r\n    return character as ProcessedCharacterT\r\n  character = withWeapon\r\n    ? character\r\n    : {\r\n        ...character,\r\n        weapon: undefined,\r\n      }\r\n\r\n  const abilities = getAbilities(character)\r\n  const stats = getStats(character)\r\n  const traits = getTraits(character)\r\n  const damageResistances = getDamageResistances(character)\r\n  const healthOffset = noneg(\r\n    traits.reduce((p, c) => p - c.healthOffset, character.healthOffset),\r\n  )\r\n  return {\r\n    ...character,\r\n    healthOffset,\r\n    weapon: processWeapon(character.weapon || FISTS),\r\n    abilities,\r\n    stats,\r\n    traits,\r\n    damageResistances,\r\n    processed: true,\r\n    dead: healthOffset >= stats.health,\r\n  }\r\n}\r\n\r\n// TODO: Maybe add the rest, but healthOffset is the wonky one\r\nexport const commitTrait = (character: CharacterT) => (\r\n  trait: CharacterTraitT,\r\n): CharacterT => {\r\n  return {\r\n    ...character,\r\n    healthOffset: noneg(character.healthOffset - trait.healthOffset),\r\n    focusOffset: noneg(character.focusOffset - trait.focusOffset),\r\n  }\r\n}\r\n\r\nexport const getModifierValueFromKeys = (character: ProcessedCharacterT) => (\r\n  keys: CharacterSkillCheckKeyT[],\r\n) =>\r\n  (keys as any[]).reduce((total: number = 0, key: CharacterSkillCheckKeyT) => {\r\n    const a: number = character.abilities[key as CharacterAbilityKeyT]\r\n    const s: number = character.stats[key as CharacterStatKeyT]\r\n    if (a) total += a\r\n    if (s) total += s\r\n    return total\r\n  }, 0)\r\n\r\nexport const setCharacterAbilityScore = (character: CharacterT) => (\r\n  key: CharacterAbilityKeyT,\r\n  value: number,\r\n  characterPoints: number = character.resources.characterPoints,\r\n): [CharacterT, EquippableT[]] =>\r\n  validateCharacter({\r\n    ...character,\r\n    power:\r\n      character.power + (character.resources.characterPoints - characterPoints),\r\n    resources: {\r\n      ...character.resources,\r\n      characterPoints,\r\n    },\r\n    abilities: {\r\n      ...character.abilities,\r\n      [key]: value,\r\n    },\r\n  })\r\n\r\nexport const CharacterKeyMap3: Record<CharacterSkillCheckKeyT, string> = {\r\n  strength: 'STR',\r\n  dexterity: 'DEX',\r\n  intelligence: 'INT',\r\n  vigor: 'VIG',\r\n  health: 'HLT',\r\n  focus: 'FOC',\r\n  will: 'WIL',\r\n  perception: 'PER',\r\n  // lift: 'LFT',\r\n  agility: 'AGL',\r\n  accuracy: 'ACC',\r\n  evade: 'EVD',\r\n}\r\n\r\nexport const characterAbilityScoreCosts: Record<\r\n  CharacterAbilityKeyT,\r\n  number\r\n> = {\r\n  strength: 10,\r\n  dexterity: 20,\r\n  intelligence: 20,\r\n  vigor: 10,\r\n}\r\n\r\nexport const CharacterStatsCostsMap: Record<CharacterSkillCheckKeyT, number> = {\r\n  ...characterAbilityScoreCosts,\r\n  health: 5,\r\n  focus: 5,\r\n  will: 10,\r\n  perception: 10,\r\n  // lift: 1,\r\n  agility: 10,\r\n  accuracy: 10,\r\n  evade: 10,\r\n}\r\n\r\nexport const canEquip = (character: CharacterT) => (\r\n  item: EquippableT,\r\n  withWeapon?: boolean,\r\n): boolean => {\r\n  if (!item) return false\r\n  if (!item.equippable) return false\r\n  const equipable = item as EquippableT\r\n  const processedCharacter = processCharacter(character, withWeapon)\r\n  if (\r\n    !resolveCharacterCheck(equipable.requirementCheck, processedCharacter)\r\n      .result\r\n  )\r\n    return false\r\n  if (equipable.type === 'weapon' && character.weapon) {\r\n    return false\r\n  } else {\r\n    if (processedCharacter.resources[equipable.resource] < equipable.cost)\r\n      return false\r\n  }\r\n  return true\r\n}\r\n\r\nexport const equipItem = (character: CharacterT) => (\r\n  item: EquippableT,\r\n): CharacterT => {\r\n  if (!canEquip(character)(item)) return character\r\n  if (item.type === 'armor') return equipArmor(character)(item as ArmorT)\r\n  if (item.type === 'weapon') return equipWeapon(character)(item as WeaponT)\r\n  return equipGenericItem(character)(item)\r\n}\r\n\r\nexport const unequipItem = (\r\n  character: CharacterT,\r\n  validate: boolean = true,\r\n) => (itemId: string): [EquippableT[], CharacterT] => {\r\n  let equippables: EquippableT[] = []\r\n  let c = { ...character }\r\n  if (character.weapon?.id === itemId) {\r\n    equippables = [{ ...character.weapon }]\r\n    c = unequipWeapon(c)\r\n  }\r\n  const armor = character.armor.find((i) => i.id === itemId)\r\n  if (armor) {\r\n    equippables = [{ ...armor }]\r\n    c = unequipArmor(character)(armor)\r\n  }\r\n  const item = character.equippedItems.find((i) => i.id === itemId)\r\n  if (item) {\r\n    equippables = [{ ...item }]\r\n    c = unequipGenericItem(character)(item)\r\n  }\r\n  if (validate) {\r\n    let vr = validateCharacter(c)\r\n    c = vr[0]\r\n    equippables = [...equippables, ...vr[1]]\r\n  }\r\n  return [equippables, c]\r\n}\r\n\r\nexport const equipGenericItem = (character: CharacterT) => (\r\n  item: EquippableT,\r\n): CharacterT => {\r\n  const resourceValue = character.resources[item.resource]\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      [item.resource]: resourceValue - item.cost,\r\n    },\r\n    equippedItems: [...character.equippedItems, item],\r\n  }\r\n}\r\n\r\nexport const unequipGenericItem = (character: CharacterT) => (\r\n  item: EquippableT,\r\n): CharacterT => {\r\n  if (!item) return character\r\n  const resourceValue = character.resources[item.resource]\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      [item.resource]: resourceValue + item.cost,\r\n    },\r\n    equippedItems: character.equippedItems.filter((i) => i.id !== item.id),\r\n  }\r\n}\r\n\r\nexport const equipArmor = (character: CharacterT) => (\r\n  item: ArmorT,\r\n): CharacterT => {\r\n  const resourceValue = character.resources[item.resource]\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      [item.resource]: resourceValue - item.cost,\r\n    },\r\n    armor: [...character.armor, item],\r\n  }\r\n}\r\n\r\nexport const unequipArmor = (character: CharacterT) => (\r\n  item: ArmorT,\r\n): CharacterT => {\r\n  if (!item) return character\r\n  const resourceValue = character.resources[item.resource]\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      [item.resource]: resourceValue + item.cost,\r\n    },\r\n    armor: character.armor.filter((i) => i.id !== item.id),\r\n  }\r\n}\r\n\r\nexport const equipWeapon = (character: CharacterT) => (\r\n  item: WeaponT,\r\n): CharacterT => {\r\n  if (item.type !== 'weapon') return character\r\n  let weapon = character.weapon\r\n  if (weapon?.id === FISTS.id) weapon = undefined\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      weaponHands:\r\n        character.resources.weaponHands -\r\n        item.cost +\r\n        (weapon ? weapon.cost : 0),\r\n    },\r\n    weapon: item,\r\n  }\r\n}\r\n\r\nexport const unequipWeapon = (character: CharacterT): CharacterT => {\r\n  if (!character.weapon) return character\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      weaponHands: character.resources.weaponHands + character.weapon.cost,\r\n    },\r\n    weapon: undefined,\r\n  }\r\n}\r\n\r\nexport const getTraitValue = (\r\n  trait: CharacterTraitT,\r\n  key: CharacterSkillCheckKeyT,\r\n) => {\r\n  const abilityValue = trait.abilitiesModifiers[key as CharacterAbilityKeyT]\r\n  const statValue = trait.statsModifiers[key as CharacterStatKeyT]\r\n  return abilityValue !== undefined ? abilityValue : statValue\r\n}\r\n\r\nexport const combineTraits = (traits: CharacterTraitT[]): CharacterTraitT => {\r\n  const id = v4()\r\n  const name = 'combine' + id\r\n  return traits.reduce((result, current) => {\r\n    const ar = result.abilitiesModifiers\r\n    const ac = current.abilitiesModifiers\r\n    const sr = result.statsModifiers\r\n    const sc = current.statsModifiers\r\n    return {\r\n      id,\r\n      name,\r\n      duration: current.duration,\r\n      healthOffset: result.healthOffset + current.healthOffset,\r\n      focusOffset: result.focusOffset + current.focusOffset,\r\n      abilitiesModifiers: {\r\n        strength: ar.strength + ac.strength,\r\n        dexterity: ar.dexterity + ac.dexterity,\r\n        intelligence: ar.intelligence + ac.intelligence,\r\n        vigor: ar.vigor + ac.vigor,\r\n      },\r\n      statsModifiers: {\r\n        health: sr.health + sc.health,\r\n        focus: sr.focus + sc.focus,\r\n        will: sr.will + sc.will,\r\n        perception: sr.perception + sc.perception,\r\n        agility: sr.agility + sc.agility,\r\n        accuracy: sr.accuracy + sc.accuracy,\r\n        evade: sr.evade + sc.evade,\r\n      },\r\n    }\r\n  }, makeTrait())\r\n}\r\n\r\nexport const validateCharacter = (\r\n  character: CharacterT,\r\n): [CharacterT, EquippableT[]] => {\r\n  let pc = processCharacter(character)\r\n  let result = { ...character }\r\n  let removedItems: EquippableT[] = []\r\n  const localUpdate = (c: CharacterT) => {\r\n    result = { ...c }\r\n    pc = processCharacter(c)\r\n  }\r\n  if (!resolveCharacterCheck(pc.weapon.requirementCheck, pc).result) {\r\n    const unequipResult = unequipItem(result, false)(pc.weapon.id)\r\n    localUpdate(unequipResult[1])\r\n    if (unequipResult[0]) removedItems = [...removedItems, ...unequipResult[0]]\r\n  }\r\n  pc.armor.forEach((i) => {\r\n    if (!resolveCharacterCheck(i.requirementCheck, pc).result) {\r\n      const unequipResult = unequipItem(result, false)(i.id)\r\n      localUpdate(unequipResult[1])\r\n      if (unequipResult[0])\r\n        removedItems = [...removedItems, ...unequipResult[0]]\r\n    }\r\n  })\r\n  pc.equippedItems.forEach((i) => {\r\n    if (!resolveCharacterCheck(i.requirementCheck, pc).result) {\r\n      if (!resolveCharacterCheck(i.requirementCheck, pc).result) {\r\n        const unequipResult = unequipItem(result, false)(i.id)\r\n        localUpdate(unequipResult[1])\r\n        if (unequipResult[0])\r\n          removedItems = [...removedItems, ...unequipResult[0]]\r\n      }\r\n    }\r\n  })\r\n\r\n  if (\r\n    result.weapon?.id !== character.weapon?.id ||\r\n    result.armor.length !== character.armor.length ||\r\n    result.equippedItems.length !== result.equippedItems.length\r\n  ) {\r\n    const [ret, items] = validateCharacter(result)\r\n    removedItems = [...removedItems, ...items]\r\n    localUpdate(ret)\r\n  }\r\n  return [result, removedItems]\r\n}\r\n","import { CharacterT } from '../types/Character'\r\nimport { v4 } from 'uuid'\r\nimport { makeCharacterRoll } from '../types/Roll2'\r\n/*\r\nimport { Config, adjectives, names } from 'unique-names-generator'\r\n\r\nconst config: Config = {\r\n  dictionaries: [adjectives, names],\r\n  length: 2,\r\n  separator: ' ',\r\n}\r\n*/\r\n\r\nexport const BASE_CHARACTER: CharacterT = {\r\n  name: '-- init --', //uniqueNamesGenerator(config),\r\n  id: v4(),\r\n  power: 0,\r\n  resources: {\r\n    characterPoints: 0,\r\n    weaponHands: 0,\r\n    heads: 0,\r\n    bodies: 0,\r\n    hands: 0,\r\n    fingers: 0,\r\n    feet: 0,\r\n  },\r\n  abilities: {\r\n    strength: 0,\r\n    dexterity: 0,\r\n    intelligence: 0,\r\n    vigor: 0,\r\n  },\r\n  damageResistances: {\r\n    slashing: makeCharacterRoll([]),\r\n    piercing: makeCharacterRoll([]),\r\n    fire: makeCharacterRoll([]),\r\n    blood: makeCharacterRoll([]),\r\n    light: makeCharacterRoll([]),\r\n    dark: makeCharacterRoll([]),\r\n  },\r\n\r\n  traits: [],\r\n  skills: [],\r\n\r\n  equippedItems: [],\r\n  armor: [],\r\n\r\n  healthOffset: 0,\r\n  focusOffset: 0,\r\n  dead: false,\r\n  inspected: false,\r\n}\r\n","import { CharacterT, ProcessedCharacterT, processCharacter } from './Character'\r\nimport { ItemT, EquippableT } from './Item'\r\nimport { SkillT } from './Skill'\r\nimport { WeaponModT } from './Weapon'\r\n\r\nexport interface PartyT {\r\n  id: string\r\n  items: EquippableT[]\r\n  characters: CharacterT[]\r\n  skills: SkillT[]\r\n  mods: WeaponModT[]\r\n}\r\nexport interface ProcessedPartyT {\r\n  id: string\r\n  items: EquippableT[]\r\n  characters: ProcessedCharacterT[]\r\n  skills: SkillT[]\r\n  mods: WeaponModT[]\r\n  processed: true\r\n}\r\n\r\nexport const processParty = (party: PartyT): ProcessedPartyT => ({\r\n  ...party,\r\n  characters: party.characters.map((c) => ({\r\n    ...processCharacter(c),\r\n    partyId: party.id,\r\n  })),\r\n  processed: true,\r\n})\r\n","import { StateCoreT, StateReducerT } from './types'\r\n\r\nexport const makeReducer = (\r\n  core: StateCoreT,\r\n  initialState: any,\r\n): StateReducerT => {\r\n  return (state = initialState, action) => {\r\n    const coreFn = core[action.type]\r\n    if (coreFn) return coreFn(state, action)\r\n    return state\r\n  }\r\n}\r\n","export interface IDT {\r\n  id: string\r\n}\r\nexport const upsertIn = <T extends IDT>(list: T[], item: T) => {\r\n  return [...list.filter((i) => i.id !== item.id), item]\r\n}\r\n\r\nexport const updateIn = <T extends IDT>(\r\n  list: T[],\r\n  id: string,\r\n  accessor: (i: T) => T,\r\n) => {\r\n  return list.map((i) => (i.id === id ? accessor(i) : i))\r\n}\r\n","export const getRandom = <T>(items: T[]) =>\r\n  items[Math.floor(Math.random() * items.length)]\r\n","import { EquippableT } from '../types/Item'\r\nimport { BASE_EQUIPPABLE, makeTrait, makeRequirementCheck } from './util'\r\nimport { makeCharacterRoll } from '../types/Roll2'\r\n\r\nexport const BASIC_SHIELD: EquippableT = {\r\n  ...BASE_EQUIPPABLE('shield'),\r\n  id: 'basic-shield',\r\n  equippable: true,\r\n  type: 'shield',\r\n  rarity: 'rare',\r\n  name: 'Basic Shield',\r\n  cost: 1,\r\n  resource: 'weaponHands',\r\n  requirementCheck: makeRequirementCheck(['strength'], 3),\r\n  traits: [\r\n    {\r\n      ...makeTrait(),\r\n      id: 'basic-shield--bonus',\r\n      abilitiesModifiers: {\r\n        strength: 1,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: 2,\r\n      },\r\n      statsModifiers: {\r\n        health: 0,\r\n        focus: 0,\r\n        will: 0,\r\n        perception: 0,\r\n        agility: -2,\r\n        accuracy: 0,\r\n        evade: 0,\r\n      },\r\n    },\r\n  ],\r\n  damageResistances: {\r\n    slashing: makeCharacterRoll([], undefined, 3),\r\n    piercing: makeCharacterRoll([], undefined, 2),\r\n    fire: makeCharacterRoll([]),\r\n    blood: makeCharacterRoll([]),\r\n    light: makeCharacterRoll([]),\r\n    dark: makeCharacterRoll([]),\r\n  },\r\n}\r\n","import { EquippableT } from '../types/Item'\r\nimport { BASE_EQUIPPABLE, makeTrait, makeRequirementCheck } from './util'\r\nimport { makeCharacterRoll } from '../types/Roll2'\r\n\r\nexport const BASIC_TOME: EquippableT = {\r\n  ...BASE_EQUIPPABLE('tome'),\r\n  id: 'basic-tome',\r\n  equippable: true,\r\n  type: 'tome',\r\n  rarity: 'unique',\r\n  name: 'Basic Tome',\r\n  cost: 1,\r\n  resource: 'weaponHands',\r\n  requirementCheck: makeRequirementCheck(['intelligence'], 12),\r\n  traits: [\r\n    {\r\n      ...makeTrait(),\r\n      id: 'basic-tome--bonus',\r\n      abilitiesModifiers: {\r\n        strength: 0,\r\n        dexterity: 0,\r\n        intelligence: 4,\r\n        vigor: 0,\r\n      },\r\n    },\r\n  ],\r\n  damageResistances: {\r\n    slashing: makeCharacterRoll([]),\r\n    piercing: makeCharacterRoll([]),\r\n    fire: makeCharacterRoll([]),\r\n    blood: makeCharacterRoll([]),\r\n    light: makeCharacterRoll([]),\r\n    dark: makeCharacterRoll([]),\r\n  },\r\n}\r\n","import { ArmorTypeT } from '../../../types/Armor'\r\n\r\nexport const ArmorUniqueNames: Record<ArmorTypeT, string[]> = {\r\n  helmet: ['Helmet of Doom', 'Helmet of Dawn'],\r\n  cowl: ['Hood of the Night'],\r\n  chestplate: ['Armor of the King'],\r\n  robe: ['Robe of the Necromancer'],\r\n  gloves: ['Gloves of the Great War'],\r\n  ring: ['Ring of Green', 'Silver Serpant Ring'],\r\n  boots: ['Boots of the Gods'],\r\n}\r\n","import { ItemRarityT } from '../../types/Item'\r\nimport { CharacterSkillCheckKeyT } from '../../types/Character'\r\nimport { ItemModifierValuesT } from './makeItem'\r\nimport { getRandom } from '../../util/getRandom'\r\n\r\nexport const shuffleArray = <T>(a: T[]): T[] => {\r\n  let array = [...a]\r\n  for (let i = array.length - 1; i > 0; i--) {\r\n    const j = Math.floor(Math.random() * (i + 1))\r\n    ;[array[i], array[j]] = [array[j], array[i]]\r\n  }\r\n  return array\r\n}\r\n\r\nexport const Rarity3d6Map: Record<number, ItemRarityT> = {\r\n  3: 'set',\r\n  4: 'unique',\r\n  5: 'legendary',\r\n  6: 'rare',\r\n  7: 'uncommon',\r\n  8: 'common',\r\n  9: 'common',\r\n  10: 'common',\r\n  11: 'common',\r\n  12: 'common',\r\n  13: 'uncommon',\r\n  14: 'uncommon',\r\n  15: 'rare',\r\n  16: 'legendary',\r\n  17: 'unique',\r\n  18: 'mythic',\r\n}\r\n\r\nexport const getItemStatRolls = (\r\n  keys: CharacterSkillCheckKeyT[],\r\n  count: number,\r\n  requirementScore: number,\r\n): ItemModifierValuesT => {\r\n  let offset = requirementScore - 13\r\n  offset = offset > 0 ? offset : 0\r\n\r\n  let statCount = count + offset\r\n  statCount = statCount > 0 ? statCount : 0\r\n\r\n  let statRolls: ItemModifierValuesT = {}\r\n  for (let i = 0; i < statCount; ++i) {\r\n    let key = getRandom(shuffleArray(keys))\r\n    statRolls[key] = (statRolls[key] || 0) + 1\r\n  }\r\n  return statRolls\r\n}\r\n","import {\r\n  CharacterSkillCheckKeyT,\r\n  CharacterAbilityKeyT,\r\n  CharacterResourceKeyT,\r\n} from '../../../types/Character'\r\nimport { ItemRarityT } from '../../../types/Item'\r\nimport { ArmorTypeT } from '../../../types/Armor'\r\nimport { getRandom } from '../../../util/getRandom'\r\nimport { ItemModifierValuesT } from '../makeItem'\r\nimport { ArmorUniqueNames } from './names'\r\nimport { DamageTypeRollsT } from '../../../types/Damage'\r\nimport { shuffleArray, getItemStatRolls } from '../util'\r\nimport { quickRoll, makeCharacterRoll } from '../../../types/Roll2'\r\n\r\nexport const ArmorRequirementKeys: Record<\r\n  ArmorTypeT,\r\n  CharacterAbilityKeyT[]\r\n> = {\r\n  helmet: ['strength', 'dexterity'],\r\n  cowl: ['dexterity', 'intelligence'],\r\n  chestplate: ['strength', 'vigor'],\r\n  robe: ['dexterity', 'intelligence'],\r\n  gloves: ['strength', 'dexterity', 'intelligence'],\r\n  ring: ['strength', 'dexterity', 'intelligence'],\r\n  boots: ['strength', 'dexterity', 'intelligence'],\r\n}\r\n\r\nexport const ArmorCostsT: Record<ArmorTypeT, number> = {\r\n  helmet: 1,\r\n  cowl: 1,\r\n  chestplate: 1,\r\n  robe: 1,\r\n  gloves: 2,\r\n  ring: 1,\r\n  boots: 2,\r\n}\r\n\r\nexport const ArmorResourcesT: Record<ArmorTypeT, CharacterResourceKeyT> = {\r\n  helmet: 'heads',\r\n  cowl: 'heads',\r\n  chestplate: 'bodies',\r\n  robe: 'bodies',\r\n  gloves: 'hands',\r\n  ring: 'fingers',\r\n  boots: 'feet',\r\n}\r\n\r\nexport type ArmorStatKeyT = Record<ArmorTypeT, CharacterSkillCheckKeyT[]>\r\nconst armorStatKeysBase: ArmorStatKeyT = {\r\n  helmet: ['strength', 'intelligence', 'vigor', 'accuracy'],\r\n  cowl: ['dexterity', 'intelligence', 'agility', 'evade'],\r\n  chestplate: ['strength', 'intelligence', 'vigor'],\r\n  robe: ['dexterity', 'intelligence', 'agility', 'evade'],\r\n  gloves: [\r\n    'strength',\r\n    'dexterity',\r\n    'intelligence',\r\n    'vigor',\r\n    'health',\r\n    'focus',\r\n    'agility',\r\n    'accuracy',\r\n  ],\r\n  ring: [\r\n    'strength',\r\n    'dexterity',\r\n    'intelligence',\r\n    'vigor',\r\n    'health',\r\n    'focus',\r\n    'will',\r\n    'perception',\r\n    'agility',\r\n    'accuracy',\r\n    'evade',\r\n  ],\r\n  boots: [\r\n    'strength',\r\n    'dexterity',\r\n    'intelligence',\r\n    'vigor',\r\n    'health',\r\n    'focus',\r\n    'agility',\r\n    'evade',\r\n  ],\r\n}\r\nexport const ArmorRarityStatKeys: Record<ItemRarityT, ArmorStatKeyT> = {\r\n  common: armorStatKeysBase,\r\n  uncommon: armorStatKeysBase,\r\n  rare: armorStatKeysBase,\r\n  legendary: armorStatKeysBase,\r\n  unique: armorStatKeysBase,\r\n  mythic: armorStatKeysBase,\r\n  set: armorStatKeysBase,\r\n}\r\n\r\nexport type ArmorNameKeyT = Record<ArmorTypeT, string>\r\nexport const ArmorNameKeys = (): Record<ItemRarityT, ArmorNameKeyT> => ({\r\n  common: {\r\n    helmet: 'Common Helmet',\r\n    cowl: 'Common Hood',\r\n    chestplate: 'Common Chestplate',\r\n    robe: 'Common Robe',\r\n    gloves: 'Common Gloves',\r\n    ring: 'Common Ring',\r\n    boots: 'Common Boots',\r\n  },\r\n  uncommon: {\r\n    helmet: 'Uncommon Helmet',\r\n    cowl: 'Uncommon Hood',\r\n    chestplate: 'Uncommon Chestplate',\r\n    robe: 'Uncommon Robe',\r\n    gloves: 'Uncommon Gloves',\r\n    ring: 'Uncommon Ring',\r\n    boots: 'Uncommon Boots',\r\n  },\r\n  rare: {\r\n    helmet: 'Rare Helmet',\r\n    cowl: 'Rare Hood',\r\n    chestplate: 'Rare Chestplate',\r\n    robe: 'Rare Robe',\r\n    gloves: 'Rare Gloves',\r\n    ring: 'Rare Ring',\r\n    boots: 'Rare Boots',\r\n  },\r\n  legendary: {\r\n    helmet: 'Epic Helmet',\r\n    cowl: 'Epic Hood',\r\n    chestplate: 'Epic Chestplate',\r\n    robe: 'Epic Robe',\r\n    gloves: 'Epic Gloves',\r\n    ring: 'Epic Ring',\r\n    boots: 'Epic Boots',\r\n  },\r\n  unique: {\r\n    helmet: getRandom(ArmorUniqueNames.helmet),\r\n    cowl: getRandom(ArmorUniqueNames.cowl),\r\n    chestplate: getRandom(ArmorUniqueNames.chestplate),\r\n    robe: getRandom(ArmorUniqueNames.robe),\r\n    gloves: getRandom(ArmorUniqueNames.gloves),\r\n    ring: getRandom(ArmorUniqueNames.ring),\r\n    boots: getRandom(ArmorUniqueNames.boots),\r\n  },\r\n  mythic: {\r\n    helmet: 'Mythic Helmet',\r\n    cowl: 'Mythic Hood',\r\n    chestplate: 'Mythic Chestplate',\r\n    robe: 'Mythic Robe',\r\n    gloves: 'Mythic Gloves',\r\n    ring: 'Mythic Ring',\r\n    boots: 'Mythic Boots',\r\n  },\r\n  set: {\r\n    helmet: 'Set Helmet',\r\n    cowl: 'Set Hood',\r\n    chestplate: 'Set Chestplate',\r\n    robe: 'Set Robe',\r\n    gloves: 'Set Gloves',\r\n    ring: 'Set Ring',\r\n    boots: 'Set Boots',\r\n  },\r\n})\r\n\r\nexport type ArmorStatCountT = Record<ArmorTypeT, number[]>\r\nexport const ArmorRarityStatCounts: Record<ItemRarityT, number> = {\r\n  common: 0,\r\n  uncommon: 1,\r\n  rare: 2,\r\n  legendary: 3,\r\n  unique: 4,\r\n  mythic: 5,\r\n  set: 5,\r\n}\r\n\r\nexport const makeStaticRoll = (str: string) =>\r\n  makeCharacterRoll([], '', quickRoll(str))\r\nexport const makeRoll = (str: string) => makeCharacterRoll([], str)\r\nexport type ArmorResistanceT = Record<ArmorTypeT, DamageTypeRollsT>\r\nexport const ArmorResistances = (): Record<ItemRarityT, ArmorResistanceT> => ({\r\n  common: {\r\n    helmet: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n    },\r\n    cowl: {\r\n      blood: makeStaticRoll('1d2-1'),\r\n      light: makeStaticRoll('1d2-1'),\r\n      dark: makeStaticRoll('1d2-1'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n      fire: makeStaticRoll('1d2-1'),\r\n    },\r\n    robe: {\r\n      fire: makeStaticRoll('1d2-1'),\r\n      blood: makeStaticRoll('1d2-1'),\r\n      light: makeStaticRoll('1d2-1'),\r\n      dark: makeStaticRoll('1d2-1'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n    },\r\n    ring: {\r\n      blood: makeStaticRoll('1d2-1'),\r\n      light: makeStaticRoll('1d2-1'),\r\n      dark: makeStaticRoll('1d2-1'),\r\n    },\r\n    boots: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n    },\r\n  },\r\n  uncommon: {\r\n    helmet: {\r\n      slashing: makeStaticRoll('1d3-1'),\r\n      piercing: makeStaticRoll('1d3-1'),\r\n    },\r\n    cowl: {\r\n      blood: makeStaticRoll('1d3-1'),\r\n      light: makeStaticRoll('1d3-1'),\r\n      dark: makeStaticRoll('1d3-1'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeStaticRoll('1d3-1'),\r\n      piercing: makeStaticRoll('1d3-1'),\r\n      fire: makeStaticRoll('1d3-1'),\r\n    },\r\n    robe: {\r\n      fire: makeStaticRoll('1d3-1'),\r\n      blood: makeStaticRoll('1d3-1'),\r\n      light: makeStaticRoll('1d3-1'),\r\n      dark: makeStaticRoll('1d3-1'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d3-1'),\r\n      piercing: makeStaticRoll('1d3-1'),\r\n    },\r\n    ring: {\r\n      blood: makeStaticRoll('1d3-1'),\r\n      light: makeStaticRoll('1d3-1'),\r\n      dark: makeStaticRoll('1d3-1'),\r\n    },\r\n    boots: {\r\n      slashing: makeStaticRoll('1d3-1'),\r\n      piercing: makeStaticRoll('1d3-1'),\r\n    },\r\n  },\r\n  rare: {\r\n    helmet: {\r\n      slashing: makeStaticRoll('1d4-1'),\r\n      piercing: makeStaticRoll('1d4-1'),\r\n    },\r\n    cowl: {\r\n      blood: makeStaticRoll('1d4-1'),\r\n      light: makeStaticRoll('1d4-1'),\r\n      dark: makeStaticRoll('1d4-1'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeStaticRoll('1d4-1'),\r\n      piercing: makeStaticRoll('1d4-1'),\r\n      fire: makeStaticRoll('1d4-1'),\r\n    },\r\n    robe: {\r\n      fire: makeStaticRoll('1d4-1'),\r\n      blood: makeStaticRoll('1d4-1'),\r\n      light: makeStaticRoll('1d4-1'),\r\n      dark: makeStaticRoll('1d4-1'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d4-1'),\r\n      piercing: makeStaticRoll('1d4-1'),\r\n    },\r\n    ring: {\r\n      blood: makeStaticRoll('1d4-1'),\r\n      light: makeStaticRoll('1d4-1'),\r\n      dark: makeStaticRoll('1d4-1'),\r\n    },\r\n    boots: {\r\n      slashing: makeStaticRoll('1d4-1'),\r\n      piercing: makeStaticRoll('1d4-1'),\r\n    },\r\n  },\r\n  legendary: {\r\n    helmet: {\r\n      slashing: makeStaticRoll('1d5-1'),\r\n      piercing: makeStaticRoll('1d5-1'),\r\n    },\r\n    cowl: {\r\n      blood: makeStaticRoll('1d5-1'),\r\n      light: makeStaticRoll('1d5-1'),\r\n      dark: makeStaticRoll('1d5-1'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeStaticRoll('1d5-1'),\r\n      piercing: makeStaticRoll('1d5-1'),\r\n      fire: makeStaticRoll('1d5-1'),\r\n    },\r\n    robe: {\r\n      fire: makeStaticRoll('1d5-1'),\r\n      blood: makeStaticRoll('1d5-1'),\r\n      light: makeStaticRoll('1d5-1'),\r\n      dark: makeStaticRoll('1d5-1'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d5-1'),\r\n      piercing: makeStaticRoll('1d5-1'),\r\n    },\r\n    ring: {\r\n      fire: makeStaticRoll('1d5-1'),\r\n      blood: makeStaticRoll('1d5-1'),\r\n      light: makeStaticRoll('1d5-1'),\r\n      dark: makeStaticRoll('1d5-1'),\r\n    },\r\n    boots: {\r\n      slashing: makeStaticRoll('1d5-1'),\r\n      piercing: makeStaticRoll('1d5-1'),\r\n    },\r\n  },\r\n  unique: {\r\n    helmet: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    cowl: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    robe: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    ring: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    boots: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n  },\r\n  mythic: {\r\n    helmet: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    cowl: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    robe: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    ring: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    boots: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n  },\r\n  set: {\r\n    helmet: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    cowl: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    robe: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    ring: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    boots: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n  },\r\n})\r\n\r\nexport const getArmorStatRolls = (\r\n  type: ArmorTypeT,\r\n  rarity: ItemRarityT,\r\n  requirementScore: number,\r\n): ItemModifierValuesT => {\r\n  const keys = shuffleArray(ArmorRarityStatKeys[rarity][type])\r\n  let counts = ArmorRarityStatCounts[rarity]\r\n  return getItemStatRolls(keys, counts, requirementScore)\r\n}\r\n","import { ArmorT } from '../../../../types/Armor'\r\n\r\nexport const UNIQUE_ARMORS: ArmorT[] = []\r\n","import { ArmorT } from '../../../../types/Armor'\r\n\r\nexport const MYTHIC_ARMORS: ArmorT[] = []\r\n","import { ArmorT } from '../../../../types/Armor'\r\n\r\nexport const SET_ARMORS: ArmorT[] = []\r\n","import { BASE_EQUIPPABLE, makeRequirementCheck } from '../../util'\r\nimport { DamageTypeRollsT } from '../../../types/Damage'\r\nimport { ItemRarityT } from '../../../types/Item'\r\nimport { ItemModifierValuesT } from '../makeItem'\r\nimport { ArmorT, ArmorTypeT } from '../../../types/Armor'\r\nimport { CharacterResourceKeyT } from '../../../types/Character'\r\nimport { getRandom } from '../../../util/getRandom'\r\nimport {\r\n  ArmorRequirementKeys,\r\n  ArmorNameKeys,\r\n  ArmorCostsT,\r\n  ArmorResourcesT,\r\n  getArmorStatRolls,\r\n  ArmorResistances,\r\n} from './stats'\r\nimport { UNIQUE_ARMORS } from './uniques'\r\nimport { MYTHIC_ARMORS } from './mythics'\r\nimport { Rarity3d6Map } from '../util'\r\nimport { SET_ARMORS } from './sets'\r\nimport { CharacterCheckT, quickRoll } from '../../../types/Roll2'\r\n\r\nexport const buildArmor = (type: ArmorTypeT, rarity?: ItemRarityT): ArmorT => {\r\n  rarity = rarity || Rarity3d6Map[quickRoll('3d6')]\r\n  const requirementCheck = makeRequirementCheck(\r\n    [getRandom(ArmorRequirementKeys[type])],\r\n    10, //getRollValue('3d6'),\r\n  )\r\n  const unique = UNIQUE_ARMORS.find(\r\n    (a) => a.armorType === type || a.requirementCheck === requirementCheck,\r\n  )\r\n  const mythic = MYTHIC_ARMORS.find(\r\n    (a) => a.armorType === type || a.requirementCheck === requirementCheck,\r\n  )\r\n  const set = SET_ARMORS.find(\r\n    (a) => a.armorType === type || a.requirementCheck === requirementCheck,\r\n  )\r\n  if (rarity === 'unique' && unique) return unique\r\n  if (rarity === 'mythic' && mythic) return mythic\r\n  if (rarity === 'set' && set) return set\r\n  return createArmor(\r\n    type,\r\n    ArmorNameKeys()[rarity][type],\r\n    ArmorCostsT[type],\r\n    ArmorResourcesT[type],\r\n    requirementCheck,\r\n    getArmorStatRolls(type, rarity, requirementCheck.value),\r\n    ArmorResistances()[rarity][type],\r\n    rarity,\r\n  )\r\n}\r\n\r\nexport const createArmor = (\r\n  armorType: ArmorTypeT,\r\n  name: string,\r\n  cost: number,\r\n  resource: CharacterResourceKeyT,\r\n  requirementCheck: CharacterCheckT,\r\n  statRolls: ItemModifierValuesT,\r\n  damageRolls: DamageTypeRollsT,\r\n  rarity: ItemRarityT,\r\n): ArmorT => {\r\n  const base = BASE_EQUIPPABLE('armor')\r\n  return {\r\n    ...base,\r\n    type: 'armor',\r\n    armorType,\r\n    name,\r\n    cost,\r\n    resource,\r\n    requirementCheck,\r\n    rarity,\r\n    damageResistances: {\r\n      ...base.damageResistances,\r\n      ...damageRolls,\r\n    },\r\n    traits: [\r\n      {\r\n        id: `${base.id}--bonus`,\r\n        name: 'Armor Trait',\r\n        duration: -1,\r\n        healthOffset: 0,\r\n        focusOffset: 0,\r\n        abilitiesModifiers: {\r\n          strength: statRolls.strength || 0,\r\n          dexterity: statRolls.dexterity || 0,\r\n          intelligence: statRolls.intelligence || 0,\r\n          vigor: statRolls.vigor || 0,\r\n        },\r\n        statsModifiers: {\r\n          health: statRolls.health || 0,\r\n          focus: statRolls.focus || 0,\r\n          will: statRolls.will || 0,\r\n          perception: statRolls.perception || 0,\r\n          agility: statRolls.agility || 0,\r\n          accuracy: statRolls.accuracy || 0,\r\n          evade: statRolls.evade || 0,\r\n        },\r\n      },\r\n    ],\r\n  }\r\n}\r\n","import {\r\n  CharacterSkillCheckKeyT,\r\n  CharacterAbilityKeyT,\r\n} from '../../../types/Character'\r\nimport { ItemRarityT } from '../../../types/Item'\r\nimport { ArmorTypeT } from '../../../types/Armor'\r\nimport { getRandom } from '../../../util/getRandom'\r\nimport { ItemModifierValuesT } from '../makeItem'\r\nimport { DamageTypeRollsT, DamageElementTypeT } from '../../../types/Damage'\r\nimport { shuffleArray, getItemStatRolls } from '../util'\r\nimport { WeaponTypeT } from '../../../types/Weapon'\r\nimport {\r\n  quickRoll,\r\n  CharacterRollT,\r\n  makeCharacterRoll,\r\n} from '../../../types/Roll2'\r\n\r\nexport const WeaponRequirementKeys: Record<\r\n  WeaponTypeT,\r\n  CharacterAbilityKeyT[]\r\n> = {\r\n  fists: ['strength'],\r\n  axe: ['strength'],\r\n  greataxe: ['strength'],\r\n  flail: ['strength'],\r\n  daggers: ['dexterity'],\r\n  katana: ['dexterity'],\r\n  rapier: ['dexterity'],\r\n  wand: ['intelligence'],\r\n  staff: ['intelligence'],\r\n  elementalSword: ['strength', 'intelligence'],\r\n  elementalGreatsword: ['strength', 'intelligence'],\r\n  sword: ['strength', 'dexterity'],\r\n  greatsword: ['strength', 'dexterity'],\r\n  pistol: ['dexterity', 'intelligence'],\r\n  crossbow: ['dexterity', 'intelligence'],\r\n}\r\n\r\nexport const WeaponCosts: Record<WeaponTypeT, number> = {\r\n  fists: 1,\r\n  axe: 1,\r\n  greataxe: 2,\r\n  flail: 1,\r\n  daggers: 2,\r\n  katana: 1,\r\n  rapier: 1,\r\n  wand: 1,\r\n  staff: 2,\r\n  elementalSword: 1,\r\n  elementalGreatsword: 2,\r\n  sword: 1,\r\n  greatsword: 2,\r\n  pistol: 1,\r\n  crossbow: 2,\r\n}\r\n\r\nexport type WeaponStatKeyT = Record<WeaponTypeT, CharacterSkillCheckKeyT[]>\r\nconst weaponStatKeysBase: WeaponStatKeyT = {\r\n  fists: ['strength', 'vigor'],\r\n  axe: ['strength', 'vigor', 'health', 'agility'],\r\n  greataxe: ['strength', 'vigor', 'health', 'agility'],\r\n  flail: ['strength', 'vigor', 'health', 'agility'],\r\n  daggers: ['dexterity', 'vigor', 'health', 'agility'],\r\n  katana: ['dexterity', 'vigor', 'health', 'agility'],\r\n  rapier: ['dexterity', 'vigor', 'health', 'agility'],\r\n  wand: ['intelligence', 'vigor', 'agility'],\r\n  staff: ['intelligence', 'vigor', 'perception', 'will'],\r\n  elementalSword: ['intelligence', 'vigor', 'strength', 'will'],\r\n  elementalGreatsword: ['intelligence', 'vigor', 'strength', 'will'],\r\n  sword: ['strength', 'intelligence', 'health', 'agility'],\r\n  greatsword: ['strength', 'intelligence', 'health', 'vigor'],\r\n  pistol: ['dexterity', 'intelligence', 'perception', 'vigor'],\r\n  crossbow: ['dexterity', 'intelligence', 'perception', 'vigor'],\r\n}\r\nexport const WeaponRarityStatKeys: Record<ItemRarityT, WeaponStatKeyT> = {\r\n  common: weaponStatKeysBase,\r\n  uncommon: weaponStatKeysBase,\r\n  rare: weaponStatKeysBase,\r\n  legendary: weaponStatKeysBase,\r\n  unique: weaponStatKeysBase,\r\n  mythic: weaponStatKeysBase,\r\n  set: weaponStatKeysBase,\r\n}\r\n\r\nexport type WeaponNameKeyT = Record<WeaponTypeT, string>\r\nexport const WeaponNameKeys = (): Record<ItemRarityT, WeaponNameKeyT> => ({\r\n  common: {\r\n    fists: 'Unarmed',\r\n    axe: 'Common Axe',\r\n    greataxe: 'Common Greataxe',\r\n    flail: 'Common Flail',\r\n    daggers: 'Common Daggers',\r\n    katana: 'Common Katana',\r\n    rapier: 'Common Rapier',\r\n    wand: 'Common Wand',\r\n    staff: 'Common Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Common Sword',\r\n    greatsword: 'Common Greatsword',\r\n    pistol: 'Common Pistol',\r\n    crossbow: 'Common Crossbow',\r\n  },\r\n  uncommon: {\r\n    fists: 'Unarmed',\r\n    axe: 'Uncommon Axe',\r\n    greataxe: 'Uncommon Greataxe',\r\n    flail: 'Uncommon Flail',\r\n    daggers: 'Uncommon Daggers',\r\n    katana: 'Uncommon Katana',\r\n    rapier: 'Uncommon Rapier',\r\n    wand: 'Uncommon Wand',\r\n    staff: 'Uncommon Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Uncommon Sword',\r\n    greatsword: 'Uncommon Greatsword',\r\n    pistol: 'Uncommon Pistol',\r\n    crossbow: 'Uncommon Crossbow',\r\n  },\r\n  rare: {\r\n    fists: 'Unarmed',\r\n    axe: 'Rare Axe',\r\n    greataxe: 'Rare Greataxe',\r\n    flail: 'Rare Flail',\r\n    daggers: 'Rare Daggers',\r\n    katana: 'Rare Katana',\r\n    rapier: 'Rare Rapier',\r\n    wand: 'Rare Wand',\r\n    staff: 'Rare Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Rare Sword',\r\n    greatsword: 'Rare Greatsword',\r\n    pistol: 'Rare Pistol',\r\n    crossbow: 'Rare Crossbow',\r\n  },\r\n  legendary: {\r\n    fists: 'Unarmed',\r\n    axe: 'Epic Axe',\r\n    greataxe: 'Epic Greataxe',\r\n    flail: 'Epic Flail',\r\n    daggers: 'Epic Daggers',\r\n    katana: 'Epic Katana',\r\n    rapier: 'Epic Rapier',\r\n    wand: 'Epic Wand',\r\n    staff: 'Epic Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Epic Sword',\r\n    greatsword: 'Epic Greatsword',\r\n    pistol: 'Epic Pistol',\r\n    crossbow: 'Epic Crossbow',\r\n  },\r\n  unique: {\r\n    fists: 'Unarmed',\r\n    axe: 'Unique Axe',\r\n    greataxe: 'Unique Greataxe',\r\n    flail: 'Unique Flail',\r\n    daggers: 'Unique Daggers',\r\n    katana: 'Unique Katana',\r\n    rapier: 'Unique Rapier',\r\n    wand: 'Unique Wand',\r\n    staff: 'Unique Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Unique Sword',\r\n    greatsword: 'Unique Greatsword',\r\n    pistol: 'Unique Pistol',\r\n    crossbow: 'Unique Crossbow',\r\n  },\r\n  mythic: {\r\n    fists: 'Unarmed',\r\n    axe: 'Mythic Axe',\r\n    greataxe: 'Mythic Greataxe',\r\n    flail: 'Mythic Flail',\r\n    daggers: 'Mythic Daggers',\r\n    katana: 'Mythic Katana',\r\n    rapier: 'Mythic Rapier',\r\n    wand: 'Mythic Wand',\r\n    staff: 'Mythic Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Mythic Sword',\r\n    greatsword: 'Mythic Greatsword',\r\n    pistol: 'Mythic Pistol',\r\n    crossbow: 'Mythic Crossbow',\r\n  },\r\n  set: {\r\n    fists: 'Unarmed',\r\n    axe: 'Set Axe',\r\n    greataxe: 'Set Greataxe',\r\n    flail: 'Set Flail',\r\n    daggers: 'Set Daggers',\r\n    katana: 'Set Katana',\r\n    rapier: 'Set Rapier',\r\n    wand: 'Set Wand',\r\n    staff: 'Set Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Set Sword',\r\n    greatsword: 'Set Greatsword',\r\n    pistol: 'Set Pistol',\r\n    crossbow: 'Set Crossbow',\r\n  },\r\n})\r\n\r\nexport type ArmorStatCountT = Record<ArmorTypeT, number[]>\r\nexport const WeaponRarityStatCounts: Record<ItemRarityT, number> = {\r\n  common: 1,\r\n  uncommon: 2,\r\n  rare: 3,\r\n  legendary: 4,\r\n  unique: 5,\r\n  mythic: 6,\r\n  set: 6,\r\n}\r\n\r\nexport const makeDamageRoll = (\r\n  rollString: string,\r\n  modString: string,\r\n  keys: CharacterSkillCheckKeyT[] = [],\r\n  modCoef: number = -1,\r\n  mod: number = 0,\r\n): CharacterRollT => {\r\n  return makeCharacterRoll(\r\n    keys,\r\n    rollString,\r\n    quickRoll(modString) * modCoef + mod,\r\n  )\r\n}\r\n\r\nexport type WeaponDamagesT = Record<WeaponTypeT, DamageTypeRollsT>\r\nexport const WeaponDamages = (): Record<ItemRarityT, WeaponDamagesT> => {\r\n  const element: DamageElementTypeT = getRandom<DamageElementTypeT>([\r\n    'fire',\r\n    'blood',\r\n    'dark',\r\n    'light',\r\n  ])\r\n  return {\r\n    common: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    uncommon: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    rare: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    legendary: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    unique: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    mythic: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    set: {\r\n      fists: {},\r\n      axe: {},\r\n      greataxe: {},\r\n      flail: {},\r\n      daggers: {},\r\n      katana: {},\r\n      rapier: {},\r\n      wand: {},\r\n      staff: {},\r\n      elementalSword: {},\r\n      elementalGreatsword: {},\r\n      sword: {},\r\n      greatsword: {},\r\n      pistol: {},\r\n      crossbow: {},\r\n    },\r\n  }\r\n}\r\n\r\nexport const getWeaponStatRolls = (\r\n  type: WeaponTypeT,\r\n  rarity: ItemRarityT,\r\n  requirementScore: number,\r\n): ItemModifierValuesT => {\r\n  const keys = shuffleArray(WeaponRarityStatKeys[rarity][type])\r\n  const counts = WeaponRarityStatCounts[rarity]\r\n  return getItemStatRolls(keys, counts, requirementScore)\r\n}\r\n","import { BASE_EQUIPPABLE, makeRequirementCheck, makeTrait } from '../../util'\r\nimport { WeaponT, WeaponTypeT } from '../../../types/Weapon'\r\nimport { DamageTypeRollsT } from '../../../types/Damage'\r\nimport { ItemRarityT } from '../../../types/Item'\r\nimport { ItemModifierValuesT } from '../makeItem'\r\nimport { Rarity3d6Map } from '../util'\r\nimport { getRandom } from '../../../util/getRandom'\r\nimport {\r\n  WeaponRequirementKeys,\r\n  WeaponCosts,\r\n  getWeaponStatRolls,\r\n  WeaponNameKeys,\r\n  WeaponDamages,\r\n} from './stats'\r\nimport {\r\n  CharacterCheckT,\r\n  makeCharacterCheck,\r\n  quickRoll,\r\n} from '../../../types/Roll2'\r\n\r\nexport const buildWeapon = (\r\n  type: WeaponTypeT,\r\n  rarity?: ItemRarityT,\r\n): WeaponT => {\r\n  rarity = rarity || Rarity3d6Map[quickRoll('3d6')]\r\n  if (rarity === 'set') rarity = 'mythic'\r\n  const requirementCheck = makeRequirementCheck(\r\n    [getRandom(WeaponRequirementKeys[type])],\r\n    10, //getRollValue('3d6'),\r\n  )\r\n  return createWeapon(\r\n    type,\r\n    WeaponNameKeys()[rarity][type],\r\n    WeaponCosts[type],\r\n    requirementCheck,\r\n    0,\r\n    getWeaponStatRolls(type, rarity, requirementCheck.value),\r\n    WeaponDamages()[rarity][type],\r\n    rarity,\r\n  )\r\n}\r\n\r\nexport const createWeapon = (\r\n  weaponType: WeaponTypeT,\r\n  name: string,\r\n  cost: number,\r\n  requirementCheck: CharacterCheckT,\r\n  accuracyModifier: number,\r\n  statRolls: ItemModifierValuesT,\r\n  damageRolls: DamageTypeRollsT,\r\n  rarity: ItemRarityT,\r\n  rest: Partial<WeaponT> = {},\r\n): WeaponT => {\r\n  const base = BASE_EQUIPPABLE('weapon')\r\n  return {\r\n    ...base,\r\n    type: 'weapon',\r\n    weaponType,\r\n    name,\r\n    cost,\r\n    rarity,\r\n    requirementCheck,\r\n    accuracyCheck: makeCharacterCheck(\r\n      ['accuracy'],\r\n      undefined,\r\n      0,\r\n      accuracyModifier,\r\n    ),\r\n    damageRolls,\r\n    traits: [\r\n      {\r\n        ...makeTrait(),\r\n        id: `${base.id}--bonus`,\r\n        name: 'Weapon Trait',\r\n        abilitiesModifiers: {\r\n          strength: statRolls.strength || 0,\r\n          dexterity: statRolls.dexterity || 0,\r\n          intelligence: statRolls.intelligence || 0,\r\n          vigor: statRolls.vigor || 0,\r\n        },\r\n        statsModifiers: {\r\n          health: statRolls.health || 0,\r\n          focus: statRolls.focus || 0,\r\n          will: statRolls.will || 0,\r\n          perception: statRolls.perception || 0,\r\n          agility: statRolls.agility || 0,\r\n          accuracy: statRolls.accuracy || 0,\r\n          evade: statRolls.evade || 0,\r\n        },\r\n      },\r\n    ],\r\n    events: {},\r\n    slotCount: 0,\r\n    slots: [],\r\n    ...rest,\r\n  }\r\n}\r\n","import { EquippableT, ItemTypeT, ItemRarityT } from '../../types/Item'\r\nimport { getRandom } from '../../util/getRandom'\r\nimport { WeaponTypeT, WeaponT } from '../../types/Weapon'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport { ArmorT, ArmorTypeT } from '../../types/Armor'\r\nimport { BASIC_SHIELD } from '../basicShield'\r\nimport { FISTS } from '../fists'\r\nimport { BASIC_TOME } from '../basicTome'\r\nimport { CharacterSkillCheckKeyT } from '../../types/Character'\r\n\r\nimport { buildArmor } from './armor/createArmor'\r\nimport { buildWeapon } from './weapons/createWeapon'\r\n\r\ntype _ItemModifierValuesT = Record<CharacterSkillCheckKeyT, number>\r\nexport type ItemModifierValuesT = Partial<_ItemModifierValuesT>\r\n\r\nexport const getTotal = (rollResults: ItemModifierValuesT): number => {\r\n  return getKeys(rollResults as _ItemModifierValuesT)\r\n    .map((key) => rollResults[key] as number)\r\n    .reduce((sum, current) => sum + current, 0)\r\n}\r\n\r\nconst ITEM_TYPES: ItemTypeT[] = [\r\n  'weapon',\r\n  'weapon',\r\n  'armor',\r\n  'armor',\r\n  'armor',\r\n  'armor',\r\n]\r\nexport type ItemMakerMapT = Record<ItemTypeT, () => EquippableT>\r\nexport const makeItem = (core: ItemMakerMapT): EquippableT => {\r\n  return core[getRandom<ItemTypeT>(ITEM_TYPES)]()\r\n}\r\n\r\nexport type WeaponMakerMapT = Partial<Record<WeaponTypeT, () => WeaponT>>\r\nexport const makeWeapon = (core: WeaponMakerMapT): WeaponT => {\r\n  const keys = getKeys(core)\r\n  const randomKey = getRandom<WeaponTypeT>(keys)\r\n  const maker = core[randomKey] || (() => FISTS)\r\n  return maker()\r\n}\r\n\r\nexport type ArmorMakerMapT = Partial<Record<ArmorTypeT, () => ArmorT>>\r\nexport const makeArmor = (core: ArmorMakerMapT): ArmorT => {\r\n  const keys = getKeys(core)\r\n  const randomKey = getRandom<ArmorTypeT>(keys)\r\n  const maker = core[randomKey] || (() => buildArmor('ring'))\r\n  return maker()\r\n}\r\n\r\nconst rarityArray: ItemRarityT[] = [\r\n  'common',\r\n  'uncommon',\r\n  'rare',\r\n  'legendary',\r\n  'unique',\r\n  'mythic',\r\n]\r\nexport const getRarity = (index: number): ItemRarityT => {\r\n  if (index < 0) return 'common'\r\n  if (index >= rarityArray.length) return 'mythic'\r\n  return rarityArray[index]\r\n}\r\n\r\nconst itemCore: ItemMakerMapT = {\r\n  weapon: () =>\r\n    makeWeapon({\r\n      // fists: () => FISTS,\r\n      // S\r\n      axe: () => buildWeapon('axe'),\r\n      greataxe: () => buildWeapon('greataxe'),\r\n      flail: () => buildWeapon('flail'),\r\n      // D\r\n      daggers: () => buildWeapon('daggers'),\r\n      katana: () => buildWeapon('katana'),\r\n      rapier: () => buildWeapon('rapier'),\r\n      // I\r\n      wand: () => buildWeapon('wand'),\r\n      staff: () => buildWeapon('staff'),\r\n      // S+I\r\n      elementalSword: () => buildWeapon('elementalSword'),\r\n      elementalGreatsword: () => buildWeapon('elementalGreatsword'),\r\n      // S+D\r\n      sword: () => buildWeapon('sword'),\r\n      greatsword: () => buildWeapon('greatsword'),\r\n      // D+I\r\n      pistol: () => buildWeapon('pistol'),\r\n      crossbow: () => buildWeapon('crossbow'),\r\n    }),\r\n  armor: () =>\r\n    makeArmor({\r\n      helmet: () => buildArmor('helmet'),\r\n      cowl: () => buildArmor('cowl'),\r\n      chestplate: () => buildArmor('chestplate'),\r\n      robe: () => buildArmor('robe'),\r\n      ring: () => buildArmor('ring'),\r\n      boots: () => buildArmor('boots'),\r\n      gloves: () => buildArmor('gloves'),\r\n    }),\r\n  shield: () => BASIC_SHIELD,\r\n  tome: () => BASIC_TOME,\r\n}\r\n\r\nexport default (): EquippableT => makeItem(itemCore)\r\n","import { SkillT } from '../types/Skill'\r\nimport { v4 } from 'uuid'\r\nimport {\r\n  makeCharacterCheck,\r\n  makeCharacterRoll,\r\n  makeStandardCharacterCheck,\r\n  makeRoll,\r\n} from '../types/Roll2'\r\nimport { makeRequirementCheck, makeTrait } from './util'\r\nimport Healing from '../assets/img/healing1.png'\r\nimport Fireball from '../assets/img/fireball.png'\r\nimport Thunderbolt from '../assets/img/thunderbolt.png'\r\nimport DarkBlast from '../assets/img/dark-blast.png'\r\nimport CripplingBlow from '../assets/img/crippling-blow.png'\r\nimport Wrath from '../assets/img/wrath.png'\r\nimport Charge from '../assets/img/charge.png'\r\nimport SkillShot from '../assets/img/headshot.png'\r\nimport ShadowStrike from '../assets/img/shadow-strike.png'\r\nimport Vanish from '../assets/img/vanish.png'\r\nimport Inspect from '../assets/img/inspect.png'\r\nimport WeaponAttack from '../assets/img/weapon-attack.png'\r\n\r\nexport const makeSkill = (name: string = 'Weapon Attack'): SkillT => {\r\n  return {\r\n    id: v4(),\r\n    name,\r\n    imgSrc: '',\r\n    requirementCheck: makeRequirementCheck(['intelligence'], 1),\r\n    damageRolls: {},\r\n    targetTraits: [],\r\n    sourceTraits: [],\r\n    events: {},\r\n    combineWeaponDamage: true,\r\n    checkDodgeForTraits: true,\r\n    focusCost: 0,\r\n    target: true,\r\n  }\r\n}\r\n\r\nexport const BASIC_ATTACK: SkillT = {\r\n  ...makeSkill(),\r\n  imgSrc: WeaponAttack,\r\n}\r\nexport const INSPECT: SkillT = {\r\n  ...makeSkill('Inspect'),\r\n  imgSrc: Inspect,\r\n  combineWeaponDamage: false,\r\n  damageRolls: {},\r\n  inspected: true,\r\n}\r\n\r\nexport const FIREBALL: SkillT = {\r\n  ...makeSkill('Fireball'),\r\n  imgSrc: Fireball,\r\n  check: makeCharacterCheck(['intelligence']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    fire: makeCharacterRoll([], '4d10', -7),\r\n  },\r\n  focusCost: 10,\r\n}\r\nexport const CRIPPLING_BLOW: SkillT = {\r\n  ...makeSkill('Critical Blow'),\r\n  imgSrc: CripplingBlow,\r\n  requirementCheck: makeRequirementCheck(['strength'], 10),\r\n  combineWeaponDamage: true,\r\n  checkDodgeForTraits: true,\r\n  damageRolls: {},\r\n  targetTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 2,\r\n      abilitiesModifiers: {\r\n        strength: 0,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: -5,\r\n      },\r\n    },\r\n    {\r\n      ...makeTrait(),\r\n      duration: -1,\r\n      focusOffset: -3,\r\n      abilitiesModifiers: {\r\n        strength: 0,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: 0,\r\n      },\r\n    },\r\n  ],\r\n  focusCost: 1,\r\n}\r\nexport const THUNDERBOLT: SkillT = {\r\n  ...makeSkill('Thunderbolt'),\r\n  imgSrc: Thunderbolt,\r\n  check: makeStandardCharacterCheck(['intelligence'], -3),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    light: makeCharacterRoll(['intelligence']),\r\n  },\r\n  focusCost: 3,\r\n}\r\nexport const DARK_BLAST: SkillT = {\r\n  ...makeSkill('Dark Blast'),\r\n  imgSrc: DarkBlast,\r\n  check: makeCharacterCheck(['intelligence']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    dark: makeCharacterRoll(['intelligence'], '2d6', -8),\r\n  },\r\n  focusCost: 5,\r\n}\r\nexport const HEALING: SkillT = {\r\n  ...makeSkill('Healing'),\r\n  target: false,\r\n  imgSrc: Healing,\r\n  check: makeCharacterCheck(['intelligence']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {},\r\n  focusCost: 5,\r\n  sourceTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      healthOffset: 15,\r\n    },\r\n  ],\r\n}\r\nexport const WRATH: SkillT = {\r\n  ...makeSkill('Wrath'),\r\n  imgSrc: Wrath,\r\n  check: makeCharacterCheck(['strength']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: { piercing: makeCharacterRoll([], '1d6') },\r\n  focusCost: 5,\r\n  sourceTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 4,\r\n      abilitiesModifiers: {\r\n        strength: 2,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: 0,\r\n      },\r\n    },\r\n  ],\r\n  targetTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 4,\r\n      abilitiesModifiers: {\r\n        strength: -2,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: 0,\r\n      },\r\n    },\r\n  ],\r\n}\r\nexport const CHARGE: SkillT = {\r\n  ...makeSkill('Charge'),\r\n  imgSrc: Charge,\r\n  focusCost: 5,\r\n  check: makeCharacterCheck(['strength']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    slashing: makeCharacterRoll(['strength'], '3d6', -12),\r\n    piercing: makeCharacterRoll(['strength'], '3d6', -12),\r\n  },\r\n  sourceTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 2,\r\n      statsModifiers: {\r\n        health: 0,\r\n        focus: 0,\r\n        will: 0,\r\n        perception: 0,\r\n        accuracy: 0,\r\n        evade: 0,\r\n        agility: 3,\r\n      },\r\n    },\r\n  ],\r\n  targetTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 2,\r\n      abilitiesModifiers: {\r\n        strength: 0,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: -3,\r\n      },\r\n    },\r\n  ],\r\n}\r\n\r\nexport const SKILL_SHOT: SkillT = {\r\n  ...makeSkill('Skill Shot'),\r\n  imgSrc: SkillShot,\r\n  focusCost: 12,\r\n  check: makeStandardCharacterCheck(['dexterity'], -4),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    piercing: makeCharacterRoll(['dexterity'], '1d20'),\r\n    fire: makeCharacterRoll([], '8d2', -8),\r\n  },\r\n  targetTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 2,\r\n      abilitiesModifiers: {\r\n        strength: 0,\r\n        dexterity: 0,\r\n        intelligence: -2,\r\n        vigor: 0,\r\n      },\r\n    },\r\n  ],\r\n}\r\n\r\nexport const VANISH: SkillT = {\r\n  ...makeSkill('Vanish'),\r\n  imgSrc: Vanish,\r\n  focusCost: 8,\r\n  check: makeStandardCharacterCheck(['dexterity']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {},\r\n  target: false,\r\n  sourceTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 2,\r\n      statsModifiers: {\r\n        health: 0,\r\n        focus: 0,\r\n        will: 0,\r\n        perception: 2,\r\n        agility: -2,\r\n        accuracy: 0,\r\n        evade: 20,\r\n      },\r\n    },\r\n  ],\r\n}\r\n\r\nexport const SHADOW_STRIKE: SkillT = {\r\n  ...makeSkill('Shadow Strike'),\r\n  imgSrc: ShadowStrike,\r\n  focusCost: 7,\r\n  check: makeStandardCharacterCheck(['evade'], -3),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    piercing: makeCharacterRoll(['evade'], '1d6', -6),\r\n  },\r\n}\r\n","import { CharacterT } from '../types/Character'\r\nimport { buildArmor } from './builders/armor/createArmor'\r\nimport { getRandom } from '../util/getRandom'\r\nimport { buildWeapon } from './builders/weapons/createWeapon'\r\nimport { v4 } from 'uuid'\r\nimport { makeSkill, BASIC_ATTACK, INSPECT } from './makeSkill'\r\nimport { makeCharacterRoll } from '../types/Roll2'\r\n/*\r\nimport { Config, adjectives, names } from 'unique-names-generator'\r\n\r\nconst config: Config = {\r\n  dictionaries: [adjectives, names],\r\n  length: 2,\r\n  separator: ' ',\r\n}\r\n*/\r\n\r\nexport const makeCharacter = (name?: string): CharacterT => ({\r\n  name: name || '-- init --', //uniqueNamesGenerator(config),\r\n  id: v4(),\r\n  power: 600,\r\n  resources: {\r\n    characterPoints: 250,\r\n    weaponHands: 1,\r\n    heads: 0,\r\n    bodies: 0,\r\n    hands: 0,\r\n    fingers: 10,\r\n    feet: 0,\r\n  },\r\n  abilities: {\r\n    strength: 10,\r\n    dexterity: 10,\r\n    intelligence: 10,\r\n    vigor: 10,\r\n  },\r\n  damageResistances: {\r\n    slashing: makeCharacterRoll([]),\r\n    piercing: makeCharacterRoll([]),\r\n    fire: makeCharacterRoll([]),\r\n    blood: makeCharacterRoll([]),\r\n    light: makeCharacterRoll([]),\r\n    dark: makeCharacterRoll([]),\r\n  },\r\n\r\n  traits: [],\r\n  skills: [BASIC_ATTACK, INSPECT],\r\n\r\n  equippedItems: [],\r\n  armor: [\r\n    buildArmor(getRandom(['cowl', 'helmet'])),\r\n    buildArmor(getRandom(['chestplate', 'robe'])),\r\n    buildArmor('gloves'),\r\n    buildArmor('boots'),\r\n  ],\r\n\r\n  weapon: buildWeapon(\r\n    getRandom([\r\n      'axe',\r\n      'greataxe',\r\n      'wand',\r\n      'staff',\r\n      'daggers',\r\n      'katana',\r\n      'sword',\r\n      'greatsword',\r\n      'flail',\r\n      'elementalGreatsword',\r\n      'elementalSword',\r\n    ]),\r\n  ),\r\n\r\n  healthOffset: 0,\r\n  focusOffset: 0,\r\n  dead: false,\r\n  inspected: false,\r\n})\r\n","import { WeaponT, ZERO_WEAPON_TRAIT } from '../../../../types/Weapon'\r\nimport { buildWeapon } from '../createWeapon'\r\nimport { makeTrait } from '../../../util'\r\nimport { makeCharacterRoll } from '../../../../types/Roll2'\r\nimport { v4 } from 'uuid'\r\n\r\nexport const SWORD_OF_BLOOD_AND_FIRE: WeaponT = {\r\n  ...buildWeapon('elementalSword', 'mythic'),\r\n  name: 'Sword of Blood and Fire',\r\n  damageRolls: {\r\n    // getRollValue('2d6')\r\n    slashing: makeCharacterRoll(['strength'], '1d10', -3),\r\n    fire: makeCharacterRoll(['intelligence'], '1d4', -10),\r\n    blood: makeCharacterRoll(['intelligence'], '1d4', -10),\r\n  },\r\n  events: {\r\n    onHit: [\r\n      {\r\n        ...makeTrait(),\r\n        name: 'heal on hit',\r\n        healthOffset: 5,\r\n      },\r\n      {\r\n        ...makeTrait(),\r\n        name: 'restore fp on hit',\r\n        focusOffset: 5,\r\n      },\r\n    ],\r\n    onCrit: [\r\n      {\r\n        ...makeTrait(),\r\n        name: 'add strenth on crit',\r\n        abilitiesModifiers: {\r\n          strength: 2,\r\n          dexterity: 0,\r\n          intelligence: 0,\r\n          vigor: 0,\r\n        },\r\n      },\r\n    ],\r\n  },\r\n}\r\n\r\nexport const SWORD_OF_THE_INFINITE: WeaponT = {\r\n  ...buildWeapon('elementalSword', 'mythic'),\r\n  name: 'Sword of the Infinite',\r\n  damageRolls: {\r\n    // getRollValue('2d6')\r\n    fire: makeCharacterRoll([], '3d6', -3),\r\n    blood: makeCharacterRoll([], '', 6),\r\n    light: makeCharacterRoll(['intelligence'], '', -7),\r\n    dark: makeCharacterRoll(['intelligence'], '1d6', -10),\r\n    slashing: makeCharacterRoll([]),\r\n  },\r\n  events: {\r\n    onHit: [\r\n      {\r\n        ...makeTrait(),\r\n        name: 'heal on hit',\r\n        healthOffset: 5,\r\n      },\r\n    ],\r\n    onCrit: [\r\n      {\r\n        ...makeTrait(),\r\n        name: 'add strenth on crit',\r\n        abilitiesModifiers: {\r\n          strength: 2,\r\n          dexterity: 0,\r\n          intelligence: 0,\r\n          vigor: 0,\r\n        },\r\n      },\r\n    ],\r\n  },\r\n  slotCount: 3,\r\n  slots: [\r\n    {\r\n      id: v4(),\r\n      name: 'Slash Gem',\r\n      rarity: 'mythic',\r\n      traits: [\r\n        {\r\n          ...ZERO_WEAPON_TRAIT,\r\n          accuracyOffset: 2,\r\n          traits: [\r\n            {\r\n              ...makeTrait(),\r\n              statsModifiers: {\r\n                health: 0,\r\n                focus: 2,\r\n                will: 0,\r\n                perception: 0,\r\n                accuracy: 0,\r\n                agility: 0,\r\n                evade: 2,\r\n              },\r\n            },\r\n          ],\r\n          damageRolls: {\r\n            slashing: makeCharacterRoll([], '1d6'),\r\n          },\r\n        },\r\n      ],\r\n    },\r\n  ],\r\n}\r\n\r\nexport const MYTHIC_WEAPONS: WeaponT[] = []\r\n","import { WeaponModT, ZERO_WEAPON_TRAIT } from '../../../types/Weapon'\r\nimport { v4 } from 'uuid'\r\nimport { makeCharacterRoll } from '../../../types/Roll2'\r\n\r\nexport const SLASHING_MOD: WeaponModT = {\r\n  id: v4(),\r\n  name: 'Slashing Mod',\r\n  rarity: 'mythic',\r\n  traits: [\r\n    {\r\n      ...ZERO_WEAPON_TRAIT,\r\n      damageRolls: {\r\n        slashing: makeCharacterRoll([], '1d6'),\r\n      },\r\n    },\r\n  ],\r\n}\r\n","import { PartyT } from '../../types/Party'\r\nimport { StateActionT, StateT, StateCoreT } from '../types'\r\nimport {\r\n  CharacterT,\r\n  canEquip,\r\n  equipItem,\r\n  unequipItem,\r\n} from '../../types/Character'\r\nimport { Dispatch } from 'redux'\r\nimport { v4 } from 'uuid'\r\nimport { makeReducer } from '../util'\r\nimport { useSelector } from 'react-redux'\r\nimport { useActions } from '../../hooks/useActions'\r\nimport { ItemT, EquippableT } from '../../types/Item'\r\nimport { upsertIn, updateIn } from '../../util/updateIn'\r\nimport makeItem from '../../objects/builders/makeItem'\r\nimport { makeCharacter } from '../../objects/makeCharacter'\r\nimport {\r\n  SWORD_OF_BLOOD_AND_FIRE,\r\n  SWORD_OF_THE_INFINITE,\r\n} from '../../objects/builders/weapons/mythics'\r\nimport {\r\n  FIREBALL,\r\n  CRIPPLING_BLOW,\r\n  THUNDERBOLT,\r\n  DARK_BLAST,\r\n  HEALING,\r\n  WRATH,\r\n  CHARGE,\r\n  SKILL_SHOT,\r\n  VANISH,\r\n  SHADOW_STRIKE,\r\n} from '../../objects/makeSkill'\r\nimport { buildWeapon } from '../../objects/builders/weapons/createWeapon'\r\nimport { SLASHING_MOD } from '../../objects/builders/mods'\r\nimport { WeaponModT } from '../../types/Weapon'\r\n\r\nexport const UPSERT_PARTY = '@actions/parties/upsert-party'\r\nexport const UPSERT_CHARACTER = '@actions/parties/upsert-character'\r\nexport const DELETE_CHARACTER = '@actions/parties/delete-character'\r\nexport const UPSERT_ITEM = '@actions/parties/upsert-item'\r\nexport const DELETE_ITEM = '@actions/parties/delete-item'\r\nexport const UPSERT_MOD = '@actions/parties/upsert-mod'\r\nexport const DELETE_MOD = '@actions/parties/delete-mod'\r\n\r\nexport const actionCreators = {\r\n  upsertParty: (party: PartyT): StateActionT => ({\r\n    type: UPSERT_PARTY,\r\n    payload: {\r\n      party,\r\n    },\r\n  }),\r\n  upsertCharacter: (partyId: string, character: CharacterT) => {\r\n    return {\r\n      type: UPSERT_CHARACTER,\r\n      payload: {\r\n        partyId,\r\n        character,\r\n      },\r\n    }\r\n  },\r\n  deleteCharacter: (partyId: string, characterId: string) => {\r\n    return {\r\n      type: DELETE_CHARACTER,\r\n      payload: {\r\n        partyId,\r\n        characterId,\r\n      },\r\n    }\r\n  },\r\n  upsertItem: (partyId: string, item: ItemT) => {\r\n    return {\r\n      type: UPSERT_ITEM,\r\n      payload: {\r\n        partyId,\r\n        item,\r\n      },\r\n    }\r\n  },\r\n  deleteItem: (partyId: string, itemId: string) => {\r\n    return {\r\n      type: DELETE_ITEM,\r\n      payload: {\r\n        partyId,\r\n        itemId,\r\n      },\r\n    }\r\n  },\r\n  upsertMod: (partyId: string, mod: WeaponModT) => {\r\n    return {\r\n      type: UPSERT_MOD,\r\n      payload: {\r\n        partyId,\r\n        mod,\r\n      },\r\n    }\r\n  },\r\n  deleteMod: (partyId: string, modId: string) => {\r\n    return {\r\n      type: DELETE_MOD,\r\n      payload: {\r\n        partyId,\r\n        modId,\r\n      },\r\n    }\r\n  },\r\n}\r\n\r\nexport const actions = {\r\n  upsertParty: (party: PartyT) => (dispatch: Dispatch) => {\r\n    dispatch(actionCreators.upsertParty(party))\r\n  },\r\n  upsertCharacter: (partyId: string, character: CharacterT) => (\r\n    dispatch: Dispatch,\r\n  ) => {\r\n    dispatch(actionCreators.upsertCharacter(partyId, character))\r\n  },\r\n  deleteCharacter: (partyId: string, characterId: string) => (\r\n    dispatch: Dispatch,\r\n  ) => {\r\n    dispatch(actionCreators.deleteCharacter(partyId, characterId))\r\n  },\r\n  upsertItem: (partyId: string, item: ItemT) => (dispatch: Dispatch) => {\r\n    dispatch(actionCreators.upsertItem(partyId, item))\r\n  },\r\n  removeItem: (partyId: string, itemId: string) => (dispatch: Dispatch) => {\r\n    dispatch(actionCreators.deleteItem(partyId, itemId))\r\n  },\r\n  upsertMod: (partyId: string, mod: WeaponModT) => (dispatch: Dispatch) => {\r\n    dispatch(actionCreators.upsertMod(partyId, mod))\r\n  },\r\n  deleteMod: (partyId: string, modId: string) => (dispatch: Dispatch) => {\r\n    dispatch(actionCreators.deleteMod(partyId, modId))\r\n  },\r\n  equipItem: (partyId: string, characterId: string, itemId: string) => (\r\n    dispatch: Dispatch,\r\n    getState: () => StateT,\r\n  ) => {\r\n    const party = getState().parties.find((p) => p.id === partyId)\r\n    if (!party) return\r\n    const character = party.characters.find((c) => c.id === characterId)\r\n    const item = party.items.find((i) => i.id === itemId) as EquippableT\r\n    if (!character || !item) return\r\n    if (!canEquip(character)(item)) return\r\n    dispatch(\r\n      actionCreators.upsertCharacter(partyId, equipItem(character)(item)),\r\n    )\r\n    dispatch(actionCreators.deleteItem(partyId, item.id))\r\n  },\r\n  unequipItem: (partyId: string, characterId: string, itemId: string) => (\r\n    dispatch: Dispatch,\r\n    getState: () => StateT,\r\n  ) => {\r\n    const party = getState().parties.find((p) => p.id === partyId)\r\n    if (!party) return\r\n    const _character = party.characters.find((c) => c.id === characterId)\r\n    if (!_character) return\r\n    const [items, character] = unequipItem(_character)(itemId)\r\n    dispatch(actionCreators.upsertCharacter(partyId, character))\r\n    items.forEach((item) => {\r\n      dispatch(actionCreators.upsertItem(partyId, item))\r\n    })\r\n  },\r\n  equipMod: (partyId: string, characterId: string, modId: string) => (\r\n    dispatch: Dispatch,\r\n    getState: () => StateT,\r\n  ) => {\r\n    const party = getState().parties.find((p) => p.id === partyId)\r\n    if (!party) return\r\n    const character = party.characters.find((c) => c.id === characterId)\r\n    const mod = party.mods.find((m) => m.id === modId)\r\n    if (!character || !mod) return\r\n    const { weapon } = character\r\n    if (!weapon) return\r\n    if (weapon.slotCount > weapon.slots.length) {\r\n      dispatch(\r\n        actionCreators.upsertCharacter(partyId, {\r\n          ...character,\r\n          weapon: { ...weapon, slots: [...weapon.slots, mod] },\r\n        }),\r\n      )\r\n      dispatch(actionCreators.deleteMod(partyId, modId))\r\n    }\r\n  },\r\n  unequipMod: (partyId: string, characterId: string, modId: string) => (\r\n    dispatch: Dispatch,\r\n    getState: () => StateT,\r\n  ) => {\r\n    console.log('unequip mod')\r\n    const party = getState().parties.find((p) => p.id === partyId)\r\n    if (!party) return\r\n    const character = party.characters.find((c) => c.id === characterId)\r\n    if (!character) return\r\n    const { weapon } = character\r\n    if (!weapon) return\r\n    const mod = weapon.slots.find((m) => m.id === modId)\r\n    if (!mod) return\r\n    dispatch(\r\n      actionCreators.upsertCharacter(partyId, {\r\n        ...character,\r\n        weapon: {\r\n          ...weapon,\r\n          slots: weapon.slots.filter((m) => m.id !== modId),\r\n        },\r\n      }),\r\n    )\r\n    dispatch(actionCreators.upsertMod(partyId, mod))\r\n  },\r\n}\r\n\r\nexport const core: StateCoreT<PartyT[]> = {\r\n  [UPSERT_PARTY]: (state, action) => {\r\n    return upsertIn(state, action.payload.party)\r\n  },\r\n  [UPSERT_CHARACTER]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      characters: upsertIn(party.characters, action.payload.character),\r\n    }))\r\n  },\r\n  [DELETE_CHARACTER]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      characters: party.characters.filter(\r\n        (c) => c.id !== action.payload.characterId,\r\n      ),\r\n    }))\r\n  },\r\n  [UPSERT_ITEM]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      items: upsertIn(party.items, action.payload.item),\r\n    }))\r\n  },\r\n  [DELETE_ITEM]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      items: party.items.filter((i) => i.id !== action.payload.itemId),\r\n    }))\r\n  },\r\n  [UPSERT_MOD]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      mods: upsertIn(party.mods, action.payload.mod),\r\n    }))\r\n  },\r\n  [DELETE_MOD]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      mods: party.mods.filter((i) => i.id !== action.payload.modId),\r\n    }))\r\n  },\r\n}\r\n\r\nconst max = makeCharacter('Max M')\r\nconst katie = makeCharacter('Katie C')\r\nconst milo = makeCharacter('Milo W')\r\nexport const PC_PARTY_ID = v4()\r\nexport const INITIAL_STATE: PartyT[] = [\r\n  {\r\n    id: PC_PARTY_ID,\r\n    items: [\r\n      ...Array(80)\r\n        .fill(null)\r\n        .map(() => makeItem()),\r\n    ],\r\n    skills: [\r\n      WRATH,\r\n      CHARGE,\r\n      CRIPPLING_BLOW,\r\n      VANISH,\r\n      SHADOW_STRIKE,\r\n      SKILL_SHOT,\r\n      THUNDERBOLT,\r\n      FIREBALL,\r\n      DARK_BLAST,\r\n      HEALING,\r\n    ],\r\n    mods: [SLASHING_MOD],\r\n    characters: [\r\n      {\r\n        ...max,\r\n        weapon: SWORD_OF_THE_INFINITE,\r\n        skills: [\r\n          ...max.skills,\r\n          WRATH,\r\n          CHARGE,\r\n          CRIPPLING_BLOW,\r\n          VANISH,\r\n          SHADOW_STRIKE,\r\n          SKILL_SHOT,\r\n          THUNDERBOLT,\r\n          FIREBALL,\r\n          DARK_BLAST,\r\n          HEALING,\r\n        ],\r\n      },\r\n      {\r\n        ...katie,\r\n        skills: [\r\n          ...katie.skills,\r\n          WRATH,\r\n          CHARGE,\r\n          CRIPPLING_BLOW,\r\n          VANISH,\r\n          SHADOW_STRIKE,\r\n          SKILL_SHOT,\r\n          THUNDERBOLT,\r\n          FIREBALL,\r\n          DARK_BLAST,\r\n          HEALING,\r\n        ],\r\n        weapon: SWORD_OF_BLOOD_AND_FIRE,\r\n      },\r\n      {\r\n        ...milo,\r\n        skills: [\r\n          ...milo.skills,\r\n          WRATH,\r\n          CHARGE,\r\n          CRIPPLING_BLOW,\r\n          VANISH,\r\n          SHADOW_STRIKE,\r\n          SKILL_SHOT,\r\n          THUNDERBOLT,\r\n          FIREBALL,\r\n          DARK_BLAST,\r\n          HEALING,\r\n        ],\r\n        weapon: buildWeapon('greataxe', 'mythic'),\r\n      },\r\n    ],\r\n  },\r\n]\r\nexport default makeReducer(core, INITIAL_STATE)\r\nexport const useParties = () => useSelector((state: StateT) => state.parties)\r\nexport const usePartiesActions = () =>\r\n  useActions(actions) as {\r\n    upsertParty: (party: PartyT) => void\r\n    upsertCharacter: (partyId: string, character: CharacterT) => void\r\n    deleteCharacter: (partyId: string, characterId: string) => void\r\n    upsertItem: (partyId: string, item: ItemT) => void\r\n    removeItem: (partyId: string, itemId: string) => void\r\n    upsertMod: (partyId: string, mod: WeaponModT) => void\r\n    deleteMod: (partyId: string, modId: string) => void\r\n    equipItem: (partyId: string, characterId: string, itemId: string) => void\r\n    unequipItem: (partyId: string, characterId: string, itemId: string) => void\r\n    equipMod: (partyId: string, characterId: string, modId: string) => void\r\n    unequipMod: (partyId: string, characterId: string, modId: string) => void\r\n  }\r\n","import { useMemo } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { bindActionCreators } from 'redux'\r\n\r\nexport const useActions = (actions: any, deps?: any[]) => {\r\n  const dispatch = useDispatch()\r\n  return useMemo(\r\n    () => bindActionCreators(actions, dispatch),\r\n    deps ? [dispatch, ...deps] : [dispatch],\r\n  )\r\n}\r\n","import React, { useMemo, useContext, useState } from 'react'\r\nimport { PartyT, ProcessedPartyT, processParty } from '../../types/Party'\r\nimport { CharacterT, ProcessedCharacterT } from '../../types/Character'\r\nimport { v4 } from 'uuid'\r\nimport { useParties, PC_PARTY_ID, usePartiesActions } from '../../state/parties'\r\nimport { actionCreators } from '../../state/rolls'\r\nimport { EquippableT } from '../../types/Item'\r\nimport { WeaponModT } from '../../types/Weapon'\r\n\r\nexport interface PartyContextT {\r\n  parties: ProcessedPartyT[]\r\n  rawParties: PartyT[]\r\n  userParty: ProcessedPartyT\r\n  rawUserParty: PartyT\r\n  activeCharacterId: string | null\r\n\r\n  upsertParty: (party: PartyT) => void\r\n  upsertItem: (item: EquippableT) => void\r\n  upsertCharacter: (character: CharacterT, partyId?: string) => void\r\n  deleteCharacter: (characterId: string, partyId?: string) => void\r\n  upsertMod: (mod: WeaponModT, partyId?: string) => void\r\n  deleteMod: (modId: string, partyId?: string) => void\r\n  findCharacter: (\r\n    characterId: string,\r\n    partyId?: string,\r\n  ) => ProcessedCharacterT | undefined\r\n  findRawCharacter: (\r\n    characterId: string,\r\n    partyId?: string,\r\n  ) => CharacterT | undefined\r\n  equipItem: (characterId: string, itemId: string, partyId?: string) => void\r\n  unequipItem: (characterId: string, itemId: string, partyId?: string) => void\r\n  equipMod: (characterId: string, modId: string, partyId?: string) => void\r\n  unequipMod: (characterId: string, modId: string, partyId?: string) => void\r\n  setActiveCharacterId: (id: string | null) => void\r\n}\r\nconst defaultContextValue: PartyContextT = {\r\n  parties: [],\r\n  rawParties: [],\r\n  userParty: {\r\n    id: v4(),\r\n    characters: [],\r\n    processed: true,\r\n    items: [],\r\n    skills: [],\r\n    mods: [],\r\n  },\r\n  rawUserParty: { id: v4(), characters: [], items: [], skills: [], mods: [] },\r\n  activeCharacterId: null,\r\n  upsertParty: (party) => {},\r\n  upsertItem: (item) => {},\r\n  upsertCharacter: (character, partyId) => {},\r\n  deleteCharacter: (characterId, partyId) => {},\r\n  upsertMod: (mod, partyId) => {},\r\n  deleteMod: (modId, partyId) => {},\r\n  findCharacter: (characterId, partyId) => undefined,\r\n  findRawCharacter: (characterId, partyId) => undefined,\r\n  equipItem: (characterId, itemId, partyId) => {},\r\n  unequipItem: (characterId, itemId, partyId) => {},\r\n  equipMod: (characterId, modId, partyId) => {},\r\n  unequipMod: (characterId, modId, partyId) => {},\r\n  setActiveCharacterId: (id) => {},\r\n}\r\nexport const PartyContext = React.createContext<PartyContextT>(\r\n  defaultContextValue,\r\n)\r\n\r\nexport interface PartyContextProviderPropsT {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const PartyContextProvider = (props: PartyContextProviderPropsT) => {\r\n  const { children } = props\r\n  const actions = usePartiesActions()\r\n  const rawParties = useParties()\r\n  const parties = useMemo(() => {\r\n    return rawParties.map((p) => processParty(p))\r\n  }, [rawParties])\r\n  const userParty = parties.find((p) => p.id === PC_PARTY_ID) as ProcessedPartyT\r\n  const rawUserParty = rawParties.find((p) => p.id === PC_PARTY_ID) as PartyT\r\n  const [activeCharacterId, setActiveCharacterId] = useState<string | null>(\r\n    null,\r\n  )\r\n  const upsertParty = (party: PartyT) => {\r\n    if (!party) return\r\n    if ((party as ProcessedPartyT).processed) {\r\n      throw new Error('No Processed Parties Allowed')\r\n    }\r\n    actions.upsertParty(party)\r\n  }\r\n  const upsertItem = (item: EquippableT, partyId: string = PC_PARTY_ID) => {\r\n    actions.upsertItem(partyId, item)\r\n  }\r\n  const upsertCharacter = (\r\n    character: CharacterT,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    if (!character) return\r\n    if ((character as ProcessedCharacterT).processed) {\r\n      throw new Error('No processed Characters Allowed')\r\n    }\r\n    actions.upsertCharacter(partyId, character)\r\n  }\r\n  const deleteCharacter = (\r\n    characterId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    actions.deleteCharacter(partyId, characterId)\r\n  }\r\n  const upsertMod = (mod: WeaponModT, partyId: string = PC_PARTY_ID) => {\r\n    actions.upsertMod(partyId, mod)\r\n  }\r\n  const deleteMod = (modId: string, partyId: string = PC_PARTY_ID) => {\r\n    actions.deleteMod(partyId, modId)\r\n  }\r\n  const equipItem = (\r\n    characterId: string,\r\n    itemId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    actions.equipItem(partyId, characterId, itemId)\r\n  }\r\n  const unequipItem = (\r\n    characterId: string,\r\n    itemId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    actions.unequipItem(partyId, characterId, itemId)\r\n  }\r\n  const equipMod = (\r\n    characterId: string,\r\n    modId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    actions.equipMod(partyId, characterId, modId)\r\n  }\r\n  const unequipMod = (\r\n    characterId: string,\r\n    modId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    actions.unequipMod(partyId, characterId, modId)\r\n  }\r\n  const findCharacter = (\r\n    characterId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    const party = parties.find((p) => p.id === partyId) as ProcessedPartyT\r\n    return party.characters.find((c) => c.id === characterId)\r\n  }\r\n  const findRawCharacter = (\r\n    characterId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    const party = rawParties.find((p) => p.id === partyId) as PartyT\r\n    return party.characters.find((c) => c.id === characterId)\r\n  }\r\n\r\n  return (\r\n    <PartyContext.Provider\r\n      value={{\r\n        parties,\r\n        rawParties,\r\n        userParty,\r\n        rawUserParty,\r\n        activeCharacterId,\r\n        upsertParty,\r\n        upsertItem,\r\n        upsertCharacter,\r\n        deleteCharacter,\r\n        upsertMod,\r\n        deleteMod,\r\n        equipItem,\r\n        unequipItem,\r\n        equipMod,\r\n        unequipMod,\r\n        findCharacter,\r\n        findRawCharacter,\r\n        setActiveCharacterId,\r\n      }}\r\n    >\r\n      {children}\r\n    </PartyContext.Provider>\r\n  )\r\n}\r\n\r\nexport const usePartyContext = () => useContext(PartyContext)\r\n","import { Dispatch } from 'redux'\r\nimport { StateActionT, StateCoreT, StateT } from '../types'\r\nimport { useSelector } from 'react-redux'\r\nimport { makeReducer } from '../util'\r\nimport { Roll2ResultT, Check2ResultT } from '../../types/Roll2'\r\n\r\nexport const ADD_ROLL = '@state/rolls/ADD_ROLL'\r\n\r\nexport const actionCreators = {\r\n  addRoll: (rollResult: Roll2ResultT | Check2ResultT): StateActionT => ({\r\n    type: ADD_ROLL,\r\n    payload: {\r\n      rollResult,\r\n    },\r\n  }),\r\n}\r\n\r\nexport const actions = {\r\n  addRoll: (dispatch: Dispatch) => (\r\n    rollResult: Roll2ResultT | Check2ResultT,\r\n  ) => {\r\n    dispatch(actionCreators.addRoll(rollResult))\r\n  },\r\n}\r\n\r\nexport const core: StateCoreT<(Roll2ResultT | Check2ResultT)[]> = {\r\n  [ADD_ROLL]: (state, action) => {\r\n    return [...state, action.payload.rollResult]\r\n  },\r\n}\r\n\r\nexport const INITIAL_STATE = []\r\nexport default makeReducer(core, INITIAL_STATE)\r\nexport const useRolls = () => useSelector((state: StateT) => state.rolls)\r\n","import React, { useContext } from 'react'\r\nimport { ProcessedCharacterT, CharacterT } from '../../types/Character'\r\nimport { useCharacterContext } from '../CharacterContext'\r\nimport { useRolls, actionCreators } from '../../state/rolls'\r\nimport { useDispatch } from 'react-redux'\r\nimport {\r\n  Roll2T,\r\n  Check2T,\r\n  Roll2ResultT,\r\n  resolveCharacterRoll,\r\n  CharacterRollT,\r\n  CharacterCheckT,\r\n  resolveCharacterCheck,\r\n  resolveRoll,\r\n  resolveCheck,\r\n  getCheckProbability,\r\n  reduceCharacterCheck,\r\n  Check2ResultT,\r\n} from '../../types/Roll2'\r\n\r\nexport type RollCheckerT<T, R> = (\r\n  roll: T,\r\n  log?: boolean,\r\n  allowNegatives?: boolean,\r\n  label?: string,\r\n) => R\r\nexport interface RollContextT {\r\n  history: Roll2ResultT[]\r\n  execRoll: RollCheckerT<Roll2T | CharacterRollT, Roll2ResultT>\r\n  execCheck: RollCheckerT<Check2T | CharacterCheckT, Check2ResultT>\r\n  rollCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterRollT, Roll2ResultT>\r\n  checkCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterCheckT, Check2ResultT>\r\n  getProbability: (check: CharacterCheckT, log?: boolean) => number\r\n}\r\nexport const RollContext = React.createContext<RollContextT>({\r\n  history: [],\r\n  execRoll: (roll) => ({} as Roll2ResultT),\r\n  execCheck: (roll) => ({} as Check2ResultT),\r\n  rollCharacter: (c) => (roll, log, allowNegatives) =>\r\n    resolveCharacterRoll(roll, c),\r\n  checkCharacter: (c) => (roll, log, allowNegatives) =>\r\n    resolveCharacterCheck(roll, c),\r\n  getProbability: (roll) => 0,\r\n})\r\nexport const useRollContext = () => useContext(RollContext)\r\n\r\nexport interface RollContextProviderPropsT {\r\n  children: any\r\n  rolls: (Roll2ResultT | Check2ResultT)[]\r\n  character?: ProcessedCharacterT\r\n  addRoll: (roll: Roll2ResultT | Check2ResultT, label?: string) => void\r\n}\r\nexport const RollContextProvider = (props: RollContextProviderPropsT) => {\r\n  const { children, rolls, addRoll } = props\r\n  const characterContext = useCharacterContext()\r\n  const character = props.character || characterContext.character\r\n  return (\r\n    <RollContext.Provider\r\n      value={{\r\n        history: rolls,\r\n        execRoll: (roll, log = true, allowNegatives, label) => {\r\n          const result: Roll2ResultT = (roll as CharacterRollT).keys\r\n            ? resolveCharacterRoll(\r\n                roll as CharacterRollT,\r\n                character,\r\n                allowNegatives,\r\n              )\r\n            : resolveRoll(roll, allowNegatives)\r\n          if (log) addRoll(result, label)\r\n          return result\r\n        },\r\n        execCheck: (check, log = true, allowNegatives, label) => {\r\n          const result: Check2ResultT = (check as CharacterCheckT).keys\r\n            ? resolveCharacterCheck(\r\n                check as CharacterCheckT,\r\n                character,\r\n                allowNegatives,\r\n              )\r\n            : resolveCheck(check, allowNegatives)\r\n          if (log) addRoll(result, label)\r\n          return result\r\n        },\r\n        rollCharacter: (\r\n          character,\r\n        ): RollCheckerT<CharacterRollT, Roll2ResultT> => {\r\n          return (\r\n            roll: CharacterRollT,\r\n            log = true,\r\n            allowNegatives = false,\r\n            label,\r\n          ) => {\r\n            const result = resolveCharacterRoll(roll, character, allowNegatives)\r\n            if (log) addRoll(result, label)\r\n            return result\r\n          }\r\n        },\r\n        checkCharacter: (character) => {\r\n          return (\r\n            check: CharacterCheckT,\r\n            log = true,\r\n            allowNegatives = false,\r\n            label,\r\n          ) => {\r\n            const result = resolveCharacterCheck(\r\n              check,\r\n              character,\r\n              allowNegatives,\r\n            )\r\n            if (log) addRoll(result, label)\r\n            return result\r\n          }\r\n        },\r\n        getProbability: (check, log: boolean = false) => {\r\n          return getCheckProbability(reduceCharacterCheck(check, character))\r\n        },\r\n      }}\r\n    >\r\n      {children}\r\n    </RollContext.Provider>\r\n  )\r\n}\r\n\r\nexport interface RollStateContextProviderPropsT {\r\n  children: any\r\n  character?: ProcessedCharacterT\r\n}\r\nexport const RollStateContextProvider = (\r\n  props: RollStateContextProviderPropsT,\r\n) => {\r\n  const { children, character } = props\r\n  const rolls = useRolls()\r\n  const dispatch = useDispatch()\r\n  const addRoll = (roll: Roll2ResultT, label?: string) => {\r\n    dispatch(actionCreators.addRoll({ ...roll, label }))\r\n  }\r\n  return (\r\n    <RollContextProvider rolls={rolls} addRoll={addRoll} character={character}>\r\n      {children}\r\n    </RollContextProvider>\r\n  )\r\n}\r\n","import React, { useContext, useMemo } from 'react'\r\nimport {\r\n  CharacterT,\r\n  ProcessedCharacterT,\r\n  processCharacter,\r\n} from '../../types/Character'\r\nimport { BASE_CHARACTER } from '../../objects/baseCharacter'\r\nimport { usePartyContext } from '../PartyContext'\r\nimport { RollStateContextProvider } from '../RollContext'\r\n\r\nexport interface CharacterContextT {\r\n  character: ProcessedCharacterT\r\n  rawCharacter: CharacterT\r\n  onChange: (character: CharacterT) => void\r\n}\r\nexport const CharacterContext = React.createContext<CharacterContextT>({\r\n  rawCharacter: BASE_CHARACTER,\r\n  character: processCharacter(BASE_CHARACTER),\r\n  onChange: (character) => {},\r\n})\r\nexport const useCharacterContext = () => useContext(CharacterContext)\r\n\r\nexport interface CharacterContextProviderT {\r\n  children: any\r\n  character: CharacterT\r\n  onChange: (character: CharacterT) => void\r\n}\r\nexport const CharacterContextProvider = (props: CharacterContextProviderT) => {\r\n  const { character, children, onChange } = props\r\n  const processedCharacter: ProcessedCharacterT = useMemo(\r\n    () => processCharacter(character),\r\n    [character],\r\n  )\r\n  return (\r\n    <CharacterContext.Provider\r\n      value={{\r\n        character: processedCharacter,\r\n        rawCharacter: character,\r\n        onChange,\r\n      }}\r\n    >\r\n      <RollStateContextProvider>{children}</RollStateContextProvider>\r\n    </CharacterContext.Provider>\r\n  )\r\n}\r\n\r\nexport interface CharacterStateContextProviderPropsT {\r\n  children: any\r\n  characterId?: string\r\n}\r\nexport const CharacterStateContextProvider = (\r\n  props: CharacterStateContextProviderPropsT,\r\n) => {\r\n  const { children, characterId } = props\r\n  const { activeCharacterId, rawUserParty, upsertCharacter } = usePartyContext()\r\n  const character =\r\n    rawUserParty.characters.find((c) => c.id === characterId) ||\r\n    rawUserParty.characters.find((c) => c.id === activeCharacterId) ||\r\n    BASE_CHARACTER\r\n  const onChange = (character: CharacterT) => {\r\n    if (!character) return\r\n    if ((character as ProcessedCharacterT).processed) {\r\n      throw new Error('no process characters allowed')\r\n    }\r\n    upsertCharacter(character)\r\n  }\r\n  return (\r\n    <CharacterContextProvider\r\n      character={character as CharacterT}\r\n      onChange={onChange}\r\n    >\r\n      {children}\r\n    </CharacterContextProvider>\r\n  )\r\n}\r\n","import { styled } from 'styletron-react'\r\n\r\nexport interface FlexContainerPropsT {\r\n  $direction?: 'row' | 'column' | 'column-reverse'\r\n  $full?: boolean\r\n}\r\nexport const FlexContainer = styled('div', (props: FlexContainerPropsT) => ({\r\n  display: 'flex',\r\n  flexDirection: props.$direction || 'row',\r\n  flex: props.$full ? 1 : 'default',\r\n}))\r\nexport const FullContainer = styled('div', () => ({\r\n  flex: 1,\r\n}))\r\n","import { CharacterResourceKeyT } from '../types/Character'\r\nimport WeaponHands from '../icons/svg/delapouite/sword-brandish.svg'\r\nimport CharacterPoints from '../icons/svg/lorc/aura.svg'\r\nimport Heads from '../icons/svg/lorc/barbute.svg'\r\nimport Bodies from '../icons/svg/delapouite/muscular-torso.svg'\r\nimport Hands from '../icons/svg/sbed/hand.svg'\r\nimport Finger from '../icons/svg/delapouite/ring.svg'\r\nimport Feet from '../icons/svg/lorc/footprint.svg'\r\nimport Slashing from '../icons/svg/lorc/quick-slash.svg'\r\nimport Piercing from '../icons/svg/lorc/barbed-arrow.svg'\r\nimport Fire from '../icons/svg/carl-olsen/flame.svg'\r\nimport Blood from '../icons/svg/lorc/bleeding-eye.svg'\r\nimport Light from '../icons/svg/lorc/moebius-trefoil.svg'\r\nimport Dark from '../icons/svg/lorc/triorb.svg'\r\nimport Shield from '../icons/svg/sbed/shield.svg'\r\nimport Tome from '../icons/svg/lorc/book-cover.svg'\r\nimport Fists from '../icons/svg/skoll/fist.svg'\r\nimport Axe from '../icons/svg/lorc/fire-axe.svg'\r\nimport GreatAxe from '../icons/svg/delapouite/war-axe.svg'\r\nimport Sword from '../icons/svg/lorc/stiletto.svg'\r\nimport Greatsword from '../icons/svg/lorc/croc-sword.svg'\r\nimport Flail from '../icons/svg/delapouite/flail.svg'\r\nimport Daggers from '../icons/svg/lorc/crossed-swords.svg'\r\nimport Katana from '../icons/svg/delapouite/katana.svg'\r\nimport Rapier from '../icons/svg/lorc/sword-hilt.svg'\r\nimport Wand from '../icons/svg/willdabeast/orb-wand.svg'\r\nimport Staff from '../icons/svg/lorc/wizard-staff.svg'\r\nimport Pistol from '../icons/svg/skoll/luger.svg'\r\nimport Crossbow from '../icons/svg/carl-olsen/crossbow.svg'\r\nimport FireSword from '../icons/svg/lorc/shard-sword.svg'\r\nimport BloodSword from '../icons/svg/lorc/bloody-sword.svg'\r\nimport LightSword from '../icons/svg/lorc/winged-sword.svg'\r\nimport DarkSword from '../icons/svg/lorc/spiral-thrust.svg'\r\nimport Helmet from '../icons/svg/delapouite/closed-barbute.svg'\r\nimport Cowl from '../icons/svg/lorc/hood.svg'\r\nimport Armor from '../icons/svg/delapouite/shoulder-armor.svg'\r\nimport Robe from '../icons/svg/lorc/robe.svg'\r\nimport Gloves from '../icons/svg/delapouite/gloves.svg'\r\nimport Ring from '../icons/svg/delapouite/power-ring.svg'\r\nimport Boots from '../icons/svg/lorc/boots.svg'\r\nimport { DamageTypeKeyT } from '../types/Damage'\r\nimport { WeaponTypeT, WeaponIconKeyT } from '../types/Weapon'\r\nimport { ArmorTypeT } from '../types/Armor'\r\nimport { ItemTypeT } from '../types/Item'\r\n\r\nexport const IconCharacterResourceMap: Record<CharacterResourceKeyT, string> = {\r\n  weaponHands: WeaponHands,\r\n  characterPoints: CharacterPoints,\r\n  heads: Heads,\r\n  bodies: Bodies,\r\n  hands: Hands,\r\n  fingers: Finger,\r\n  feet: Feet,\r\n}\r\n\r\nexport const IconDamageTypeMap: Record<DamageTypeKeyT, string> = {\r\n  slashing: Slashing,\r\n  piercing: Piercing,\r\n  fire: Fire,\r\n  blood: Blood,\r\n  light: Light,\r\n  dark: Dark,\r\n}\r\n\r\nexport const IconItemTypeMap: Record<ItemTypeT, string> = {\r\n  weapon: '',\r\n  armor: '',\r\n  shield: Shield,\r\n  tome: Tome,\r\n}\r\n\r\nexport const IconWeaponTypeMap: Record<WeaponTypeT, string> = {\r\n  fists: Fists,\r\n  axe: Axe,\r\n  greataxe: GreatAxe,\r\n  flail: Flail,\r\n  daggers: Daggers,\r\n  katana: Katana,\r\n  rapier: Rapier,\r\n  wand: Wand,\r\n  staff: Staff,\r\n  elementalSword: FireSword,\r\n  elementalGreatsword: DarkSword,\r\n  sword: Sword,\r\n  greatsword: Greatsword,\r\n  pistol: Pistol,\r\n  crossbow: Crossbow,\r\n}\r\n\r\nexport const IconUniqueWeaponMap: Record<WeaponIconKeyT, string> = {\r\n  'fire-sword': FireSword,\r\n  'blood-sword': BloodSword,\r\n  'light-sword': LightSword,\r\n  'dark-sword': DarkSword,\r\n}\r\n\r\nexport const IconArmorTypeMap: Record<ArmorTypeT, string> = {\r\n  helmet: Helmet,\r\n  cowl: Cowl,\r\n  chestplate: Armor,\r\n  robe: Robe,\r\n  gloves: Gloves,\r\n  ring: Ring,\r\n  boots: Boots,\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\nexport interface IconPropsT {\r\n  src: string\r\n  size: number\r\n  fill?: string\r\n  style?: React.CSSProperties\r\n  onClick?: () => void\r\n}\r\nexport const Icon = ({\r\n  src,\r\n  size,\r\n  style = {},\r\n  fill = 'white',\r\n  onClick,\r\n}: IconPropsT) => {\r\n  const [loading, setLoading] = useState(true)\r\n  const [svg, setSvg] = useState('')\r\n\r\n  useEffect(() => {\r\n    if (src) {\r\n      fetch(src)\r\n        .then((res) => res.text())\r\n        .then((text) => setSvg(text))\r\n        .then(() => setLoading(false))\r\n    }\r\n  }, [src])\r\n\r\n  return !loading ? (\r\n    <div\r\n      onClick={() => {\r\n        if (onClick) onClick()\r\n      }}\r\n      style={{ ...style, height: size, width: size, fill }}\r\n      dangerouslySetInnerHTML={{ __html: svg }}\r\n    />\r\n  ) : (\r\n    <div />\r\n  )\r\n}\r\n","import React, { useState, useEffect, useLayoutEffect } from 'react'\r\nimport { timeout } from '../../util/wait'\r\nimport { v4 } from 'uuid'\r\n\r\nexport interface HoverChildrenT {\r\n  isHovering: boolean\r\n}\r\nexport interface HoverPropsT {\r\n  delay?: number\r\n  children: (props: HoverChildrenT) => JSX.Element\r\n}\r\nexport const Hover = (props: HoverPropsT) => {\r\n  const { delay = 500, children } = props\r\n  const [internalHovering, setInternalHovering] = useState<boolean>(false)\r\n  const [isHovering, setIsHovering] = useState<boolean>(false)\r\n  const [guid, setGuid] = useState<string>(v4())\r\n  useLayoutEffect(() => {\r\n    const action = async () => {\r\n      if (internalHovering) {\r\n        setTimeout(() => {\r\n          setGuid(v4())\r\n        }, delay)\r\n      }\r\n    }\r\n    action()\r\n  }, [internalHovering])\r\n  useLayoutEffect(() => {\r\n    if (internalHovering) {\r\n      setIsHovering(true)\r\n    }\r\n  }, [guid])\r\n  const onMouseEnter = (e: React.MouseEvent) => {\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n    setInternalHovering(true)\r\n  }\r\n  const onMouseLeave = (e: React.MouseEvent) => {\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n    setInternalHovering(false)\r\n    setIsHovering(false)\r\n  }\r\n  return (\r\n    <div onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave}>\r\n      {children({ isHovering })}\r\n    </div>\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport { Hover } from '../components/Hover'\r\n\r\nexport interface BoxContainerPropsT extends React.HTMLProps<HTMLDivElement> {\r\n  substyle?: React.CSSProperties\r\n  tag?: any\r\n  to?: string\r\n}\r\nexport const BoxContainer = (props: BoxContainerPropsT) => {\r\n  const {\r\n    style = {},\r\n    substyle = {},\r\n    children,\r\n    tag: Element = 'div',\r\n    ...rest\r\n  } = props\r\n  return (\r\n    <div\r\n      style={{\r\n        border: '1px solid #000',\r\n        display: 'flex',\r\n        boxSizing: 'border-box',\r\n        ...style,\r\n      }}\r\n    >\r\n      <Element\r\n        style={{\r\n          border: substyle.border || '1px solid #555',\r\n          background: 'linear-gradient(0deg, #222222 0%, #2a2a2a 100%)',\r\n          padding: 10,\r\n          color: '#ccc',\r\n          flex: 1,\r\n          ...substyle,\r\n        }}\r\n        {...rest}\r\n      >\r\n        {children}\r\n      </Element>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const SmallBox = (props: BoxContainerPropsT) => (\r\n  <BoxContainer\r\n    {...props}\r\n    style={{\r\n      height: 40,\r\n      width: 40,\r\n      ...props.style,\r\n    }}\r\n    substyle={{\r\n      display: 'flex',\r\n      padding: 0,\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      background: '#111',\r\n      ...props.substyle,\r\n    }}\r\n  >\r\n    {props.children}\r\n  </BoxContainer>\r\n)\r\n\r\nexport const BoxButton = (props: BoxContainerPropsT) => {\r\n  return (\r\n    <Hover delay={0}>\r\n      {({ isHovering }) => (\r\n        <BoxContainer\r\n          {...props}\r\n          tag='button'\r\n          style={{\r\n            margin: 0,\r\n            ...(props.style || {}),\r\n          }}\r\n          substyle={{\r\n            borderColor: isHovering ? '#999' : '#555',\r\n            padding: '4px',\r\n            cursor: props.disabled ? 'default' : 'pointer',\r\n            background: props.disabled ? '#444' : '#111',\r\n            ...(props.substyle || {}),\r\n          }}\r\n        />\r\n      )}\r\n    </Hover>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { CharacterResourceKeyT } from '../../types/Character'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { IconCharacterResourceMap } from '../../icons/maps'\r\nimport { Icon } from '../Icon'\r\nimport { BoxContainer } from '../../elements/box'\r\n\r\nexport interface ResourceScorePropsT {\r\n  id: CharacterResourceKeyT\r\n}\r\nexport const ResourceScore = (props: ResourceScorePropsT) => {\r\n  const { id } = props\r\n  const { character } = useCharacterContext()\r\n  const iconUrl = IconCharacterResourceMap[id]\r\n\r\n  return (\r\n    <BoxContainer\r\n      substyle={{\r\n        display: 'flex',\r\n        padding: 4,\r\n        fontFamily: 'monospace',\r\n        fontSize: 16,\r\n      }}\r\n    >\r\n      <div style={{ flex: 1, marginRight: 10 }}>\r\n        <Icon size={18} src={iconUrl} />\r\n      </div>\r\n      {character.resources[id]}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport {\r\n  CharacterAbilityKeyT,\r\n  CharacterKeyMap3,\r\n  characterAbilityScoreCosts,\r\n  setCharacterAbilityScore,\r\n} from '../../types/Character'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { makeCharacterCheck } from '../../types/Roll2'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\n\r\nexport interface AbilityScorePropsT {\r\n  id: CharacterAbilityKeyT\r\n  edit?: boolean\r\n}\r\nexport const AbilityScore = (props: AbilityScorePropsT) => {\r\n  const { id, edit = true } = props\r\n  const { character, rawCharacter, onChange } = useCharacterContext()\r\n  const { upsertItem } = usePartyContext()\r\n  const { execCheck } = useRollContext()\r\n  const keyName = CharacterKeyMap3[id]\r\n  const rawValue = rawCharacter.abilities[id]\r\n  const displayValue = character.abilities[id]\r\n  const cost = characterAbilityScoreCosts[id]\r\n  const points = character.resources.characterPoints\r\n\r\n  return (\r\n    <PureAbilityScore\r\n      name={keyName}\r\n      value={displayValue}\r\n      rawValue={rawValue}\r\n      points={points}\r\n      cost={cost}\r\n      edit={edit}\r\n      onClick={() => {\r\n        execCheck(makeCharacterCheck([id]))\r\n      }}\r\n      onIncrement={() => {\r\n        const [char, items] = setCharacterAbilityScore(rawCharacter)(\r\n          id,\r\n          rawValue + 1,\r\n          points - cost,\r\n        )\r\n        onChange(char)\r\n        items.forEach((item) => {\r\n          upsertItem(item)\r\n        })\r\n      }}\r\n      onDecrement={() => {\r\n        const [char, items] = setCharacterAbilityScore(rawCharacter)(\r\n          id,\r\n          rawValue - 1,\r\n          points + cost,\r\n        )\r\n        onChange(char)\r\n        items.forEach((item) => {\r\n          upsertItem(item)\r\n        })\r\n      }}\r\n    />\r\n  )\r\n}\r\n\r\nexport const PureAbilityScore = (props: any) => {\r\n  const {\r\n    name,\r\n    edit,\r\n    rawValue,\r\n    value,\r\n    points,\r\n    cost,\r\n    onClick,\r\n    onIncrement,\r\n    onDecrement,\r\n  } = props\r\n  return (\r\n    <BoxContainer\r\n      substyle={{\r\n        padding: 0,\r\n        display: 'flex',\r\n        fontFamily: 'monospace',\r\n      }}\r\n    >\r\n      <FlexContainer\r\n        style={{ padding: 8, marginRight: 10, whiteSpace: 'nowrap' }}\r\n        $direction='column'\r\n        $full\r\n      >\r\n        <a href='#' onClick={onClick}>\r\n          {name} ({rawValue})\r\n        </a>\r\n        <span style={{ fontSize: 36, fontWeight: 'bolder' }}>{value}</span>\r\n      </FlexContainer>\r\n      {edit && (\r\n        <FlexContainer\r\n          $direction='column'\r\n          style={{\r\n            width: 30,\r\n          }}\r\n        >\r\n          <BoxButton\r\n            style={{ margin: 0 }}\r\n            disabled={points < cost || rawValue === 18}\r\n            onClick={onIncrement}\r\n          >\r\n            +\r\n          </BoxButton>\r\n          <FlexContainer\r\n            $full\r\n            style={{\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n            }}\r\n          >\r\n            <div>{cost}</div>\r\n          </FlexContainer>\r\n          <BoxButton\r\n            style={{ margin: 0 }}\r\n            disabled={rawValue === 3}\r\n            onClick={onDecrement}\r\n          >\r\n            -\r\n          </BoxButton>\r\n        </FlexContainer>\r\n      )}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { CharacterStatKeyT } from '../../types/Character'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { makeCharacterCheck } from '../../types/Roll2'\r\n\r\nexport interface StatScorePropsT {\r\n  id: CharacterStatKeyT\r\n}\r\nexport const StatScore = (props: StatScorePropsT) => {\r\n  const { id } = props\r\n  const { character } = useCharacterContext()\r\n  const { execCheck } = useRollContext()\r\n  const displayName = id //CharacterKeyMap3[id]\r\n  return (\r\n    <BoxContainer\r\n      style={{ flex: 1 }}\r\n      substyle={{\r\n        display: 'flex',\r\n        fontFamily: 'monospace',\r\n        alignItems: 'center',\r\n      }}\r\n    >\r\n      <a\r\n        href='#'\r\n        style={{ display: 'inline-block', flex: 1, marginRight: 10 }}\r\n        onClick={() => execCheck(makeCharacterCheck([id]))}\r\n      >\r\n        {displayName}\r\n      </a>\r\n      <span>{character.stats[id]}</span>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { DamageTypeKeyT, DamageTypeKeyColors } from '../../types/Damage'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { Icon } from '../Icon'\r\nimport { IconDamageTypeMap } from '../../icons/maps'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport {\r\n  CharacterRollT,\r\n  getRollRange,\r\n  reduceCharacterRoll,\r\n} from '../../types/Roll2'\r\n\r\nexport interface DamageResistanceScorePropsT {\r\n  id: DamageTypeKeyT\r\n}\r\nexport const DamageResistanceScore = (props: DamageResistanceScorePropsT) => {\r\n  const { id } = props\r\n  const { character } = useCharacterContext()\r\n  const { execRoll } = useRollContext()\r\n  const { damageResistances } = character\r\n  const roll = damageResistances[id] as CharacterRollT\r\n  const rollText = roll\r\n    ? `(${getRollRange(reduceCharacterRoll(roll, character))})`\r\n    : ''\r\n  const iconUrl = IconDamageTypeMap[id]\r\n  const fill = DamageTypeKeyColors[id]\r\n\r\n  return (\r\n    <BoxContainer\r\n      style={{ flex: 1 }}\r\n      substyle={{\r\n        display: 'flex',\r\n        whiteSpace: 'nowrap',\r\n        fontFamily: 'monospace',\r\n        alignItems: 'center',\r\n      }}\r\n    >\r\n      <div style={{ flex: 1, marginRight: 20 }}>\r\n        <FlexContainer>\r\n          <Icon\r\n            size={18}\r\n            src={iconUrl}\r\n            fill={fill}\r\n            style={{ marginRight: 10 }}\r\n          />\r\n          <a href='#' onClick={() => (roll ? execRoll(roll) : null)}>\r\n            {id}\r\n          </a>\r\n        </FlexContainer>\r\n      </div>\r\n      <div>{rollText ? rollText : 0}</div>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","export type CompareResultT = -1 | 0 | 1\r\nexport type CompareResultFn<T = any> = (...args: [T, T, T]) => T\r\nexport const ZERO_COMPARE: CompareResultFn = (...args) => args[1]\r\nexport const ONE_COMPARE: CompareResultFn = (...args) => args[2]\r\nexport const BASE_ARGS: [string, string, string] = [\r\n  'lightcoral',\r\n  'inherit',\r\n  'lightgreen',\r\n]\r\nexport const compareResult = (result: CompareResultT): CompareResultFn => (\r\n  ...args: any[]\r\n) => {\r\n  return args[result + 1]\r\n}\r\nexport const toCompareResult = (n: number) => (n < 0 ? -1 : n > 0 ? 1 : 0)\r\nexport const getCompareFn = (valueA: number, valueB: number) => {\r\n  return compareResult(toCompareResult(valueA - valueB))\r\n}\r\n","import React from 'react'\r\nimport {\r\n  CharacterTraitT,\r\n  CharacterKeyMap3,\r\n  CharacterSkillCheckKeyT,\r\n  getTraitValue,\r\n} from '../../types/Character'\r\nimport { getSign } from '../../util/getSign'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport { CompareResultFn, ZERO_COMPARE, BASE_ARGS } from '../../util/compare'\r\n\r\nexport interface TraitScorePropsT {\r\n  trait: CharacterTraitT\r\n  compareResult?: (keY: CharacterSkillCheckKeyT) => CompareResultFn\r\n}\r\nexport const TraitScore = (props: TraitScorePropsT) => {\r\n  const {\r\n    trait,\r\n    compareResult = (key: CharacterSkillCheckKeyT) => ZERO_COMPARE,\r\n  } = props\r\n  const { abilitiesModifiers, statsModifiers } = trait\r\n  const abilityKeys = getKeys(abilitiesModifiers).filter(\r\n    (key) => getTraitValue(trait, key) !== 0,\r\n  )\r\n  const statKeys = getKeys(statsModifiers).filter(\r\n    (key) => getTraitValue(trait, key) !== 0,\r\n  )\r\n\r\n  return (\r\n    <div style={{ fontFamily: 'monospace' }}>\r\n      {trait.focusOffset !== 0 && (\r\n        <span>\r\n          {getSign(trait.focusOffset)}\r\n          {Math.abs(trait.focusOffset)} FP\r\n          {trait.healthOffset !== 0 ||\r\n          abilityKeys.length > 0 ||\r\n          statKeys.length > 0\r\n            ? ', '\r\n            : ''}\r\n        </span>\r\n      )}\r\n      {trait.healthOffset !== 0 && (\r\n        <span>\r\n          {getSign(trait.healthOffset)}\r\n          {Math.abs(trait.healthOffset)} HP\r\n          {abilityKeys.length > 0 || statKeys.length > 0 ? ', ' : ''}\r\n        </span>\r\n      )}\r\n      {abilityKeys.map((key, i) => (\r\n        <span key={key}>\r\n          {i > 0 ? ', ' : ''}\r\n          <span\r\n            style={{\r\n              color: compareResult(key)(...BASE_ARGS),\r\n            }}\r\n          >\r\n            {getSign(getTraitValue(trait, key))}\r\n            {Math.abs(getTraitValue(trait, key))} {CharacterKeyMap3[key]}\r\n          </span>\r\n        </span>\r\n      ))}\r\n      {abilityKeys.length > 0 && statKeys.length > 0 && ', '}\r\n      {statKeys.map((key, i) => (\r\n        <span key={key}>\r\n          {i > 0 ? ', ' : ''}\r\n          <span\r\n            style={{\r\n              color: compareResult(key)(...BASE_ARGS),\r\n            }}\r\n          >\r\n            {getSign(getTraitValue(trait, key))}\r\n            {Math.abs(getTraitValue(trait, key))} {CharacterKeyMap3[key]}\r\n          </span>\r\n        </span>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n","import { notZero } from './notZero'\r\n\r\nexport const getValueString = (value: number): string =>\r\n  notZero(value, `${Math.abs(value)}`)\r\n","import React, { useMemo } from 'react'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { CharacterKeyMap3 } from '../../types/Character'\r\nimport { getSign } from '../../util/getSign'\r\nimport { getValueString } from '../../util/getValueString'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { Icon } from '../Icon'\r\nimport Dice6 from '../../icons/svg/delapouite/dice-six-faces-six.svg'\r\nimport { CompareResultFn, ZERO_COMPARE, BASE_ARGS } from '../../util/compare'\r\nimport { CharacterCheckT } from '../../types/Roll2'\r\n\r\nexport interface CheckPreviewPropsT {\r\n  check: CharacterCheckT\r\n  name?: string\r\n  showCheckButton?: boolean\r\n  compareResult?: CompareResultFn\r\n}\r\nexport const CheckPreview = (props: CheckPreviewPropsT) => {\r\n  const {\r\n    check,\r\n    name,\r\n    showCheckButton = true,\r\n    compareResult = ZERO_COMPARE,\r\n  } = props\r\n  const { execCheck, getProbability } = useRollContext()\r\n  const value = check.value || 0\r\n  const rollKeys = (check.keys || []).map((k) => CharacterKeyMap3[k])\r\n  const keyStr =\r\n    rollKeys.reduce((str, key, i) => `${str}${i !== 0 ? '+' : ''}${key}`, '') +\r\n    (rollKeys.length === 0 ? '' : getSign(value))\r\n  const rollStr = check.roll.string ? ` {${check.roll.string}} ` : ''\r\n  const probability = useMemo(() => getProbability(check, true), [\r\n    check,\r\n    getProbability,\r\n  ])\r\n\r\n  return (\r\n    <FlexContainer>\r\n      <div\r\n        style={{\r\n          marginRight: 10,\r\n          flex: 1,\r\n          color: compareResult(...BASE_ARGS),\r\n        }}\r\n      >\r\n        {name && <strong>{name}</strong>}\r\n        <div style={{ fontFamily: 'monospace', whiteSpace: 'nowrap' }}>\r\n          {rollStr}\r\n          {keyStr}\r\n          {rollStr && getValueString(value)}{' '}\r\n          {!rollStr && ' = ' + getValueString(check.roll.modifier)} (\r\n          {probability}%)\r\n        </div>\r\n      </div>\r\n      {showCheckButton && (\r\n        <div>\r\n          <button onClick={() => execCheck(check)}>\r\n            <Icon src={Dice6} size={18} fill='4bebc6' />\r\n          </button>\r\n        </div>\r\n      )}\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { Icon } from '../Icon'\r\nimport { IconArmorTypeMap } from '../../icons/maps'\r\nimport { ArmorT } from '../../types/Armor'\r\n\r\nexport interface ArmorIconPropsT {\r\n  item: ArmorT\r\n  size: number\r\n  fill?: string\r\n  style?: React.CSSProperties\r\n}\r\nexport const ArmorIcon = (props: ArmorIconPropsT) => {\r\n  const { item, size, fill, style } = props\r\n  const src = IconArmorTypeMap[item.armorType]\r\n\r\n  return <Icon src={src} size={size} fill={fill} style={style} />\r\n}\r\n","import { CharacterTraitT, CharacterResourceKeyT } from './Character'\r\nimport { DamageTypeRollsT } from './Damage'\r\nimport { CharacterCheckT } from './Roll2'\r\n\r\nexport type ItemRarityT =\r\n  | 'common'\r\n  | 'uncommon'\r\n  | 'rare'\r\n  | 'legendary'\r\n  | 'unique'\r\n  | 'mythic'\r\n  | 'set'\r\nexport interface ItemT {\r\n  id: string\r\n  name: string\r\n  rarity: ItemRarityT\r\n  icon?: string\r\n}\r\nexport type ItemTypeT = 'weapon' | 'armor' | 'shield' | 'tome'\r\nexport interface EquippableT extends ItemT {\r\n  equippable: true\r\n  type: ItemTypeT\r\n  rarity: ItemRarityT\r\n  cost: number\r\n  resource: CharacterResourceKeyT\r\n  requirementCheck: CharacterCheckT\r\n  traits: CharacterTraitT[]\r\n  damageResistances: DamageTypeRollsT\r\n}\r\n\r\nexport const ItemRarityColorMap: Record<ItemRarityT, string> = {\r\n  common: '#fff',\r\n  uncommon: '#9fbd9f',\r\n  rare: '#91b4f2',\r\n  legendary: '#cda5f3',\r\n  unique: '#c2af6b',\r\n  mythic: 'lightsalmon',\r\n  set: '#38f5e2',\r\n}\r\n","import React from 'react'\r\nimport { Icon } from '../Icon'\r\nimport { IconItemTypeMap } from '../../icons/maps'\r\nimport { EquippableT } from '../../types/Item'\r\n\r\nexport interface ItemIconPropsT {\r\n  item: EquippableT\r\n  size: number\r\n  fill?: string\r\n  style?: React.CSSProperties\r\n}\r\nexport const ItemIcon = (props: ItemIconPropsT) => {\r\n  const { item, size, fill, style } = props\r\n  const src = IconItemTypeMap[item.type]\r\n\r\n  return <Icon src={src} size={size} fill={fill} style={style} />\r\n}\r\n","import React, { useState } from 'react'\r\nimport Color from 'color'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport {\r\n  getDamageTypeKeys,\r\n  DamageTypeKeyColors,\r\n  DamageTypeKeyT,\r\n} from '../../types/Damage'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { TraitScore } from '../TraitScore'\r\nimport { CheckPreview } from '../CheckPreview'\r\nimport { CharacterSkillCheckKeyT } from '../../types/Character'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport { IconDamageTypeMap, IconCharacterResourceMap } from '../../icons/maps'\r\nimport { Icon } from '../Icon'\r\nimport { ArmorIcon } from '../ArmorIcon'\r\nimport { ArmorT } from '../../types/Armor'\r\nimport { EquippableT, ItemRarityColorMap } from '../../types/Item'\r\nimport { ItemIcon } from '../ItemIcon'\r\nimport { CompareResultFn, ZERO_COMPARE, BASE_ARGS } from '../../util/compare'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { CharacterRollT, getRollText } from '../../types/Roll2'\r\n\r\nexport interface ItemPreviewPropsT {\r\n  item: EquippableT\r\n  showEquipButton?: boolean\r\n  showRequirementCheck?: boolean\r\n  showCollapseButton?: boolean\r\n  requirementCompare?: CompareResultFn\r\n  traitCompare?: (key: CharacterSkillCheckKeyT) => CompareResultFn\r\n  resistancesCompare?: (key: DamageTypeKeyT) => CompareResultFn\r\n  costComare?: CompareResultFn\r\n}\r\nexport const ItemPreview = (props: ItemPreviewPropsT) => {\r\n  const {\r\n    item,\r\n    showEquipButton = true,\r\n    showRequirementCheck = true,\r\n    showCollapseButton = false,\r\n  } = props\r\n  const { rawCharacter } = useCharacterContext()\r\n  const { unequipItem } = usePartyContext()\r\n  const [collapsed, setCollapsed] = useState(false)\r\n  const requirementCompare = props.requirementCompare || ZERO_COMPARE\r\n  const traitCompare = props.traitCompare || ((key) => ZERO_COMPARE)\r\n  const resistancesCompare = props.resistancesCompare || ((key) => ZERO_COMPARE)\r\n  const costComare = props.costComare || ZERO_COMPARE\r\n  const isArmor = item.type === 'armor'\r\n  const rarityColor = ItemRarityColorMap[item.rarity]\r\n  const borderColor = Color(rarityColor)\r\n    .desaturate(0.5)\r\n    .fade(0.5)\r\n    .rgb()\r\n    .string()\r\n  return (\r\n    <BoxContainer\r\n      style={{ width: 380 }}\r\n      substyle={{ borderColor: borderColor }}\r\n    >\r\n      <FlexContainer>\r\n        {isArmor ? (\r\n          <ArmorIcon\r\n            item={item as ArmorT}\r\n            size={24}\r\n            fill={rarityColor}\r\n            style={{ marginRight: 10 }}\r\n          />\r\n        ) : (\r\n          <ItemIcon\r\n            item={item}\r\n            size={24}\r\n            style={{ marginRight: 10 }}\r\n            fill={rarityColor}\r\n          />\r\n        )}\r\n        <h3\r\n          style={{\r\n            margin: '0 10px 0 0',\r\n            flex: 1,\r\n            whiteSpace: 'nowrap',\r\n            // color: rarityColor,\r\n          }}\r\n        >\r\n          {item.name}\r\n        </h3>\r\n        {showCollapseButton && (\r\n          <BoxButton\r\n            substyle={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n            }}\r\n            onClick={() => {\r\n              setCollapsed((c) => !c)\r\n            }}\r\n          >\r\n            {collapsed ? 'more' : 'less'}\r\n          </BoxButton>\r\n        )}\r\n        {!showEquipButton && (\r\n          <FlexContainer\r\n            style={{\r\n              margin: '0 0 10px 0',\r\n              fontWeight: 'bold',\r\n              fontSize: 12,\r\n              color: costComare(...BASE_ARGS),\r\n            }}\r\n          >\r\n            <Icon\r\n              src={IconCharacterResourceMap[item.resource]}\r\n              size={12}\r\n              fill={costComare('lightcoral', 'white', 'lightgreen')}\r\n              style={{ margin: '0 8px' }}\r\n            />\r\n            {item.cost}\r\n          </FlexContainer>\r\n        )}\r\n        {showEquipButton && (\r\n          <BoxButton\r\n            substyle={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n            }}\r\n            onClick={() => {\r\n              unequipItem(rawCharacter.id, item.id)\r\n            }}\r\n          >\r\n            <Icon\r\n              src={IconCharacterResourceMap[item.resource]}\r\n              size={12}\r\n              fill='rgba(255,255,255,0.8)'\r\n              style={{ marginRight: 10 }}\r\n            />\r\n            {item.cost}\r\n          </BoxButton>\r\n        )}\r\n      </FlexContainer>\r\n      {!collapsed && (\r\n        <>\r\n          {item.requirementCheck.roll.modifier !== 1 && showRequirementCheck && (\r\n            <div style={{ marginTop: 10 }}>\r\n              <CheckPreview\r\n                name='Requirement'\r\n                check={item.requirementCheck}\r\n                showCheckButton={false}\r\n                compareResult={requirementCompare}\r\n              />\r\n            </div>\r\n          )}\r\n          <FlexContainer $direction='column'>\r\n            {item.traits.map((trait) => (\r\n              <div key={trait.id} style={{ marginTop: 10 }}>\r\n                <TraitScore trait={trait} compareResult={traitCompare} />\r\n              </div>\r\n            ))}\r\n            {item.damageResistances && (\r\n              <FlexContainer\r\n                style={{\r\n                  fontFamily: 'monospace',\r\n                  flexWrap: 'wrap',\r\n                  marginTop: 15,\r\n                  justifyContent: 'space-evenly',\r\n                }}\r\n              >\r\n                {getDamageTypeKeys(item.damageResistances)\r\n                  .filter((k) => item.damageResistances[k])\r\n                  .map((key) => (\r\n                    <FlexContainer key={key}>\r\n                      <Icon\r\n                        src={IconDamageTypeMap[key]}\r\n                        size={14}\r\n                        fill={DamageTypeKeyColors[key]}\r\n                        style={{\r\n                          marginRight: 8,\r\n                        }}\r\n                      />\r\n                      <div\r\n                        style={{\r\n                          fontSize: 16,\r\n                          lineHeight: '16px',\r\n                          color: resistancesCompare(key)(...BASE_ARGS),\r\n                        }}\r\n                      >\r\n                        {getRollText(\r\n                          item.damageResistances[key] as CharacterRollT,\r\n                        ) || 0}\r\n                      </div>\r\n                    </FlexContainer>\r\n                  ))}\r\n              </FlexContainer>\r\n            )}\r\n          </FlexContainer>\r\n        </>\r\n      )}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import { EquippableT } from './Item'\r\nimport { DamageTypeRollsT } from './Damage'\r\n\r\nexport type ArmorTypeT =\r\n  | 'helmet'\r\n  | 'cowl'\r\n  | 'chestplate'\r\n  | 'robe'\r\n  | 'gloves'\r\n  | 'ring'\r\n  | 'boots'\r\nexport interface ArmorT extends EquippableT {\r\n  type: 'armor'\r\n  armorType: ArmorTypeT\r\n  damageResistances: DamageTypeRollsT\r\n}\r\n\r\nexport const ArmorTypeSortKey: Record<ArmorTypeT, number> = {\r\n  helmet: 0,\r\n  cowl: 0,\r\n  chestplate: 1,\r\n  robe: 1,\r\n  gloves: 2,\r\n  ring: 3,\r\n  boots: 4,\r\n}\r\n","import React from 'react'\r\nimport { WeaponT, WeaponIconKeyT } from '../../types/Weapon'\r\nimport { Icon } from '../Icon'\r\nimport { IconUniqueWeaponMap, IconWeaponTypeMap } from '../../icons/maps'\r\n\r\nexport interface WeaponIconPropsT {\r\n  weapon: WeaponT\r\n  size: number\r\n  fill?: string\r\n  style?: React.CSSProperties\r\n}\r\nexport const WeaponIcon = (props: WeaponIconPropsT) => {\r\n  const { weapon, size, fill, style } = props\r\n  const src = weapon.icon\r\n    ? IconUniqueWeaponMap[weapon.icon as WeaponIconKeyT]\r\n    : IconWeaponTypeMap[weapon.weaponType]\r\n\r\n  return <Icon src={src} size={size} fill={fill} style={style} />\r\n}\r\n","import React from 'react'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport {\r\n  DamageTypeKeyT,\r\n  DamageTypeKeyColors,\r\n  DamageTypeRollsT,\r\n} from '../../types/Damage'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { Icon } from '../Icon'\r\nimport { IconDamageTypeMap } from '../../icons/maps'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport { CompareResultFn, ZERO_COMPARE, BASE_ARGS } from '../../util/compare'\r\nimport {\r\n  CharacterRollT,\r\n  getRollText,\r\n  getRollRange,\r\n  reduceCharacterRoll,\r\n  combineCharacterRolls,\r\n} from '../../types/Roll2'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\n\r\nexport interface HasDamageRollsT {\r\n  damageRolls: DamageTypeRollsT\r\n}\r\nexport interface DamageRollScoresPropsT {\r\n  parent: HasDamageRollsT\r\n  children: (\r\n    values: DamageRollScorePropsT[],\r\n    combinedRoll: CharacterRollT,\r\n  ) => any\r\n}\r\nexport const DamageRollScores = (props: DamageRollScoresPropsT) => {\r\n  const { parent, children } = props\r\n  const { character } = useCharacterContext()\r\n  const { damageRolls } = parent\r\n  const keys: DamageTypeKeyT[] = getKeys(damageRolls).filter(\r\n    (key) => damageRolls[key],\r\n  )\r\n  const rolls = keys\r\n    .map((key) => damageRolls[key])\r\n    .filter((roll) => roll) as CharacterRollT[]\r\n\r\n  const getDamageRange = (roll: CharacterRollT) => {\r\n    return getRollRange(reduceCharacterRoll(roll, character))\r\n  }\r\n\r\n  return (\r\n    <BoxContainer\r\n      style={{ whiteSpace: 'nowrap' }}\r\n      substyle={{ padding: '4px 10px', background: '#111' }}\r\n    >\r\n      {children(\r\n        keys.map((key) => ({\r\n          id: key,\r\n          key,\r\n          damageRangeText: getDamageRange(damageRolls[key] as CharacterRollT),\r\n          damageRollText: getRollText(damageRolls[key] as CharacterRollT),\r\n        })),\r\n        combineCharacterRolls(...rolls),\r\n      )}\r\n    </BoxContainer>\r\n  )\r\n}\r\n\r\nexport interface DamageRollScorePropsT {\r\n  id: DamageTypeKeyT\r\n  damageRangeText: string\r\n  damageRollText: string\r\n  compareResult?: CompareResultFn\r\n}\r\nexport const DamageRollScore = (props: DamageRollScorePropsT) => {\r\n  const {\r\n    id,\r\n    damageRangeText,\r\n    damageRollText,\r\n    compareResult = ZERO_COMPARE,\r\n  } = props\r\n  if (!damageRollText) return null\r\n  return (\r\n    <FlexContainer\r\n      key={id}\r\n      style={{\r\n        alignItems: 'flex-end',\r\n        padding: '4px 0',\r\n        height: 24,\r\n        lineHeight: '24px',\r\n      }}\r\n    >\r\n      <h3 style={{ margin: '0 8px 0 0' }}>\r\n        <span\r\n          style={{\r\n            color: compareResult(...BASE_ARGS),\r\n          }}\r\n        >\r\n          ({damageRangeText})\r\n        </span>{' '}\r\n        <span style={{ color: 'rgba(255,255,255, 0.5)' }}>\r\n          {damageRollText}\r\n        </span>\r\n      </h3>\r\n      <Icon\r\n        src={IconDamageTypeMap[id]}\r\n        size={20}\r\n        fill={DamageTypeKeyColors[id]}\r\n        style={{ marginBottom: 2 }}\r\n      />\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport { WeaponModT, combineWeaponTraits } from '../../types/Weapon'\r\nimport { Icon } from '../Icon'\r\nimport Mod from '../../icons/svg/lorc/emerald.svg'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { combineTraits } from '../../types/Character'\r\nimport { DamageRollScores, DamageRollScore } from '../DamageRollScores'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { TraitScore } from '../TraitScore'\r\nimport { getSign } from '../../util/getSign'\r\n\r\nexport interface ModPreviewPropsT {\r\n  mod: WeaponModT\r\n  onEquip?: (modId: string) => void\r\n}\r\nexport const ModPreview = (props: ModPreviewPropsT) => {\r\n  const { mod, onEquip } = props\r\n  const { character } = useCharacterContext()\r\n  const weaponTrait = combineWeaponTraits(...mod.traits)\r\n  const trait = combineTraits(weaponTrait.traits)\r\n  return (\r\n    <BoxContainer>\r\n      <FlexContainer>\r\n        <Icon src={Mod} size={24} />\r\n        <span\r\n          style={{\r\n            margin: '0 10px',\r\n            flex: 1,\r\n            fontWeight: 'bold',\r\n            whiteSpace: 'nowrap',\r\n          }}\r\n        >\r\n          {mod.name}\r\n        </span>\r\n        <BoxButton onClick={() => onEquip && onEquip(mod.id)}>equip</BoxButton>\r\n      </FlexContainer>\r\n      {weaponTrait.accuracyOffset !== 0 && (\r\n        <div style={{ fontFamily: 'monospace', marginTop: 10 }}>\r\n          {getSign(weaponTrait.accuracyOffset)}\r\n          {Math.abs(weaponTrait.accuracyOffset)} to hit\r\n        </div>\r\n      )}\r\n      <div style={{ marginBottom: 10 }}>\r\n        <TraitScore trait={trait} />\r\n      </div>\r\n      <DamageRollScores parent={weaponTrait}>\r\n        {(values, combinedRoll) =>\r\n          values.map((value) => (\r\n            <DamageRollScore\r\n              key={value.id}\r\n              id={value.id}\r\n              damageRangeText={value.damageRangeText}\r\n              damageRollText={value.damageRollText}\r\n            />\r\n          ))\r\n        }\r\n      </DamageRollScores>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport Color from 'color'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { CheckPreview } from '../CheckPreview'\r\nimport { TraitScore } from '../TraitScore'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport { DamageRollScores, DamageRollScore } from '../DamageRollScores'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { WeaponIcon } from '../WeaponIcon'\r\nimport {\r\n  combineTraits,\r\n  CharacterSkillCheckKeyT,\r\n  CharacterTraitT,\r\n} from '../../types/Character'\r\nimport { CompareResultFn, ZERO_COMPARE, BASE_ARGS } from '../../util/compare'\r\nimport { DamageTypeKeyT } from '../../types/Damage'\r\nimport { Icon } from '../Icon'\r\nimport { IconCharacterResourceMap } from '../../icons/maps'\r\nimport { FISTS } from '../../objects/fists'\r\nimport { ItemRarityColorMap } from '../../types/Item'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport {\r\n  getRollText,\r\n  getRollRange,\r\n  reduceCharacterRoll,\r\n} from '../../types/Roll2'\r\nimport { EventsTypeMap } from '../../types/Events'\r\nimport { ModPreview } from '../ModPreview'\r\nimport Mod from '../../icons/svg/lorc/emerald.svg'\r\nimport { Hover } from '../Hover'\r\nimport Tooltip from 'react-tooltip-lite'\r\n\r\nexport interface WeaponPreviewPropsT {\r\n  weapon?: WeaponT\r\n  showEquipButton?: boolean\r\n  showRequirement?: boolean\r\n  requirementCompare?: CompareResultFn\r\n  accuracyCompare?: CompareResultFn\r\n  traitCompare?: (key: CharacterSkillCheckKeyT) => CompareResultFn\r\n  damageCompare?: (key: DamageTypeKeyT) => CompareResultFn\r\n  costComare?: CompareResultFn\r\n}\r\nexport const WeaponPreview = (props: WeaponPreviewPropsT) => {\r\n  const { character, rawCharacter, onChange } = useCharacterContext()\r\n  const { unequipItem, unequipMod } = usePartyContext()\r\n  const { showEquipButton = true, showRequirement = true } = props\r\n  const weapon = props.weapon || character.weapon\r\n  const rarityColor = ItemRarityColorMap[weapon.rarity]\r\n  const borderColor = Color(rarityColor)\r\n    .desaturate(0.5)\r\n    .fade(0.5)\r\n    .rgb()\r\n    .string()\r\n  const requirementCompare = props.requirementCompare || ZERO_COMPARE\r\n  const accuracyCompare = props.accuracyCompare || ZERO_COMPARE\r\n  const traitCompare = props.traitCompare || ((key) => ZERO_COMPARE)\r\n  const damageCompare = props.damageCompare || ((key) => ZERO_COMPARE)\r\n  const costComare = props.costComare || ZERO_COMPARE\r\n  const trait = combineTraits(weapon.traits)\r\n  return (\r\n    <BoxContainer\r\n      style={{ width: 380 }}\r\n      substyle={{ borderColor: borderColor }}\r\n    >\r\n      <FlexContainer style={{ marginBottom: 10 }}>\r\n        <WeaponIcon weapon={weapon} size={24} fill={rarityColor} />\r\n        <h3 style={{ margin: '0 0 0 10px', flex: 1 }}>{weapon.name}</h3>\r\n        {weapon.id !== FISTS.id && showEquipButton ? (\r\n          <BoxButton\r\n            substyle={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n            }}\r\n            onClick={() => unequipItem(rawCharacter.id, weapon.id)}\r\n          >\r\n            <Icon\r\n              src={IconCharacterResourceMap[weapon.resource]}\r\n              size={12}\r\n              fill='rgba(255,255,255,0.8)'\r\n              style={{ marginRight: 10 }}\r\n            />\r\n            {weapon.cost}\r\n          </BoxButton>\r\n        ) : (\r\n          <FlexContainer\r\n            style={{\r\n              margin: '0 0 10px 0',\r\n              fontWeight: 'bold',\r\n              fontSize: 12,\r\n              color: costComare(...BASE_ARGS),\r\n            }}\r\n          >\r\n            <Icon\r\n              src={IconCharacterResourceMap.weaponHands}\r\n              size={12}\r\n              style={{ margin: '0 8px' }}\r\n              fill={costComare('lightcoral', 'white', 'lightgreen')}\r\n            />\r\n            {weapon.cost}\r\n          </FlexContainer>\r\n        )}\r\n      </FlexContainer>\r\n\r\n      <FlexContainer style={{ marginBottom: 10 }}>\r\n        {showRequirement && (\r\n          <FullContainer>\r\n            <CheckPreview\r\n              name='Requirement'\r\n              showCheckButton={false}\r\n              check={weapon.requirementCheck}\r\n              compareResult={requirementCompare}\r\n            />\r\n          </FullContainer>\r\n        )}\r\n        <FullContainer>\r\n          <CheckPreview\r\n            name='Accuracy'\r\n            showCheckButton={false}\r\n            check={weapon.accuracyCheck}\r\n            compareResult={accuracyCompare}\r\n          />\r\n        </FullContainer>\r\n      </FlexContainer>\r\n      <div style={{ marginBottom: 10 }}>\r\n        <TraitScore trait={trait} compareResult={traitCompare} />\r\n      </div>\r\n      <div style={{ marginBottom: 10 }}>\r\n        {getKeys(weapon.events).map((key) => (\r\n          <FlexContainer key={key} style={{ alignItems: 'center' }}>\r\n            <strong\r\n              style={{\r\n                fontFamily: 'monospace',\r\n                marginRight: 10,\r\n                color: 'rgba(255,255,255,0.5)',\r\n              }}\r\n            >\r\n              {EventsTypeMap[key]}:\r\n            </strong>\r\n            <TraitScore\r\n              trait={combineTraits(weapon.events[key] as CharacterTraitT[])}\r\n            />\r\n          </FlexContainer>\r\n        ))}\r\n      </div>\r\n      <FlexContainer style={{ justifyContent: 'center', padding: 8 }}>\r\n        {Array(weapon.slotCount)\r\n          .fill(null)\r\n          .map((_, i) => {\r\n            const mod = weapon.slots[i]\r\n            if (mod) {\r\n              return (\r\n                <Hover>\r\n                  {({ isHovering }) => (\r\n                    <Tooltip\r\n                      isOpen={isHovering}\r\n                      direction='up'\r\n                      tagName='div'\r\n                      padding='0'\r\n                      arrow={false}\r\n                      content={<ModPreview mod={mod} />}\r\n                    >\r\n                      <Icon\r\n                        src={Mod}\r\n                        size={20}\r\n                        fill={ItemRarityColorMap[mod.rarity]}\r\n                        style={{\r\n                          padding: '0 8px',\r\n                          cursor: 'pointer',\r\n                        }}\r\n                        onClick={() => {\r\n                          console.log('click')\r\n                          unequipMod(character.id, mod.id)\r\n                        }}\r\n                      />\r\n                    </Tooltip>\r\n                  )}\r\n                </Hover>\r\n              )\r\n            } else {\r\n              return (\r\n                <Icon\r\n                  src={Mod}\r\n                  size={20}\r\n                  fill='rgba(255,255,255,0.4)'\r\n                  style={{ padding: '0 8px' }}\r\n                />\r\n              )\r\n            }\r\n          })}\r\n      </FlexContainer>\r\n      <DamageRollScores parent={weapon}>\r\n        {(values, combinedRoll) => (\r\n          <>\r\n            <span\r\n              style={{\r\n                fontFamily: 'monospace',\r\n                color: 'rgba(255,255,255,0.25)',\r\n              }}\r\n            >\r\n              ({getRollRange(reduceCharacterRoll(combinedRoll, character))}){' '}\r\n              {getRollText(combinedRoll)}\r\n            </span>\r\n            {values.map((value) => (\r\n              <DamageRollScore\r\n                key={value.id}\r\n                id={value.id}\r\n                damageRangeText={value.damageRangeText}\r\n                damageRollText={value.damageRollText}\r\n                compareResult={damageCompare(value.id)}\r\n              />\r\n            ))}\r\n          </>\r\n        )}\r\n      </DamageRollScores>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { useState, useMemo } from 'react'\r\nimport Color from 'color'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { EquippableT, ItemRarityColorMap } from '../../types/Item'\r\nimport { ArmorIcon } from '../ArmorIcon'\r\nimport { ArmorT } from '../../types/Armor'\r\nimport { ItemPreview } from '../ItemPreview'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { WeaponIcon } from '../WeaponIcon'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport { WeaponPreview } from '../WeaponPreview'\r\nimport { BASE_EQUIPPABLE } from '../../objects/util'\r\nimport { Hover } from '../Hover'\r\n\r\nexport interface ItemPreviewSmallPropsT {\r\n  item: EquippableT\r\n  size?: number\r\n  onClick?: (item: EquippableT) => void\r\n}\r\nexport const ItemPreviewSmall = (props: ItemPreviewSmallPropsT) => {\r\n  const { item = {} as EquippableT, size = 38, onClick } = props\r\n  const isEmpty = item.type === undefined\r\n  const rarityColor = ItemRarityColorMap[item ? item.rarity : 'common']\r\n  const borderColor = Color(rarityColor)\r\n    .desaturate(0.5)\r\n    .fade(0.5)\r\n    .rgb()\r\n    .string()\r\n\r\n  const isArmor = item.type === 'armor'\r\n  const isWeapon = item.type === 'weapon'\r\n  const icon = useMemo(() => {\r\n    if (!item) return null\r\n    if (isWeapon) {\r\n      return (\r\n        <WeaponIcon\r\n          weapon={item as WeaponT}\r\n          size={size - 16}\r\n          fill={rarityColor}\r\n        />\r\n      )\r\n    }\r\n    if (isArmor) {\r\n      return (\r\n        <ArmorIcon item={item as ArmorT} size={size - 16} fill={rarityColor} />\r\n      )\r\n    }\r\n  }, [item, isArmor, isWeapon, rarityColor])\r\n  if (!item) return null\r\n  return (\r\n    <Hover>\r\n      {({ isHovering }) => (\r\n        <Tooltip\r\n          isOpen={isHovering}\r\n          direction='bottom'\r\n          tagName='div'\r\n          padding='0'\r\n          arrow={false}\r\n          content={\r\n            item.type === 'armor' ? (\r\n              <ItemPreview\r\n                item={item}\r\n                showEquipButton={false}\r\n                showCollapseButton={false}\r\n              />\r\n            ) : (\r\n              <WeaponPreview weapon={item as WeaponT} showEquipButton={false} />\r\n            )\r\n          }\r\n        >\r\n          <BoxContainer\r\n            style={{\r\n              height: size,\r\n              width: size,\r\n              cursor: item && onClick ? 'pointer' : 'default',\r\n            }}\r\n            substyle={{\r\n              background: isEmpty ? '#111' : '#222',\r\n              boxShadow: 'inset 0 0 3px black',\r\n              border: `1px solid ${!isEmpty ? borderColor : '#555'}`,\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              padding: 0,\r\n            }}\r\n            onClick={() => onClick && onClick(item)}\r\n          >\r\n            {icon}\r\n          </BoxContainer>\r\n        </Tooltip>\r\n      )}\r\n    </Hover>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { ItemPreview } from '../ItemPreview'\r\nimport { ArmorTypeSortKey } from '../../types/Armor'\r\nimport { ItemPreviewSmall } from '../ItemPreviewSmall'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { v4 } from 'uuid'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\n\r\nexport interface ArmorScoreListPropsT {}\r\nexport const ArmorScoreList = (props: ArmorScoreListPropsT) => {\r\n  const { character, rawCharacter } = useCharacterContext()\r\n  const { unequipItem } = usePartyContext()\r\n  const { armor } = character\r\n  const rings = armor.filter((i) => i.armorType === 'ring')\r\n  const arr = Array(10 - rings.length).fill(undefined)\r\n  return (\r\n    <div>\r\n      <FlexContainer>\r\n        {[...arr, ...rings].map((item) => (\r\n          <ItemPreviewSmall\r\n            key={item ? item.id : v4()}\r\n            item={item}\r\n            onClick={(item) => unequipItem(rawCharacter.id, item.id)}\r\n          />\r\n        ))}\r\n      </FlexContainer>\r\n      {armor\r\n        .filter((i) => i.armorType !== 'ring')\r\n        .sort(\r\n          (a, b) =>\r\n            ArmorTypeSortKey[a.armorType] - ArmorTypeSortKey[b.armorType],\r\n        )\r\n        .map((item) => (\r\n          <ItemPreview\r\n            key={item.id}\r\n            item={item}\r\n            showRequirementCheck={false}\r\n            showCollapseButton={false}\r\n          />\r\n        ))}\r\n    </div>\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport Color from 'color'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\n\r\nexport interface GaugePropsT {\r\n  name?: string\r\n  color: string\r\n  height?: number\r\n  max: number\r\n  value: number\r\n  children?: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const Gauge = (props: GaugePropsT) => {\r\n  const { name = '', value, max, color, height = 30, children } = props\r\n  const [hovering, setHovering] = useState(false)\r\n  const p = (value / max) * 100\r\n  const percentage = p > 100 ? 100 : p\r\n  return (\r\n    <Tooltip\r\n      isOpen={hovering}\r\n      direction='right'\r\n      tagName='div'\r\n      padding='0'\r\n      content={<BoxContainer>{`${name} (${value} / ${max})`}</BoxContainer>}\r\n    >\r\n      <BoxContainer\r\n        substyle={{\r\n          padding: 0,\r\n          background: '#555',\r\n          height: height - 2,\r\n          position: 'relative',\r\n        }}\r\n        onMouseEnter={() => setHovering(true)}\r\n        onMouseLeave={() => setHovering(false)}\r\n      >\r\n        <FlexContainer\r\n          style={{\r\n            position: 'absolute',\r\n            left: 0,\r\n            boxSizing: 'border-box',\r\n            height: height - 2,\r\n            maxWidth: `${percentage}%`,\r\n            minWidth: `${percentage}%`,\r\n            border:\r\n              percentage > 0\r\n                ? `1px solid ${Color(color).lighten(0.5)}`\r\n                : 'none',\r\n            boxShadow: 'inset 1px 1px 0px rgba(0,0,0,0.5)',\r\n            textShadow: '1px 1px 1px black',\r\n            backgroundColor: color,\r\n            color: 'white',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            transition: 'all 0.5s',\r\n          }}\r\n        ></FlexContainer>\r\n        <FullContainer\r\n          style={{\r\n            position: 'absolute',\r\n            height,\r\n            lineHeight: `${height - 2}px`,\r\n            right: 4,\r\n            top: 0,\r\n            fontFamily: 'monospace',\r\n            fontWeight: 'bold',\r\n            overflow: 'hidden',\r\n            textShadow: '0px 0px 3px black',\r\n          }}\r\n        >\r\n          {children}\r\n        </FullContainer>\r\n      </BoxContainer>\r\n    </Tooltip>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { AbilityScore } from '../AbilityScore'\r\nimport { StatScore } from '../StatScore'\r\nimport { DamageResistanceScore } from '../DamageResistanceScore'\r\nimport { WeaponPreview } from '../WeaponPreview'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\n\r\nexport const CharacterInspect = () => {\r\n  const { character } = useCharacterContext()\r\n  return (\r\n    <FlexContainer>\r\n      <FlexContainer $direction='column'>\r\n        <AbilityScore id='strength' edit={false} />\r\n        <AbilityScore id='dexterity' edit={false} />\r\n        <AbilityScore id='intelligence' edit={false} />\r\n        <AbilityScore id='vigor' edit={false} />\r\n      </FlexContainer>\r\n      <FlexContainer $direction='column'>\r\n        <StatScore id='health' />\r\n        <StatScore id='focus' />\r\n        <StatScore id='will' />\r\n        <StatScore id='perception' />\r\n        <StatScore id='agility' />\r\n        <StatScore id='accuracy' />\r\n        <StatScore id='evade' />\r\n      </FlexContainer>\r\n      <FlexContainer $direction='column'>\r\n        <DamageResistanceScore id='slashing' />\r\n        <DamageResistanceScore id='piercing' />\r\n        <DamageResistanceScore id='fire' />\r\n        <DamageResistanceScore id='blood' />\r\n        <DamageResistanceScore id='light' />\r\n        <DamageResistanceScore id='dark' />\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { SkillT } from '../../types/Skill'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { makeSkill } from '../../objects/makeSkill'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { CheckPreview } from '../CheckPreview'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport { EventsTypeMap } from '../../types/Events'\r\nimport { TraitScore } from '../TraitScore'\r\nimport { combineTraits, CharacterTraitT } from '../../types/Character'\r\nimport { DamageRollScores, DamageRollScore } from '../DamageRollScores'\r\nimport {\r\n  getRollRange,\r\n  reduceCharacterRoll,\r\n  getRollText,\r\n} from '../../types/Roll2'\r\n\r\nexport interface SkillPreviewPropsT {\r\n  skillId: string\r\n  skill?: SkillT\r\n}\r\nexport const SkillPreview = (props: SkillPreviewPropsT) => {\r\n  const { skillId } = props\r\n  const { character } = useCharacterContext()\r\n  const skill =\r\n    props.skill || character.skills.find((s) => s.id === skillId) || makeSkill()\r\n  return (\r\n    <BoxContainer\r\n      style={{\r\n        width: 380,\r\n        background: `url(${skill.imgSrc}) no-repeat center center`,\r\n        backgroundSize: 'cover',\r\n      }}\r\n      substyle={{\r\n        background: 'rgba(0,0,0,0.8)',\r\n        borderColor: 'rgba(255,255,255,0.5)',\r\n      }}\r\n    >\r\n      <FlexContainer style={{ marginBottom: 10 }}>\r\n        <h3 style={{ margin: '0 10px 0 0', flex: 1 }}>{skill.name}</h3>\r\n      </FlexContainer>\r\n\r\n      <FlexContainer style={{ marginBottom: 10 }}>\r\n        <strong style={{ marginRight: 10 }}>Cost</strong>\r\n        <span>{skill.focusCost}</span>\r\n      </FlexContainer>\r\n      <FlexContainer style={{ marginBottom: 10 }}>\r\n        <FullContainer>\r\n          <CheckPreview\r\n            name='Requirement'\r\n            showCheckButton={false}\r\n            check={skill.requirementCheck}\r\n          />\r\n        </FullContainer>\r\n        {skill.check && (\r\n          <FullContainer>\r\n            <CheckPreview\r\n              name='Skill Check'\r\n              showCheckButton={false}\r\n              check={skill.check}\r\n            />\r\n          </FullContainer>\r\n        )}\r\n        {skill.combineWeaponDamage && (\r\n          <FullContainer>\r\n            <CheckPreview\r\n              name='Accuracy'\r\n              showCheckButton={false}\r\n              check={character.weapon.accuracyCheck}\r\n            />\r\n          </FullContainer>\r\n        )}\r\n      </FlexContainer>\r\n      {skill.targetTraits.length > 0 && (\r\n        <FlexContainer style={{ marginBottom: 10 }}>\r\n          <strong\r\n            style={{\r\n              fontFamily: 'monospace',\r\n              marginRight: 10,\r\n              color: 'rgba(255,255,255,0.5)',\r\n            }}\r\n          >\r\n            target:\r\n          </strong>\r\n          <TraitScore trait={combineTraits(skill.targetTraits)} />\r\n        </FlexContainer>\r\n      )}\r\n      {skill.sourceTraits.length > 0 && (\r\n        <FlexContainer style={{ marginBottom: 10 }}>\r\n          <strong\r\n            style={{\r\n              fontFamily: 'monospace',\r\n              marginRight: 10,\r\n              color: 'rgba(255,255,255,0.5)',\r\n            }}\r\n          >\r\n            self:\r\n          </strong>\r\n          <TraitScore trait={combineTraits(skill.sourceTraits)} />\r\n        </FlexContainer>\r\n      )}\r\n      <div style={{ marginBottom: 10 }}>\r\n        {getKeys(skill.events).map((key) => (\r\n          <FlexContainer key={key} style={{ alignItems: 'center' }}>\r\n            <strong\r\n              style={{\r\n                fontFamily: 'monospace',\r\n                marginRight: 10,\r\n                color: 'rgba(255,255,255,0.5)',\r\n              }}\r\n            >\r\n              {EventsTypeMap[key]}:\r\n            </strong>\r\n            <TraitScore\r\n              trait={combineTraits(skill.events[key] as CharacterTraitT[])}\r\n            />\r\n          </FlexContainer>\r\n        ))}\r\n      </div>\r\n      {skill.combineWeaponDamage && (\r\n        <div style={{ marginBottom: 10 }}>\r\n          {getKeys(character.weapon.events).map((key) => (\r\n            <FlexContainer key={key} style={{ alignItems: 'center' }}>\r\n              <strong\r\n                style={{\r\n                  fontFamily: 'monospace',\r\n                  marginRight: 10,\r\n                  color: 'rgba(255,255,255,0.5)',\r\n                }}\r\n              >\r\n                {EventsTypeMap[key]}:\r\n              </strong>\r\n              <TraitScore\r\n                trait={combineTraits(\r\n                  character.weapon.events[key] as CharacterTraitT[],\r\n                )}\r\n              />\r\n            </FlexContainer>\r\n          ))}\r\n        </div>\r\n      )}\r\n      {(skill.combineWeaponDamage ||\r\n        Object.keys(skill.damageRolls).length > 0) && (\r\n        <DamageRollScores\r\n          parent={skill.combineWeaponDamage ? character.weapon : skill}\r\n        >\r\n          {(values, combinedRoll) => (\r\n            <>\r\n              <span\r\n                style={{\r\n                  fontFamily: 'monospace',\r\n                  color: 'rgba(255,255,255,0.25)',\r\n                }}\r\n              >\r\n                ({getRollRange(reduceCharacterRoll(combinedRoll, character))}){' '}\r\n                {getRollText(combinedRoll)}\r\n              </span>\r\n              {values.map((value) => (\r\n                <DamageRollScore\r\n                  key={value.id}\r\n                  id={value.id}\r\n                  damageRangeText={value.damageRangeText}\r\n                  damageRollText={value.damageRollText}\r\n                />\r\n              ))}\r\n            </>\r\n          )}\r\n        </DamageRollScores>\r\n      )}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { CSSProperties, useState } from 'react'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { SkillT } from '../../types/Skill'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { BASIC_ATTACK, INSPECT } from '../../objects/makeSkill'\r\nimport { SkillPreview } from '../SkillPreview'\r\nimport { Hover } from '../Hover'\r\nimport { FlexContainer } from '../../elements/flex'\r\n\r\nconst size = 34\r\nexport interface CombatCharacterSkillsPropsT {\r\n  activeSkillId?: string\r\n  skills: SkillT[]\r\n  onClick: (skillId: string) => void\r\n}\r\nexport const CombatCharacterSkills = (props: CombatCharacterSkillsPropsT) => {\r\n  const { activeSkillId = BASIC_ATTACK.id, skills, onClick } = props\r\n  const { character } = useCharacterContext()\r\n  const active = (skillId: string) => activeSkillId === skillId\r\n\r\n  return (\r\n    <FlexContainer style={{ marginBottom: 2 }}>\r\n      {skills.map((skill) => (\r\n        <CombatCharacterSkill\r\n          key={skill.id}\r\n          skill={skill}\r\n          disabled={\r\n            character.dead ||\r\n            character.stats.focus - character.focusOffset < skill.focusCost\r\n          }\r\n          onClick={() => onClick(skill.id)}\r\n          style={{\r\n            padding: 0,\r\n            height: size + 2,\r\n            maxWidth: size + 2,\r\n            margin: 0,\r\n            borderColor: 'transparent',\r\n            opacity:\r\n              character.dead ||\r\n              character.stats.focus - character.focusOffset < skill.focusCost\r\n                ? 0.2\r\n                : active(skill.id)\r\n                ? 1\r\n                : 0.7,\r\n            ...(active(skill.id) ? { borderColor: 'turquoise' } : {}),\r\n          }}\r\n        />\r\n      ))}\r\n    </FlexContainer>\r\n  )\r\n}\r\n\r\nexport interface CombatCharacterSkillPropsT {\r\n  skill: SkillT\r\n  disabled: boolean\r\n  style: CSSProperties\r\n  onClick: (skillId: string) => void\r\n}\r\nexport const CombatCharacterSkill = (props: CombatCharacterSkillPropsT) => {\r\n  const { skill, disabled, style, onClick } = props\r\n  const isDefault = skill.id === BASIC_ATTACK.id || skill.id === INSPECT.id\r\n  return (\r\n    <Hover>\r\n      {({ isHovering }) => (\r\n        <Tooltip\r\n          isOpen={isHovering}\r\n          direction='down'\r\n          tagName='div'\r\n          padding='0'\r\n          arrow={false}\r\n          content={\r\n            isDefault ? (\r\n              <BoxContainer>{skill.name}</BoxContainer>\r\n            ) : (\r\n              <SkillPreview skillId={skill.id} skill={skill} />\r\n            )\r\n          }\r\n        >\r\n          <BoxContainer\r\n            onClick={() => !disabled && onClick(skill.id)}\r\n            substyle={{\r\n              borderColor: isHovering ? '#999' : '#555',\r\n              padding: '4px',\r\n              cursor: disabled ? 'default' : 'pointer',\r\n              background: disabled ? '#444' : '#111',\r\n              ...style,\r\n            }}\r\n            style={{ border: 'none' }}\r\n          >\r\n            {skill.imgSrc && (\r\n              <img\r\n                src={skill.imgSrc}\r\n                height={size}\r\n                width={size}\r\n                style={{\r\n                  height: size,\r\n                  maxWidth: size,\r\n                  boxSizing: 'border-box',\r\n                  border: '1px solid black',\r\n                }}\r\n              />\r\n            )}\r\n          </BoxContainer>\r\n        </Tooltip>\r\n      )}\r\n    </Hover>\r\n  )\r\n}\r\n","import { NpcT } from '../types/Npc'\r\nimport { v4 } from 'uuid'\r\n\r\nimport {\r\n  uniqueNamesGenerator,\r\n  Config,\r\n  names,\r\n  adjectives,\r\n  animals,\r\n  colors,\r\n} from 'unique-names-generator'\r\nimport { CharacterResourcesT, CharacterAbilitiesT } from '../types/Character'\r\nimport { DamageTypeRollsT } from '../types/Damage'\r\nimport { buildWeapon } from './builders/weapons/createWeapon'\r\nimport { getRandom } from '../util/getRandom'\r\nimport { buildArmor } from './builders/armor/createArmor'\r\nimport { makeSkill, BASIC_ATTACK } from './makeSkill'\r\nimport { makeCharacterRoll } from '../types/Roll2'\r\n\r\nconst randomNameConfig: Config = {\r\n  dictionaries: [adjectives, animals],\r\n  length: 2,\r\n  separator: ' ',\r\n}\r\n\r\nexport const makeNpc = (\r\n  abilities: Partial<CharacterAbilitiesT> = {},\r\n  damageResistances: Partial<DamageTypeRollsT> = {},\r\n  resources: Partial<CharacterResourcesT> = {},\r\n): NpcT => {\r\n  return {\r\n    id: v4(),\r\n    npc: true,\r\n    name: uniqueNamesGenerator(randomNameConfig),\r\n    power: 600,\r\n    resources: {\r\n      characterPoints: 250,\r\n      weaponHands: 2,\r\n      heads: 1,\r\n      bodies: 1,\r\n      hands: 2,\r\n      fingers: 10,\r\n      feet: 2,\r\n      ...resources,\r\n    },\r\n    abilities: {\r\n      strength: 10,\r\n      dexterity: 10,\r\n      intelligence: 10,\r\n      vigor: 10,\r\n      ...abilities,\r\n    },\r\n    damageResistances: {\r\n      slashing: makeCharacterRoll([]),\r\n      piercing: makeCharacterRoll([]),\r\n      fire: makeCharacterRoll([]),\r\n      blood: makeCharacterRoll([]),\r\n      light: makeCharacterRoll([]),\r\n      dark: makeCharacterRoll([]),\r\n      ...damageResistances,\r\n    },\r\n\r\n    weapon: buildWeapon(\r\n      getRandom([\r\n        'axe',\r\n        'greataxe',\r\n        'wand',\r\n        'staff',\r\n        'daggers',\r\n        'katana',\r\n        'sword',\r\n        'greatsword',\r\n        'flail',\r\n        'elementalGreatsword',\r\n        'elementalSword',\r\n      ]),\r\n    ),\r\n\r\n    traits: [],\r\n    skills: [BASIC_ATTACK],\r\n    equippedItems: [],\r\n    armor: [\r\n      buildArmor('cowl'),\r\n      buildArmor('chestplate'),\r\n      buildArmor('gloves'),\r\n      buildArmor('boots'),\r\n    ],\r\n\r\n    healthOffset: 0,\r\n    focusOffset: 0,\r\n    dead: false,\r\n    inspected: false,\r\n  }\r\n}\r\n","import { PartyT } from '../types/Party'\r\nimport { v4 } from 'uuid'\r\nimport { makeNpc } from './makeNpc'\r\n\r\nexport const makeParty = (id: string = v4()): PartyT => {\r\n  return {\r\n    id,\r\n    items: [],\r\n    skills: [],\r\n    mods: [],\r\n    characters: [makeNpc(), makeNpc(), makeNpc(), makeNpc(), makeNpc()].map(\r\n      (c) => ({\r\n        ...c,\r\n        partyId: id,\r\n      }),\r\n    ),\r\n  }\r\n}\r\n","import React from 'react'\r\nimport { AttackResultT, isUser, isEnemy } from './util'\r\nimport { ProcessedCharacterT, CharacterT } from '../../types/Character'\r\nimport { BASIC_ATTACK } from '../../objects/makeSkill'\r\nimport { getKeys } from '../../util/getKeys'\r\n\r\nexport const Span = (color: string, text: string, bold: boolean = true) => (\r\n  <span style={{ color, fontWeight: bold ? 'bold' : 'normal' }}>{text}</span>\r\n)\r\nexport const NameSpan = (character: CharacterT) =>\r\n  isUser(character)\r\n    ? Span('lightgreen', character.name)\r\n    : Span('lightsalmon', character.name)\r\n\r\nexport const logResult = (\r\n  attackResult: AttackResultT,\r\n  source: ProcessedCharacterT,\r\n  target: ProcessedCharacterT,\r\n  addLine: (line: React.ReactNode) => void,\r\n) => {\r\n  if (attackResult.skill.id !== BASIC_ATTACK.id) {\r\n    addLine(\r\n      <span>\r\n        {NameSpan(source)} casts {Span('#cda5f3', attackResult.skill.name)}\r\n        {attackResult.skill.target && <span> on {NameSpan(target)}.</span>}\r\n      </span>,\r\n    )\r\n  }\r\n  if (attackResult.hitSuccess) {\r\n    if (attackResult.skill.id === BASIC_ATTACK.id) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(source)} attacks {NameSpan(target)} for{' '}\r\n          {Span('white', `${attackResult.totalDamage} damage`)}.\r\n        </span>,\r\n      )\r\n    } else {\r\n      if (attackResult.rawDamage > 0) {\r\n        addLine(\r\n          <span>\r\n            {Span('#cda5f3', attackResult.skill.name)} deals{' '}\r\n            {Span('white', `${attackResult.totalDamage} damage`)}.\r\n          </span>,\r\n        )\r\n      }\r\n      if (\r\n        attackResult.targetTraits.length > 0 ||\r\n        attackResult.sourceTraits.length > 0\r\n      ) {\r\n        LogAddedTraits(attackResult, source, target, addLine)\r\n      }\r\n    }\r\n    if (attackResult.criticalSuccess) {\r\n      addLine(<span style={{ color: 'khaki' }}>Critical hit!</span>)\r\n    }\r\n  } else {\r\n    if (attackResult.skill.id === BASIC_ATTACK.id) {\r\n      addLine(<span>{NameSpan(source)}'s attack missed.</span>)\r\n    } else {\r\n      addLine(\r\n        <span>\r\n          {Span('#cda5f3', attackResult.skill.name)}{' '}\r\n          {attackResult.skill.target ? 'missed' : 'failed'}.\r\n        </span>,\r\n      )\r\n    }\r\n  }\r\n  if (attackResult.dodgeSuccess) {\r\n    addLine(\r\n      <span>\r\n        {NameSpan(target)} dodged {NameSpan(source)}'s attack\r\n      </span>,\r\n    )\r\n  }\r\n  if (target.stats.health <= target.healthOffset + attackResult.totalDamage) {\r\n    addLine(Span('lightcoral', `${target.name} died`))\r\n  }\r\n}\r\n\r\nexport const cz = (v: number) => v !== 0\r\nexport const gv = (v: number) => (v > 0 ? 'gained' : 'lost')\r\nexport const LogAddedTraits = (\r\n  attackResult: AttackResultT,\r\n  source: ProcessedCharacterT,\r\n  target: ProcessedCharacterT,\r\n  addLine: (line: React.ReactNode) => void,\r\n) => {\r\n  attackResult.targetTraits.forEach((trait) => {\r\n    const gfo = target.focusOffset - trait.focusOffset\r\n    const focusOffset = gfo < 0 ? trait.focusOffset + gfo : trait.focusOffset\r\n    if (cz(focusOffset)) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(target)} {gv(focusOffset)} {focusOffset} FP.\r\n        </span>,\r\n      )\r\n    }\r\n    getKeys(trait.abilitiesModifiers).forEach((key) => {\r\n      if (cz(trait.abilitiesModifiers[key])) {\r\n        addLine(\r\n          <span>\r\n            {NameSpan(target)} {gv(trait.abilitiesModifiers[key])}{' '}\r\n            {trait.abilitiesModifiers[key]} {key}.{' '}\r\n            {trait.duration > 1 && `(${trait.duration - 1}`}\r\n          </span>,\r\n        )\r\n      }\r\n    })\r\n    getKeys(trait.statsModifiers).forEach((key) => {\r\n      if (cz(trait.statsModifiers[key])) {\r\n        addLine(\r\n          <span>\r\n            {NameSpan(target)} {gv(trait.statsModifiers[key])}{' '}\r\n            {trait.statsModifiers[key]} {key}.{' '}\r\n            {trait.duration > 1 && `(${trait.duration - 1})`}\r\n          </span>,\r\n        )\r\n      }\r\n    })\r\n  })\r\n  attackResult.sourceTraits.forEach((trait) => {\r\n    const gfo = source.focusOffset - trait.focusOffset\r\n    const focusOffset = gfo < 0 ? trait.focusOffset + gfo : trait.focusOffset\r\n    if (cz(focusOffset)) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(source)} {gv(focusOffset)} {focusOffset} FP.\r\n        </span>,\r\n      )\r\n    }\r\n    const gho = source.healthOffset - trait.healthOffset\r\n    const healthOffset = gho < 0 ? trait.healthOffset + gho : trait.healthOffset\r\n    if (cz(healthOffset)) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(source)} {gv(healthOffset)} {healthOffset} HP.\r\n        </span>,\r\n      )\r\n    }\r\n    getKeys(trait.abilitiesModifiers).forEach((key) => {\r\n      if (cz(trait.abilitiesModifiers[key])) {\r\n        addLine(\r\n          <span>\r\n            {NameSpan(source)} {gv(trait.abilitiesModifiers[key])}{' '}\r\n            {trait.abilitiesModifiers[key]} {key}.{' '}\r\n            {trait.duration > 1 && `(${trait.duration - 1})`}\r\n          </span>,\r\n        )\r\n      }\r\n    })\r\n    getKeys(trait.statsModifiers).forEach((key) => {\r\n      if (cz(trait.statsModifiers[key])) {\r\n        addLine(\r\n          <span>\r\n            {NameSpan(source)} {gv(trait.statsModifiers[key])}{' '}\r\n            {trait.statsModifiers[key]} {key}.{' '}\r\n            {trait.duration > 1 && `(${trait.duration - 1})`}\r\n          </span>,\r\n        )\r\n      }\r\n    })\r\n  })\r\n}\r\n","import React from 'react'\r\nimport { ProcessedPartyT, PartyT, processParty } from '../../types/Party'\r\nimport { getRandom } from '../../util/getRandom'\r\nimport {\r\n  ProcessedCharacterT,\r\n  CharacterT,\r\n  processCharacter,\r\n  combineTraits,\r\n  commitTrait,\r\n  CharacterTraitT,\r\n} from '../../types/Character'\r\nimport { RollCheckerT } from '../RollContext'\r\nimport {\r\n  rollDamage,\r\n  getDamageTypeKeys,\r\n  DamageTypeRollsT,\r\n} from '../../types/Damage'\r\nimport { noneg } from '../../util/noneg'\r\nimport { v4 } from 'uuid'\r\nimport { PC_PARTY_ID } from '../../state/parties'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport { BASIC_ATTACK } from '../../objects/makeSkill'\r\nimport { NameSpan, logResult, gv } from './log'\r\nimport {\r\n  combineCharacterRolls,\r\n  ZERO_ROLL,\r\n  CharacterRollT,\r\n  CharacterCheckT,\r\n  makeCharacterCheck,\r\n  Check2ResultT,\r\n  Roll2ResultT,\r\n} from '../../types/Roll2'\r\nimport { SkillT } from '../../types/Skill'\r\nimport { EventTypeT, checkEvent } from '../../types/Events'\r\n\r\nexport interface AttackResultT {\r\n  id: string\r\n  sourceId: string\r\n  targetId: string\r\n  skill: SkillT\r\n  index: number\r\n  hitSuccess: boolean\r\n  criticalSuccess: boolean\r\n  dodgeSuccess: boolean\r\n  rawDamage: number\r\n  blockedDamage: number\r\n  totalDamage: number\r\n  targetTraits: CharacterTraitT[]\r\n  sourceTraits: CharacterTraitT[]\r\n}\r\nexport const ZERO_RESULT: AttackResultT = {\r\n  id: 'zero',\r\n  sourceId: '',\r\n  targetId: '',\r\n  skill: BASIC_ATTACK,\r\n  index: 0,\r\n  hitSuccess: false,\r\n  criticalSuccess: false,\r\n  dodgeSuccess: false,\r\n  rawDamage: 0,\r\n  blockedDamage: 0,\r\n  totalDamage: 0,\r\n  targetTraits: [],\r\n  sourceTraits: [],\r\n}\r\n\r\nexport type CombatRoundT = Record<string, AttackResultT>\r\n\r\nexport const getCombatRecordBuilder = (\r\n  characterSkills: { [characterId: string]: string | undefined },\r\n  characterTargets: { [characterId: string]: string | undefined },\r\n  checkCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterCheckT, Check2ResultT>,\r\n  rollCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterRollT, Roll2ResultT>,\r\n) => (\r\n  userParty: ProcessedPartyT,\r\n  enemyParty: ProcessedPartyT,\r\n  rawParties: PartyT[],\r\n): CombatRoundT => {\r\n  const characters = [...userParty.characters, ...enemyParty.characters]\r\n  let result: CombatRoundT = {}\r\n  characters\r\n    .filter((c) => !c.dead)\r\n    .sort((a, b) => b.stats.agility - a.stats.agility)\r\n    .forEach((source, index) => {\r\n      const partyA = rawParties.find((p) => p.id === source.partyId)\r\n      // this line is volitile\r\n      const partyB = rawParties.find((p) => p.id !== source.partyId)\r\n      if (!partyA || !partyB) return\r\n      const bCharacters = processParty(partyB).characters.filter((c) => !c.dead)\r\n      const target =\r\n        bCharacters.find((c) => c.id === characterTargets[source.id]) ||\r\n        getRandom(bCharacters)\r\n      if (target) {\r\n        result = {\r\n          ...result,\r\n          [source.name]: {\r\n            ...execSkill(\r\n              characterSkills,\r\n              checkCharacter,\r\n              rollCharacter,\r\n            )(target, source),\r\n            index,\r\n          },\r\n        }\r\n      }\r\n    })\r\n  return result\r\n}\r\n\r\nconst cr = (roll?: CharacterRollT): CharacterRollT =>\r\n  roll || { ...ZERO_ROLL, keys: [] }\r\nexport const getSkillDamageRolls = (\r\n  skill: SkillT,\r\n  weapon: WeaponT,\r\n): DamageTypeRollsT => {\r\n  if (skill.combineWeaponDamage) {\r\n    return {\r\n      slashing: combineCharacterRolls(\r\n        cr(skill.damageRolls.slashing),\r\n        cr(weapon.damageRolls.slashing),\r\n      ),\r\n      piercing: combineCharacterRolls(\r\n        cr(skill.damageRolls.piercing),\r\n        cr(weapon.damageRolls.piercing),\r\n      ),\r\n      fire: combineCharacterRolls(\r\n        cr(skill.damageRolls.fire),\r\n        cr(weapon.damageRolls.fire),\r\n      ),\r\n      blood: combineCharacterRolls(\r\n        cr(skill.damageRolls.blood),\r\n        cr(weapon.damageRolls.blood),\r\n      ),\r\n      light: combineCharacterRolls(\r\n        cr(skill.damageRolls.light),\r\n        cr(weapon.damageRolls.light),\r\n      ),\r\n      dark: combineCharacterRolls(\r\n        cr(skill.damageRolls.dark),\r\n        cr(weapon.damageRolls.dark),\r\n      ),\r\n    }\r\n  } else {\r\n    return skill.damageRolls\r\n  }\r\n}\r\n\r\nexport const getSkillCheck = (\r\n  skill: SkillT,\r\n  weapon: WeaponT,\r\n): CharacterCheckT => {\r\n  if (skill.combineWeaponDamage) {\r\n    return weapon.accuracyCheck\r\n  } else {\r\n    return skill.check || makeCharacterCheck([], undefined, 0, 18)\r\n  }\r\n}\r\n\r\nexport const execSkill = (\r\n  characterSkills: { [characterId: string]: string | undefined },\r\n  checkCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterCheckT, Check2ResultT>,\r\n  rollCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterRollT, Roll2ResultT>,\r\n) => (\r\n  target: ProcessedCharacterT,\r\n  source: ProcessedCharacterT,\r\n): AttackResultT => {\r\n  let attackResult = {\r\n    ...ZERO_RESULT,\r\n    id: v4(),\r\n    targetId: target.id,\r\n    sourceId: source.id,\r\n  }\r\n  const skill =\r\n    source.skills.find((skill) => skill.id === characterSkills[source.id]) ||\r\n    BASIC_ATTACK\r\n\r\n  attackResult.skill = skill\r\n  const { weapon } = source\r\n  const damageRolls = getSkillDamageRolls(skill, weapon)\r\n  const skillCheck = getSkillCheck(skill, weapon)\r\n  const skillCheckResult = checkCharacter(source)(skillCheck)\r\n  if (skillCheckResult.result) {\r\n    const criticalSuccess = skillCheckResult.criticalSuccess\r\n    attackResult.hitSuccess = true\r\n    attackResult.criticalSuccess = criticalSuccess\r\n    const rr = rollCharacter(source)\r\n    const damageRollsResult = rollDamage(rr)(\r\n      damageRolls,\r\n      criticalSuccess,\r\n      `${source.name} damage`,\r\n    )\r\n    attackResult.rawDamage = damageRollsResult.total\r\n    const dodgeRoll = checkCharacter(target)(\r\n      makeCharacterCheck(['evade'], undefined),\r\n    )\r\n    attackResult.dodgeSuccess = dodgeRoll.result || false\r\n    if (!dodgeRoll.result) {\r\n      const { damageResistances } = target\r\n      const damageKeys = getDamageTypeKeys(\r\n        damageRollsResult.rollResults,\r\n      ).filter((k) => damageRollsResult.rollResults[k])\r\n      damageKeys.forEach((key) => {\r\n        const damageResult = damageRollsResult.rollResults[key] as Roll2ResultT\r\n        const resistanceCheck = damageResistances[key] as CharacterRollT\r\n        const resistanceRoll = rollCharacter(source)(resistanceCheck, true)\r\n        const blockedDamage = criticalSuccess ? 0 : resistanceRoll.total\r\n        const damageTotal = damageResult.total - blockedDamage\r\n        attackResult.blockedDamage += damageResult.total > 0 ? blockedDamage : 0\r\n        attackResult.totalDamage += noneg(damageTotal)\r\n      })\r\n    }\r\n    if (skill.checkDodgeForTraits) {\r\n      if (!dodgeRoll.result) {\r\n        attackResult.targetTraits = skill.targetTraits\r\n        attackResult.sourceTraits = skill.sourceTraits\r\n      }\r\n    } else {\r\n      attackResult.targetTraits = skill.targetTraits\r\n      attackResult.sourceTraits = skill.sourceTraits\r\n    }\r\n  }\r\n\r\n  return attackResult\r\n}\r\n\r\nexport const resolveRound = (\r\n  rounds: CombatRoundT[],\r\n  rawUserParty: PartyT,\r\n  rawEnemyParty: PartyT,\r\n  addLine: (line: React.ReactNode) => void,\r\n  updateCharacter: (character: CharacterT, partyId?: string) => void,\r\n): ProcessedCharacterT[] => {\r\n  if (rounds.length === 0) return []\r\n  if (!rawUserParty || !rawEnemyParty) return []\r\n  let rawCharacters = [...rawUserParty.characters, ...rawEnemyParty.characters]\r\n  const getCharacters = () => rawCharacters.map((c) => processCharacter(c))\r\n  const localUpdate = (\r\n    id: string,\r\n    updater: (character: CharacterT) => CharacterT,\r\n  ) => {\r\n    rawCharacters = rawCharacters.map((c) => (c.id === id ? updater(c) : c))\r\n  }\r\n  const round = rounds[rounds.length - 1]\r\n  addLine(\r\n    <strong\r\n      style={{\r\n        color: 'lightblue',\r\n        fontSize: 20,\r\n        display: 'inline-block',\r\n        marginTop: 4,\r\n      }}\r\n    >{`ROUND ${rounds.length}`}</strong>,\r\n  )\r\n  Object.values(round)\r\n    .sort((a, b) => a.index - b.index)\r\n    .forEach((attackResult) => {\r\n      const characters = getCharacters()\r\n      const source = characters.find((c) => c.id === attackResult.sourceId)\r\n      const target = characters.find((c) => c.id === attackResult.targetId)\r\n      const rawSource = rawCharacters.find(\r\n        (c) => c.id === attackResult.sourceId,\r\n      )\r\n      const rawTarget = rawCharacters.find(\r\n        (c) => c.id === attackResult.targetId,\r\n      )\r\n      if (!rawSource || !source || !rawTarget || !target) return\r\n      if (!source.dead && !target.dead) {\r\n        logResult(attackResult, source, target, addLine)\r\n        const skill = attackResult.skill\r\n        const healthOffset = rawTarget.healthOffset + attackResult.totalDamage\r\n        const focusOffset = rawSource.focusOffset + skill.focusCost\r\n        const getTraitUpdates = (\r\n          c: CharacterT,\r\n          traits: CharacterTraitT[],\r\n        ): CharacterT => {\r\n          if (attackResult.hitSuccess) {\r\n            return {\r\n              ...commitTrait(c)(combineTraits(traits)),\r\n              traits: [\r\n                ...c.traits,\r\n                ...traits.map((t) => ({\r\n                  ...t,\r\n                  healthOffset: 0,\r\n                  focusOffset: 0,\r\n                })),\r\n              ],\r\n            }\r\n          }\r\n          return c\r\n        }\r\n        localUpdate(target.id, (c) => ({\r\n          ...c,\r\n          ...getTraitUpdates(c, skill.targetTraits),\r\n          inspected: skill.inspected || c.inspected,\r\n          healthOffset,\r\n        }))\r\n        localUpdate(source.id, (c) => ({\r\n          ...c,\r\n          ...getTraitUpdates(c, skill.sourceTraits),\r\n          focusOffset,\r\n        }))\r\n\r\n        if (skill.combineWeaponDamage && attackResult.hitSuccess) {\r\n          processEvent('onHit', source, rawSource, skill, addLine, localUpdate)\r\n        }\r\n        if (skill.combineWeaponDamage && attackResult.criticalSuccess) {\r\n          processEvent('onCrit', source, rawSource, skill, addLine, localUpdate)\r\n        }\r\n      }\r\n    })\r\n  rawCharacters.forEach((c) => {\r\n    const pc = processCharacter(c)\r\n    updateCharacter(\r\n      {\r\n        ...c,\r\n        traits: pc.dead\r\n          ? c.traits\r\n          : c.traits\r\n              .map((t) => ({ ...t, duration: t.duration - 1 }))\r\n              .filter((t) => t.duration !== 0),\r\n      },\r\n      c.partyId,\r\n    )\r\n  })\r\n  return rawCharacters.map((c) => processCharacter(c))\r\n}\r\n\r\nexport const processEvent = (\r\n  event: EventTypeT,\r\n  source: ProcessedCharacterT,\r\n  rawSource: CharacterT,\r\n  skill: SkillT,\r\n  addLine: (line: React.ReactNode) => void,\r\n  localUpdate: (\r\n    id: string,\r\n    updater: (character: CharacterT) => CharacterT,\r\n  ) => void,\r\n) => {\r\n  const addedTraits = checkEvent(rawSource, skill)(event)\r\n  const name =\r\n    skill.combineWeaponDamage && !skill.events[event]\r\n      ? source.weapon.name\r\n      : skill.name\r\n  if (addedTraits) {\r\n    const combinedTrait = combineTraits(addedTraits)\r\n    const gho = source.healthOffset - combinedTrait.healthOffset\r\n    const healthOffset =\r\n      gho <= 0 ? combinedTrait.healthOffset + gho : combinedTrait.healthOffset\r\n    if (healthOffset !== 0) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(source)} {gv(healthOffset)} {healthOffset} HP from {name}.\r\n        </span>,\r\n      )\r\n    }\r\n    const gfo = source.focusOffset - combinedTrait.focusOffset\r\n    const focusOffset =\r\n      gfo < 0 ? combinedTrait.focusOffset + gfo : combinedTrait.focusOffset\r\n    if (focusOffset !== 0) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(source)} {gv(focusOffset)} {focusOffset} FP from {name}.\r\n        </span>,\r\n      )\r\n    }\r\n    getKeys(combinedTrait.abilitiesModifiers).forEach((key) => {\r\n      const value = combinedTrait.abilitiesModifiers[key]\r\n      if (value !== 0) {\r\n        addLine(\r\n          <span>\r\n            {NameSpan(source)} {gv(value)} {value} {key} from {name}.\r\n          </span>,\r\n        )\r\n      }\r\n    })\r\n    localUpdate(rawSource.id, (c) => ({\r\n      ...commitTrait(c)(combinedTrait),\r\n      traits: [\r\n        ...c.traits,\r\n        ...addedTraits.map((t) => ({ ...t, healthOffset: 0 })),\r\n      ],\r\n    }))\r\n  }\r\n}\r\n\r\nexport const checkParty = (party: ProcessedPartyT) => {\r\n  return (\r\n    party &&\r\n    party.characters.filter((c) => c.healthOffset < c.stats.health).length === 0\r\n  )\r\n}\r\n\r\nexport const checkCharacterActiveSkills = (\r\n  characters: ProcessedCharacterT[],\r\n  characterSkills: { [characterId: string]: string | undefined },\r\n  setCharacterSkill: (characterId: string, skillId?: string) => void,\r\n) => {\r\n  characters.forEach((character) => {\r\n    const activeSkill =\r\n      character.skills.find((s) => s.id === characterSkills[character.id]) ||\r\n      BASIC_ATTACK\r\n    const focus = character.stats.focus - character.focusOffset\r\n    if (activeSkill.focusCost > focus) {\r\n      setCharacterSkill(character.id, BASIC_ATTACK.id)\r\n    }\r\n  })\r\n}\r\n\r\nexport const checkCharacterActiveTargets = (\r\n  characters: ProcessedCharacterT[],\r\n  characterTargets: { [characterId: string]: string | undefined },\r\n  setCharacterTarget: (characterId: string, targetId?: string) => void,\r\n) => {\r\n  characters.forEach((character) => {\r\n    const activeTarget = characters.find(\r\n      (c) => c.id === characterTargets[character.id],\r\n    )\r\n    if (activeTarget) {\r\n      if (activeTarget.dead) {\r\n        setCharacterTarget(character.id, undefined)\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nexport const ENEMY_PARTY_ID = v4()\r\nexport const isUser = (character: CharacterT) =>\r\n  character.partyId === PC_PARTY_ID\r\nexport const isEnemy = (character: CharacterT) =>\r\n  character.partyId === ENEMY_PARTY_ID\r\n","import React, { useContext, useState } from 'react'\r\n\r\nexport interface CombatLogContextT {\r\n  lines: React.ReactNode[]\r\n  addLine: (line: React.ReactNode) => void\r\n  clear: () => void\r\n}\r\nexport const CombatLogContext = React.createContext<CombatLogContextT>({\r\n  lines: [],\r\n  addLine: (line: React.ReactNode) => {},\r\n  clear: () => {},\r\n})\r\nexport const useCombatLogContext = () => useContext(CombatLogContext)\r\n\r\nexport interface CombatLogContextProviderPropsT {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const CombatLogContextProvider = (\r\n  props: CombatLogContextProviderPropsT,\r\n) => {\r\n  const { children } = props\r\n  const [lines, setLines] = useState<React.ReactNode[]>([])\r\n  const clear = () => setLines([])\r\n\r\n  return (\r\n    <CombatLogContext.Provider\r\n      value={{\r\n        lines,\r\n        addLine: (line) => setLines((log) => [...log, line]),\r\n        clear,\r\n      }}\r\n    >\r\n      {children}\r\n    </CombatLogContext.Provider>\r\n  )\r\n}\r\n","import { CSSProperties } from 'react'\r\n\r\nexport interface ModalContextStateT {\r\n  isOpen: boolean\r\n  contents: React.FC | null\r\n  callback: ((payload?: any) => void) | null\r\n  payload: any | null\r\n  blocking: boolean\r\n  style: CSSProperties\r\n}\r\nexport const initialState: ModalContextStateT = {\r\n  isOpen: false,\r\n  contents: null,\r\n  callback: null,\r\n  payload: null,\r\n  blocking: false,\r\n  style: {},\r\n}\r\n\r\nexport const OPEN = 'modalContext/OPEN'\r\nexport const CLOSE = 'modalContext/CLOSE'\r\nexport const SET_CONTENTS = 'modalContext/SET_CONTENTS'\r\nexport const SET_CALLBACK = 'modalContext/SET_CALLBACK'\r\nexport const SET_PAYLOAD = 'modalContext/SET_PAYLOAD'\r\nexport const SET_BLOCKING = 'modalContext/SET_BLOCKING'\r\nexport const SET_STYLE = 'modalContext/SET_STYLE'\r\n\r\nexport const actions = {\r\n  open: (contents?: React.FC, style?: CSSProperties, blocking?: boolean) => ({\r\n    type: OPEN,\r\n    contents,\r\n    style,\r\n    blocking,\r\n  }),\r\n  close: () => ({ type: CLOSE }),\r\n  setPayload: (payload: any) => ({ type: SET_PAYLOAD, payload }),\r\n  setContents: (contents: React.FC | null) => ({\r\n    type: SET_CONTENTS,\r\n    contents,\r\n  }),\r\n  setCallback: (callback: (() => void) | null) => ({\r\n    type: SET_CALLBACK,\r\n    callback,\r\n  }),\r\n  setBlocking: (blocking: boolean) => ({ type: SET_BLOCKING, blocking }),\r\n  setStyle: (style: CSSProperties) => ({ type: SET_STYLE, style }),\r\n}\r\n\r\nconst core: Record<\r\n  string,\r\n  (state: ModalContextStateT, action: any) => ModalContextStateT\r\n> = {\r\n  [OPEN]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    isOpen: true,\r\n    contents: action.contents ? action.contents : state.contents,\r\n    style: action.style ? action.style : state.style || {},\r\n    blocking: action.blocking || false,\r\n  }),\r\n  [CLOSE]: (state: ModalContextStateT) => ({\r\n    ...state,\r\n    isOpen: false,\r\n  }),\r\n  [SET_PAYLOAD]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    payload: action.payload,\r\n  }),\r\n  [SET_CONTENTS]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    callback: null,\r\n    payload: null,\r\n    contents: action.contents,\r\n    blocking: false,\r\n    style: {},\r\n  }),\r\n  [SET_CALLBACK]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    callback: action.callback,\r\n  }),\r\n  [SET_BLOCKING]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    blocking: action.blocking,\r\n  }),\r\n  [SET_STYLE]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    style: action.style,\r\n  }),\r\n}\r\n\r\nexport const reducer = (\r\n  state: ModalContextStateT = initialState,\r\n  action: any,\r\n) => {\r\n  const coreFunction = core[action.type]\r\n  return coreFunction ? coreFunction(state, action) : state\r\n}\r\n","import React, { useContext, useReducer, useMemo, CSSProperties } from 'react'\r\nimport Modal from 'react-modal'\r\nimport { actions, reducer, initialState, ModalContextStateT } from './reducer'\r\n\r\nconst overlayStyles = () => ({\r\n  zIndex: 700,\r\n})\r\nconst contentStyles = (styles: CSSProperties): CSSProperties => ({\r\n  width: '50vw',\r\n  maxHeight: 'calc(100vh - 128px)',\r\n  marginLeft: 'auto',\r\n  marginRight: 'auto',\r\n  ...styles,\r\n})\r\n\r\nexport interface ModalContextT {\r\n  open: (contents?: React.FC, style?: CSSProperties, blocking?: boolean) => void\r\n  close: (payload?: any) => void\r\n  setPayload: (payload: any) => void\r\n  setBlocking: (blocking: boolean) => void\r\n  setContents: (contents: React.FC) => void\r\n  setCallback: (callback: (payload?: any) => void) => void\r\n  setStyle: (style: CSSProperties) => void\r\n}\r\nconst defaultContext: ModalContextT = {\r\n  open: () => null,\r\n  close: () => null,\r\n  setBlocking: () => null,\r\n  setPayload: () => null,\r\n  setContents: () => null,\r\n  setCallback: () => null,\r\n  setStyle: () => null,\r\n}\r\nexport const ModalContext = React.createContext<ModalContextT>(defaultContext)\r\nexport const useModalContext = () => useContext(ModalContext)\r\n\r\nconst getContextValue = (\r\n  state: ModalContextStateT,\r\n  dispatch: React.Dispatch<any>,\r\n) => ({\r\n  isOpen: state.isOpen,\r\n  open: (contents?: React.FC, style?: CSSProperties, blocking?: boolean) =>\r\n    dispatch(actions.open(contents, style, blocking)),\r\n  close: (payload?: any) => {\r\n    if (state.callback) state.callback(payload || state.payload)\r\n    dispatch(actions.close())\r\n  },\r\n  setPayload: (payload: any) => dispatch(actions.setPayload(payload)),\r\n  setContents: (contents: React.FC) => dispatch(actions.setContents(contents)),\r\n  setCallback: (callback: (payload?: any) => void) =>\r\n    dispatch(actions.setCallback(callback)),\r\n  setBlocking: (blocking: boolean) => dispatch(actions.setBlocking(blocking)),\r\n  setStyle: (style: CSSProperties) => dispatch(actions.setStyle(style)),\r\n})\r\n\r\nModal.setAppElement('#root')\r\nexport interface ModalContextProviderPropsT {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const ModalContextProvider = (props: ModalContextProviderPropsT) => {\r\n  const { children } = props\r\n  const reducerValue = useReducer(reducer, initialState)\r\n  const [state] = reducerValue\r\n  const context = useMemo(() => getContextValue(...reducerValue), [\r\n    reducerValue,\r\n  ])\r\n\r\n  return (\r\n    <ModalContext.Provider value={context}>\r\n      {children}\r\n      <Modal\r\n        parentSelector={() =>\r\n          document.querySelector('#content-root') as HTMLElement\r\n        }\r\n        isOpen={state.isOpen}\r\n        onRequestClose={() => {\r\n          if (!state.blocking) context.close()\r\n        }}\r\n        style={{\r\n          content: {\r\n            backgroundColor: '#111',\r\n            color: 'white',\r\n            width: 400,\r\n            margin: '0 auto',\r\n            bottom: 'unset',\r\n            borderColor: '#555',\r\n          },\r\n          overlay: {\r\n            backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n          },\r\n        }}\r\n      >\r\n        {state.contents && <state.contents />}\r\n      </Modal>\r\n    </ModalContext.Provider>\r\n  )\r\n}\r\n","import React, { useMemo, useState } from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { BoxButton } from '../../elements/box'\r\nimport { useModalContext } from '../../contexts/ModalContext'\r\nimport makeItem from '../../objects/builders/makeItem'\r\nimport { ItemPreviewSmall } from '../ItemPreviewSmall'\r\nimport { EquippableT } from '../../types/Item'\r\n\r\nexport interface CombatVictoryModalPropsT {\r\n  reset: (done: boolean) => void\r\n}\r\nexport const CombatVictoryModal = (props: CombatVictoryModalPropsT) => {\r\n  const { reset } = props\r\n  const { close } = useModalContext()\r\n\r\n  const [chosenItemId, setChosenItemId] = useState<string | undefined>()\r\n  const rewardChoices = useMemo(() => {\r\n    return [makeItem(), makeItem(), makeItem(), makeItem(), makeItem()]\r\n  }, [])\r\n\r\n  const onNextClick = () => {\r\n    reset(false)\r\n    close(rewardChoices.find((i) => i.id === chosenItemId))\r\n  }\r\n\r\n  console.log(rewardChoices)\r\n  return (\r\n    <FlexContainer $direction='column'>\r\n      <h1 style={{ textAlign: 'center', marginTop: 0 }}>Victory!</h1>\r\n      <FlexContainer $direction='column' style={{ alignItems: 'center' }}>\r\n        <span>Choose a Reward</span>\r\n        <FlexContainer>\r\n          {rewardChoices.map((item) => (\r\n            <div\r\n              style={{\r\n                border: '2px solid transparent',\r\n                borderColor: chosenItemId === item.id ? 'white' : 'transparent',\r\n              }}\r\n            >\r\n              <ItemPreviewSmall\r\n                item={item}\r\n                size={60}\r\n                onClick={() => setChosenItemId(item.id)}\r\n              />\r\n            </div>\r\n          ))}\r\n        </FlexContainer>\r\n      </FlexContainer>\r\n      <FlexContainer style={{ marginTop: 20, alignItems: 'center' }}>\r\n        <BoxButton disabled={chosenItemId === undefined} onClick={onNextClick}>\r\n          Next Battle\r\n        </BoxButton>\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { BoxButton } from '../../elements/box'\r\nimport { useModalContext } from '../../contexts/ModalContext'\r\nimport { useHistory } from 'react-router'\r\n\r\nexport interface CombatLossModalPropsT {\r\n  wins: number\r\n}\r\nexport const CombatLossModal = (props: CombatLossModalPropsT) => {\r\n  const { wins } = props\r\n  const history = useHistory()\r\n  const { close } = useModalContext()\r\n\r\n  const onNextClick = () => {\r\n    close()\r\n    history.push('/characters/')\r\n  }\r\n  return (\r\n    <FlexContainer $direction='column'>\r\n      <h1 style={{ textAlign: 'center', marginTop: 0 }}>You Died...</h1>\r\n      <span>But you won {wins} times.</span>\r\n      <FlexContainer>\r\n        <BoxButton onClick={onNextClick}>Back to Characters</BoxButton>\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React, { createContext, useContext, useEffect, useState } from 'react'\r\nimport { ProcessedPartyT, PartyT } from '../../types/Party'\r\nimport { usePartyContext } from '../PartyContext'\r\nimport { makeParty } from '../../objects/makeParty'\r\nimport { v4 } from 'uuid'\r\nimport { PC_PARTY_ID } from '../../state/parties'\r\nimport { useRollContext } from '../RollContext'\r\nimport {\r\n  getCombatRecordBuilder,\r\n  CombatRoundT,\r\n  ENEMY_PARTY_ID,\r\n  checkParty,\r\n  resolveRound,\r\n  checkCharacterActiveSkills,\r\n  checkCharacterActiveTargets,\r\n} from './util'\r\nimport { useCombatLogContext } from '../CombatLogContext'\r\nimport { useInterval } from '../../hooks/useInterval'\r\nimport { useModalContext } from '../ModalContext'\r\nimport { useHistory } from 'react-router'\r\nimport { CombatVictoryModal } from '../../components/CombatVictoryModal'\r\nimport { CombatLossModal } from '../../components/CombatLossModal'\r\n\r\nexport interface CombatContextT {\r\n  rounds: any[]\r\n  userParty: ProcessedPartyT\r\n  rawUserParty: PartyT\r\n  enemyParty: ProcessedPartyT\r\n  rawEnemyParty: PartyT\r\n  parties: ProcessedPartyT[]\r\n  running: boolean\r\n  done: boolean\r\n  characterSkills: { [characterId: string]: string | undefined }\r\n  characterTargets: { [characterId: string]: string | undefined }\r\n  setCharacterSkill: (characterId: string, skillId?: string) => void\r\n  setCharacterTarget: (characterId: string, targetId?: string) => void\r\n  next: () => void\r\n  start: () => void\r\n  stop: () => void\r\n  reset: (done: boolean) => void\r\n}\r\nconst defaultContextValue: CombatContextT = {\r\n  rounds: [],\r\n  userParty: {\r\n    id: v4(),\r\n    characters: [],\r\n    processed: true,\r\n    items: [],\r\n    skills: [],\r\n    mods: [],\r\n  },\r\n  rawUserParty: { id: v4(), characters: [], items: [], skills: [], mods: [] },\r\n  enemyParty: {\r\n    id: v4(),\r\n    characters: [],\r\n    processed: true,\r\n    items: [],\r\n    skills: [],\r\n    mods: [],\r\n  },\r\n  rawEnemyParty: { id: v4(), characters: [], items: [], skills: [], mods: [] },\r\n  parties: [],\r\n  running: false,\r\n  done: false,\r\n  characterSkills: {},\r\n  characterTargets: {},\r\n  setCharacterSkill: (characterId, skillId) => {},\r\n  setCharacterTarget: (characterId, targetId) => {},\r\n  next: () => {},\r\n  start: () => {},\r\n  stop: () => {},\r\n  reset: (done: boolean) => {},\r\n}\r\nexport const CombatContext = createContext<CombatContextT>(defaultContextValue)\r\nexport const useCombatContext = () => useContext(CombatContext)\r\n\r\nexport interface CombatContextProviderPropsT {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const CombatContextProvider = (props: CombatContextProviderPropsT) => {\r\n  const { children } = props\r\n  const {\r\n    parties,\r\n    rawParties,\r\n    userParty,\r\n    rawUserParty,\r\n    upsertParty,\r\n    upsertCharacter,\r\n    upsertItem,\r\n  } = usePartyContext()\r\n  const { checkCharacter, rollCharacter } = useRollContext()\r\n  const { addLine, clear } = useCombatLogContext()\r\n  const [rounds, setRounds] = useState<CombatRoundT[]>([])\r\n  const [wins, setWins] = useState<number>(0)\r\n  const [characterSkills, setCharacterSkills] = useState<{\r\n    [characterId: string]: string | undefined\r\n  }>({})\r\n  const [characterTargets, setCharacterTargets] = useState<{\r\n    [characterId: string]: string | undefined\r\n  }>({})\r\n  const setCharacterSkill = (\r\n    characterId: string,\r\n    skillId: string | undefined,\r\n  ) => setCharacterSkills((skills) => ({ ...skills, [characterId]: skillId }))\r\n  const setCharacterTarget = (characterId: string, targetId?: string) =>\r\n    setCharacterTargets((targets) => ({ ...targets, [characterId]: targetId }))\r\n  const [done, setDone] = useState(false)\r\n  const rawEnemyParty = rawParties.filter((p) => p.id === ENEMY_PARTY_ID)[0]\r\n  const enemyParty = parties.filter((p) => p.id === ENEMY_PARTY_ID)[0]\r\n  const { open, setCallback } = useModalContext()\r\n  const history = useHistory()\r\n\r\n  const next = () => {\r\n    if (!enemyParty || !userParty) return\r\n    const builder = getCombatRecordBuilder(\r\n      characterSkills,\r\n      characterTargets,\r\n      checkCharacter,\r\n      rollCharacter,\r\n    )\r\n    const round = builder(userParty, enemyParty, rawParties)\r\n    setRounds((r) => [...r, round])\r\n  }\r\n\r\n  const { start, stop, running } = useInterval(next)\r\n\r\n  const reset = (done: boolean = false) => {\r\n    clear()\r\n    if (!done) {\r\n      setDone(false)\r\n      setRounds([])\r\n      upsertParty(makeParty(ENEMY_PARTY_ID))\r\n      upsertParty({\r\n        ...rawUserParty,\r\n        characters: rawUserParty.characters.map((c) => ({\r\n          ...c,\r\n          traits: [],\r\n          partyId: PC_PARTY_ID,\r\n          //dead: false,\r\n          //healthOffset: 0,\r\n          //focusOffset: 0,\r\n        })),\r\n      })\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    upsertParty(makeParty(ENEMY_PARTY_ID))\r\n    upsertParty({\r\n      ...rawUserParty,\r\n      characters: rawUserParty.characters.map((c) => ({\r\n        ...c,\r\n        partyId: PC_PARTY_ID,\r\n        dead: false,\r\n        healthOffset: 0,\r\n        focusOffset: 0,\r\n        traits: [],\r\n      })),\r\n    })\r\n    return () => {\r\n      stop()\r\n      reset(true)\r\n    }\r\n  }, [])\r\n\r\n  const finish = (didWin: boolean) => {\r\n    stop()\r\n    setDone(true)\r\n    if (didWin) {\r\n      open(() => <CombatVictoryModal reset={reset} />, {}, true)\r\n      setCallback((item) => {\r\n        upsertItem(item)\r\n      })\r\n    } else {\r\n      open(() => <CombatLossModal wins={wins} />, {}, true)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (checkParty(userParty) && !done) {\r\n      setCallback(() => {\r\n        history.push('/characters')\r\n      })\r\n      finish(false)\r\n    } else {\r\n      if (checkParty(enemyParty) && !done) {\r\n        setCallback(() => {})\r\n        finish(true)\r\n        setWins((w) => w + 1)\r\n      } else {\r\n        if (running) {\r\n          start()\r\n        }\r\n      }\r\n    }\r\n  }, [userParty, enemyParty])\r\n\r\n  useEffect(() => {\r\n    if (rounds.length > 0) {\r\n      const characters = resolveRound(\r\n        rounds,\r\n        rawUserParty,\r\n        rawEnemyParty,\r\n        addLine,\r\n        upsertCharacter,\r\n      )\r\n      checkCharacterActiveSkills(characters, characterSkills, setCharacterSkill)\r\n      checkCharacterActiveTargets(\r\n        characters,\r\n        characterTargets,\r\n        setCharacterTarget,\r\n      )\r\n    }\r\n  }, [rounds])\r\n\r\n  return (\r\n    <CombatContext.Provider\r\n      value={{\r\n        rounds,\r\n        userParty,\r\n        rawUserParty,\r\n        enemyParty,\r\n        rawEnemyParty,\r\n        parties,\r\n        running,\r\n        done,\r\n        characterSkills,\r\n        characterTargets,\r\n        setCharacterSkill,\r\n        setCharacterTarget,\r\n        start,\r\n        stop,\r\n        reset,\r\n        next,\r\n      }}\r\n    >\r\n      {children}\r\n    </CombatContext.Provider>\r\n  )\r\n}\r\n","import { useRef, useState } from 'react'\r\n\r\nexport const useInterval = (\r\n  onTick: (...args: any[]) => void,\r\n  delay: number = 1000,\r\n) => {\r\n  const [running, setRunning] = useState<boolean>(false)\r\n  const ref = useRef<NodeJS.Timeout | undefined>()\r\n  const start = (...args: any[]) => {\r\n    if (ref.current === undefined) {\r\n      setRunning(true)\r\n      ref.current = setInterval(() => onTick(...args), delay)\r\n    } else {\r\n      clearInterval(ref.current)\r\n      ref.current = setInterval(() => onTick(...args), delay)\r\n    }\r\n  }\r\n  const stop = () => {\r\n    if (ref.current !== undefined) {\r\n      setRunning(false)\r\n      clearInterval(ref.current)\r\n      ref.current = undefined\r\n    }\r\n  }\r\n\r\n  return { start, stop, running }\r\n}\r\n","import React, { CSSProperties, useState } from 'react'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { useCombatContext } from '../../contexts/CombatContext'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport Dice6 from '../../icons/svg/delapouite/dice-six-faces-six.svg'\r\nimport { Icon } from '../Icon'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport Roll from '../../assets/img/roll.png'\r\nimport { Hover } from '../Hover'\r\n\r\nconst size = 34\r\nexport interface CombatCharacterTargetsPropsT {\r\n  activeTargetId?: string\r\n  onClick: (targetId?: string) => void\r\n}\r\nexport const CombatCharacterTargets = (props: CombatCharacterTargetsPropsT) => {\r\n  const { activeTargetId, onClick } = props\r\n  const { enemyParty } = useCombatContext()\r\n  const cc = useCharacterContext()\r\n  const active = (targetId?: string) => activeTargetId === targetId\r\n  const characters = enemyParty ? enemyParty.characters : []\r\n  return (\r\n    <FlexContainer>\r\n      <BoxButton\r\n        disabled={cc.character.dead}\r\n        onClick={() => !cc.character.dead && onClick(undefined)}\r\n        style={{ border: 'none' }}\r\n        substyle={{\r\n          cursor: cc.character.dead ? 'default' : 'pointer',\r\n          background: cc.character.dead ? '#444' : '#111',\r\n          padding: 0,\r\n          height: size + 2,\r\n          width: size + 2,\r\n          boxSizing: 'border-box',\r\n          borderColor: 'transparent',\r\n          opacity: activeTargetId === undefined ? 1 : 0.5,\r\n          margin: 0,\r\n          ...(active(undefined) ? { borderColor: 'turquoise' } : {}),\r\n        }}\r\n        // style={{ marginRight: 16 }}\r\n      >\r\n        <img\r\n          alt='random'\r\n          src={Roll}\r\n          height={size}\r\n          width={size}\r\n          style={{\r\n            height: size,\r\n            width: size,\r\n            boxSizing: 'border-box',\r\n            border: '1px solid black',\r\n          }}\r\n        />\r\n      </BoxButton>\r\n      {characters.map((character) => (\r\n        <CombatCharacterTarget\r\n          key={character.id}\r\n          name={character.name}\r\n          onClick={() => onClick(character.id)}\r\n          disabled={cc.character.dead || character.dead}\r\n          style={{\r\n            padding: 0,\r\n            height: size + 2,\r\n            width: size + 2,\r\n            boxSizing: 'border-box',\r\n            margin: 0,\r\n            borderColor: 'transparent',\r\n            opacity:\r\n              cc.character.dead || character.dead\r\n                ? 0.5\r\n                : active(character.id)\r\n                ? 1\r\n                : 0.7,\r\n            ...(active(character.id) ? { borderColor: 'turquoise' } : {}),\r\n          }}\r\n        />\r\n      ))}\r\n      <FlexContainer $full />\r\n    </FlexContainer>\r\n  )\r\n}\r\n\r\nexport interface CombatCharacterTargetPropsT {\r\n  name: string\r\n  disabled: boolean\r\n  style: CSSProperties\r\n  onClick: () => void\r\n}\r\nexport const CombatCharacterTarget = (props: CombatCharacterTargetPropsT) => {\r\n  const { name, disabled, style, onClick } = props\r\n  return (\r\n    <Hover>\r\n      {({ isHovering }) => (\r\n        <Tooltip\r\n          isOpen={isHovering}\r\n          direction='up'\r\n          tagName='div'\r\n          padding='0'\r\n          arrow={false}\r\n          content={<BoxContainer>{name}</BoxContainer>}\r\n        >\r\n          <BoxContainer\r\n            onClick={() => !disabled && onClick()}\r\n            disabled={disabled}\r\n            substyle={{\r\n              borderColor: isHovering ? '#999' : '#555',\r\n              padding: '4px',\r\n              cursor: disabled ? 'default' : 'pointer',\r\n              background: disabled ? '#444' : '#111',\r\n              ...style,\r\n            }}\r\n            style={{ border: 'none' }}\r\n          >\r\n            <img\r\n              alt='profile'\r\n              src={`https://picsum.photos/seed/${name}/60/60`}\r\n              style={{\r\n                height: size,\r\n                width: size,\r\n                boxSizing: 'border-box',\r\n                border: '1px solid black',\r\n              }}\r\n            />\r\n          </BoxContainer>\r\n        </Tooltip>\r\n      )}\r\n    </Hover>\r\n  )\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport Inspect from '../../icons/svg/lorc/magnifying-glass.svg'\r\nimport WeaponHands from '../../icons/svg/delapouite/sword-brandish.svg'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { BoxContainer, SmallBox, BoxButton } from '../../elements/box'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { Gauge } from '../Gauge'\r\nimport { CharacterInspect } from '../CharacterInspect'\r\nimport { Icon } from '../Icon'\r\nimport { ProcessedCharacterT } from '../../types/Character'\r\nimport { WeaponPreview } from '../WeaponPreview'\r\nimport Tombstone from '../../icons/svg/lorc/tombstone.svg'\r\nimport Pencil from '../../icons/svg/delapouite/pencil.svg'\r\nimport Save from '../../icons/svg/delapouite/save.svg'\r\nimport Delete from '../../icons/svg/delapouite/trash-can.svg'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { noneg } from '../../util/noneg'\r\nimport { CombatCharacterSkills } from '../CombatCharacterSkills'\r\nimport { CombatCharacterTargets } from '../CombatCharacterTargets'\r\nimport { useCombatContext } from '../../contexts/CombatContext'\r\nimport { PC_PARTY_ID } from '../../state/parties'\r\n\r\nexport interface CharacterDetailsPropsT {\r\n  character?: ProcessedCharacterT\r\n  showInspect?: boolean\r\n  showWeaponInspect?: boolean\r\n  showEdit?: boolean\r\n  showSkills?: boolean\r\n}\r\nexport const CharacterDetails = (props: CharacterDetailsPropsT) => {\r\n  const {\r\n    showEdit = false,\r\n    showInspect = false,\r\n    showWeaponInspect = false,\r\n    showSkills = false,\r\n  } = props\r\n  const characterContext = useCharacterContext()\r\n  const { deleteCharacter, userParty } = usePartyContext()\r\n  const {\r\n    characterSkills,\r\n    setCharacterSkill,\r\n    characterTargets,\r\n    setCharacterTarget,\r\n  } = useCombatContext()\r\n  const { rawCharacter, onChange } = characterContext\r\n  const character = props.character || characterContext.character\r\n  const [detailsHovering, setDetailsHovering] = useState(false)\r\n  const [weaponHovering, setWeaponHovering] = useState(false)\r\n  const [isEditing, setIsEditing] = useState(false)\r\n  const [name, setName] = useState<string>(character.name)\r\n  const health = noneg(character.stats.health - character.healthOffset)\r\n  const focus = noneg(character.stats.focus - character.focusOffset)\r\n  useEffect(() => {\r\n    setName(character.name)\r\n  }, [character.name])\r\n  return (\r\n    <BoxContainer\r\n      style={{\r\n        width: 454,\r\n        transition: 'all 1s',\r\n        border: '2px solid black',\r\n      }}\r\n      substyle={{\r\n        padding: 0,\r\n      }}\r\n    >\r\n      <FlexContainer $direction='column'>\r\n        <FlexContainer\r\n          style={{\r\n            padding: 4,\r\n            background:\r\n              'linear-gradient(0deg, rgba(34,34,34,1) 0%, rgba(51,51,51,1) 100%)',\r\n          }}\r\n        >\r\n          <FlexContainer $full>\r\n            <BoxContainer\r\n              style={{\r\n                marginRight: 10,\r\n                height: 64,\r\n                width: 64,\r\n              }}\r\n              substyle={{\r\n                padding: 0,\r\n                backgroundColor: '#111',\r\n                border: 'none',\r\n              }}\r\n            >\r\n              {character.dead ? (\r\n                <FlexContainer\r\n                  style={{\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    height: 60,\r\n                  }}\r\n                >\r\n                  <Icon src={Tombstone} size={48} />\r\n                </FlexContainer>\r\n              ) : (\r\n                <img\r\n                  alt='profile'\r\n                  src={`https://picsum.photos/seed/${character.name}/60/60`}\r\n                  style={{\r\n                    height: 60,\r\n                    width: 60,\r\n                    border: '1px solid rgba(255,255,255,0.5)',\r\n                  }}\r\n                />\r\n              )}\r\n            </BoxContainer>\r\n\r\n            {isEditing ? (\r\n              <div>\r\n                <input value={name} onChange={(e) => setName(e.target.value)} />\r\n              </div>\r\n            ) : (\r\n              <FlexContainer $direction='column'>\r\n                <h2\r\n                  style={{\r\n                    margin: 0,\r\n                    textShadow: '1px 1px 1px black',\r\n                    fontSize: 18,\r\n                  }}\r\n                >\r\n                  {character.name}\r\n                </h2>\r\n                <FullContainer />\r\n                <strong\r\n                  style={{\r\n                    fontFamily: 'monospace',\r\n                    fontSize: 10,\r\n                    color: 'rgba(255,255,255,0.24)',\r\n                  }}\r\n                >\r\n                  {character.abilities.strength} {character.abilities.dexterity}{' '}\r\n                  {character.abilities.intelligence} {character.abilities.vigor}\r\n                </strong>\r\n                <strong\r\n                  style={{\r\n                    fontFamily: 'monospace',\r\n                    fontSize: 10,\r\n                    color: 'rgba(255,255,255,0.24)',\r\n                  }}\r\n                >\r\n                  {character.stats.will} {character.stats.perception}{' '}\r\n                  {character.stats.agility} {character.stats.accuracy}{' '}\r\n                  {character.stats.evade}\r\n                </strong>\r\n              </FlexContainer>\r\n            )}\r\n          </FlexContainer>\r\n          {showWeaponInspect && (\r\n            <Tooltip\r\n              isOpen={detailsHovering}\r\n              direction='right'\r\n              tagName='div'\r\n              padding='0'\r\n              arrow={false}\r\n              content={<WeaponPreview weapon={character.weapon} />}\r\n            >\r\n              <SmallBox\r\n                onMouseEnter={() => setDetailsHovering(true)}\r\n                onMouseLeave={() => setDetailsHovering(false)}\r\n              >\r\n                <Icon src={WeaponHands} size={18} />\r\n              </SmallBox>\r\n            </Tooltip>\r\n          )}\r\n          {showInspect && (\r\n            <Tooltip\r\n              isOpen={weaponHovering}\r\n              direction='right'\r\n              tagName='div'\r\n              padding='0'\r\n              arrow={false}\r\n              content={<CharacterInspect />}\r\n            >\r\n              <SmallBox\r\n                onMouseEnter={() => setWeaponHovering(true)}\r\n                onMouseLeave={() => setWeaponHovering(false)}\r\n              >\r\n                <Icon src={Inspect} size={18} />\r\n              </SmallBox>\r\n            </Tooltip>\r\n          )}\r\n          {showEdit && !isEditing && (\r\n            <BoxButton\r\n              style={{ height: 42, width: 42, margin: 0 }}\r\n              substyle={{\r\n                padding: 0,\r\n                display: 'flex',\r\n                justifyContent: 'center',\r\n                alignItems: 'center',\r\n              }}\r\n              onClick={() => setIsEditing((e) => !e)}\r\n            >\r\n              <Icon src={Pencil} size={18} />\r\n            </BoxButton>\r\n          )}\r\n          {isEditing && (\r\n            <>\r\n              <BoxButton\r\n                style={{ height: 42, width: 42, margin: 0 }}\r\n                substyle={{\r\n                  padding: 0,\r\n                  display: 'flex',\r\n                  justifyContent: 'center',\r\n                  alignItems: 'center',\r\n                }}\r\n                onClick={() => {\r\n                  onChange({ ...rawCharacter, name })\r\n                  setIsEditing((e) => !e)\r\n                }}\r\n              >\r\n                <Icon src={Save} size={18} />\r\n              </BoxButton>\r\n              <BoxButton\r\n                style={{ height: 42, width: 42, margin: 0 }}\r\n                substyle={{\r\n                  padding: 0,\r\n                  display: 'flex',\r\n                  justifyContent: 'center',\r\n                  alignItems: 'center',\r\n                }}\r\n                onClick={() => {\r\n                  deleteCharacter(character.id)\r\n                }}\r\n              >\r\n                <Icon src={Delete} size={18} />\r\n              </BoxButton>\r\n            </>\r\n          )}\r\n        </FlexContainer>\r\n        {showSkills && (\r\n          <FlexContainer\r\n            $direction='column'\r\n            style={{\r\n              backgroundColor: '#1a1a1a',\r\n              boxShadow: 'inset 0px 0px 15px black',\r\n              width: 'calc(100% - 16px)',\r\n              padding: '4px 8px',\r\n              borderTop: '1px solid #555',\r\n            }}\r\n          >\r\n            <span\r\n              style={{\r\n                fontFamily: 'monospace',\r\n                fontWeight: 'bold',\r\n                color: 'rgba(255,255,255,0.24)',\r\n                marginBottom: 2,\r\n              }}\r\n            >\r\n              SKILLS\r\n            </span>\r\n            <CombatCharacterSkills\r\n              activeSkillId={characterSkills[character.id]}\r\n              skills={character.skills}\r\n              onClick={(skillId) => setCharacterSkill(character.id, skillId)}\r\n            />\r\n            <span\r\n              style={{\r\n                fontFamily: 'monospace',\r\n                fontWeight: 'bold',\r\n                color: 'rgba(255,255,255,0.24)',\r\n                marginBottom: 2,\r\n                marginTop: 4,\r\n              }}\r\n            >\r\n              TARGETS\r\n            </span>\r\n            <CombatCharacterTargets\r\n              activeTargetId={characterTargets[character.id]}\r\n              onClick={(targetId) => setCharacterTarget(character.id, targetId)}\r\n            />\r\n          </FlexContainer>\r\n        )}\r\n        <Gauge\r\n          name='Health'\r\n          color='#8f4e4d'\r\n          max={character.stats.health}\r\n          value={health}\r\n          height={15}\r\n        >\r\n          {health}/{character.stats.health}\r\n        </Gauge>\r\n        <Gauge\r\n          name='Focus'\r\n          color='#517e4e'\r\n          max={character.stats.focus}\r\n          value={focus}\r\n          height={15}\r\n        >\r\n          {focus}/{character.stats.focus}\r\n        </Gauge>\r\n      </FlexContainer>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { useContext, useState } from 'react'\r\n\r\nexport interface UIContextT {\r\n  logKey: string | undefined\r\n  sidebarKey: string | undefined\r\n\r\n  setLogKey: (key?: string) => void\r\n  setSidebarKey: (key?: string) => void\r\n}\r\nconst defaultValue: UIContextT = {\r\n  logKey: undefined,\r\n  sidebarKey: undefined,\r\n  setLogKey: () => {},\r\n  setSidebarKey: () => {},\r\n}\r\nexport const UIContext = React.createContext<UIContextT>(defaultValue)\r\nexport const useUIContext = () => useContext(UIContext)\r\n\r\nexport interface UIContextProviderPropsT {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const UIContextProvider = (props: UIContextProviderPropsT) => {\r\n  const { children } = props\r\n  const [logKey, setLogKey] = useState<string | undefined>()\r\n  const [sidebarKey, setSidebarKey] = useState<string | undefined>()\r\n\r\n  return (\r\n    <UIContext.Provider\r\n      value={{\r\n        logKey,\r\n        sidebarKey,\r\n        setLogKey,\r\n        setSidebarKey,\r\n      }}\r\n    >\r\n      {children}\r\n    </UIContext.Provider>\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { SkillT } from '../../types/Skill'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { SkillPreview } from '../SkillPreview'\r\nimport { Hover } from '../Hover'\r\n\r\nconst size = 60\r\nexport interface SkillPreviewAltPropsT {\r\n  skill: SkillT\r\n}\r\nexport const SkillPreviewAlt = (props: SkillPreviewAltPropsT) => {\r\n  const { skill } = props\r\n\r\n  return (\r\n    <BoxContainer\r\n      style={{\r\n        height: size + 4,\r\n        width: size + 4,\r\n      }}\r\n      substyle={{ padding: 0 }}\r\n    >\r\n      <Hover>\r\n        {({ isHovering }) => (\r\n          <Tooltip\r\n            isOpen={isHovering}\r\n            direction='down'\r\n            tagName='div'\r\n            padding='0'\r\n            arrow={false}\r\n            content={<SkillPreview skillId={skill.id} skill={skill} />}\r\n          >\r\n            <img src={skill.imgSrc} height={size} width={size} />\r\n          </Tooltip>\r\n        )}\r\n      </Hover>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { useMemo, useEffect } from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { ResourceScore } from '../../components/ResourceScore'\r\nimport { AbilityScore } from '../../components/AbilityScore'\r\nimport { StatScore } from '../../components/StatScore'\r\nimport { DamageResistanceScore } from '../../components/DamageResistanceScore'\r\nimport { ArmorScoreList } from '../../components/ArmorScoreList'\r\nimport { ItemPreview } from '../../components/ItemPreview'\r\nimport { WeaponPreview } from '../../components/WeaponPreview'\r\nimport { CharacterDetails } from '../../components/CharacterDetails'\r\nimport { CharacterStateContextProvider } from '../../contexts/CharacterContext'\r\nimport { RollStateContextProvider } from '../../contexts/RollContext'\r\nimport { useParams, useHistory } from 'react-router'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { useUIContext } from '../../contexts/UIContext'\r\nimport { SkillPreviewAlt } from '../../components/SkillPreviewAlt'\r\nimport { BASIC_ATTACK, INSPECT } from '../../objects/makeSkill'\r\nimport { BoxContainer } from '../../elements/box'\r\n\r\nexport const Character = () => {\r\n  const { id } = useParams()\r\n  const history = useHistory()\r\n  const { rawUserParty, setActiveCharacterId } = usePartyContext()\r\n  const { setLogKey, setSidebarKey } = useUIContext()\r\n  const character = useMemo(() => {\r\n    return rawUserParty.characters.find((c) => c.id === id)\r\n  }, [id, rawUserParty])\r\n  useEffect(() => {\r\n    if (!character) {\r\n      history.push(`/characters/${rawUserParty.characters[0].id}`)\r\n    } else {\r\n      setActiveCharacterId(character.id)\r\n    }\r\n  }, [id])\r\n\r\n  useEffect(() => {\r\n    setLogKey('items')\r\n    return () => {\r\n      setLogKey(undefined)\r\n      setActiveCharacterId(null)\r\n    }\r\n  }, [])\r\n\r\n  if (!character) return null\r\n  return (\r\n    <CharacterStateContextProvider>\r\n      <RollStateContextProvider>\r\n        <FlexContainer style={{ margin: 10, flex: 1 }}>\r\n          <FlexContainer $direction='column' style={{ marginRight: 10 }}>\r\n            <CharacterDetails showEdit={true} />\r\n            <FlexContainer>\r\n              <div>\r\n                <ResourceScore id='characterPoints' />\r\n                <ResourceScore id='weaponHands' />\r\n                <ResourceScore id='heads' />\r\n                <ResourceScore id='bodies' />\r\n                <ResourceScore id='hands' />\r\n                <ResourceScore id='fingers' />\r\n                <ResourceScore id='feet' />\r\n              </div>\r\n              <div>\r\n                <AbilityScore id='strength' />\r\n                <AbilityScore id='dexterity' />\r\n                <AbilityScore id='intelligence' />\r\n                <AbilityScore id='vigor' />\r\n              </div>\r\n              <div>\r\n                <StatScore id='health' />\r\n                <StatScore id='focus' />\r\n                <StatScore id='will' />\r\n                <StatScore id='perception' />\r\n                <StatScore id='agility' />\r\n                <StatScore id='accuracy' />\r\n                <StatScore id='evade' />\r\n              </div>\r\n              <div>\r\n                <DamageResistanceScore id='slashing' />\r\n                <DamageResistanceScore id='piercing' />\r\n                <DamageResistanceScore id='fire' />\r\n                <DamageResistanceScore id='blood' />\r\n                <DamageResistanceScore id='light' />\r\n                <DamageResistanceScore id='dark' />\r\n              </div>\r\n            </FlexContainer>\r\n          </FlexContainer>\r\n          <FlexContainer>\r\n            <div>\r\n              <WeaponPreview showEquipButton={true} showRequirement={false} />\r\n              {character.equippedItems.map((item) => (\r\n                <ItemPreview\r\n                  key={item.id}\r\n                  item={item}\r\n                  showRequirementCheck={false}\r\n                  showCollapseButton={false}\r\n                />\r\n              ))}\r\n              <BoxContainer\r\n                substyle={{\r\n                  width: 320,\r\n                  // padding: 28,\r\n                }}\r\n              >\r\n                <span\r\n                  style={{\r\n                    fontFamily: 'monospace',\r\n                    fontWeight: 'bold',\r\n                    color: 'rgba(255,255,255,0.24)',\r\n                    marginBottom: 2,\r\n                  }}\r\n                >\r\n                  SKILLS\r\n                </span>\r\n                <FlexContainer style={{ flexWrap: 'wrap' }}>\r\n                  {character.skills\r\n                    .filter(\r\n                      (s) => s.id !== BASIC_ATTACK.id && s.id !== INSPECT.id,\r\n                    )\r\n                    .map((skill) => (\r\n                      <div style={{ padding: 3.5 }}>\r\n                        <SkillPreviewAlt key={skill.id} skill={skill} />\r\n                      </div>\r\n                    ))}\r\n                </FlexContainer>\r\n              </BoxContainer>\r\n            </div>\r\n            <ArmorScoreList />\r\n          </FlexContainer>\r\n        </FlexContainer>\r\n      </RollStateContextProvider>\r\n    </CharacterStateContextProvider>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { CharacterKeyMap3 } from '../../types/Character'\r\nimport { getSign } from '../../util/getSign'\r\nimport { getValueString } from '../../util/getValueString'\r\nimport { Roll2T, Check2T, Roll2ResultT, Check2ResultT } from '../../types/Roll2'\r\nimport { Span } from '../../contexts/CombatContext/log'\r\n\r\nexport const RollResult = (props: any) => {\r\n  const roll: Roll2ResultT | Check2ResultT = props.roll\r\n  const check = roll as Check2ResultT\r\n  const isCheck = check.goal !== undefined\r\n  const result = isCheck ? check.result : undefined\r\n  return (\r\n    <div style={{ fontFamily: 'monospace' }}>\r\n      {isCheck && result && Span('lightgreen', '[PASSED] ')}\r\n      {isCheck && !result && Span('lightcoral', '[FAILED] ')}\r\n      {!isCheck && Span('turquoise', '[STATIC] ')}\r\n      {isCheck && <span>({check.goal}) </span>}\r\n      <span>{roll.output}</span>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst RollDescription = (props: any) => {\r\n  const keys: any[] = props.keys\r\n  const modifier = props.modifier\r\n  const goal = props.goal\r\n  const rollStr = props.rollStr\r\n  const percentage = props.percentage\r\n  const rollText = goal === null ? `${rollStr}+` : ''\r\n  const keyText = keys.reduce((str, key, i) => `${str}${getSign(i)}${key}`, '')\r\n  const modifierText = getSign(modifier) + getValueString(modifier)\r\n  const percentageStr =\r\n    goal === null\r\n      ? ''\r\n      : `: ${percentage === 100 ? ' ~' : ''}${percentage.toFixed(\r\n          percentage === 100 ? 0 : percentage >= 10 ? 1 : 2,\r\n        )}%`\r\n  return <>{`(${rollText}${keyText}${modifierText}${percentageStr})`}</>\r\n}\r\n\r\nconst RollStatus = (props: any) => {\r\n  const { result } = props\r\n  return (\r\n    <>\r\n      {'['}\r\n      <span style={{ color: getColor(result) }}>{getText(result)}</span>\r\n      {'] '}\r\n    </>\r\n  )\r\n}\r\n\r\nconst getColor = (result: boolean | null) => {\r\n  switch (result) {\r\n    case true:\r\n      return 'lightgreen'\r\n    case false:\r\n      return 'lightcoral'\r\n    default:\r\n      return '#4bebc6'\r\n  }\r\n}\r\nconst getText = (result: boolean | null) => {\r\n  switch (result) {\r\n    case true:\r\n      return 'PASSED'\r\n    case false:\r\n      return 'FAILED'\r\n    default:\r\n      return 'STATIC'\r\n  }\r\n}\r\n","import React, { useContext } from 'react'\r\nimport { useRollContext } from '../RollContext'\r\nimport { getCompareFn, CompareResultFn, ZERO_COMPARE } from '../../util/compare'\r\nimport { CharacterRollT, CharacterCheckT } from '../../types/Roll2'\r\n\r\nexport type CompareKeyT = 'a' | 'b'\r\nexport interface CompareContextT<T> extends Record<CompareKeyT, T> {\r\n  compareChecks: (\r\n    checkA: CharacterCheckT,\r\n    checkB: CharacterCheckT,\r\n  ) => CompareResultFn\r\n  compareRolls: (\r\n    rollA: CharacterRollT,\r\n    rollB: CharacterRollT,\r\n  ) => CompareResultFn\r\n  compareValues: (valueA: number, valueB: number) => CompareResultFn\r\n}\r\nexport const CompareContext = React.createContext<CompareContextT<any>>({\r\n  a: null,\r\n  b: null,\r\n  compareChecks: (checkA: CharacterCheckT, checkB: CharacterCheckT) =>\r\n    ZERO_COMPARE,\r\n  compareRolls: (rollA: CharacterRollT, rollB: CharacterRollT) => ZERO_COMPARE,\r\n  compareValues: (valueA: number, valueB: number) => ZERO_COMPARE,\r\n})\r\n\r\nexport function useCompareContext<T>(): CompareContextT<T> {\r\n  return useContext(CompareContext)\r\n}\r\n\r\nexport interface CompareContextProviderProps<T> extends Record<CompareKeyT, T> {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport function CompareContextProvider<T>(\r\n  props: CompareContextProviderProps<T>,\r\n) {\r\n  const { a, b, children } = props\r\n  const { execRoll, getProbability } = useRollContext()\r\n  const compareChecks = (checkA: CharacterCheckT, checkB: CharacterCheckT) => {\r\n    const a = getProbability(checkA)\r\n    const b = getProbability(checkB)\r\n    return getCompareFn(a, b)\r\n  }\r\n  const compareRolls = (rollA: CharacterRollT, rollB: CharacterRollT) => {\r\n    const a = execRoll(rollA, false).averageTotal as number\r\n    const b = execRoll(rollB, false).averageTotal as number\r\n    return getCompareFn(a, b < 0 ? 0 : b)\r\n  }\r\n  const compareValues = (valueA: number, valueB: number) =>\r\n    getCompareFn(valueA, valueB)\r\n  return (\r\n    <CompareContext.Provider\r\n      value={{ a, b, compareChecks, compareRolls, compareValues }}\r\n    >\r\n      {children}\r\n    </CompareContext.Provider>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { ONE_COMPARE } from '../../util/compare'\r\nimport { DamageTypeKeyT } from '../../types/Damage'\r\nimport {\r\n  CharacterSkillCheckKeyT,\r\n  combineTraits,\r\n  getTraitValue,\r\n} from '../../types/Character'\r\nimport {\r\n  CompareContextProvider,\r\n  useCompareContext,\r\n} from '../../contexts/CompareContext'\r\nimport { WeaponPreview } from '../WeaponPreview'\r\nimport { FISTS } from '../../objects/fists'\r\nimport { CharacterRollT } from '../../types/Roll2'\r\n\r\nexport interface EquipedWeaponComparePropsT {\r\n  weapon: WeaponT\r\n}\r\nexport const EquipedWeaponCompare = (props: EquipedWeaponComparePropsT) => {\r\n  const { weapon } = props\r\n  const { character } = useCharacterContext()\r\n  return (\r\n    <CompareContextProvider<WeaponT> a={weapon} b={character.weapon}>\r\n      <WeaponCompareItem />\r\n    </CompareContextProvider>\r\n  )\r\n}\r\n\r\nexport interface WeaponCompareItemPropsT {}\r\nexport const WeaponCompareItem = (props: WeaponCompareItemPropsT) => {\r\n  const context = useCompareContext<WeaponT>()\r\n  const { compareChecks, compareRolls, compareValues } = context\r\n  const a: WeaponT = context['a'] || FISTS\r\n  const b: WeaponT = context['b'] || FISTS\r\n\r\n  const requirementCompare = compareChecks(\r\n    a.requirementCheck,\r\n    b.requirementCheck,\r\n  )\r\n  const accuracyCompare = compareChecks(a.accuracyCheck, b.accuracyCheck)\r\n  const damageCompare = (key: DamageTypeKeyT) => {\r\n    const weaponRoll = a.damageRolls[key] as CharacterRollT\r\n    const testRoll = b.damageRolls[key] as CharacterRollT\r\n    if (!testRoll) return ONE_COMPARE\r\n    return compareRolls(weaponRoll, testRoll)\r\n  }\r\n  const traitCompare = (key: CharacterSkillCheckKeyT) => {\r\n    const weaponValue = getTraitValue(combineTraits(a.traits), key)\r\n    const testValue = getTraitValue(combineTraits(b.traits), key)\r\n    return compareValues(weaponValue, testValue)\r\n  }\r\n  const costComapre = compareValues(b.cost, a.cost)\r\n\r\n  return (\r\n    <WeaponPreview\r\n      weapon={a}\r\n      showEquipButton={false}\r\n      requirementCompare={requirementCompare}\r\n      accuracyCompare={accuracyCompare}\r\n      damageCompare={damageCompare}\r\n      traitCompare={traitCompare}\r\n      costComare={costComapre}\r\n    />\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { ONE_COMPARE } from '../../util/compare'\r\nimport { DamageTypeKeyT } from '../../types/Damage'\r\nimport {\r\n  CharacterSkillCheckKeyT,\r\n  combineTraits,\r\n  getTraitValue,\r\n} from '../../types/Character'\r\nimport {\r\n  CompareContextProvider,\r\n  useCompareContext,\r\n} from '../../contexts/CompareContext'\r\nimport { EquippableT } from '../../types/Item'\r\nimport { BASE_EQUIPPABLE } from '../../objects/util'\r\nimport { ItemPreview } from '../ItemPreview'\r\nimport { ArmorT } from '../../types/Armor'\r\nimport { CharacterRollT } from '../../types/Roll2'\r\n\r\nexport interface EquipedItemComparePropsT {\r\n  item: EquippableT\r\n}\r\nexport const EquipeItemCompare = (props: EquipedItemComparePropsT) => {\r\n  const { item } = props\r\n  const { character } = useCharacterContext()\r\n  if ((item as ArmorT).armorType === 'ring')\r\n    return (\r\n      <ItemPreview\r\n        item={item}\r\n        showEquipButton={false}\r\n        showRequirementCheck={true}\r\n        showCollapseButton={false}\r\n      />\r\n    )\r\n  const testItem = [...character.armor, ...character.equippedItems].find(\r\n    (i) => {\r\n      if (item.type === 'armor') {\r\n        return i.type === 'armor' && i.resource === item.resource\r\n      } else {\r\n        return i.type !== 'armor' && i.resource === item.resource\r\n      }\r\n    },\r\n  )\r\n  return (\r\n    <CompareContextProvider<EquippableT>\r\n      a={item}\r\n      b={testItem || BASE_EQUIPPABLE('armor')}\r\n    >\r\n      <ItemCompareItem />\r\n    </CompareContextProvider>\r\n  )\r\n}\r\n\r\nexport interface ItemCompareItemPropsT {}\r\nexport const ItemCompareItem = (props: ItemCompareItemPropsT) => {\r\n  const context = useCompareContext<EquippableT>()\r\n  const { compareChecks, compareRolls, compareValues } = context\r\n  const a: EquippableT = context['a'] || BASE_EQUIPPABLE('armor')\r\n  const b: EquippableT = context['b'] || BASE_EQUIPPABLE('armor')\r\n\r\n  const requirementCompare = compareChecks(\r\n    a.requirementCheck,\r\n    b.requirementCheck,\r\n  )\r\n  const resistancesCompare = (key: DamageTypeKeyT) => {\r\n    const itemRoll = a.damageResistances[key] as CharacterRollT\r\n    const testRoll = b.damageResistances[key] as CharacterRollT\r\n    if (!testRoll) return ONE_COMPARE\r\n    return compareRolls(itemRoll, testRoll)\r\n  }\r\n  const traitCompare = (key: CharacterSkillCheckKeyT) => {\r\n    const itemValue = getTraitValue(combineTraits(a.traits), key)\r\n    const testValue = getTraitValue(combineTraits(b.traits), key)\r\n    return compareValues(itemValue, testValue)\r\n  }\r\n  const costComapre = compareValues(b.cost, a.cost)\r\n\r\n  return (\r\n    <ItemPreview\r\n      item={a}\r\n      showEquipButton={false}\r\n      requirementCompare={requirementCompare}\r\n      resistancesCompare={resistancesCompare}\r\n      traitCompare={traitCompare}\r\n      costComare={costComapre}\r\n    />\r\n  )\r\n}\r\n","import React from 'react'\r\nimport Color from 'color'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { ItemRarityT, ItemRarityColorMap, ItemTypeT } from '../../types/Item'\r\nimport { FlexContainer } from '../../elements/flex'\r\n\r\nexport interface CharacterItemFilters {\r\n  onClick: (rarity?: ItemRarityT, type?: ItemTypeT) => void\r\n}\r\nexport const CharacterItemFilters = (props: CharacterItemFilters) => {\r\n  const { onClick } = props\r\n  return (\r\n    <FlexContainer>\r\n      <CharacterItemFilterButton rarity='common' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='uncommon' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='rare' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='legendary' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='unique' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='mythic' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='set' onClick={onClick} />\r\n      <CharacterItemFilterButton type='weapon' onClick={onClick}>\r\n        W\r\n      </CharacterItemFilterButton>\r\n      <CharacterItemFilterButton type='armor' onClick={onClick}>\r\n        A\r\n      </CharacterItemFilterButton>\r\n      <CharacterItemFilterButton onClick={onClick}>R</CharacterItemFilterButton>\r\n    </FlexContainer>\r\n  )\r\n}\r\n\r\nexport interface CharacterItemFilterButtonPropsT {\r\n  rarity?: ItemRarityT\r\n  type?: ItemTypeT\r\n  children?: React.ReactNode | React.ReactNode[]\r\n  onClick: (rarity?: ItemRarityT, type?: ItemTypeT) => void\r\n}\r\nexport const CharacterItemFilterButton = (\r\n  props: CharacterItemFilterButtonPropsT,\r\n) => {\r\n  const { rarity, type, children, onClick } = props\r\n  const backgroundColor = rarity\r\n    ? Color(ItemRarityColorMap[rarity]).fade(0.75).hsl().toString()\r\n    : '#222'\r\n  const borderColor = rarity\r\n    ? Color(ItemRarityColorMap[rarity]).fade(0.5).hsl().toString()\r\n    : '#555'\r\n  return (\r\n    <BoxContainer\r\n      tag='button'\r\n      style={{ width: 40, height: 40 }}\r\n      substyle={{\r\n        background: backgroundColor,\r\n        cursor: 'pointer',\r\n        borderColor: borderColor,\r\n        boxShadow: 'inset 0 0 3px black',\r\n        display: 'flex',\r\n        padding: 0,\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        margin: 0,\r\n      }}\r\n      onClick={() => onClick(rarity, type)}\r\n    >\r\n      {children}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { useMemo, useState } from 'react'\r\nimport Color from 'color'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport {\r\n  ItemT,\r\n  EquippableT,\r\n  ItemRarityColorMap,\r\n  ItemTypeT,\r\n  ItemRarityT,\r\n} from '../../types/Item'\r\nimport { CharacterT, canEquip } from '../../types/Character'\r\nimport { WeaponIcon } from '../WeaponIcon'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { ArmorIcon } from '../ArmorIcon'\r\nimport { ArmorT } from '../../types/Armor'\r\nimport { EquipedWeaponCompare } from '../WeaponCompare'\r\nimport { ItemIcon } from '../ItemIcon'\r\nimport { EquipeItemCompare } from '../ItemCompare'\r\nimport { CharacterItemFilters } from '../CharacterItemFilters'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\n\r\nexport const CharacterItems = () => {\r\n  const { rawCharacter } = useCharacterContext()\r\n  const { userParty, equipItem } = usePartyContext()\r\n  const [itemType, setItemType] = useState<ItemTypeT | undefined>()\r\n  const [itemRarity, setItemRarity] = useState<ItemRarityT | undefined>()\r\n\r\n  const filter = (i: EquippableT) => {\r\n    if (itemType) return i.type === itemType\r\n    if (itemRarity) return i.rarity === itemRarity\r\n    return true\r\n  }\r\n\r\n  const other = userParty.items\r\n    .filter((i) => i.type !== 'armor' && i.type !== 'weapon')\r\n    .filter(filter)\r\n  const weapons = userParty.items\r\n    .filter((i) => i.type === 'weapon')\r\n    .filter(filter)\r\n  const armors = userParty.items\r\n    .filter((i) => i.type === 'armor')\r\n    .filter(filter)\r\n  return (\r\n    <FlexContainer style={{}} $direction='column'>\r\n      <CharacterItemFilters\r\n        onClick={(r, t) => {\r\n          if (r) setItemRarity(r)\r\n          if (t) setItemType(t)\r\n          if (!r && !t) {\r\n            setItemRarity(undefined)\r\n            setItemType(undefined)\r\n          }\r\n        }}\r\n      />\r\n      <div style={{ marginTop: 10 }}>\r\n        {weapons.length > 0 && (\r\n          <span\r\n            style={{\r\n              fontFamily: 'monospace',\r\n              fontWeight: 'bold',\r\n              color: 'rgba(255,255,255,0.24)',\r\n              marginBottom: 2,\r\n            }}\r\n          >\r\n            WEAPONS\r\n          </span>\r\n        )}\r\n        <FlexContainer\r\n          style={{\r\n            flexWrap: 'wrap',\r\n            width: 400,\r\n          }}\r\n        >\r\n          {weapons.map((item) => (\r\n            <Item\r\n              key={item.id}\r\n              item={item}\r\n              rawCharacter={rawCharacter}\r\n              onEquip={(id) => equipItem(rawCharacter.id, id)}\r\n            />\r\n          ))}\r\n        </FlexContainer>\r\n        {armors.length > 0 && (\r\n          <span\r\n            style={{\r\n              fontFamily: 'monospace',\r\n              fontWeight: 'bold',\r\n              color: 'rgba(255,255,255,0.24)',\r\n              marginBottom: 2,\r\n            }}\r\n          >\r\n            ARMOR\r\n          </span>\r\n        )}\r\n        <FlexContainer\r\n          style={{\r\n            flexWrap: 'wrap',\r\n            width: 400,\r\n          }}\r\n        >\r\n          {armors.map((item) => (\r\n            <Item\r\n              key={item.id}\r\n              item={item}\r\n              rawCharacter={rawCharacter}\r\n              onEquip={(id) => equipItem(rawCharacter.id, id)}\r\n            />\r\n          ))}\r\n        </FlexContainer>\r\n        {other.length > 0 && (\r\n          <span\r\n            style={{\r\n              fontFamily: 'monospace',\r\n              fontWeight: 'bold',\r\n              color: 'rgba(255,255,255,0.24)',\r\n              marginBottom: 2,\r\n            }}\r\n          >\r\n            OTHER\r\n          </span>\r\n        )}\r\n        <FlexContainer\r\n          style={{\r\n            flexWrap: 'wrap',\r\n            width: 400,\r\n          }}\r\n        >\r\n          {other.map((item) => (\r\n            <Item\r\n              key={item.id}\r\n              item={item}\r\n              rawCharacter={rawCharacter}\r\n              onEquip={(id) => equipItem(rawCharacter.id, id)}\r\n            />\r\n          ))}\r\n        </FlexContainer>\r\n      </div>\r\n    </FlexContainer>\r\n  )\r\n}\r\n\r\nexport interface ItemPropsT {\r\n  item: ItemT\r\n  rawCharacter: CharacterT\r\n  onEquip: (itemId: string) => void\r\n}\r\nconst Item = (props: ItemPropsT) => {\r\n  const { item, rawCharacter, onEquip } = props\r\n  const [isHovering, setIsHovering] = useState(false)\r\n  const type = (item as EquippableT).type\r\n  const isEquipable = (item as EquippableT).equippable\r\n  const isArmor = type === 'armor'\r\n  const isWeapon = type === 'weapon'\r\n  const canEquipItem = useMemo(\r\n    () => canEquip(rawCharacter)(item as EquippableT, !isWeapon),\r\n    [item, rawCharacter, isWeapon],\r\n  )\r\n  const iconSize = 18\r\n  const rarityColor = ItemRarityColorMap[item.rarity]\r\n  const icon = useMemo(() => {\r\n    if (isWeapon) {\r\n      return (\r\n        <WeaponIcon\r\n          weapon={item as WeaponT}\r\n          size={iconSize}\r\n          fill={rarityColor}\r\n        />\r\n      )\r\n    }\r\n    if (isArmor) {\r\n      return (\r\n        <ArmorIcon item={item as ArmorT} size={iconSize} fill={rarityColor} />\r\n      )\r\n    }\r\n    if (isEquipable) {\r\n      return (\r\n        <ItemIcon\r\n          item={item as EquippableT}\r\n          size={iconSize}\r\n          fill={rarityColor}\r\n        />\r\n      )\r\n    }\r\n  }, [item, isArmor, isEquipable, isWeapon, rarityColor])\r\n\r\n  return (\r\n    <div\r\n      onMouseEnter={() => setIsHovering(true)}\r\n      onMouseLeave={() => setIsHovering(false)}\r\n    >\r\n      <Tooltip\r\n        isOpen={isHovering}\r\n        direction='bottom'\r\n        tagName='div'\r\n        padding='0'\r\n        arrow={false}\r\n        content={\r\n          isWeapon ? (\r\n            <EquipedWeaponCompare weapon={item as WeaponT} />\r\n          ) : isEquipable ? (\r\n            <EquipeItemCompare item={item as EquippableT} />\r\n          ) : (\r\n            'item'\r\n          )\r\n        }\r\n      >\r\n        <BoxContainer\r\n          style={{\r\n            width: 40,\r\n            height: 40,\r\n            background: !canEquipItem ? '#333' : '#222',\r\n            boxShadow: `inset 0 0 ${!canEquipItem ? '3px' : '12px'} ${\r\n              item.rarity !== 'common' && canEquipItem\r\n                ? Color(rarityColor).fade(0.5).hsl().toString()\r\n                : 'black'\r\n            }`,\r\n          }}\r\n          substyle={{\r\n            background: 'transparent',\r\n            cursor: canEquipItem ? 'pointer' : 'default',\r\n            borderColor: isHovering\r\n              ? rarityColor\r\n              : item.rarity === 'common'\r\n              ? '#555'\r\n              : Color(rarityColor).fade(0.5).hsl().toString(),\r\n            boxShadow: canEquipItem ? 'inset 0 0 3px black' : 'none',\r\n            display: 'flex',\r\n            padding: 0,\r\n            justifyContent: 'center',\r\n            alignItems: 'center',\r\n            margin: 0,\r\n            opacity: canEquipItem ? 1 : 0.5,\r\n          }}\r\n          onClick={(event) => {\r\n            event.preventDefault()\r\n            event.stopPropagation()\r\n            if (isEquipable) {\r\n              onEquip(item.id)\r\n            }\r\n          }}\r\n        >\r\n          {icon}\r\n        </BoxContainer>\r\n      </Tooltip>\r\n    </div>\r\n  )\r\n}\r\n","import React, { useMemo } from 'react'\r\nimport { BoxContainer } from '../../elements/box'\r\n\r\nimport { Icon } from '../Icon'\r\nimport { FlexContainer } from '../../elements/flex'\r\n\r\nexport interface SidebarOptionT {\r\n  key: string\r\n  icon: string\r\n  Component: React.FC\r\n}\r\n\r\nexport interface SidebarPropsT {\r\n  activeKey: string | undefined\r\n  setActiveKey: (key?: string) => void\r\n  options: SidebarOptionT[]\r\n  direction?: 'right' | 'left'\r\n}\r\nexport const Sidebar = (props: SidebarPropsT) => {\r\n  const { activeKey, setActiveKey, options, direction = 'right' } = props\r\n  const activeOption = useMemo(() => options.find((o) => o.key === activeKey), [\r\n    activeKey,\r\n  ])\r\n  return (\r\n    <BoxContainer\r\n      substyle={{\r\n        display: 'flex',\r\n        flexDirection: direction === 'right' ? 'row' : 'row-reverse',\r\n        padding: 0,\r\n      }}\r\n    >\r\n      <FlexContainer\r\n        $direction='column'\r\n        style={{\r\n          width: 60,\r\n        }}\r\n      >\r\n        {options.map((option, i) => (\r\n          <div\r\n            key={option.key}\r\n            style={{\r\n              height: 60,\r\n              width: 60,\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              cursor: 'pointer',\r\n              boxSizing: 'border-box',\r\n              backgroundColor:\r\n                activeKey === option.key ? '#111' : 'transparent',\r\n              borderTop: i === 0 ? 'none' : '1px solid #555',\r\n              borderBottom: '1px solid black',\r\n              borderRight:\r\n                direction === 'right'\r\n                  ? activeKey && activeKey !== option.key\r\n                    ? '1px solid #555'\r\n                    : 'none'\r\n                  : 'none',\r\n              borderLeft:\r\n                direction === 'left'\r\n                  ? activeKey && activeKey !== option.key\r\n                    ? '1px solid #555'\r\n                    : 'none'\r\n                  : 'none',\r\n            }}\r\n            onClick={(e) => {\r\n              e.preventDefault()\r\n              e.stopPropagation()\r\n              setActiveKey(activeKey === option.key ? undefined : option.key)\r\n            }}\r\n          >\r\n            <Icon src={option.icon} size={24} />\r\n          </div>\r\n        ))}\r\n        <FlexContainer\r\n          $full\r\n          style={{\r\n            borderTop: '1px solid #555',\r\n            borderRight:\r\n              direction === 'right'\r\n                ? activeKey !== undefined\r\n                  ? '1px solid #555'\r\n                  : 'none'\r\n                : 'none',\r\n            borderLeft:\r\n              direction === 'left'\r\n                ? activeKey !== undefined\r\n                  ? '1px solid #555'\r\n                  : 'none'\r\n                : 'none',\r\n          }}\r\n        />\r\n      </FlexContainer>\r\n      {activeOption && (\r\n        <div\r\n          style={{\r\n            padding: 8,\r\n            backgroundColor: '#111',\r\n            overflow: 'auto',\r\n          }}\r\n        >\r\n          <activeOption.Component />\r\n        </div>\r\n      )}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { RollLog } from '../RollLog'\r\nimport Dice6 from '../../icons/svg/delapouite/dice-six-faces-six.svg'\r\nimport Attack from '../../icons/svg/cathelineau/swordman.svg'\r\nimport Items from '../../icons/svg/lorc/swap-bag.svg'\r\nimport Skills from '../../icons/svg/delapouite/skills.svg'\r\nimport Mods from '../../icons/svg/delapouite/crystal-shrine.svg'\r\nimport { CharacterItems } from '../CharacterItems'\r\nimport { AttackLog } from '../AttackLog'\r\nimport { useUIContext } from '../../contexts/UIContext'\r\nimport { SidebarOptionT, Sidebar } from '../Sidebar'\r\nimport { PartySkills } from '../PartySkills'\r\nimport { PartyMods } from '../PartyMods'\r\n\r\nexport const options: SidebarOptionT[] = [\r\n  {\r\n    key: 'roll-log',\r\n    icon: Dice6,\r\n    Component: RollLog,\r\n  },\r\n  {\r\n    key: 'attack-log',\r\n    icon: Attack,\r\n    Component: AttackLog,\r\n  },\r\n  {\r\n    key: 'items',\r\n    icon: Items,\r\n    Component: CharacterItems,\r\n  },\r\n  {\r\n    key: 'skills',\r\n    icon: Skills,\r\n    Component: PartySkills,\r\n  },\r\n  {\r\n    key: 'mods',\r\n    icon: Mods,\r\n    Component: PartyMods,\r\n  },\r\n]\r\n\r\nexport interface AppLogPropsT {}\r\nexport const AppLog = (props: AppLogPropsT) => {\r\n  const { logKey, setLogKey } = useUIContext()\r\n  return (\r\n    <Sidebar\r\n      activeKey={logKey}\r\n      setActiveKey={setLogKey}\r\n      options={options}\r\n      direction='left'\r\n    />\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { RollResult } from '../RollResult'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { Icon } from '../Icon'\r\nimport Dice6 from '../../icons/svg/delapouite/dice-six-faces-six.svg'\r\n\r\nexport interface RollLogPropsT {}\r\nexport const RollLog = (props: RollLogPropsT) => {\r\n  const { history, execRoll } = useRollContext()\r\n  const [text, setText] = useState('')\r\n  const [submitLog, setSubmitLog] = useState<string[]>([])\r\n  const [index, setIndex] = useState(0)\r\n  const submit = () => {\r\n    try {\r\n      execRoll({ string: text, keys: [], modifier: 0 }, true, true)\r\n      setSubmitLog([...submitLog, text])\r\n      setIndex(submitLog.length)\r\n    } catch (e) {\r\n      alert(e)\r\n    } finally {\r\n      setText('')\r\n    }\r\n  }\r\n  return (\r\n    <FlexContainer $direction='column' $full style={{ width: 400 }}>\r\n      {history.length > 0 ? (\r\n        <FlexContainer\r\n          $full\r\n          $direction='column'\r\n          style={{ overflow: 'auto', padding: 10 }}\r\n        >\r\n          {history.map((roll) => (\r\n            <React.Fragment key={roll.id}>\r\n              <RollResult key={roll.id} roll={roll} />\r\n            </React.Fragment>\r\n          ))}\r\n        </FlexContainer>\r\n      ) : (\r\n        <FlexContainer $full />\r\n      )}\r\n      <FlexContainer>\r\n        <input\r\n          value={text}\r\n          style={{ flex: 1 }}\r\n          onChange={(e) => setText(e.target.value)}\r\n          onKeyDown={(e) => {\r\n            if (e.keyCode === 13) {\r\n              submit()\r\n            }\r\n            if (e.keyCode === 38) {\r\n              setText(submitLog[index] || '')\r\n              setIndex(index - 1)\r\n            }\r\n          }}\r\n        />\r\n        <button onClick={submit}>\r\n          <Icon src={Dice6} size={18} fill='#4bebc6' />\r\n        </button>\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React, { useRef, useEffect } from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { useCombatLogContext } from '../../contexts/CombatLogContext'\r\n\r\nexport const AttackLog = () => {\r\n  // const { attackResults, clear } = useAttackContext()\r\n  const { lines, clear } = useCombatLogContext()\r\n  const scrollRef = useRef<HTMLDivElement>(null)\r\n  useEffect(() => {\r\n    if (scrollRef.current) {\r\n      scrollRef.current.scrollIntoView({ behavior: 'smooth' })\r\n    }\r\n  }, [lines])\r\n  return (\r\n    <FlexContainer\r\n      $direction='column'\r\n      $full\r\n      style={{ overflow: 'auto', padding: 10, overflowY: 'auto' }}\r\n    >\r\n      <button onClick={clear} style={{ marginBottom: 20 }}>\r\n        Clear Log\r\n      </button>\r\n      <FlexContainer\r\n        $direction='column'\r\n        $full\r\n        style={{\r\n          color: 'rgba(200,200,200, 1)',\r\n          background: '#111',\r\n          width: 380,\r\n          overflowX: 'auto',\r\n        }}\r\n      >\r\n        {lines.map((l, i) => (\r\n          <pre key={i}>{l}</pre>\r\n        ))}\r\n        <div ref={scrollRef} />\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { SkillPreviewAlt } from '../SkillPreviewAlt'\r\n\r\nexport const PartySkills = () => {\r\n  const { userParty } = usePartyContext()\r\n  return (\r\n    <FlexContainer style={{ width: 320, flexWrap: 'wrap' }}>\r\n      {userParty.skills.map((skill) => (\r\n        <SkillPreviewAlt skill={skill} />\r\n      ))}\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { ModPreview } from '../ModPreview'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\n\r\nexport const PartyMods = () => {\r\n  const { rawCharacter } = useCharacterContext()\r\n  const { userParty, equipMod } = usePartyContext()\r\n  return (\r\n    <FlexContainer $direction='column'>\r\n      {userParty.mods.map((mod) => (\r\n        <ModPreview\r\n          key={mod.id}\r\n          mod={mod}\r\n          onEquip={(modId) => {\r\n            equipMod(rawCharacter.id, modId)\r\n          }}\r\n        />\r\n      ))}\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { Route } from 'react-router-dom'\r\n\r\nexport const makeRoute = (path: string, Component: React.FC) => (\r\n  <Route path={path}>\r\n    <Component />\r\n  </Route>\r\n)\r\n","import React from 'react'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { ProcessedCharacterT } from '../../types/Character'\r\nimport { BoxButton } from '../../elements/box'\r\n\r\nimport CharactersIcon from '../../icons/svg/lorc/two-shadows.svg'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport { makeCharacter } from '../../objects/makeCharacter'\r\nimport { Sidebar, SidebarOptionT } from '../Sidebar'\r\nimport { useUIContext } from '../../contexts/UIContext'\r\n\r\nexport const MAIN_OPTIONS: SidebarOptionT[] = [\r\n  {\r\n    key: 'characters',\r\n    icon: CharactersIcon,\r\n    Component: () => <AppSidebarCharacters />,\r\n  },\r\n]\r\n\r\nexport interface AppSidebarPropsT {}\r\nexport const AppSidebar = (props: AppSidebarPropsT) => {\r\n  const { sidebarKey, setSidebarKey } = useUIContext()\r\n  return (\r\n    <Sidebar\r\n      options={MAIN_OPTIONS}\r\n      direction='right'\r\n      activeKey={sidebarKey}\r\n      setActiveKey={setSidebarKey}\r\n    />\r\n  )\r\n}\r\n\r\nconst AppSidebarCharacters = () => {\r\n  const { userParty, upsertCharacter } = usePartyContext()\r\n  const history = useHistory()\r\n  return (\r\n    <FlexContainer $direction='column'>\r\n      {userParty.characters.map((character: ProcessedCharacterT) => (\r\n        <Link\r\n          key={character.id}\r\n          to={`/characters/${character.id}`}\r\n          style={{\r\n            padding: 8,\r\n          }}\r\n        >\r\n          {character.name}\r\n        </Link>\r\n      ))}\r\n      {userParty.characters.length < 4 && (\r\n        <BoxButton\r\n          onClick={() => {\r\n            const newCharacter = makeCharacter('new character')\r\n            upsertCharacter(newCharacter)\r\n            history.push(`/characters/${newCharacter.id}`)\r\n          }}\r\n        >\r\n          Add New Character\r\n        </BoxButton>\r\n      )}\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { PartyT } from '../../types/Party'\r\nimport {\r\n  CharacterContextProvider,\r\n  useCharacterContext,\r\n} from '../../contexts/CharacterContext'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { CharacterDetails } from '../CharacterDetails'\r\nimport { CombatCharacterSkills } from '../CombatCharacterSkills'\r\nimport { useCombatContext } from '../../contexts/CombatContext'\r\nimport { PC_PARTY_ID } from '../../state/parties'\r\nimport { CombatCharacterTargets } from '../CombatCharacterTargets'\r\nimport { processCharacter, ProcessedCharacterT } from '../../types/Character'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { getSkillRange } from '../../types/Skill'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { BASIC_ATTACK } from '../../objects/makeSkill'\r\nimport {\r\n  ZERO_CHECK,\r\n  reduceCharacterCheck,\r\n  getCheckProbability,\r\n  makeCharacterCheck,\r\n} from '../../types/Roll2'\r\n\r\nexport interface CombatPartyPropsT {\r\n  party: PartyT\r\n}\r\nexport const CombatParty = (props: CombatPartyPropsT) => {\r\n  const { party } = props\r\n  const { upsertCharacter } = usePartyContext()\r\n  const {\r\n    userParty,\r\n    enemyParty,\r\n    characterSkills,\r\n    setCharacterSkill,\r\n    characterTargets,\r\n    setCharacterTarget,\r\n  } = useCombatContext()\r\n  if (!party || !userParty || !enemyParty) return <div>Loading...</div>\r\n\r\n  const characters = [...userParty.characters, ...enemyParty.characters]\r\n  return (\r\n    <div>\r\n      {party.characters.map((character) => (\r\n        <CharacterContextProvider\r\n          key={character.id}\r\n          character={character}\r\n          onChange={(c) => upsertCharacter(c, party.id)}\r\n        >\r\n          <FlexContainer\r\n            style={{\r\n              position: 'relative',\r\n              opacity: processCharacter(character).dead ? 0.5 : 1,\r\n            }}\r\n          >\r\n            <FlexContainer\r\n              $direction='column'\r\n              $full\r\n              style={{\r\n                marginBottom: 10,\r\n              }}\r\n            >\r\n              <CharacterDetails\r\n                showInspect={\r\n                  character.inspected ||\r\n                  character.partyId === PC_PARTY_ID ||\r\n                  processCharacter(character).dead\r\n                }\r\n                showWeaponInspect={\r\n                  character.inspected ||\r\n                  character.partyId === PC_PARTY_ID ||\r\n                  processCharacter(character).dead\r\n                }\r\n                showSkills={party.id === PC_PARTY_ID}\r\n              />\r\n            </FlexContainer>\r\n            {character.partyId === PC_PARTY_ID && (\r\n              <FlexContainer\r\n                $direction='column'\r\n                style={{\r\n                  fontFamily: 'monospace',\r\n                  width: 80,\r\n                }}\r\n              >\r\n                <FullContainer />\r\n                <SelectedDamageRange\r\n                  skillId={characterSkills[character.id]}\r\n                  targetId={characterTargets[character.id]}\r\n                  characters={characters}\r\n                />\r\n                <FullContainer />\r\n              </FlexContainer>\r\n            )}\r\n          </FlexContainer>\r\n        </CharacterContextProvider>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\ninterface SelectedDamageRangePropsT {\r\n  skillId?: string\r\n  targetId?: string\r\n  characters: ProcessedCharacterT[]\r\n}\r\nconst SelectedDamageRange = (props: SelectedDamageRangePropsT) => {\r\n  const { skillId, targetId, characters } = props\r\n  const { character } = useCharacterContext()\r\n  const skill = character.skills.find((s) => s.id === skillId) || BASIC_ATTACK\r\n  const target = characters.find((c) => c.id === targetId)\r\n  if (!target && skill.target) return null\r\n  const range = getSkillRange(skill, character, target)\r\n  const prob = getCheckProbability(\r\n    reduceCharacterCheck(\r\n      skill.combineWeaponDamage\r\n        ? character.weapon.accuracyCheck\r\n        : skill.check || { ...ZERO_CHECK, keys: [] },\r\n      character,\r\n    ),\r\n  )\r\n  const dodgeProb =\r\n    skill.target && target\r\n      ? getCheckProbability(\r\n          reduceCharacterCheck(makeCharacterCheck(['evade']), target),\r\n        )\r\n      : 0\r\n  return (\r\n    <BoxContainer\r\n      style={{ textAlign: 'center', fontWeight: 'bold', borderLeft: 'none' }}\r\n      substyle={{ borderLeft: 'none', background: '#111' }}\r\n    >\r\n      {range && range !== '0' && (\r\n        <div style={{ marginBottom: 5 }}>({range})</div>\r\n      )}\r\n      <div style={{ fontSize: 20 }}>{Math.floor(prob - dodgeProb)}%</div>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import {\r\n  CharacterCheckT,\r\n  CharacterRollT,\r\n  Roll2ResultT,\r\n  resolveCharacterRoll,\r\n} from './Roll2'\r\nimport { DamageTypeRollsT, rollDamage, getDamageTypeKeys } from './Damage'\r\nimport { CharacterTraitT, ProcessedCharacterT } from './Character'\r\nimport { EventsT } from './Events'\r\nimport { getSkillDamageRolls } from '../contexts/CombatContext/util'\r\nimport { noneg } from '../util/noneg'\r\n\r\nexport interface SkillT {\r\n  id: string\r\n  name: string\r\n  imgSrc: string\r\n  check?: CharacterCheckT\r\n  requirementCheck: CharacterCheckT\r\n  damageRolls: DamageTypeRollsT\r\n  targetTraits: CharacterTraitT[]\r\n  sourceTraits: CharacterTraitT[]\r\n  events: EventsT\r\n  combineWeaponDamage: boolean\r\n  checkDodgeForTraits: boolean\r\n  focusCost: number\r\n  inspected?: true\r\n  target: boolean\r\n}\r\n\r\nexport const getSkillRange = (\r\n  skill: SkillT,\r\n  source: ProcessedCharacterT,\r\n  target?: ProcessedCharacterT,\r\n): string | undefined => {\r\n  if (!target) return undefined\r\n  let min = 0\r\n  let max = 0\r\n  const damageRolls = getSkillDamageRolls(skill, source.weapon)\r\n  const rr = (r: CharacterRollT) => resolveCharacterRoll(r, source)\r\n  const damageRollsResult = rollDamage(rr)(damageRolls, false)\r\n  const damageResults = damageRollsResult.rollResults\r\n  const { damageResistances } = target\r\n  const damageKeys = getDamageTypeKeys(damageResults).filter(\r\n    (k) => damageResults[k],\r\n  )\r\n  damageKeys.forEach((key) => {\r\n    const damageResult = damageResults[key] as Roll2ResultT\r\n    const resistanceCheck = damageResistances[key] as CharacterRollT\r\n    const resistanceResult = resolveCharacterRoll(resistanceCheck, source, true)\r\n    min += noneg(damageResult.minTotal - resistanceResult.maxTotal)\r\n    max += noneg(damageResult.maxTotal - resistanceResult.minTotal)\r\n  })\r\n  if (min === max) return `${max}`\r\n  return `${min}-${max}`\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { useCombatContext } from '../../contexts/CombatContext'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { CombatParty } from '../../components/CombatParty'\r\nimport { useUIContext } from '../../contexts/UIContext'\r\nimport { useEvent } from '../../hooks/useEvent'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport BG from '../../assets/img/23761.jpg'\r\n\r\nexport const Combat = () => {\r\n  const {\r\n    rawUserParty,\r\n    rawEnemyParty,\r\n    running,\r\n    done,\r\n    rounds,\r\n    start,\r\n    stop,\r\n    reset,\r\n    next,\r\n  } = useCombatContext()\r\n  const { setLogKey } = useUIContext()\r\n\r\n  useEffect(() => {\r\n    setLogKey('attack-log')\r\n    return () => {\r\n      setLogKey(undefined)\r\n    }\r\n  }, [])\r\n\r\n  return (\r\n    <FlexContainer\r\n      $full\r\n      $direction='column'\r\n      style={{\r\n        background: `url(${BG}) center center`,\r\n        backgroundSize: 'cover',\r\n      }}\r\n    >\r\n      <BoxContainer>\r\n        <FlexContainer style={{ alignItems: 'center' }}>\r\n          <div>{!done && <button onClick={() => next()}>Next</button>}</div>\r\n\r\n          <FullContainer />\r\n          <FlexContainer>Round {rounds.length + 1}</FlexContainer>\r\n        </FlexContainer>\r\n      </BoxContainer>\r\n      <FlexContainer id='Combat' $full style={{ padding: 10 }}>\r\n        <CombatParty party={rawUserParty} />\r\n        <FlexContainer $full $direction='column'></FlexContainer>\r\n        <CombatParty party={rawEnemyParty} />\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React, { CSSProperties } from 'react'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { Link, useLocation } from 'react-router-dom'\r\n\r\nconst activeStyles: CSSProperties = {\r\n  background: '#111',\r\n  boxShadow: 'inset 0 0 3px black',\r\n}\r\nconst inactiveStyles: CSSProperties = {\r\n  backgroundColor: '#333',\r\n}\r\n\r\nexport const AppHeader = () => {\r\n  const location = useLocation()\r\n  const { pathname } = location\r\n  const chunks = pathname.split('/')\r\n  const check = (paths: string[]): CSSProperties =>\r\n    paths.includes(chunks[1]) ? activeStyles : inactiveStyles\r\n  return (\r\n    <BoxContainer\r\n      substyle={{\r\n        height: 64,\r\n        padding: 0,\r\n        alignItems: 'center',\r\n        display: 'flex',\r\n      }}\r\n    >\r\n      <div\r\n        style={{\r\n          fontFamily: 'monospace',\r\n          fontSize: 24,\r\n          margin: '0 30px',\r\n        }}\r\n      >\r\n        rpgjs\r\n      </div>\r\n      {/*\r\n      <BoxContainer\r\n        tag={Link}\r\n        to=''\r\n        style={{\r\n          height: '100%',\r\n        }}\r\n        substyle={{\r\n          padding: '0 20px',\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          ...check(['', 'characters']),\r\n        }}\r\n      >\r\n        character\r\n      </BoxContainer>\r\n      */}\r\n      <BoxContainer\r\n        tag={Link}\r\n        to='/battle'\r\n        style={{\r\n          height: '100%',\r\n        }}\r\n        substyle={{\r\n          padding: '0 20px',\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          ...check(['battle']),\r\n        }}\r\n      >\r\n        battle\r\n      </BoxContainer>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { Switch } from 'react-router-dom'\r\n\r\nimport { CharacterStateContextProvider } from './contexts/CharacterContext'\r\n\r\nimport { Character } from './domain'\r\n\r\nimport { FlexContainer } from './elements/flex'\r\nimport { AppLog } from './components/ApplicationLog'\r\nimport { makeRoute } from './routes'\r\nimport { PartyContextProvider } from './contexts/PartyContext'\r\nimport { AppSidebar, MAIN_OPTIONS } from './components/AppSidebar'\r\nimport { Combat } from './domain/Combat'\r\nimport { CombatContextProvider } from './contexts/CombatContext'\r\nimport { AppHeader } from './components/AppHeader'\r\nimport { CombatLogContextProvider } from './contexts/CombatLogContext'\r\nimport { ModalContextProvider } from './contexts/ModalContext'\r\nimport { UIContextProvider } from './contexts/UIContext'\r\n\r\nexport const App = () => {\r\n  return (\r\n    <div\r\n      style={{\r\n        height: '100%',\r\n        width: '100%',\r\n        display: 'flex',\r\n      }}\r\n    >\r\n      <UIContextProvider>\r\n        <ModalContextProvider>\r\n          <PartyContextProvider>\r\n            <CharacterStateContextProvider>\r\n              <CombatLogContextProvider>\r\n                <FlexContainer $full $direction='column' id='content-root'>\r\n                  <AppHeader />\r\n                  <FlexContainer\r\n                    $full\r\n                    style={{\r\n                      height: 'calc(100% - 70px)',\r\n                      width: '100vw',\r\n                      overflow: 'auto',\r\n                    }}\r\n                  >\r\n                    <AppSidebar />\r\n                    <FlexContainer $full style={{ overflow: 'auto' }}>\r\n                      <Switch>\r\n                        {makeRoute('/battle', () => (\r\n                          <CombatContextProvider>\r\n                            <Combat />\r\n                          </CombatContextProvider>\r\n                        ))}\r\n                        {makeRoute('/characters/:id', () => (\r\n                          <Character />\r\n                        ))}\r\n                        {makeRoute('/', () => (\r\n                          <Character />\r\n                        ))}\r\n                      </Switch>\r\n                    </FlexContainer>\r\n                    <AppLog />\r\n                  </FlexContainer>\r\n                </FlexContainer>\r\n              </CombatLogContextProvider>\r\n            </CharacterStateContextProvider>\r\n          </PartyContextProvider>\r\n        </ModalContextProvider>\r\n      </UIContextProvider>\r\n    </div>\r\n  )\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { App } from './App'\nimport * as serviceWorker from './serviceWorker'\nimport './index.css'\n\nimport { Provider as StyletronProvider, DebugEngine } from 'styletron-react'\nimport { Client as Styletron } from 'styletron-engine-atomic'\n\nimport { Provider as ReduxProvider } from 'react-redux'\nimport { makeStore } from './state'\n\nimport { BrowserRouter as Router } from 'react-router-dom'\n\nconst debug = process.env.NODE_ENV === 'production' ? void 0 : new DebugEngine()\nconst engine: Styletron = new Styletron()\nconst store = makeStore()\n\nReactDOM.render(\n  <React.StrictMode>\n    <ReduxProvider store={store}>\n      <StyletronProvider value={engine} debug={debug} debugAfterHydration>\n        <Router>\n          <App />\n        </Router>\n      </StyletronProvider>\n    </ReduxProvider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n","import { createStore, combineReducers, compose, applyMiddleware } from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport rolls from './rolls'\r\nimport parties from './parties'\r\n\r\nexport const makeStore = () =>\r\n  createStore(\r\n    combineReducers({ rolls, parties }),\r\n    compose(applyMiddleware(thunk)),\r\n  )\r\n"],"sourceRoot":""}