{"version":3,"sources":["icons/svg/delapouite/dice-six-faces-six.svg","icons/svg/lorc/emerald.svg","icons/svg/delapouite/sword-brandish.svg","icons/svg/lorc/shard-sword.svg","icons/svg/lorc/spiral-thrust.svg","assets/img/healing1.png","assets/img/fireball.png","assets/img/thunderbolt.png","assets/img/dark-blast.png","assets/img/crippling-blow.png","assets/img/wrath.png","assets/img/charge.png","assets/img/headshot.png","assets/img/shadow-strike.png","assets/img/vanish.png","assets/img/inspect.png","assets/img/weapon-attack.png","icons/svg/lorc/aura.svg","icons/svg/lorc/barbute.svg","icons/svg/delapouite/muscular-torso.svg","icons/svg/sbed/hand.svg","icons/svg/delapouite/ring.svg","icons/svg/lorc/footprint.svg","icons/svg/lorc/quick-slash.svg","icons/svg/lorc/barbed-arrow.svg","icons/svg/carl-olsen/flame.svg","icons/svg/lorc/bleeding-eye.svg","icons/svg/lorc/moebius-trefoil.svg","icons/svg/lorc/triorb.svg","icons/svg/skoll/fist.svg","icons/svg/lorc/fire-axe.svg","icons/svg/delapouite/war-axe.svg","icons/svg/lorc/stiletto.svg","icons/svg/lorc/croc-sword.svg","icons/svg/delapouite/flail.svg","icons/svg/lorc/crossed-swords.svg","icons/svg/delapouite/katana.svg","icons/svg/lorc/sword-hilt.svg","icons/svg/willdabeast/orb-wand.svg","icons/svg/lorc/wizard-staff.svg","icons/svg/skoll/luger.svg","icons/svg/carl-olsen/crossbow.svg","icons/svg/lorc/bloody-sword.svg","icons/svg/lorc/winged-sword.svg","icons/svg/delapouite/closed-barbute.svg","icons/svg/lorc/hood.svg","icons/svg/delapouite/shoulder-armor.svg","icons/svg/lorc/robe.svg","icons/svg/delapouite/gloves.svg","icons/svg/delapouite/power-ring.svg","icons/svg/lorc/boots.svg","icons/svg/lorc/magnifying-glass.svg","icons/svg/lorc/tombstone.svg","icons/svg/delapouite/pencil.svg","icons/svg/delapouite/save.svg","icons/svg/delapouite/trash-can.svg","assets/img/roll.png","assets/img/forest-931706_1920.jpg","icons/svg/cathelineau/swordman.svg","icons/svg/lorc/swap-bag.svg","icons/svg/delapouite/skills.svg","icons/svg/delapouite/crystal-shrine.svg","icons/svg/lorc/two-shadows.svg","assets/img/23761.jpg","util/getKeys.ts","util/notZero.ts","util/getSign.ts","util/noneg.ts","types/Roll2.ts","types/Damage.ts","util/reduce.ts","types/Events.ts","types/Weapon.ts","objects/util.ts","objects/fists.ts","types/Character.ts","objects/baseCharacter.ts","types/Party.ts","state/util.ts","util/updateIn.ts","util/getRandom.ts","objects/builders/armor/names.ts","objects/builders/util.ts","objects/builders/armor/stats.ts","objects/builders/armor/uniques/index.ts","objects/builders/armor/mythics/index.ts","objects/builders/armor/sets/index.ts","objects/builders/armor/createArmor.ts","objects/builders/weapons/stats.ts","objects/builders/weapons/createWeapon.ts","objects/makeSkill.ts","objects/makeCharacter.ts","objects/builders/weapons/mythics/index.ts","objects/builders/mods/index.tsx","state/parties/index.ts","hooks/useActions.ts","contexts/PartyContext/index.tsx","state/rolls/index.ts","contexts/RollContext/index.tsx","contexts/CharacterContext/index.tsx","elements/flex.ts","icons/maps.tsx","components/Icon/index.tsx","components/Hover/index.tsx","elements/box.tsx","components/ResourceScore/index.tsx","elements/monospace.tsx","components/AbilityScore/index.tsx","components/StatScore/index.tsx","components/DamageResistanceScore/index.tsx","util/compare.ts","components/TraitScore/index.tsx","util/getValueString.ts","components/CheckPreview/index.tsx","components/ArmorIcon/index.tsx","types/Item.ts","components/ItemIcon/index.tsx","components/ItemPreview/index.tsx","types/Armor.ts","components/WeaponIcon/index.tsx","components/DamageRollScores/index.tsx","components/ModPreview/index.tsx","components/Tooltip/index.tsx","components/WeaponPreview/index.tsx","components/ItemPreviewSmall/index.tsx","components/ArmorScoreList/index.tsx","components/Gauge/index.tsx","components/CharacterInspect/index.tsx","components/SkillPreview/index.tsx","components/CombatCharacterSkills/index.tsx","objects/makeNpc.ts","objects/makeParty.ts","contexts/CombatContext/log.tsx","contexts/CombatContext/util.tsx","contexts/CombatLogContext/index.tsx","contexts/ModalContext/reducer.ts","contexts/ModalContext/index.tsx","objects/builders/makeItem.ts","components/CombatVictoryModal/index.tsx","components/CombatLossModal/index.tsx","contexts/CombatContext/index.tsx","components/CombatCharacterTargets/index.tsx","components/CharacterDetails/index.tsx","contexts/UIContext/index.tsx","components/SkillPreviewAlt/index.tsx","components/CharacterHeader/index.tsx","util/sortById.ts","domain/Character/index.tsx","components/RollResult/index.tsx","contexts/CompareContext/index.tsx","components/WeaponCompare/index.tsx","components/ItemCompare/index.tsx","components/CharacterItemFilters/index.tsx","components/CharacterItems/index.tsx","components/Sidebar/index.tsx","components/ApplicationLog/index.tsx","components/RollLog/index.tsx","components/AttackLog/index.tsx","components/PartySkills/index.tsx","components/PartyMods/index.tsx","routes/index.tsx","components/AppSidebar/index.tsx","components/CombatParty/index.tsx","types/Skill.ts","domain/Combat/index.tsx","components/AppHeader/index.tsx","App.tsx","serviceWorker.ts","index.tsx","state/index.ts"],"names":["module","exports","getKeys","obj","Object","keys","notZero","value","content","getSign","noneg","THREE_D6_DIST","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","processRollString","rollString","split","map","roll","n","d","parseInt","getModifierString","modifier","Math","abs","resolveRoll","allowNegatives","string","combineRollStrings","result","DiceRoll","id","v4","total","output","criticalSuccess","minTotal","criticalFailure","maxTotal","averageTotal","quickRoll","str","mod","getCheckProbability","check","resolveCheck","rollResult","chance","goal","ZERO_ROLL","THREE_D6","ZERO_CHECK","makeCharacterRoll","makeCharacterCheck","undefined","makeStandardCharacterCheck","rolls","list","filter","r","reduce","p","c","forEach","pRoll","i","combineRolls","combineCharacterRolls","reduceCharacterRoll","character","keyValue","getModifierValueFromKeys","reduceCharacterCheck","resolveCharacterRoll","resolveCharacterCheck","getRollRange","getRollText","length","hasMod","keyString","plus","CharacterKeyMap3","modString","DamageTypeKeyColors","slashing","piercing","fire","blood","light","dark","getDamageTypeKeys","rollDamage","crit","label","key","rollResults","ZERO_DAMAGE_ROLLS","combineDamageTypeRolls","ret","reducer","initialValue","EventsTypeMap","onHit","onCrit","force","traits","combineEvents","events","ZERO_WEAPON_TRAIT","accuracyOffset","damageRolls","combineWeaponTraits","processWeapon","weapon","processed","Error","mods","slots","combinedTrait","accuracyCheck","makeRequirementCheck","BASE_EQUIPPABLE","type","rarity","equippable","name","cost","resource","requirementCheck","duration","healthOffset","focusOffset","abilitiesModifiers","strength","dexterity","intelligence","vigor","statsModifiers","health","focus","will","perception","agility","accuracy","evade","damageResistances","makeTrait","FISTS","weaponType","slotCount","getTraits","armorTraits","armor","item","equippedItemTraits","equippedItems","getAbilities","trait","cur","abilities","getStats","getDamageResistances","a","processCharacter","withWeapon","stats","dead","commitTrait","s","setCharacterAbilityScore","characterPoints","resources","validateCharacter","power","characterAbilityScoreCosts","canEquip","equipable","processedCharacter","unequipItem","validate","itemId","equippables","unequipWeapon","find","unequipArmor","unequipGenericItem","vr","equipGenericItem","resourceValue","equipArmor","equipWeapon","weaponHands","getTraitValue","abilityValue","statValue","combineTraits","current","ar","ac","sr","sc","pc","removedItems","localUpdate","unequipResult","items","BASE_CHARACTER","heads","bodies","hands","fingers","feet","skills","inspected","processParty","party","characters","partyId","makeReducer","core","initialState","state","action","coreFn","upsertIn","updateIn","accessor","getRandom","floor","random","ArmorUniqueNames","shuffleArray","array","j","Rarity3d6Map","18","getItemStatRolls","count","requirementScore","offset","statCount","statRolls","ArmorRequirementKeys","helmet","cowl","chestplate","robe","gloves","ring","boots","ArmorCostsT","ArmorResourcesT","armorStatKeysBase","ArmorRarityStatKeys","common","uncommon","rare","legendary","unique","mythic","set","ArmorRarityStatCounts","makeStaticRoll","makeRoll","UNIQUE_ARMORS","MYTHIC_ARMORS","SET_ARMORS","buildArmor","armorType","createArmor","getArmorStatRolls","base","WeaponRequirementKeys","fists","axe","greataxe","flail","daggers","katana","rapier","wand","staff","elementalSword","elementalGreatsword","sword","greatsword","pistol","crossbow","WeaponCosts","weaponStatKeysBase","WeaponRarityStatKeys","WeaponRarityStatCounts","makeDamageRoll","modCoef","buildWeapon","createWeapon","getWeaponStatRolls","element","WeaponDamages","accuracyModifier","rest","makeSkill","imgSrc","targetTraits","sourceTraits","combineWeaponDamage","checkDodgeForTraits","focusCost","target","BASIC_ATTACK","WeaponAttack","INSPECT","Inspect","FIREBALL","Fireball","CRIPPLING_BLOW","CripplingBlow","THUNDERBOLT","Thunderbolt","DARK_BLAST","DarkBlast","HEALING","Healing","WRATH","Wrath","CHARGE","Charge","SKILL_SHOT","SkillShot","VANISH","Vanish","SHADOW_STRIKE","ShadowStrike","makeCharacter","SWORD_OF_BLOOD_AND_FIRE","SWORD_OF_THE_INFINITE","SLASHING_MOD","actionCreators","payload","characterId","modId","actions","upsertParty","dispatch","upsertCharacter","deleteCharacter","upsertItem","removeItem","upsertMod","deleteMod","equipItem","getState","parties","_character","equipMod","m","unequipMod","console","log","max","katie","milo","PC_PARTY_ID","INITIAL_STATE","usePartiesActions","deps","useDispatch","useMemo","bindActionCreators","useActions","defaultContextValue","rawParties","userParty","rawUserParty","activeCharacterId","findCharacter","findRawCharacter","setActiveCharacterId","PartyContext","React","createContext","PartyContextProvider","props","children","useSelector","useState","Provider","usePartyContext","useContext","RollContext","history","execRoll","execCheck","rollCharacter","checkCharacter","getProbability","useRollContext","RollContextProvider","addRoll","characterContext","useCharacterContext","RollStateContextProvider","CharacterContext","rawCharacter","onChange","CharacterContextProvider","CharacterStateContextProvider","FlexContainer","styled","display","flexDirection","$direction","flex","$full","FullContainer","IconCharacterResourceMap","WeaponHands","CharacterPoints","Heads","Bodies","Hands","Finger","Feet","IconDamageTypeMap","Slashing","Piercing","Fire","Blood","Light","Dark","IconItemTypeMap","offhand","IconWeaponTypeMap","Fists","Axe","GreatAxe","Flail","Daggers","Katana","Rapier","Wand","Staff","FireSword","DarkSword","Sword","Greatsword","Pistol","Crossbow","IconUniqueWeaponMap","BloodSword","LightSword","IconArmorTypeMap","Helmet","Cowl","Armor","Robe","Gloves","Ring","Boots","Icon","src","size","style","fill","onClick","loading","setLoading","svg","setSvg","useEffect","fetch","then","res","text","height","width","dangerouslySetInnerHTML","__html","Hover","delay","internalHovering","setInternalHovering","isHovering","setIsHovering","guid","setGuid","useLayoutEffect","setTimeout","onMouseEnter","e","preventDefault","stopPropagation","onMouseLeave","BoxContainer","substyle","tag","Element","border","boxSizing","background","padding","color","boxShadow","SmallBox","justifyContent","alignItems","BoxButton","margin","borderColor","disabled","cursor","ResourceScore","iconUrl","fontFamily","fontSize","marginRight","Monospace","fontWeight","Monodiv","AbilityScore","edit","keyName","rawValue","displayValue","points","onIncrement","char","onDecrement","PureAbilityScore","whiteSpace","textShadow","StatScore","displayName","toLocaleUpperCase","DamageResistanceScore","rollText","ZERO_COMPARE","ONE_COMPARE","BASE_ARGS","getCompareFn","valueA","valueB","args","TraitScore","compareResult","abilityKeys","statKeys","getValueString","CheckPreview","showCheckButton","rollKeys","k","keyStr","rollStr","probability","Dice6","ArmorIcon","ItemRarityColorMap","ItemIcon","ItemPreview","showEquipButton","showRequirementCheck","showCollapseButton","collapsed","setCollapsed","requirementCompare","traitCompare","resistancesCompare","costComare","isArmor","rarityColor","Color","desaturate","fade","rgb","borderBottom","lineHeight","marginTop","marginBottom","flexWrap","ArmorTypeSortKey","WeaponIcon","icon","DamageRollScores","parent","damageRangeText","damageRollText","DamageRollScore","ModPreview","onEquip","weaponTrait","Mod","values","combinedRoll","Tooltip","direction","tagName","arrow","HoverToolTip","isOpen","WeaponPreview","showRequirement","accuracyCompare","damageCompare","borderBottomWidth","Array","_","ItemPreviewSmall","isEmpty","isWeapon","ArmorScoreList","rings","arr","sort","b","Gauge","percentage","position","left","maxWidth","minWidth","lighten","backgroundColor","transition","right","top","overflow","CharacterInspect","SkillPreview","skillId","skill","backgroundSize","CombatCharacterSkills","activeSkillId","active","opacity","CombatCharacterSkill","isDefault","randomNameConfig","dictionaries","adjectives","animals","separator","makeNpc","npc","uniqueNamesGenerator","makeParty","Span","bold","NameSpan","isUser","cz","v","gv","LogAddedTraits","attackResult","source","addLine","gfo","gho","ZERO_RESULT","sourceId","targetId","index","hitSuccess","dodgeSuccess","rawDamage","blockedDamage","totalDamage","cr","getSkillDamageRolls","execSkill","characterSkills","skillCheck","getSkillCheck","skillCheckResult","rr","damageRollsResult","dodgeRoll","damageResult","resistanceCheck","resistanceRoll","damageTotal","resolveRound","rounds","rawEnemyParty","updateCharacter","rawCharacters","updater","round","rawSource","rawTarget","logResult","getTraitUpdates","t","processEvent","event","addedTraits","skillTraits","checkEvent","checkParty","ENEMY_PARTY_ID","CombatLogContext","lines","line","clear","useCombatLogContext","CombatLogContextProvider","setLines","contents","callback","blocking","OPEN","CLOSE","coreFunction","ModalContext","open","close","setBlocking","setPayload","setContents","setCallback","setStyle","useModalContext","getContextValue","Modal","setAppElement","ModalContextProvider","reducerValue","useReducer","context","parentSelector","document","querySelector","onRequestClose","bottom","overlay","ITEM_TYPES","itemCore","makeWeapon","makeArmor","CombatVictoryModal","reset","chosenItemId","setChosenItemId","rewardChoices","makeItem","textAlign","CombatLossModal","wins","useHistory","push","enemyParty","done","characterTargets","setCharacterSkill","setCharacterTarget","next","CombatContext","useCombatContext","CombatContextProvider","setRounds","setWins","setCharacterSkills","setCharacterTargets","targets","setDone","started","setStarted","finish","didWin","w","activeSkill","checkCharacterActiveSkills","activeTarget","checkCharacterActiveTargets","partyA","partyB","bCharacters","getCombatRecordBuilder","builder","CombatCharacterTargets","activeTargetId","showRandom","cc","alt","Roll","CombatCharacterTarget","CharacterDetails","showEdit","showInspect","showWeaponInspect","showSkills","isEditing","setIsEditing","setName","Tombstone","Pencil","Save","Delete","borderTop","defaultValue","logKey","sidebarKey","setLogKey","setSidebarKey","UIContext","useUIContext","UIContextProvider","SkillPreviewAlt","activeStyles","inactiveStyles","CharacterHeader","borderLeft","borderRight","localeCompare","Link","to","Character","useParams","BG","RollResult","isCheck","CompareContext","compareChecks","checkA","checkB","compareRolls","rollA","rollB","compareValues","useCompareContext","CompareContextProvider","EquipedWeaponCompare","WeaponCompareItem","costComapre","weaponRoll","testRoll","weaponValue","testValue","EquipeItemCompare","testItem","ItemCompareItem","itemRoll","itemValue","CharacterItemFilters","CharacterItemFilterButton","hsl","toString","Item","isEquipable","canEquipItem","Sidebar","activeKey","setActiveKey","options","activeOption","o","option","Component","setText","submitLog","setSubmitLog","setIndex","submit","alert","Fragment","onKeyDown","keyCode","Attack","scrollRef","useRef","scrollIntoView","behavior","overflowY","overflowX","l","ref","Items","itemType","setItemType","itemRarity","setItemRarity","other","weapons","armors","Skills","Mods","AppLog","makeRoute","path","MAIN_OPTIONS","CharactersIcon","AppSidebar","AppSidebarCharacters","newCharacter","CombatParty","SelectedDamageRange","range","min","damageResults","resistanceResult","getSkillRange","prob","dodgeProb","Combat","_targetId","every","textTransform","tid","AppHeader","chunks","useLocation","pathname","paths","includes","App","Boolean","window","location","hostname","match","engine","Styletron","store","createStore","combineReducers","compose","applyMiddleware","thunk","ReactDOM","render","StrictMode","debug","debugAfterHydration","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"kGAAAA,EAAOC,QAAU,IAA0B,gD,wBCA3CD,EAAOC,QAAU,IAA0B,qC,yBCA3CD,EAAOC,QAAU,IAA0B,4C,sCCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,2C,iECA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,4C,gBCA3CD,EAAOC,QAAU,IAA0B,mC,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,2C,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,qC,gBCA3CD,EAAOC,QAAU,IAA0B,2C,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,qC,gBCA3CD,EAAOC,QAAU,IAA0B,4C,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,uC,gBCA3CD,EAAOC,QAAU,IAA0B,yC,gBCA3CD,EAAOC,QAAU,IAA0B,0C,gBCA3CD,EAAOC,QAAU,IAA0B,mC,gBCA3CD,EAAOC,QAAU,IAA0B,0C,gBCA3CD,EAAOC,QAAU,IAA0B,6C,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,kC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,qC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,mC,gBCA3CD,EAAOC,QAAU,IAA0B,4C,gBCA3CD,EAAOC,QAAU,IAA0B,oC,gBCA3CD,EAAOC,QAAU,IAA0B,wC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,0C,gBCA3CD,EAAOC,QAAU,IAA0B,mC,gBCA3CD,EAAOC,QAAU,IAA0B,sC,gBCA3CD,EAAOC,QAAU,IAA0B,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","file":"static/js/main.d413832a.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/dice-six-faces-six.e202d07a.svg\";","module.exports = __webpack_public_path__ + \"static/media/emerald.df0125b6.svg\";","module.exports = __webpack_public_path__ + \"static/media/sword-brandish.a3fe9ae2.svg\";","module.exports = __webpack_public_path__ + \"static/media/shard-sword.23a923d5.svg\";","module.exports = __webpack_public_path__ + \"static/media/spiral-thrust.4b9960c0.svg\";","module.exports = __webpack_public_path__ + \"static/media/healing1.e72c5d2c.png\";","module.exports = __webpack_public_path__ + \"static/media/fireball.267cc34c.png\";","module.exports = __webpack_public_path__ + \"static/media/thunderbolt.bb5d2de7.png\";","module.exports = __webpack_public_path__ + \"static/media/dark-blast.155cdf6e.png\";","module.exports = __webpack_public_path__ + \"static/media/crippling-blow.f9be9048.png\";","module.exports = __webpack_public_path__ + \"static/media/wrath.b68f4b08.png\";","module.exports = __webpack_public_path__ + \"static/media/charge.11d38245.png\";","module.exports = __webpack_public_path__ + \"static/media/headshot.6549c4b8.png\";","module.exports = __webpack_public_path__ + \"static/media/shadow-strike.b9675e5b.png\";","module.exports = __webpack_public_path__ + \"static/media/vanish.670b9e64.png\";","module.exports = __webpack_public_path__ + \"static/media/inspect.af959ce1.png\";","module.exports = __webpack_public_path__ + \"static/media/weapon-attack.1f0b2b4e.png\";","module.exports = __webpack_public_path__ + \"static/media/aura.72475924.svg\";","module.exports = __webpack_public_path__ + \"static/media/barbute.e93dc754.svg\";","module.exports = __webpack_public_path__ + \"static/media/muscular-torso.92dbbc2a.svg\";","module.exports = __webpack_public_path__ + \"static/media/hand.9a950e42.svg\";","module.exports = __webpack_public_path__ + \"static/media/ring.5187be72.svg\";","module.exports = __webpack_public_path__ + \"static/media/footprint.88018ef0.svg\";","module.exports = __webpack_public_path__ + \"static/media/quick-slash.1d87b52f.svg\";","module.exports = __webpack_public_path__ + \"static/media/barbed-arrow.c6c3f6ae.svg\";","module.exports = __webpack_public_path__ + \"static/media/flame.332be8c2.svg\";","module.exports = __webpack_public_path__ + \"static/media/bleeding-eye.12de19c6.svg\";","module.exports = __webpack_public_path__ + \"static/media/moebius-trefoil.d014b37d.svg\";","module.exports = __webpack_public_path__ + \"static/media/triorb.b6fc9ecd.svg\";","module.exports = __webpack_public_path__ + \"static/media/fist.d1b25a44.svg\";","module.exports = __webpack_public_path__ + \"static/media/fire-axe.3106dbae.svg\";","module.exports = __webpack_public_path__ + \"static/media/war-axe.e2df8956.svg\";","module.exports = __webpack_public_path__ + \"static/media/stiletto.ad33f46f.svg\";","module.exports = __webpack_public_path__ + \"static/media/croc-sword.dfa5ecf6.svg\";","module.exports = __webpack_public_path__ + \"static/media/flail.1f360b03.svg\";","module.exports = __webpack_public_path__ + \"static/media/crossed-swords.b7d2c27a.svg\";","module.exports = __webpack_public_path__ + \"static/media/katana.8ca51fab.svg\";","module.exports = __webpack_public_path__ + \"static/media/sword-hilt.409c650d.svg\";","module.exports = __webpack_public_path__ + \"static/media/orb-wand.2f0c673e.svg\";","module.exports = __webpack_public_path__ + \"static/media/wizard-staff.3e6091b9.svg\";","module.exports = __webpack_public_path__ + \"static/media/luger.ec54b497.svg\";","module.exports = __webpack_public_path__ + \"static/media/crossbow.6d23d544.svg\";","module.exports = __webpack_public_path__ + \"static/media/bloody-sword.59d8ca0f.svg\";","module.exports = __webpack_public_path__ + \"static/media/winged-sword.c22831aa.svg\";","module.exports = __webpack_public_path__ + \"static/media/closed-barbute.59102a4b.svg\";","module.exports = __webpack_public_path__ + \"static/media/hood.7b3df127.svg\";","module.exports = __webpack_public_path__ + \"static/media/shoulder-armor.caa17ee9.svg\";","module.exports = __webpack_public_path__ + \"static/media/robe.5b61ecba.svg\";","module.exports = __webpack_public_path__ + \"static/media/gloves.03da1411.svg\";","module.exports = __webpack_public_path__ + \"static/media/power-ring.ed9dcd22.svg\";","module.exports = __webpack_public_path__ + \"static/media/boots.b6910f10.svg\";","module.exports = __webpack_public_path__ + \"static/media/magnifying-glass.ec7b5987.svg\";","module.exports = __webpack_public_path__ + \"static/media/tombstone.31b6aa47.svg\";","module.exports = __webpack_public_path__ + \"static/media/pencil.ac0b4bc7.svg\";","module.exports = __webpack_public_path__ + \"static/media/save.ec2d8043.svg\";","module.exports = __webpack_public_path__ + \"static/media/trash-can.3332c6a4.svg\";","module.exports = __webpack_public_path__ + \"static/media/roll.300ea409.png\";","module.exports = __webpack_public_path__ + \"static/media/forest-931706_1920.f9c3ec0d.jpg\";","module.exports = __webpack_public_path__ + \"static/media/swordman.c84cfcb8.svg\";","module.exports = __webpack_public_path__ + \"static/media/swap-bag.df43fabd.svg\";","module.exports = __webpack_public_path__ + \"static/media/skills.60519e24.svg\";","module.exports = __webpack_public_path__ + \"static/media/crystal-shrine.d915d792.svg\";","module.exports = __webpack_public_path__ + \"static/media/two-shadows.3e048aca.svg\";","module.exports = __webpack_public_path__ + \"static/media/23761.e6671090.jpg\";","export const getKeys = <T extends string>(\r\n  obj: Partial<Record<T, any>>,\r\n): T[] => {\r\n  return Object.keys(obj || {}) as T[]\r\n}\r\n","export const notZero = <T = any>(value: number, content: T) =>\r\n  value === 0 ? '' : content\r\n","import { notZero } from './notZero'\r\n\r\nexport const getSign = (value: number): string =>\r\n  notZero(value, value > 0 ? '+' : '-')\r\n","export const noneg = (value: number) => (value > 0 ? value : 0)\r\n","import { DiceRoll } from 'rpg-dice-roller'\r\nimport { getSign } from '../util/getSign'\r\nimport { v4 } from 'uuid'\r\nimport {\r\n  CharacterSkillCheckKeyT,\r\n  ProcessedCharacterT,\r\n  getModifierValueFromKeys,\r\n  CharacterKeyMap3,\r\n} from './Character'\r\nimport { getKeys } from '../util/getKeys'\r\nimport { noneg } from '../util/noneg'\r\n\r\nexport const THREE_D6_DIST: any = {\r\n  3: 0.46,\r\n  4: 1.85,\r\n  5: 4.62,\r\n  6: 9.25,\r\n  7: 16.2,\r\n  8: 25.92,\r\n  9: 37.5,\r\n  10: 50.0,\r\n  11: 62.5,\r\n  12: 74.07,\r\n  13: 83.79,\r\n  14: 90.74,\r\n  15: 95.37,\r\n  16: 98.14,\r\n  17: 99.53,\r\n}\r\nexport const get3d6Probability = (result: number) => {\r\n  if (result < 3) return 0.46\r\n  if (result > 17) return 99.53\r\n  return THREE_D6_DIST[result]\r\n}\r\n\r\ninterface ProcessedRollT {\r\n  n: number\r\n  d: number\r\n}\r\nconst processRollString = (rollString: string): ProcessedRollT[] => {\r\n  const rolls = rollString.split('+')\r\n  return rolls.map((roll) => {\r\n    const [n, d] = roll.split('d')\r\n    return { n: parseInt(n, 10), d: parseInt(d, 10) }\r\n  })\r\n}\r\n\r\nexport interface Roll2T {\r\n  string: string\r\n  modifier: number\r\n}\r\nexport interface Check2T {\r\n  value: number\r\n  roll: Roll2T\r\n}\r\nexport interface Roll2ResultT {\r\n  id: string\r\n  label?: string\r\n  total: number\r\n  output: string\r\n  criticalSuccess: boolean\r\n  criticalFailure: boolean\r\n  minTotal: number\r\n  maxTotal: number\r\n  averageTotal: number\r\n}\r\nexport interface Check2ResultT extends Roll2ResultT {\r\n  result: boolean\r\n  chance: number\r\n  goal: number\r\n}\r\nexport interface CharacterRollT extends Roll2T {\r\n  keys: CharacterSkillCheckKeyT[]\r\n}\r\nexport interface CharacterCheckT extends Check2T {\r\n  keys: CharacterSkillCheckKeyT[]\r\n}\r\n\r\nconst getModifierString = (modifier: number) => {\r\n  if (modifier === 0) return ''\r\n  return `${getSign(modifier)}${Math.abs(modifier)}`\r\n}\r\nexport const resolveRoll = (\r\n  roll: Roll2T,\r\n  allowNegatives: boolean = true,\r\n): Roll2ResultT => {\r\n  const string = combineRollStrings(roll.string) || '1d1-1'\r\n  const result = new DiceRoll(`${string}${getModifierString(roll.modifier)}`)\r\n  return {\r\n    id: v4(),\r\n    total: allowNegatives ? result.total : noneg(result.total),\r\n    output: result.output,\r\n    criticalSuccess: result.total === result.minTotal,\r\n    criticalFailure: result.total === result.maxTotal,\r\n    minTotal: allowNegatives ? result.minTotal : noneg(result.minTotal),\r\n    maxTotal: allowNegatives ? result.maxTotal : noneg(result.maxTotal),\r\n    averageTotal: allowNegatives\r\n      ? result.averageTotal\r\n      : noneg(result.averageTotal),\r\n  }\r\n}\r\nexport const quickRoll = (str: string, mod?: number): number =>\r\n  resolveRoll({ string: str, modifier: mod || 0 }).total\r\n\r\nexport const getCheckProbability = (check: Check2T): number => {\r\n  const { value, roll } = check\r\n  if (roll.string === '3d6' && roll.modifier === 0)\r\n    return get3d6Probability(value)\r\n  if (roll.string === '') {\r\n    return roll.modifier <= value ? 100 : 0\r\n  }\r\n  return 0\r\n}\r\n\r\nexport const resolveCheck = (\r\n  check: Check2T,\r\n  allowNegatives?: boolean,\r\n): Check2ResultT => {\r\n  const { value, roll } = check\r\n  const rollResult = resolveRoll(roll, allowNegatives)\r\n  return {\r\n    ...rollResult,\r\n    result: rollResult.total <= value,\r\n    chance: getCheckProbability(check),\r\n    goal: value,\r\n  }\r\n}\r\n\r\nexport const ZERO_ROLL: Roll2T = {\r\n  string: '',\r\n  modifier: 0,\r\n}\r\nexport const THREE_D6: Roll2T = {\r\n  string: '3d6',\r\n  modifier: 0,\r\n}\r\nexport const ZERO_CHECK: Check2T = {\r\n  value: 0,\r\n  roll: ZERO_ROLL,\r\n}\r\nexport const makeRoll = (str?: string, mod?: number): Roll2T => ({\r\n  string: str || ZERO_ROLL.string,\r\n  modifier: mod || ZERO_ROLL.modifier,\r\n})\r\nexport const makeCheck = (\r\n  value: number,\r\n  str?: string,\r\n  mod?: number,\r\n): Check2T => ({\r\n  value,\r\n  roll: {\r\n    string: str || THREE_D6.string,\r\n    modifier: mod || THREE_D6.modifier,\r\n  },\r\n})\r\nexport const makeCharacterRoll = (\r\n  keys: CharacterSkillCheckKeyT[],\r\n  str?: string,\r\n  mod?: number,\r\n): CharacterRollT => ({\r\n  keys,\r\n  string: str || ZERO_ROLL.string,\r\n  modifier: mod || ZERO_ROLL.modifier,\r\n})\r\nexport const makeCharacterCheck = (\r\n  keys: CharacterSkillCheckKeyT[],\r\n  str?: string,\r\n  mod?: number,\r\n  value?: number,\r\n): CharacterCheckT => ({\r\n  keys,\r\n  value: value || ZERO_CHECK.value,\r\n  roll: {\r\n    string: str === undefined ? THREE_D6.string : str,\r\n    modifier: mod || THREE_D6.modifier,\r\n  },\r\n})\r\nexport const makeStandardCharacterCheck = (\r\n  keys: CharacterSkillCheckKeyT[],\r\n  modifier: number = 0,\r\n) => makeCharacterCheck(keys, undefined, undefined, modifier)\r\nexport const combineRollStrings = (...rolls: string[]): string => {\r\n  const list = rolls\r\n    .filter((r) => r !== '')\r\n    .map((r) => processRollString(r))\r\n    .reduce((p, c) => [...p, ...c], [])\r\n  let result: Record<number, number> = {}\r\n  list.forEach((pRoll) => {\r\n    result[pRoll.d] = (result[pRoll.d] || 0) + pRoll.n\r\n  })\r\n  return getKeys(result)\r\n    .map((d, i) => {\r\n      return `${result[parseInt(d, 10)]}d${d}`\r\n    })\r\n    .reduce((p, c, i) => `${p}${i > 0 ? '+' : ''}${c}`, '')\r\n}\r\nexport const combineRolls = (...rolls: Roll2T[]): Roll2T => {\r\n  return rolls.reduce(\r\n    (p, c) => ({\r\n      string: combineRollStrings(p.string, c.string),\r\n      modifier: p.modifier + c.modifier,\r\n    }),\r\n    ZERO_ROLL,\r\n  )\r\n}\r\nexport const combineChecks = (...checks: Check2T[]): Check2T => {\r\n  return checks.reduce((p, c) => ({\r\n    value: p.value + c.value,\r\n    roll: combineRolls(p.roll, c.roll),\r\n  }))\r\n}\r\nexport const combineCharacterRolls = (\r\n  ...rolls: CharacterRollT[]\r\n): CharacterRollT => {\r\n  return rolls.reduce(\r\n    (p, c) => ({\r\n      ...combineRolls(p, c),\r\n      keys: [...p.keys, ...c.keys],\r\n    }),\r\n    makeCharacterRoll([]),\r\n  )\r\n}\r\nexport const reduceCharacterRoll = (\r\n  roll: CharacterRollT,\r\n  character: ProcessedCharacterT,\r\n): Roll2T => {\r\n  const keyValue = getModifierValueFromKeys(character)(roll.keys || [])\r\n  return {\r\n    string: roll.string,\r\n    modifier: roll.modifier + keyValue,\r\n  }\r\n}\r\nexport const reduceCharacterCheck = (\r\n  check: CharacterCheckT,\r\n  character: ProcessedCharacterT,\r\n): Check2T => {\r\n  const keyValue = getModifierValueFromKeys(character)(check.keys)\r\n  return {\r\n    value: check.value + keyValue,\r\n    roll: check.roll,\r\n  }\r\n}\r\nexport const resolveCharacterRoll = (\r\n  roll: CharacterRollT,\r\n  character: ProcessedCharacterT,\r\n  allowNegatives?: boolean,\r\n) => {\r\n  return resolveRoll(reduceCharacterRoll(roll, character), allowNegatives)\r\n}\r\nexport const resolveCharacterCheck = (\r\n  check: CharacterCheckT,\r\n  character: ProcessedCharacterT,\r\n  allowNegatives?: boolean,\r\n) => {\r\n  return resolveCheck(reduceCharacterCheck(check, character), allowNegatives)\r\n}\r\n\r\n// utils\r\nexport const getRollRange = (roll: Roll2T): string => {\r\n  const result = resolveRoll(roll, false)\r\n  if (result.minTotal === result.maxTotal) return `${result.maxTotal}`\r\n  return `${result.minTotal}-${result.maxTotal}`\r\n}\r\nexport const getRollText = (roll: CharacterRollT) => {\r\n  const hasKeys = roll.keys.length > 0\r\n  const hasMod = roll.modifier !== 0\r\n  const keyString = roll.keys.reduce((p, c, i) => {\r\n    const plus = i === 0 && !roll.string ? '' : '+'\r\n    return `${p}${plus}${CharacterKeyMap3[c]}`\r\n  }, '')\r\n  const modString = hasMod\r\n    ? `${roll.string || keyString ? getSign(roll.modifier) : ''}${Math.abs(\r\n        roll.modifier,\r\n      )}`\r\n    : ''\r\n  return `${roll.string}${keyString}${modString}`\r\n}\r\n","import { getKeys } from '../util/getKeys'\r\nimport {\r\n  CharacterRollT,\r\n  Roll2ResultT,\r\n  makeCharacterRoll,\r\n  combineCharacterRolls,\r\n} from './Roll2'\r\nimport { RollCheckerT } from '../contexts/RollContext'\r\n\r\nexport type DamageElementTypeT = 'fire' | 'blood' | 'light' | 'dark'\r\nexport type DamageTypeKeyT = DamageElementTypeT | 'slashing' | 'piercing'\r\n\r\ntype _DamageTypeRollsT = Record<DamageTypeKeyT, CharacterRollT | undefined>\r\nexport type DamageTypeRollsT = Partial<_DamageTypeRollsT>\r\ntype _DamageTypeResultsT = Record<DamageTypeKeyT, Roll2ResultT | undefined>\r\nexport type DamageTypeResultsT = Partial<_DamageTypeResultsT>\r\n\r\nexport interface DamageRollsResultT {\r\n  total: number\r\n  rollResults: DamageTypeResultsT\r\n}\r\n\r\nexport const DamageTypeKeyColors: Record<DamageTypeKeyT, string> = {\r\n  slashing: 'grey',\r\n  piercing: 'grey',\r\n  fire: 'orange',\r\n  blood: '#cd7474',\r\n  light: 'lemonchiffon',\r\n  dark: 'mediumpurple',\r\n}\r\n\r\nexport const getDamageTypeKeys = (\r\n  obj: DamageTypeRollsT | DamageTypeResultsT,\r\n): DamageTypeKeyT[] => getKeys<DamageTypeKeyT>(obj)\r\n\r\nexport const rollDamage = (\r\n  resolveRoll: RollCheckerT<CharacterRollT, Roll2ResultT>,\r\n) => (\r\n  rolls: DamageTypeRollsT,\r\n  crit: boolean = false,\r\n  label?: string,\r\n): DamageRollsResultT => {\r\n  let total = 0\r\n  const keys: DamageTypeKeyT[] = getKeys(rolls).filter((key) => rolls[key])\r\n  let rollResults: DamageTypeResultsT = {\r\n    slashing: undefined,\r\n    piercing: undefined,\r\n    fire: undefined,\r\n    blood: undefined,\r\n    light: undefined,\r\n    dark: undefined,\r\n  }\r\n  keys.forEach((key) => {\r\n    const roll = rolls[key] as CharacterRollT\r\n    let result = resolveRoll(roll, true, false, label)\r\n    if (crit) {\r\n      result = {\r\n        ...result,\r\n        total: result.maxTotal || result.total,\r\n      }\r\n    }\r\n    total += result.total\r\n    rollResults = { ...rollResults, [key]: result }\r\n  })\r\n  return {\r\n    total,\r\n    rollResults,\r\n  }\r\n}\r\n\r\nexport const ZERO_DAMAGE_ROLLS: DamageTypeRollsT = {\r\n  slashing: makeCharacterRoll([]),\r\n  piercing: makeCharacterRoll([]),\r\n  fire: makeCharacterRoll([]),\r\n  blood: makeCharacterRoll([]),\r\n  light: makeCharacterRoll([]),\r\n  dark: makeCharacterRoll([]),\r\n}\r\nconst force = (roll?: CharacterRollT) => roll as CharacterRollT\r\n\r\nexport const combineDamageTypeRolls = (...rolls: DamageTypeRollsT[]) => {\r\n  return rolls.reduce((p, c) => {\r\n    let ret: DamageTypeRollsT = {}\r\n    getKeys(p).forEach((key) => {\r\n      ret[key] = c[key]\r\n        ? combineCharacterRolls(force(p[key]), force(c[key]))\r\n        : p[key]\r\n    })\r\n    return ret\r\n  }, ZERO_DAMAGE_ROLLS)\r\n}\r\n","export const reduce = <TList, TRestult>(\r\n  list: TList[],\r\n  reducer: (result: TRestult, current: TList, index?: number) => TRestult,\r\n  initialValue: TRestult,\r\n): TRestult => {\r\n  return list.reduce(reducer as any, initialValue as TRestult) as TRestult\r\n}\r\n","import { CharacterTraitT, CharacterT, ProcessedCharacterT } from './Character'\r\nimport { SkillT } from './Skill'\r\nimport { getKeys } from '../util/getKeys'\r\nimport { reduce } from '../util/reduce'\r\n\r\nexport type EventTypeT = 'onHit' | 'onCrit'\r\nexport type EventsT = Partial<Record<EventTypeT, CharacterTraitT[]>>\r\nexport const EventsTypeMap: Record<EventTypeT, string> = {\r\n  onHit: 'on hit',\r\n  onCrit: 'on crit',\r\n}\r\n\r\nexport const checkEvent = (character: CharacterT, skill: SkillT) => (\r\n  event: EventTypeT,\r\n): CharacterTraitT[] | undefined => {\r\n  if ((character as ProcessedCharacterT).processed) {\r\n    throw new Error('No Processed Characters [checkEvent]')\r\n  }\r\n  const skillTraits = skill.events[event]\r\n  if (skill.combineWeaponDamage) {\r\n    const { weapon } = character\r\n    if (!weapon) return skillTraits\r\n    const traits = weapon.events[event]\r\n    if (!traits) return skillTraits\r\n    return [...(skillTraits || []), ...traits]\r\n  }\r\n  return skillTraits\r\n}\r\n\r\nconst force = (traits?: CharacterTraitT[]) => traits || []\r\nexport const combineEvents = (...events: EventsT[]): EventsT => {\r\n  return reduce<EventsT, EventsT>(\r\n    events,\r\n    (p, c) => {\r\n      let ret: EventsT = {}\r\n      getKeys(p).forEach((key) => {\r\n        ret[key] = [...force(p[key]), ...force(c[key])]\r\n      })\r\n      return ret\r\n    },\r\n    {\r\n      onHit: [],\r\n      onCrit: [],\r\n    },\r\n  )\r\n}\r\n","import { EquippableT, ItemT } from './Item'\r\nimport {\r\n  DamageTypeRollsT,\r\n  ZERO_DAMAGE_ROLLS,\r\n  combineDamageTypeRolls,\r\n} from './Damage'\r\nimport { CharacterTraitT } from './Character'\r\nimport { CharacterCheckT } from './Roll2'\r\nimport { EventsT, combineEvents } from './Events'\r\nimport { reduce } from '../util/reduce'\r\n\r\nexport type WeaponTypeT =\r\n  // default\r\n  | 'fists'\r\n  // S\r\n  | 'axe' // s,1\r\n  | 'greataxe' // s,2\r\n  | 'flail' // p,1\r\n  // D\r\n  | 'daggers' // p,2\r\n  | 'katana' // s,1\r\n  | 'rapier' // p,1\r\n  // I\r\n  | 'wand' // e,1\r\n  | 'staff' // e,2\r\n  // S+I\r\n  | 'elementalSword' // s,e,1\r\n  | 'elementalGreatsword' // s,e,2\r\n  // S+D\r\n  | 'sword' // s,1\r\n  | 'greatsword' // s,2\r\n  // D+I\r\n  | 'pistol' // p,e,1\r\n  | 'crossbow' // p,e,2\r\n\r\nexport type WeaponIconKeyT =\r\n  | 'fire-sword'\r\n  | 'blood-sword'\r\n  | 'light-sword'\r\n  | 'dark-sword'\r\nexport interface WeaponT extends EquippableT {\r\n  type: 'weapon'\r\n  weaponType: WeaponTypeT\r\n  accuracyCheck: CharacterCheckT\r\n  damageRolls: DamageTypeRollsT\r\n  events: EventsT\r\n  slotCount: number\r\n  slots: WeaponModT[]\r\n}\r\nexport interface ProcessedWeaponT extends WeaponT {\r\n  processed: true\r\n}\r\n\r\nexport interface WeaponTraitT {\r\n  id: string\r\n  accuracyOffset: number\r\n  damageRolls: DamageTypeRollsT\r\n  events: EventsT\r\n  traits: CharacterTraitT[]\r\n}\r\nexport const ZERO_WEAPON_TRAIT: WeaponTraitT = {\r\n  id: '',\r\n  accuracyOffset: 0,\r\n  damageRolls: ZERO_DAMAGE_ROLLS,\r\n  events: {},\r\n  traits: [],\r\n}\r\nexport interface WeaponModT extends ItemT {\r\n  traits: WeaponTraitT[]\r\n}\r\n\r\nexport const combineWeaponTraits = (\r\n  ...traits: WeaponTraitT[]\r\n): WeaponTraitT => {\r\n  return traits.reduce((p, c) => {\r\n    return {\r\n      id: c.id,\r\n      accuracyOffset: p.accuracyOffset + c.accuracyOffset,\r\n      damageRolls: combineDamageTypeRolls(p.damageRolls, c.damageRolls),\r\n      events: combineEvents(p.events, c.events),\r\n      traits: [...p.traits, ...c.traits],\r\n    }\r\n  }, ZERO_WEAPON_TRAIT)\r\n}\r\n\r\nexport const processWeapon = (weapon: WeaponT): ProcessedWeaponT => {\r\n  if ((weapon as ProcessedWeaponT).processed) {\r\n    throw new Error('No Processed Weapons Allowed')\r\n  }\r\n  const mods = weapon.slots\r\n  const traits = reduce<WeaponModT, WeaponTraitT[]>(\r\n    mods,\r\n    (p, c) => [...p, ...c.traits],\r\n    [],\r\n  )\r\n  const combinedTrait = combineWeaponTraits(...traits)\r\n  const ret: ProcessedWeaponT = {\r\n    ...weapon,\r\n    processed: true,\r\n    accuracyCheck: {\r\n      ...weapon.accuracyCheck,\r\n      value: weapon.accuracyCheck.value + combinedTrait.accuracyOffset,\r\n    },\r\n    damageRolls: combineDamageTypeRolls(\r\n      weapon.damageRolls,\r\n      combinedTrait.damageRolls,\r\n    ),\r\n    traits: [...weapon.traits, ...combinedTrait.traits],\r\n    events: combineEvents(weapon.events, combinedTrait.events),\r\n  }\r\n  return ret\r\n}\r\n","import { EquippableT, ItemTypeT } from '../types/Item'\r\nimport { v4 } from 'uuid'\r\nimport { CharacterSkillCheckKeyT, CharacterTraitT } from '../types/Character'\r\nimport {\r\n  CharacterCheckT,\r\n  makeCharacterCheck,\r\n  makeCharacterRoll,\r\n} from '../types/Roll2'\r\n\r\nexport const makeRequirementCheck = (\r\n  keys: CharacterSkillCheckKeyT[],\r\n  value: number,\r\n): CharacterCheckT => makeCharacterCheck(keys, '', value, undefined)\r\n\r\nexport const BASE_EQUIPPABLE = (type: ItemTypeT): EquippableT => {\r\n  const id = v4()\r\n  return {\r\n    id,\r\n    type,\r\n    rarity: 'common',\r\n    equippable: true,\r\n    name: '',\r\n    cost: 0,\r\n    resource: 'weaponHands',\r\n    requirementCheck: makeRequirementCheck(['intelligence'], 1),\r\n    traits: [\r\n      {\r\n        id: `${id}-0`,\r\n        name: 'Bonus',\r\n        duration: -1,\r\n        healthOffset: 0,\r\n        focusOffset: 0,\r\n        abilitiesModifiers: {\r\n          strength: 0,\r\n          dexterity: 0,\r\n          intelligence: 0,\r\n          vigor: 0,\r\n        },\r\n        statsModifiers: {\r\n          health: 0,\r\n          focus: 0,\r\n          will: 0,\r\n          perception: 0,\r\n          agility: 0,\r\n          accuracy: 0,\r\n          evade: 0,\r\n        },\r\n      },\r\n    ],\r\n    damageResistances: {\r\n      slashing: makeCharacterRoll([]),\r\n      piercing: makeCharacterRoll([]),\r\n      fire: makeCharacterRoll([]),\r\n      blood: makeCharacterRoll([]),\r\n      light: makeCharacterRoll([]),\r\n      dark: makeCharacterRoll([]),\r\n    },\r\n  }\r\n}\r\n\r\nexport const makeTrait = (name: string = ''): CharacterTraitT => {\r\n  return {\r\n    id: v4(),\r\n    name,\r\n    duration: -1,\r\n    healthOffset: 0,\r\n    focusOffset: 0,\r\n    abilitiesModifiers: {\r\n      strength: 0,\r\n      dexterity: 0,\r\n      intelligence: 0,\r\n      vigor: 0,\r\n    },\r\n    statsModifiers: {\r\n      health: 0,\r\n      focus: 0,\r\n      will: 0,\r\n      perception: 0,\r\n      agility: 0,\r\n      accuracy: 0,\r\n      evade: 0,\r\n    },\r\n  }\r\n}\r\n","import { WeaponT } from '../types/Weapon'\r\nimport { v4 } from 'uuid'\r\nimport { BASE_EQUIPPABLE, makeRequirementCheck } from './util'\r\nimport { makeCharacterCheck, makeCharacterRoll } from '../types/Roll2'\r\n\r\nexport const FISTS: WeaponT = {\r\n  ...BASE_EQUIPPABLE('weapon'),\r\n  id: v4(),\r\n  equippable: true,\r\n  type: 'weapon',\r\n  weaponType: 'fists',\r\n  name: 'Unarmed',\r\n  cost: 0,\r\n  resource: 'weaponHands',\r\n  requirementCheck: makeRequirementCheck(['strength'], 1),\r\n  damageRolls: {\r\n    piercing: makeCharacterRoll([], '1d6', -3),\r\n  },\r\n  accuracyCheck: makeCharacterCheck(['dexterity']),\r\n  traits: [],\r\n  events: {},\r\n  slotCount: 0,\r\n  slots: [],\r\n}\r\n","import { WeaponT, ProcessedWeaponT, processWeapon } from './Weapon'\r\nimport { EquippableT } from './Item'\r\nimport { FISTS } from '../objects/fists'\r\nimport { DamageTypeRollsT, getDamageTypeKeys, DamageTypeKeyT } from './Damage'\r\nimport { ArmorT } from './Armor'\r\nimport { reduce } from '../util/reduce'\r\nimport { v4 } from 'uuid'\r\nimport { noneg } from '../util/noneg'\r\nimport { makeTrait } from '../objects/util'\r\nimport {\r\n  combineCharacterRolls,\r\n  CharacterRollT,\r\n  resolveCharacterCheck,\r\n} from './Roll2'\r\nimport { SkillT } from './Skill'\r\n\r\nexport type CharacterAbilityKeyT =\r\n  | 'strength'\r\n  | 'dexterity'\r\n  | 'intelligence'\r\n  | 'vigor'\r\nexport type CharacterAbilitiesT = Record<CharacterAbilityKeyT, number>\r\n\r\nexport type CharacterStatKeyT =\r\n  | 'health'\r\n  | 'focus'\r\n  | 'will'\r\n  | 'perception'\r\n  | 'agility'\r\n  | 'accuracy'\r\n  | 'evade'\r\nexport type CharacterStatsT = Record<CharacterStatKeyT, number>\r\n\r\nexport type CharacterResourceKeyT =\r\n  | 'characterPoints'\r\n  | 'weaponHands'\r\n  | 'heads'\r\n  | 'bodies'\r\n  | 'hands'\r\n  | 'fingers'\r\n  | 'feet'\r\nexport type CharacterResourcesT = Record<CharacterResourceKeyT, number>\r\n\r\nexport type CharacterSkillCheckKeyT = CharacterAbilityKeyT | CharacterStatKeyT\r\n\r\nexport interface CharacterTraitT {\r\n  id: string\r\n  name: string\r\n  healthOffset: number\r\n  focusOffset: number\r\n  abilitiesModifiers: CharacterAbilitiesT\r\n  statsModifiers: CharacterStatsT\r\n  duration: number\r\n}\r\n\r\nexport interface CharacterT {\r\n  name: string\r\n  id: string\r\n  power: number\r\n  resources: CharacterResourcesT\r\n  abilities: CharacterAbilitiesT\r\n  damageResistances: DamageTypeRollsT\r\n  traits: CharacterTraitT[]\r\n  skills: SkillT[]\r\n\r\n  equippedItems: EquippableT[]\r\n  armor: ArmorT[]\r\n  weapon?: WeaponT\r\n\r\n  healthOffset: number\r\n  focusOffset: number\r\n  partyId?: string\r\n  dead: boolean\r\n  inspected: boolean\r\n}\r\nexport interface ProcessedCharacterT extends CharacterT {\r\n  stats: CharacterStatsT\r\n  weapon: ProcessedWeaponT\r\n  processed: true\r\n}\r\n\r\nexport const getTraits = (character: CharacterT): CharacterTraitT[] => {\r\n  const armorTraits: CharacterTraitT[] = reduce<ArmorT, CharacterTraitT[]>(\r\n    character.armor,\r\n    (result, item) => [...result, ...item.traits],\r\n    [],\r\n  )\r\n  const equippedItemTraits: CharacterTraitT[] = reduce<\r\n    EquippableT,\r\n    CharacterTraitT[]\r\n  >(character.equippedItems, (result, item) => [...result, ...item.traits], [])\r\n  return [\r\n    ...character.traits,\r\n    ...processWeapon(character.weapon || FISTS).traits,\r\n    ...equippedItemTraits,\r\n    ...armorTraits,\r\n  ]\r\n}\r\n\r\nexport const getAbilities = (character: CharacterT): CharacterAbilitiesT => {\r\n  return getTraits(character)\r\n    .map((trait) => trait.abilitiesModifiers)\r\n    .reduce(\r\n      (result, cur) => ({\r\n        strength: result.strength + cur.strength,\r\n        dexterity: result.dexterity + cur.dexterity,\r\n        intelligence: result.intelligence + cur.intelligence,\r\n        vigor: result.vigor + cur.vigor,\r\n      }),\r\n      character.abilities,\r\n    )\r\n}\r\n\r\nexport const getStats = (character: CharacterT): CharacterStatsT => {\r\n  const abilities = getAbilities(character)\r\n  return getTraits(character)\r\n    .map((trait) => trait.statsModifiers)\r\n    .reduce(\r\n      (result, cur) => ({\r\n        health: result.health + cur.health,\r\n        focus: result.focus + cur.focus,\r\n        will: result.will + cur.will,\r\n        perception: result.perception + cur.perception,\r\n        agility: result.agility + cur.agility,\r\n        accuracy: result.accuracy + cur.accuracy,\r\n        evade: result.evade + cur.evade,\r\n      }),\r\n      {\r\n        health: abilities.strength * 2 + abilities.vigor,\r\n        focus: abilities.intelligence + abilities.vigor,\r\n        will: abilities.intelligence,\r\n        perception: abilities.intelligence,\r\n        // lift: (abilities.strength * abilities.strength) / 5,\r\n        agility: (abilities.vigor + abilities.dexterity) / 4,\r\n        accuracy: abilities.dexterity - 2,\r\n        evade: abilities.dexterity - 8,\r\n      },\r\n    )\r\n}\r\n\r\nexport const getDamageResistances = (\r\n  character: CharacterT,\r\n): DamageTypeRollsT => {\r\n  const armor = character.armor\r\n  const keys = getDamageTypeKeys(character.damageResistances)\r\n  return reduce<DamageTypeKeyT, DamageTypeRollsT>(\r\n    keys,\r\n    (result, key) => {\r\n      return {\r\n        ...result,\r\n        [key]: combineCharacterRolls(\r\n          result[key] as CharacterRollT,\r\n          ...armor.map((a) => a.damageResistances[key] as CharacterRollT),\r\n        ),\r\n      }\r\n    },\r\n    character.damageResistances,\r\n  )\r\n}\r\n\r\nexport const processCharacter = (\r\n  character: CharacterT,\r\n  withWeapon: boolean = true,\r\n): ProcessedCharacterT => {\r\n  if ((character as ProcessedCharacterT).processed)\r\n    return character as ProcessedCharacterT\r\n  character = withWeapon\r\n    ? character\r\n    : {\r\n        ...character,\r\n        weapon: undefined,\r\n      }\r\n\r\n  const abilities = getAbilities(character)\r\n  const stats = getStats(character)\r\n  const traits = getTraits(character)\r\n  const damageResistances = getDamageResistances(character)\r\n  const healthOffset = noneg(\r\n    traits.reduce((p, c) => p - c.healthOffset, character.healthOffset),\r\n  )\r\n  return {\r\n    ...character,\r\n    healthOffset,\r\n    weapon: processWeapon(character.weapon || FISTS),\r\n    abilities,\r\n    stats,\r\n    traits,\r\n    damageResistances,\r\n    processed: true,\r\n    dead: healthOffset >= stats.health,\r\n  }\r\n}\r\n\r\n// TODO: Maybe add the rest, but healthOffset is the wonky one\r\nexport const commitTrait = (character: CharacterT) => (\r\n  trait: CharacterTraitT,\r\n): CharacterT => {\r\n  return {\r\n    ...character,\r\n    healthOffset: noneg(character.healthOffset - trait.healthOffset),\r\n    focusOffset: noneg(character.focusOffset - trait.focusOffset),\r\n  }\r\n}\r\n\r\nexport const getModifierValueFromKeys = (character: ProcessedCharacterT) => (\r\n  keys: CharacterSkillCheckKeyT[],\r\n) =>\r\n  (keys as any[]).reduce((total: number = 0, key: CharacterSkillCheckKeyT) => {\r\n    const a: number = character.abilities[key as CharacterAbilityKeyT]\r\n    const s: number = character.stats[key as CharacterStatKeyT]\r\n    if (a) total += a\r\n    if (s) total += s\r\n    return total\r\n  }, 0)\r\n\r\nexport const setCharacterAbilityScore = (character: CharacterT) => (\r\n  key: CharacterAbilityKeyT,\r\n  value: number,\r\n  characterPoints: number = character.resources.characterPoints,\r\n): [CharacterT, EquippableT[]] =>\r\n  validateCharacter({\r\n    ...character,\r\n    power:\r\n      character.power + (character.resources.characterPoints - characterPoints),\r\n    resources: {\r\n      ...character.resources,\r\n      characterPoints,\r\n    },\r\n    abilities: {\r\n      ...character.abilities,\r\n      [key]: value,\r\n    },\r\n  })\r\n\r\nexport const CharacterKeyMap3: Record<CharacterSkillCheckKeyT, string> = {\r\n  strength: 'STR',\r\n  dexterity: 'DEX',\r\n  intelligence: 'INT',\r\n  vigor: 'VIG',\r\n  health: 'HLT',\r\n  focus: 'FOC',\r\n  will: 'WIL',\r\n  perception: 'PER',\r\n  // lift: 'LFT',\r\n  agility: 'AGL',\r\n  accuracy: 'ACC',\r\n  evade: 'EVD',\r\n}\r\n\r\nexport const characterAbilityScoreCosts: Record<\r\n  CharacterAbilityKeyT,\r\n  number\r\n> = {\r\n  strength: 10,\r\n  dexterity: 20,\r\n  intelligence: 20,\r\n  vigor: 10,\r\n}\r\n\r\nexport const CharacterStatsCostsMap: Record<CharacterSkillCheckKeyT, number> = {\r\n  ...characterAbilityScoreCosts,\r\n  health: 5,\r\n  focus: 5,\r\n  will: 10,\r\n  perception: 10,\r\n  // lift: 1,\r\n  agility: 10,\r\n  accuracy: 10,\r\n  evade: 10,\r\n}\r\n\r\nexport const canEquip = (character: CharacterT) => (\r\n  item: EquippableT,\r\n  withWeapon?: boolean,\r\n): boolean => {\r\n  if (!item) return false\r\n  if (!item.equippable) return false\r\n  const equipable = item as EquippableT\r\n  const processedCharacter = processCharacter(character, withWeapon)\r\n  if (\r\n    !resolveCharacterCheck(equipable.requirementCheck, processedCharacter)\r\n      .result\r\n  )\r\n    return false\r\n  if (equipable.type === 'weapon' && character.weapon) {\r\n    return false\r\n  } else {\r\n    if (processedCharacter.resources[equipable.resource] < equipable.cost)\r\n      return false\r\n  }\r\n  return true\r\n}\r\n\r\nexport const equipItem = (character: CharacterT) => (\r\n  item: EquippableT,\r\n): CharacterT => {\r\n  if (!canEquip(character)(item)) return character\r\n  if (item.type === 'armor') return equipArmor(character)(item as ArmorT)\r\n  if (item.type === 'weapon') return equipWeapon(character)(item as WeaponT)\r\n  return equipGenericItem(character)(item)\r\n}\r\n\r\nexport const unequipItem = (\r\n  character: CharacterT,\r\n  validate: boolean = true,\r\n) => (itemId: string): [EquippableT[], CharacterT] => {\r\n  let equippables: EquippableT[] = []\r\n  let c = { ...character }\r\n  if (character.weapon?.id === itemId) {\r\n    equippables = [{ ...character.weapon }]\r\n    c = unequipWeapon(c)\r\n  }\r\n  const armor = character.armor.find((i) => i.id === itemId)\r\n  if (armor) {\r\n    equippables = [{ ...armor }]\r\n    c = unequipArmor(character)(armor)\r\n  }\r\n  const item = character.equippedItems.find((i) => i.id === itemId)\r\n  if (item) {\r\n    equippables = [{ ...item }]\r\n    c = unequipGenericItem(character)(item)\r\n  }\r\n  if (validate) {\r\n    let vr = validateCharacter(c)\r\n    c = vr[0]\r\n    equippables = [...equippables, ...vr[1]]\r\n  }\r\n  return [equippables, c]\r\n}\r\n\r\nexport const equipGenericItem = (character: CharacterT) => (\r\n  item: EquippableT,\r\n): CharacterT => {\r\n  const resourceValue = character.resources[item.resource]\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      [item.resource]: resourceValue - item.cost,\r\n    },\r\n    equippedItems: [...character.equippedItems, item],\r\n  }\r\n}\r\n\r\nexport const unequipGenericItem = (character: CharacterT) => (\r\n  item: EquippableT,\r\n): CharacterT => {\r\n  if (!item) return character\r\n  const resourceValue = character.resources[item.resource]\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      [item.resource]: resourceValue + item.cost,\r\n    },\r\n    equippedItems: character.equippedItems.filter((i) => i.id !== item.id),\r\n  }\r\n}\r\n\r\nexport const equipArmor = (character: CharacterT) => (\r\n  item: ArmorT,\r\n): CharacterT => {\r\n  const resourceValue = character.resources[item.resource]\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      [item.resource]: resourceValue - item.cost,\r\n    },\r\n    armor: [...character.armor, item],\r\n  }\r\n}\r\n\r\nexport const unequipArmor = (character: CharacterT) => (\r\n  item: ArmorT,\r\n): CharacterT => {\r\n  if (!item) return character\r\n  const resourceValue = character.resources[item.resource]\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      [item.resource]: resourceValue + item.cost,\r\n    },\r\n    armor: character.armor.filter((i) => i.id !== item.id),\r\n  }\r\n}\r\n\r\nexport const equipWeapon = (character: CharacterT) => (\r\n  item: WeaponT,\r\n): CharacterT => {\r\n  if (item.type !== 'weapon') return character\r\n  let weapon = character.weapon\r\n  if (weapon?.id === FISTS.id) weapon = undefined\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      weaponHands:\r\n        character.resources.weaponHands -\r\n        item.cost +\r\n        (weapon ? weapon.cost : 0),\r\n    },\r\n    weapon: item,\r\n  }\r\n}\r\n\r\nexport const unequipWeapon = (character: CharacterT): CharacterT => {\r\n  if (!character.weapon) return character\r\n  return {\r\n    ...character,\r\n    resources: {\r\n      ...character.resources,\r\n      weaponHands: character.resources.weaponHands + character.weapon.cost,\r\n    },\r\n    weapon: undefined,\r\n  }\r\n}\r\n\r\nexport const getTraitValue = (\r\n  trait: CharacterTraitT,\r\n  key: CharacterSkillCheckKeyT,\r\n) => {\r\n  const abilityValue = trait.abilitiesModifiers[key as CharacterAbilityKeyT]\r\n  const statValue = trait.statsModifiers[key as CharacterStatKeyT]\r\n  return abilityValue !== undefined ? abilityValue : statValue\r\n}\r\n\r\nexport const combineTraits = (traits: CharacterTraitT[]): CharacterTraitT => {\r\n  const id = v4()\r\n  const name = 'combine' + id\r\n  return (traits || []).reduce((result, current) => {\r\n    const ar = result.abilitiesModifiers\r\n    const ac = current.abilitiesModifiers\r\n    const sr = result.statsModifiers\r\n    const sc = current.statsModifiers\r\n    return {\r\n      id,\r\n      name,\r\n      duration: current.duration,\r\n      healthOffset: result.healthOffset + current.healthOffset,\r\n      focusOffset: result.focusOffset + current.focusOffset,\r\n      abilitiesModifiers: {\r\n        strength: ar.strength + ac.strength,\r\n        dexterity: ar.dexterity + ac.dexterity,\r\n        intelligence: ar.intelligence + ac.intelligence,\r\n        vigor: ar.vigor + ac.vigor,\r\n      },\r\n      statsModifiers: {\r\n        health: sr.health + sc.health,\r\n        focus: sr.focus + sc.focus,\r\n        will: sr.will + sc.will,\r\n        perception: sr.perception + sc.perception,\r\n        agility: sr.agility + sc.agility,\r\n        accuracy: sr.accuracy + sc.accuracy,\r\n        evade: sr.evade + sc.evade,\r\n      },\r\n    }\r\n  }, makeTrait())\r\n}\r\n\r\nexport const validateCharacter = (\r\n  character: CharacterT,\r\n): [CharacterT, EquippableT[]] => {\r\n  let pc = processCharacter(character)\r\n  let result = { ...character }\r\n  let removedItems: EquippableT[] = []\r\n  const localUpdate = (c: CharacterT) => {\r\n    result = { ...c }\r\n    pc = processCharacter(c)\r\n  }\r\n  if (!resolveCharacterCheck(pc.weapon.requirementCheck, pc).result) {\r\n    const unequipResult = unequipItem(result, false)(pc.weapon.id)\r\n    localUpdate(unequipResult[1])\r\n    if (unequipResult[0]) removedItems = [...removedItems, ...unequipResult[0]]\r\n  }\r\n  pc.armor.forEach((i) => {\r\n    if (!resolveCharacterCheck(i.requirementCheck, pc).result) {\r\n      const unequipResult = unequipItem(result, false)(i.id)\r\n      localUpdate(unequipResult[1])\r\n      if (unequipResult[0])\r\n        removedItems = [...removedItems, ...unequipResult[0]]\r\n    }\r\n  })\r\n  pc.equippedItems.forEach((i) => {\r\n    if (!resolveCharacterCheck(i.requirementCheck, pc).result) {\r\n      if (!resolveCharacterCheck(i.requirementCheck, pc).result) {\r\n        const unequipResult = unequipItem(result, false)(i.id)\r\n        localUpdate(unequipResult[1])\r\n        if (unequipResult[0])\r\n          removedItems = [...removedItems, ...unequipResult[0]]\r\n      }\r\n    }\r\n  })\r\n\r\n  if (\r\n    result.weapon?.id !== character.weapon?.id ||\r\n    result.armor.length !== character.armor.length ||\r\n    result.equippedItems.length !== result.equippedItems.length\r\n  ) {\r\n    const [ret, items] = validateCharacter(result)\r\n    removedItems = [...removedItems, ...items]\r\n    localUpdate(ret)\r\n  }\r\n  return [result, removedItems]\r\n}\r\n","import { CharacterT } from '../types/Character'\r\nimport { v4 } from 'uuid'\r\nimport { makeCharacterRoll } from '../types/Roll2'\r\n/*\r\nimport { Config, adjectives, names } from 'unique-names-generator'\r\n\r\nconst config: Config = {\r\n  dictionaries: [adjectives, names],\r\n  length: 2,\r\n  separator: ' ',\r\n}\r\n*/\r\n\r\nexport const BASE_CHARACTER: CharacterT = {\r\n  name: '-- init --', //uniqueNamesGenerator(config),\r\n  id: v4(),\r\n  power: 0,\r\n  resources: {\r\n    characterPoints: 0,\r\n    weaponHands: 0,\r\n    heads: 0,\r\n    bodies: 0,\r\n    hands: 0,\r\n    fingers: 0,\r\n    feet: 0,\r\n  },\r\n  abilities: {\r\n    strength: 0,\r\n    dexterity: 0,\r\n    intelligence: 0,\r\n    vigor: 0,\r\n  },\r\n  damageResistances: {\r\n    slashing: makeCharacterRoll([]),\r\n    piercing: makeCharacterRoll([]),\r\n    fire: makeCharacterRoll([]),\r\n    blood: makeCharacterRoll([]),\r\n    light: makeCharacterRoll([]),\r\n    dark: makeCharacterRoll([]),\r\n  },\r\n\r\n  traits: [],\r\n  skills: [],\r\n\r\n  equippedItems: [],\r\n  armor: [],\r\n\r\n  healthOffset: 0,\r\n  focusOffset: 0,\r\n  dead: false,\r\n  inspected: false,\r\n}\r\n","import { CharacterT, ProcessedCharacterT, processCharacter } from './Character'\r\nimport { ItemT, EquippableT } from './Item'\r\nimport { SkillT } from './Skill'\r\nimport { WeaponModT } from './Weapon'\r\n\r\nexport interface PartyT {\r\n  id: string\r\n  items: EquippableT[]\r\n  characters: CharacterT[]\r\n  skills: SkillT[]\r\n  mods: WeaponModT[]\r\n}\r\nexport interface ProcessedPartyT {\r\n  id: string\r\n  items: EquippableT[]\r\n  characters: ProcessedCharacterT[]\r\n  skills: SkillT[]\r\n  mods: WeaponModT[]\r\n  processed: true\r\n}\r\n\r\nexport const processParty = (party: PartyT): ProcessedPartyT => ({\r\n  ...party,\r\n  characters: party.characters.map((c) => ({\r\n    ...processCharacter(c),\r\n    partyId: party.id,\r\n  })),\r\n  processed: true,\r\n})\r\n","import { StateCoreT, StateReducerT } from './types'\r\n\r\nexport const makeReducer = (\r\n  core: StateCoreT,\r\n  initialState: any,\r\n): StateReducerT => {\r\n  return (state = initialState, action) => {\r\n    const coreFn = core[action.type]\r\n    if (coreFn) return coreFn(state, action)\r\n    return state\r\n  }\r\n}\r\n","export interface IDT {\r\n  id: string\r\n}\r\nexport const upsertIn = <T extends IDT>(list: T[], item: T) => {\r\n  return [...list.filter((i) => i.id !== item.id), item]\r\n}\r\n\r\nexport const updateIn = <T extends IDT>(\r\n  list: T[],\r\n  id: string,\r\n  accessor: (i: T) => T,\r\n) => {\r\n  return list.map((i) => (i.id === id ? accessor(i) : i))\r\n}\r\n","export const getRandom = <T>(items: T[]) =>\r\n  items[Math.floor(Math.random() * items.length)]\r\n","import { ArmorTypeT } from '../../../types/Armor'\r\n\r\nexport const ArmorUniqueNames: Record<ArmorTypeT, string[]> = {\r\n  helmet: ['Helmet of Doom', 'Helmet of Dawn'],\r\n  cowl: ['Hood of the Night'],\r\n  chestplate: ['Armor of the King'],\r\n  robe: ['Robe of the Necromancer'],\r\n  gloves: ['Gloves of the Great War'],\r\n  ring: ['Ring of Green', 'Silver Serpant Ring'],\r\n  boots: ['Boots of the Gods'],\r\n}\r\n","import { ItemRarityT } from '../../types/Item'\r\nimport { CharacterSkillCheckKeyT } from '../../types/Character'\r\nimport { ItemModifierValuesT } from './makeItem'\r\nimport { getRandom } from '../../util/getRandom'\r\n\r\nexport const shuffleArray = <T>(a: T[]): T[] => {\r\n  let array = [...a]\r\n  for (let i = array.length - 1; i > 0; i--) {\r\n    const j = Math.floor(Math.random() * (i + 1))\r\n    ;[array[i], array[j]] = [array[j], array[i]]\r\n  }\r\n  return array\r\n}\r\n\r\nexport const Rarity3d6Map: Record<number, ItemRarityT> = {\r\n  3: 'set',\r\n  4: 'unique',\r\n  5: 'legendary',\r\n  6: 'rare',\r\n  7: 'uncommon',\r\n  8: 'common',\r\n  9: 'common',\r\n  10: 'common',\r\n  11: 'common',\r\n  12: 'common',\r\n  13: 'uncommon',\r\n  14: 'uncommon',\r\n  15: 'rare',\r\n  16: 'legendary',\r\n  17: 'unique',\r\n  18: 'mythic',\r\n}\r\n\r\nexport const getItemStatRolls = (\r\n  keys: CharacterSkillCheckKeyT[],\r\n  count: number,\r\n  requirementScore: number,\r\n): ItemModifierValuesT => {\r\n  let offset = requirementScore - 13\r\n  offset = offset > 0 ? offset : 0\r\n\r\n  let statCount = count + offset\r\n  statCount = statCount > 0 ? statCount : 0\r\n\r\n  let statRolls: ItemModifierValuesT = {}\r\n  for (let i = 0; i < statCount; ++i) {\r\n    let key = getRandom(shuffleArray(keys))\r\n    statRolls[key] = (statRolls[key] || 0) + 1\r\n  }\r\n  return statRolls\r\n}\r\n","import {\r\n  CharacterSkillCheckKeyT,\r\n  CharacterAbilityKeyT,\r\n  CharacterResourceKeyT,\r\n} from '../../../types/Character'\r\nimport { ItemRarityT } from '../../../types/Item'\r\nimport { ArmorTypeT } from '../../../types/Armor'\r\nimport { getRandom } from '../../../util/getRandom'\r\nimport { ItemModifierValuesT } from '../makeItem'\r\nimport { ArmorUniqueNames } from './names'\r\nimport { DamageTypeRollsT } from '../../../types/Damage'\r\nimport { shuffleArray, getItemStatRolls } from '../util'\r\nimport { quickRoll, makeCharacterRoll } from '../../../types/Roll2'\r\n\r\nexport const ArmorRequirementKeys: Record<\r\n  ArmorTypeT,\r\n  CharacterAbilityKeyT[]\r\n> = {\r\n  helmet: ['strength', 'dexterity'],\r\n  cowl: ['dexterity', 'intelligence'],\r\n  chestplate: ['strength', 'vigor'],\r\n  robe: ['dexterity', 'intelligence'],\r\n  gloves: ['strength', 'dexterity', 'intelligence'],\r\n  ring: ['strength', 'dexterity', 'intelligence'],\r\n  boots: ['strength', 'dexterity', 'intelligence'],\r\n}\r\n\r\nexport const ArmorCostsT: Record<ArmorTypeT, number> = {\r\n  helmet: 1,\r\n  cowl: 1,\r\n  chestplate: 1,\r\n  robe: 1,\r\n  gloves: 2,\r\n  ring: 1,\r\n  boots: 2,\r\n}\r\n\r\nexport const ArmorResourcesT: Record<ArmorTypeT, CharacterResourceKeyT> = {\r\n  helmet: 'heads',\r\n  cowl: 'heads',\r\n  chestplate: 'bodies',\r\n  robe: 'bodies',\r\n  gloves: 'hands',\r\n  ring: 'fingers',\r\n  boots: 'feet',\r\n}\r\n\r\nexport type ArmorStatKeyT = Record<ArmorTypeT, CharacterSkillCheckKeyT[]>\r\nconst armorStatKeysBase: ArmorStatKeyT = {\r\n  helmet: ['strength', 'intelligence', 'vigor', 'accuracy'],\r\n  cowl: ['dexterity', 'intelligence', 'agility', 'evade'],\r\n  chestplate: ['strength', 'intelligence', 'vigor'],\r\n  robe: ['dexterity', 'intelligence', 'agility', 'evade'],\r\n  gloves: [\r\n    'strength',\r\n    'dexterity',\r\n    'intelligence',\r\n    'vigor',\r\n    'health',\r\n    'focus',\r\n    'agility',\r\n    'accuracy',\r\n  ],\r\n  ring: [\r\n    'strength',\r\n    'dexterity',\r\n    'intelligence',\r\n    'vigor',\r\n    'health',\r\n    'focus',\r\n    'will',\r\n    'perception',\r\n    'agility',\r\n    'accuracy',\r\n    'evade',\r\n  ],\r\n  boots: [\r\n    'strength',\r\n    'dexterity',\r\n    'intelligence',\r\n    'vigor',\r\n    'health',\r\n    'focus',\r\n    'agility',\r\n    'evade',\r\n  ],\r\n}\r\nexport const ArmorRarityStatKeys: Record<ItemRarityT, ArmorStatKeyT> = {\r\n  common: armorStatKeysBase,\r\n  uncommon: armorStatKeysBase,\r\n  rare: armorStatKeysBase,\r\n  legendary: armorStatKeysBase,\r\n  unique: armorStatKeysBase,\r\n  mythic: armorStatKeysBase,\r\n  set: armorStatKeysBase,\r\n}\r\n\r\nexport type ArmorNameKeyT = Record<ArmorTypeT, string>\r\nexport const ArmorNameKeys = (): Record<ItemRarityT, ArmorNameKeyT> => ({\r\n  common: {\r\n    helmet: 'Common Helmet',\r\n    cowl: 'Common Hood',\r\n    chestplate: 'Common Chestplate',\r\n    robe: 'Common Robe',\r\n    gloves: 'Common Gloves',\r\n    ring: 'Common Ring',\r\n    boots: 'Common Boots',\r\n  },\r\n  uncommon: {\r\n    helmet: 'Uncommon Helmet',\r\n    cowl: 'Uncommon Hood',\r\n    chestplate: 'Uncommon Chestplate',\r\n    robe: 'Uncommon Robe',\r\n    gloves: 'Uncommon Gloves',\r\n    ring: 'Uncommon Ring',\r\n    boots: 'Uncommon Boots',\r\n  },\r\n  rare: {\r\n    helmet: 'Rare Helmet',\r\n    cowl: 'Rare Hood',\r\n    chestplate: 'Rare Chestplate',\r\n    robe: 'Rare Robe',\r\n    gloves: 'Rare Gloves',\r\n    ring: 'Rare Ring',\r\n    boots: 'Rare Boots',\r\n  },\r\n  legendary: {\r\n    helmet: 'Epic Helmet',\r\n    cowl: 'Epic Hood',\r\n    chestplate: 'Epic Chestplate',\r\n    robe: 'Epic Robe',\r\n    gloves: 'Epic Gloves',\r\n    ring: 'Epic Ring',\r\n    boots: 'Epic Boots',\r\n  },\r\n  unique: {\r\n    helmet: getRandom(ArmorUniqueNames.helmet),\r\n    cowl: getRandom(ArmorUniqueNames.cowl),\r\n    chestplate: getRandom(ArmorUniqueNames.chestplate),\r\n    robe: getRandom(ArmorUniqueNames.robe),\r\n    gloves: getRandom(ArmorUniqueNames.gloves),\r\n    ring: getRandom(ArmorUniqueNames.ring),\r\n    boots: getRandom(ArmorUniqueNames.boots),\r\n  },\r\n  mythic: {\r\n    helmet: 'Mythic Helmet',\r\n    cowl: 'Mythic Hood',\r\n    chestplate: 'Mythic Chestplate',\r\n    robe: 'Mythic Robe',\r\n    gloves: 'Mythic Gloves',\r\n    ring: 'Mythic Ring',\r\n    boots: 'Mythic Boots',\r\n  },\r\n  set: {\r\n    helmet: 'Set Helmet',\r\n    cowl: 'Set Hood',\r\n    chestplate: 'Set Chestplate',\r\n    robe: 'Set Robe',\r\n    gloves: 'Set Gloves',\r\n    ring: 'Set Ring',\r\n    boots: 'Set Boots',\r\n  },\r\n})\r\n\r\nexport type ArmorStatCountT = Record<ArmorTypeT, number[]>\r\nexport const ArmorRarityStatCounts: Record<ItemRarityT, number> = {\r\n  common: 0,\r\n  uncommon: 1,\r\n  rare: 2,\r\n  legendary: 3,\r\n  unique: 4,\r\n  mythic: 5,\r\n  set: 5,\r\n}\r\n\r\nexport const makeStaticRoll = (str: string) =>\r\n  makeCharacterRoll([], '', quickRoll(str))\r\nexport const makeRoll = (str: string) => makeCharacterRoll([], str)\r\nexport type ArmorResistanceT = Record<ArmorTypeT, DamageTypeRollsT>\r\nexport const ArmorResistances = (): Record<ItemRarityT, ArmorResistanceT> => ({\r\n  common: {\r\n    helmet: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n    },\r\n    cowl: {\r\n      blood: makeStaticRoll('1d2-1'),\r\n      light: makeStaticRoll('1d2-1'),\r\n      dark: makeStaticRoll('1d2-1'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n      fire: makeStaticRoll('1d2-1'),\r\n    },\r\n    robe: {\r\n      fire: makeStaticRoll('1d2-1'),\r\n      blood: makeStaticRoll('1d2-1'),\r\n      light: makeStaticRoll('1d2-1'),\r\n      dark: makeStaticRoll('1d2-1'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n    },\r\n    ring: {\r\n      blood: makeStaticRoll('1d2-1'),\r\n      light: makeStaticRoll('1d2-1'),\r\n      dark: makeStaticRoll('1d2-1'),\r\n    },\r\n    boots: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n    },\r\n  },\r\n  uncommon: {\r\n    helmet: {\r\n      slashing: makeStaticRoll('1d3-1'),\r\n      piercing: makeStaticRoll('1d3-1'),\r\n    },\r\n    cowl: {\r\n      blood: makeStaticRoll('1d3-1'),\r\n      light: makeStaticRoll('1d3-1'),\r\n      dark: makeStaticRoll('1d3-1'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeStaticRoll('1d3-1'),\r\n      piercing: makeStaticRoll('1d3-1'),\r\n      fire: makeStaticRoll('1d3-1'),\r\n    },\r\n    robe: {\r\n      fire: makeStaticRoll('1d3-1'),\r\n      blood: makeStaticRoll('1d3-1'),\r\n      light: makeStaticRoll('1d3-1'),\r\n      dark: makeStaticRoll('1d3-1'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d3-1'),\r\n      piercing: makeStaticRoll('1d3-1'),\r\n    },\r\n    ring: {\r\n      blood: makeStaticRoll('1d3-1'),\r\n      light: makeStaticRoll('1d3-1'),\r\n      dark: makeStaticRoll('1d3-1'),\r\n    },\r\n    boots: {\r\n      slashing: makeStaticRoll('1d3-1'),\r\n      piercing: makeStaticRoll('1d3-1'),\r\n    },\r\n  },\r\n  rare: {\r\n    helmet: {\r\n      slashing: makeStaticRoll('1d4-1'),\r\n      piercing: makeStaticRoll('1d4-1'),\r\n    },\r\n    cowl: {\r\n      blood: makeStaticRoll('1d4-1'),\r\n      light: makeStaticRoll('1d4-1'),\r\n      dark: makeStaticRoll('1d4-1'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeStaticRoll('1d4-1'),\r\n      piercing: makeStaticRoll('1d4-1'),\r\n      fire: makeStaticRoll('1d4-1'),\r\n    },\r\n    robe: {\r\n      fire: makeStaticRoll('1d4-1'),\r\n      blood: makeStaticRoll('1d4-1'),\r\n      light: makeStaticRoll('1d4-1'),\r\n      dark: makeStaticRoll('1d4-1'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d4-1'),\r\n      piercing: makeStaticRoll('1d4-1'),\r\n    },\r\n    ring: {\r\n      blood: makeStaticRoll('1d4-1'),\r\n      light: makeStaticRoll('1d4-1'),\r\n      dark: makeStaticRoll('1d4-1'),\r\n    },\r\n    boots: {\r\n      slashing: makeStaticRoll('1d4-1'),\r\n      piercing: makeStaticRoll('1d4-1'),\r\n    },\r\n  },\r\n  legendary: {\r\n    helmet: {\r\n      slashing: makeStaticRoll('1d5-1'),\r\n      piercing: makeStaticRoll('1d5-1'),\r\n    },\r\n    cowl: {\r\n      blood: makeStaticRoll('1d5-1'),\r\n      light: makeStaticRoll('1d5-1'),\r\n      dark: makeStaticRoll('1d5-1'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeStaticRoll('1d5-1'),\r\n      piercing: makeStaticRoll('1d5-1'),\r\n      fire: makeStaticRoll('1d5-1'),\r\n    },\r\n    robe: {\r\n      fire: makeStaticRoll('1d5-1'),\r\n      blood: makeStaticRoll('1d5-1'),\r\n      light: makeStaticRoll('1d5-1'),\r\n      dark: makeStaticRoll('1d5-1'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d5-1'),\r\n      piercing: makeStaticRoll('1d5-1'),\r\n    },\r\n    ring: {\r\n      fire: makeStaticRoll('1d5-1'),\r\n      blood: makeStaticRoll('1d5-1'),\r\n      light: makeStaticRoll('1d5-1'),\r\n      dark: makeStaticRoll('1d5-1'),\r\n    },\r\n    boots: {\r\n      slashing: makeStaticRoll('1d5-1'),\r\n      piercing: makeStaticRoll('1d5-1'),\r\n    },\r\n  },\r\n  unique: {\r\n    helmet: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    cowl: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    robe: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    ring: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    boots: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n  },\r\n  mythic: {\r\n    helmet: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    cowl: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    robe: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    ring: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    boots: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n  },\r\n  set: {\r\n    helmet: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    cowl: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    chestplate: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    robe: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    gloves: {\r\n      slashing: makeStaticRoll('1d2-1'),\r\n      piercing: makeStaticRoll('1d2-1'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    ring: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n    boots: {\r\n      slashing: makeRoll('1d6'),\r\n      piercing: makeRoll('1d6'),\r\n      fire: makeRoll('1d6'),\r\n      blood: makeRoll('1d6'),\r\n      light: makeRoll('1d6'),\r\n      dark: makeRoll('1d6'),\r\n    },\r\n  },\r\n})\r\n\r\nexport const getArmorStatRolls = (\r\n  type: ArmorTypeT,\r\n  rarity: ItemRarityT,\r\n  requirementScore: number,\r\n): ItemModifierValuesT => {\r\n  const keys = shuffleArray(ArmorRarityStatKeys[rarity][type])\r\n  let counts = ArmorRarityStatCounts[rarity]\r\n  return getItemStatRolls(keys, counts, requirementScore)\r\n}\r\n","import { ArmorT } from '../../../../types/Armor'\r\n\r\nexport const UNIQUE_ARMORS: ArmorT[] = []\r\n","import { ArmorT } from '../../../../types/Armor'\r\n\r\nexport const MYTHIC_ARMORS: ArmorT[] = []\r\n","import { ArmorT } from '../../../../types/Armor'\r\n\r\nexport const SET_ARMORS: ArmorT[] = []\r\n","import { BASE_EQUIPPABLE, makeRequirementCheck } from '../../util'\r\nimport { DamageTypeRollsT } from '../../../types/Damage'\r\nimport { ItemRarityT } from '../../../types/Item'\r\nimport { ItemModifierValuesT } from '../makeItem'\r\nimport { ArmorT, ArmorTypeT } from '../../../types/Armor'\r\nimport { CharacterResourceKeyT } from '../../../types/Character'\r\nimport { getRandom } from '../../../util/getRandom'\r\nimport {\r\n  ArmorRequirementKeys,\r\n  ArmorNameKeys,\r\n  ArmorCostsT,\r\n  ArmorResourcesT,\r\n  getArmorStatRolls,\r\n  ArmorResistances,\r\n} from './stats'\r\nimport { UNIQUE_ARMORS } from './uniques'\r\nimport { MYTHIC_ARMORS } from './mythics'\r\nimport { Rarity3d6Map } from '../util'\r\nimport { SET_ARMORS } from './sets'\r\nimport { CharacterCheckT, quickRoll } from '../../../types/Roll2'\r\n\r\nexport const buildArmor = (type: ArmorTypeT, rarity?: ItemRarityT): ArmorT => {\r\n  rarity = rarity || Rarity3d6Map[quickRoll('3d6')]\r\n  const requirementCheck = makeRequirementCheck(\r\n    [getRandom(ArmorRequirementKeys[type])],\r\n    10, //getRollValue('3d6'),\r\n  )\r\n  const unique = UNIQUE_ARMORS.find(\r\n    (a) => a.armorType === type || a.requirementCheck === requirementCheck,\r\n  )\r\n  const mythic = MYTHIC_ARMORS.find(\r\n    (a) => a.armorType === type || a.requirementCheck === requirementCheck,\r\n  )\r\n  const set = SET_ARMORS.find(\r\n    (a) => a.armorType === type || a.requirementCheck === requirementCheck,\r\n  )\r\n  if (rarity === 'unique' && unique) return unique\r\n  if (rarity === 'mythic' && mythic) return mythic\r\n  if (rarity === 'set' && set) return set\r\n  return createArmor(\r\n    type,\r\n    ArmorNameKeys()[rarity][type],\r\n    ArmorCostsT[type],\r\n    ArmorResourcesT[type],\r\n    requirementCheck,\r\n    getArmorStatRolls(type, rarity, requirementCheck.value),\r\n    ArmorResistances()[rarity][type],\r\n    rarity,\r\n  )\r\n}\r\n\r\nexport const createArmor = (\r\n  armorType: ArmorTypeT,\r\n  name: string,\r\n  cost: number,\r\n  resource: CharacterResourceKeyT,\r\n  requirementCheck: CharacterCheckT,\r\n  statRolls: ItemModifierValuesT,\r\n  damageRolls: DamageTypeRollsT,\r\n  rarity: ItemRarityT,\r\n): ArmorT => {\r\n  const base = BASE_EQUIPPABLE('armor')\r\n  return {\r\n    ...base,\r\n    type: 'armor',\r\n    armorType,\r\n    name,\r\n    cost,\r\n    resource,\r\n    requirementCheck,\r\n    rarity,\r\n    damageResistances: {\r\n      ...base.damageResistances,\r\n      ...damageRolls,\r\n    },\r\n    traits: [\r\n      {\r\n        id: `${base.id}--bonus`,\r\n        name: 'Armor Trait',\r\n        duration: -1,\r\n        healthOffset: 0,\r\n        focusOffset: 0,\r\n        abilitiesModifiers: {\r\n          strength: statRolls.strength || 0,\r\n          dexterity: statRolls.dexterity || 0,\r\n          intelligence: statRolls.intelligence || 0,\r\n          vigor: statRolls.vigor || 0,\r\n        },\r\n        statsModifiers: {\r\n          health: statRolls.health || 0,\r\n          focus: statRolls.focus || 0,\r\n          will: statRolls.will || 0,\r\n          perception: statRolls.perception || 0,\r\n          agility: statRolls.agility || 0,\r\n          accuracy: statRolls.accuracy || 0,\r\n          evade: statRolls.evade || 0,\r\n        },\r\n      },\r\n    ],\r\n  }\r\n}\r\n","import {\r\n  CharacterSkillCheckKeyT,\r\n  CharacterAbilityKeyT,\r\n} from '../../../types/Character'\r\nimport { ItemRarityT } from '../../../types/Item'\r\nimport { ArmorTypeT } from '../../../types/Armor'\r\nimport { getRandom } from '../../../util/getRandom'\r\nimport { ItemModifierValuesT } from '../makeItem'\r\nimport { DamageTypeRollsT, DamageElementTypeT } from '../../../types/Damage'\r\nimport { shuffleArray, getItemStatRolls } from '../util'\r\nimport { WeaponTypeT } from '../../../types/Weapon'\r\nimport {\r\n  quickRoll,\r\n  CharacterRollT,\r\n  makeCharacterRoll,\r\n} from '../../../types/Roll2'\r\n\r\nexport const WeaponRequirementKeys: Record<\r\n  WeaponTypeT,\r\n  CharacterAbilityKeyT[]\r\n> = {\r\n  fists: ['strength'],\r\n  axe: ['strength'],\r\n  greataxe: ['strength'],\r\n  flail: ['strength'],\r\n  daggers: ['dexterity'],\r\n  katana: ['dexterity'],\r\n  rapier: ['dexterity'],\r\n  wand: ['intelligence'],\r\n  staff: ['intelligence'],\r\n  elementalSword: ['strength', 'intelligence'],\r\n  elementalGreatsword: ['strength', 'intelligence'],\r\n  sword: ['strength', 'dexterity'],\r\n  greatsword: ['strength', 'dexterity'],\r\n  pistol: ['dexterity', 'intelligence'],\r\n  crossbow: ['dexterity', 'intelligence'],\r\n}\r\n\r\nexport const WeaponCosts: Record<WeaponTypeT, number> = {\r\n  fists: 1,\r\n  axe: 1,\r\n  greataxe: 2,\r\n  flail: 1,\r\n  daggers: 2,\r\n  katana: 1,\r\n  rapier: 1,\r\n  wand: 1,\r\n  staff: 2,\r\n  elementalSword: 1,\r\n  elementalGreatsword: 2,\r\n  sword: 1,\r\n  greatsword: 2,\r\n  pistol: 1,\r\n  crossbow: 2,\r\n}\r\n\r\nexport type WeaponStatKeyT = Record<WeaponTypeT, CharacterSkillCheckKeyT[]>\r\nconst weaponStatKeysBase: WeaponStatKeyT = {\r\n  fists: ['strength', 'vigor'],\r\n  axe: ['strength', 'vigor', 'health', 'agility'],\r\n  greataxe: ['strength', 'vigor', 'health', 'agility'],\r\n  flail: ['strength', 'vigor', 'health', 'agility'],\r\n  daggers: ['dexterity', 'vigor', 'health', 'agility'],\r\n  katana: ['dexterity', 'vigor', 'health', 'agility'],\r\n  rapier: ['dexterity', 'vigor', 'health', 'agility'],\r\n  wand: ['intelligence', 'vigor', 'agility'],\r\n  staff: ['intelligence', 'vigor', 'perception', 'will'],\r\n  elementalSword: ['intelligence', 'vigor', 'strength', 'will'],\r\n  elementalGreatsword: ['intelligence', 'vigor', 'strength', 'will'],\r\n  sword: ['strength', 'intelligence', 'health', 'agility'],\r\n  greatsword: ['strength', 'intelligence', 'health', 'vigor'],\r\n  pistol: ['dexterity', 'intelligence', 'perception', 'vigor'],\r\n  crossbow: ['dexterity', 'intelligence', 'perception', 'vigor'],\r\n}\r\nexport const WeaponRarityStatKeys: Record<ItemRarityT, WeaponStatKeyT> = {\r\n  common: weaponStatKeysBase,\r\n  uncommon: weaponStatKeysBase,\r\n  rare: weaponStatKeysBase,\r\n  legendary: weaponStatKeysBase,\r\n  unique: weaponStatKeysBase,\r\n  mythic: weaponStatKeysBase,\r\n  set: weaponStatKeysBase,\r\n}\r\n\r\nexport type WeaponNameKeyT = Record<WeaponTypeT, string>\r\nexport const WeaponNameKeys = (): Record<ItemRarityT, WeaponNameKeyT> => ({\r\n  common: {\r\n    fists: 'Unarmed',\r\n    axe: 'Common Axe',\r\n    greataxe: 'Common Greataxe',\r\n    flail: 'Common Flail',\r\n    daggers: 'Common Daggers',\r\n    katana: 'Common Katana',\r\n    rapier: 'Common Rapier',\r\n    wand: 'Common Wand',\r\n    staff: 'Common Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Common Sword',\r\n    greatsword: 'Common Greatsword',\r\n    pistol: 'Common Pistol',\r\n    crossbow: 'Common Crossbow',\r\n  },\r\n  uncommon: {\r\n    fists: 'Unarmed',\r\n    axe: 'Uncommon Axe',\r\n    greataxe: 'Uncommon Greataxe',\r\n    flail: 'Uncommon Flail',\r\n    daggers: 'Uncommon Daggers',\r\n    katana: 'Uncommon Katana',\r\n    rapier: 'Uncommon Rapier',\r\n    wand: 'Uncommon Wand',\r\n    staff: 'Uncommon Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Uncommon Sword',\r\n    greatsword: 'Uncommon Greatsword',\r\n    pistol: 'Uncommon Pistol',\r\n    crossbow: 'Uncommon Crossbow',\r\n  },\r\n  rare: {\r\n    fists: 'Unarmed',\r\n    axe: 'Rare Axe',\r\n    greataxe: 'Rare Greataxe',\r\n    flail: 'Rare Flail',\r\n    daggers: 'Rare Daggers',\r\n    katana: 'Rare Katana',\r\n    rapier: 'Rare Rapier',\r\n    wand: 'Rare Wand',\r\n    staff: 'Rare Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Rare Sword',\r\n    greatsword: 'Rare Greatsword',\r\n    pistol: 'Rare Pistol',\r\n    crossbow: 'Rare Crossbow',\r\n  },\r\n  legendary: {\r\n    fists: 'Unarmed',\r\n    axe: 'Epic Axe',\r\n    greataxe: 'Epic Greataxe',\r\n    flail: 'Epic Flail',\r\n    daggers: 'Epic Daggers',\r\n    katana: 'Epic Katana',\r\n    rapier: 'Epic Rapier',\r\n    wand: 'Epic Wand',\r\n    staff: 'Epic Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Epic Sword',\r\n    greatsword: 'Epic Greatsword',\r\n    pistol: 'Epic Pistol',\r\n    crossbow: 'Epic Crossbow',\r\n  },\r\n  unique: {\r\n    fists: 'Unarmed',\r\n    axe: 'Unique Axe',\r\n    greataxe: 'Unique Greataxe',\r\n    flail: 'Unique Flail',\r\n    daggers: 'Unique Daggers',\r\n    katana: 'Unique Katana',\r\n    rapier: 'Unique Rapier',\r\n    wand: 'Unique Wand',\r\n    staff: 'Unique Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Unique Sword',\r\n    greatsword: 'Unique Greatsword',\r\n    pistol: 'Unique Pistol',\r\n    crossbow: 'Unique Crossbow',\r\n  },\r\n  mythic: {\r\n    fists: 'Unarmed',\r\n    axe: 'Mythic Axe',\r\n    greataxe: 'Mythic Greataxe',\r\n    flail: 'Mythic Flail',\r\n    daggers: 'Mythic Daggers',\r\n    katana: 'Mythic Katana',\r\n    rapier: 'Mythic Rapier',\r\n    wand: 'Mythic Wand',\r\n    staff: 'Mythic Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Mythic Sword',\r\n    greatsword: 'Mythic Greatsword',\r\n    pistol: 'Mythic Pistol',\r\n    crossbow: 'Mythic Crossbow',\r\n  },\r\n  set: {\r\n    fists: 'Unarmed',\r\n    axe: 'Set Axe',\r\n    greataxe: 'Set Greataxe',\r\n    flail: 'Set Flail',\r\n    daggers: 'Set Daggers',\r\n    katana: 'Set Katana',\r\n    rapier: 'Set Rapier',\r\n    wand: 'Set Wand',\r\n    staff: 'Set Staff',\r\n    elementalSword: 'Elemental Sword',\r\n    elementalGreatsword: 'Elemental Greatsword',\r\n    sword: 'Set Sword',\r\n    greatsword: 'Set Greatsword',\r\n    pistol: 'Set Pistol',\r\n    crossbow: 'Set Crossbow',\r\n  },\r\n})\r\n\r\nexport type ArmorStatCountT = Record<ArmorTypeT, number[]>\r\nexport const WeaponRarityStatCounts: Record<ItemRarityT, number> = {\r\n  common: 1,\r\n  uncommon: 2,\r\n  rare: 3,\r\n  legendary: 4,\r\n  unique: 5,\r\n  mythic: 6,\r\n  set: 6,\r\n}\r\n\r\nexport const makeDamageRoll = (\r\n  rollString: string,\r\n  modString: string,\r\n  keys: CharacterSkillCheckKeyT[] = [],\r\n  modCoef: number = -1,\r\n  mod: number = 0,\r\n): CharacterRollT => {\r\n  return makeCharacterRoll(\r\n    keys,\r\n    rollString,\r\n    quickRoll(modString) * modCoef + mod,\r\n  )\r\n}\r\n\r\nexport type WeaponDamagesT = Record<WeaponTypeT, DamageTypeRollsT>\r\nexport const WeaponDamages = (): Record<ItemRarityT, WeaponDamagesT> => {\r\n  const element: DamageElementTypeT = getRandom<DamageElementTypeT>([\r\n    'fire',\r\n    'blood',\r\n    'dark',\r\n    'light',\r\n  ])\r\n  return {\r\n    common: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    uncommon: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    rare: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    legendary: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    unique: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    mythic: {\r\n      fists: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      axe: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      greataxe: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['strength']),\r\n      },\r\n      flail: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['strength']),\r\n      },\r\n      daggers: {\r\n        slashing: makeDamageRoll('2d6', '1d6', ['dexterity']),\r\n      },\r\n      katana: {\r\n        slashing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      rapier: {\r\n        piercing: makeDamageRoll('1d6', '3d4', ['dexterity']),\r\n      },\r\n      wand: {\r\n        [element]: makeDamageRoll('1d6', '3d4', ['intelligence']),\r\n      },\r\n      staff: {\r\n        [element]: makeDamageRoll('2d6', '1d6', ['intelligence']),\r\n      },\r\n      elementalSword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      elementalGreatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', [\r\n          getRandom(['strength', 'dexterity']),\r\n        ]),\r\n        [element]: makeDamageRoll('1d4', '3d4', ['intelligence']),\r\n      },\r\n      sword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength']),\r\n      },\r\n      greatsword: {\r\n        slashing: makeDamageRoll('1d6', '3d6', ['strength', 'dexterity']),\r\n      },\r\n      pistol: {\r\n        piercing: makeDamageRoll('1d4', '3d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '3d6', ['intelligence']),\r\n      },\r\n      crossbow: {\r\n        piercing: makeDamageRoll('1d4', '2d6', ['dexterity']),\r\n        fire: makeDamageRoll('1d4', '2d6', ['intelligence']),\r\n      },\r\n    },\r\n    set: {\r\n      fists: {},\r\n      axe: {},\r\n      greataxe: {},\r\n      flail: {},\r\n      daggers: {},\r\n      katana: {},\r\n      rapier: {},\r\n      wand: {},\r\n      staff: {},\r\n      elementalSword: {},\r\n      elementalGreatsword: {},\r\n      sword: {},\r\n      greatsword: {},\r\n      pistol: {},\r\n      crossbow: {},\r\n    },\r\n  }\r\n}\r\n\r\nexport const getWeaponStatRolls = (\r\n  type: WeaponTypeT,\r\n  rarity: ItemRarityT,\r\n  requirementScore: number,\r\n): ItemModifierValuesT => {\r\n  const keys = shuffleArray(WeaponRarityStatKeys[rarity][type])\r\n  const counts = WeaponRarityStatCounts[rarity]\r\n  return getItemStatRolls(keys, counts, requirementScore)\r\n}\r\n","import { BASE_EQUIPPABLE, makeRequirementCheck, makeTrait } from '../../util'\r\nimport { WeaponT, WeaponTypeT } from '../../../types/Weapon'\r\nimport { DamageTypeRollsT } from '../../../types/Damage'\r\nimport { ItemRarityT } from '../../../types/Item'\r\nimport { ItemModifierValuesT } from '../makeItem'\r\nimport { Rarity3d6Map } from '../util'\r\nimport { getRandom } from '../../../util/getRandom'\r\nimport {\r\n  WeaponRequirementKeys,\r\n  WeaponCosts,\r\n  getWeaponStatRolls,\r\n  WeaponNameKeys,\r\n  WeaponDamages,\r\n} from './stats'\r\nimport {\r\n  CharacterCheckT,\r\n  makeCharacterCheck,\r\n  quickRoll,\r\n} from '../../../types/Roll2'\r\n\r\nexport const buildWeapon = (\r\n  type: WeaponTypeT,\r\n  rarity?: ItemRarityT,\r\n): WeaponT => {\r\n  rarity = rarity || Rarity3d6Map[quickRoll('3d6')]\r\n  if (rarity === 'set') rarity = 'mythic'\r\n  const requirementCheck = makeRequirementCheck(\r\n    [getRandom(WeaponRequirementKeys[type])],\r\n    10, //getRollValue('3d6'),\r\n  )\r\n  return createWeapon(\r\n    type,\r\n    WeaponNameKeys()[rarity][type],\r\n    WeaponCosts[type],\r\n    requirementCheck,\r\n    0,\r\n    getWeaponStatRolls(type, rarity, requirementCheck.value),\r\n    WeaponDamages()[rarity][type],\r\n    rarity,\r\n  )\r\n}\r\n\r\nexport const createWeapon = (\r\n  weaponType: WeaponTypeT,\r\n  name: string,\r\n  cost: number,\r\n  requirementCheck: CharacterCheckT,\r\n  accuracyModifier: number,\r\n  statRolls: ItemModifierValuesT,\r\n  damageRolls: DamageTypeRollsT,\r\n  rarity: ItemRarityT,\r\n  rest: Partial<WeaponT> = {},\r\n): WeaponT => {\r\n  const base = BASE_EQUIPPABLE('weapon')\r\n  return {\r\n    ...base,\r\n    type: 'weapon',\r\n    weaponType,\r\n    name,\r\n    cost,\r\n    rarity,\r\n    requirementCheck,\r\n    accuracyCheck: makeCharacterCheck(\r\n      ['accuracy'],\r\n      undefined,\r\n      0,\r\n      accuracyModifier,\r\n    ),\r\n    damageRolls,\r\n    traits: [\r\n      {\r\n        ...makeTrait(),\r\n        id: `${base.id}--bonus`,\r\n        name: 'Weapon Trait',\r\n        abilitiesModifiers: {\r\n          strength: statRolls.strength || 0,\r\n          dexterity: statRolls.dexterity || 0,\r\n          intelligence: statRolls.intelligence || 0,\r\n          vigor: statRolls.vigor || 0,\r\n        },\r\n        statsModifiers: {\r\n          health: statRolls.health || 0,\r\n          focus: statRolls.focus || 0,\r\n          will: statRolls.will || 0,\r\n          perception: statRolls.perception || 0,\r\n          agility: statRolls.agility || 0,\r\n          accuracy: statRolls.accuracy || 0,\r\n          evade: statRolls.evade || 0,\r\n        },\r\n      },\r\n    ],\r\n    events: {},\r\n    slotCount: 0,\r\n    slots: [],\r\n    ...rest,\r\n  }\r\n}\r\n","import { SkillT } from '../types/Skill'\r\nimport { v4 } from 'uuid'\r\nimport {\r\n  makeCharacterCheck,\r\n  makeCharacterRoll,\r\n  makeStandardCharacterCheck,\r\n  makeRoll,\r\n} from '../types/Roll2'\r\nimport { makeRequirementCheck, makeTrait } from './util'\r\nimport Healing from '../assets/img/healing1.png'\r\nimport Fireball from '../assets/img/fireball.png'\r\nimport Thunderbolt from '../assets/img/thunderbolt.png'\r\nimport DarkBlast from '../assets/img/dark-blast.png'\r\nimport CripplingBlow from '../assets/img/crippling-blow.png'\r\nimport Wrath from '../assets/img/wrath.png'\r\nimport Charge from '../assets/img/charge.png'\r\nimport SkillShot from '../assets/img/headshot.png'\r\nimport ShadowStrike from '../assets/img/shadow-strike.png'\r\nimport Vanish from '../assets/img/vanish.png'\r\nimport Inspect from '../assets/img/inspect.png'\r\nimport WeaponAttack from '../assets/img/weapon-attack.png'\r\n\r\nexport const makeSkill = (name: string = 'Weapon Attack'): SkillT => {\r\n  return {\r\n    id: v4(),\r\n    name,\r\n    imgSrc: '',\r\n    requirementCheck: makeRequirementCheck(['intelligence'], 1),\r\n    damageRolls: {},\r\n    targetTraits: [],\r\n    sourceTraits: [],\r\n    events: {},\r\n    combineWeaponDamage: true,\r\n    checkDodgeForTraits: true,\r\n    focusCost: 0,\r\n    target: true,\r\n  }\r\n}\r\n\r\nexport const BASIC_ATTACK: SkillT = {\r\n  ...makeSkill(),\r\n  imgSrc: WeaponAttack,\r\n}\r\nexport const INSPECT: SkillT = {\r\n  ...makeSkill('Inspect'),\r\n  imgSrc: Inspect,\r\n  combineWeaponDamage: false,\r\n  damageRolls: {},\r\n  inspected: true,\r\n}\r\n\r\nexport const FIREBALL: SkillT = {\r\n  ...makeSkill('Fireball'),\r\n  imgSrc: Fireball,\r\n  check: makeCharacterCheck(['intelligence']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    fire: makeCharacterRoll([], '4d10', -7),\r\n  },\r\n  focusCost: 10,\r\n}\r\nexport const CRIPPLING_BLOW: SkillT = {\r\n  ...makeSkill('Critical Blow'),\r\n  imgSrc: CripplingBlow,\r\n  requirementCheck: makeRequirementCheck(['strength'], 10),\r\n  combineWeaponDamage: true,\r\n  checkDodgeForTraits: true,\r\n  damageRolls: {},\r\n  targetTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 2,\r\n      abilitiesModifiers: {\r\n        strength: 0,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: -5,\r\n      },\r\n    },\r\n    {\r\n      ...makeTrait(),\r\n      duration: -1,\r\n      focusOffset: -3,\r\n      abilitiesModifiers: {\r\n        strength: 0,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: 0,\r\n      },\r\n    },\r\n  ],\r\n  focusCost: 1,\r\n}\r\nexport const THUNDERBOLT: SkillT = {\r\n  ...makeSkill('Thunderbolt'),\r\n  imgSrc: Thunderbolt,\r\n  check: makeStandardCharacterCheck(['intelligence'], -3),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    light: makeCharacterRoll(['intelligence']),\r\n  },\r\n  focusCost: 3,\r\n}\r\nexport const DARK_BLAST: SkillT = {\r\n  ...makeSkill('Dark Blast'),\r\n  imgSrc: DarkBlast,\r\n  check: makeCharacterCheck(['intelligence']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    dark: makeCharacterRoll(['intelligence'], '2d6', -8),\r\n  },\r\n  focusCost: 5,\r\n}\r\nexport const HEALING: SkillT = {\r\n  ...makeSkill('Healing'),\r\n  target: false,\r\n  imgSrc: Healing,\r\n  check: makeCharacterCheck(['intelligence']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {},\r\n  focusCost: 5,\r\n  sourceTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      healthOffset: 15,\r\n    },\r\n  ],\r\n}\r\nexport const WRATH: SkillT = {\r\n  ...makeSkill('Wrath'),\r\n  imgSrc: Wrath,\r\n  check: makeCharacterCheck(['strength']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: { piercing: makeCharacterRoll([], '1d6') },\r\n  focusCost: 5,\r\n  sourceTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 4,\r\n      abilitiesModifiers: {\r\n        strength: 2,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: 0,\r\n      },\r\n    },\r\n  ],\r\n  targetTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 4,\r\n      abilitiesModifiers: {\r\n        strength: -2,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: 0,\r\n      },\r\n    },\r\n  ],\r\n}\r\nexport const CHARGE: SkillT = {\r\n  ...makeSkill('Charge'),\r\n  imgSrc: Charge,\r\n  focusCost: 5,\r\n  check: makeCharacterCheck(['strength']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    slashing: makeCharacterRoll(['strength'], '3d6', -12),\r\n    piercing: makeCharacterRoll(['strength'], '3d6', -12),\r\n  },\r\n  sourceTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 2,\r\n      statsModifiers: {\r\n        health: 0,\r\n        focus: 0,\r\n        will: 0,\r\n        perception: 0,\r\n        accuracy: 0,\r\n        evade: 0,\r\n        agility: 3,\r\n      },\r\n    },\r\n  ],\r\n  targetTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 2,\r\n      abilitiesModifiers: {\r\n        strength: 0,\r\n        dexterity: 0,\r\n        intelligence: 0,\r\n        vigor: -3,\r\n      },\r\n    },\r\n  ],\r\n}\r\n\r\nexport const SKILL_SHOT: SkillT = {\r\n  ...makeSkill('Skill Shot'),\r\n  imgSrc: SkillShot,\r\n  focusCost: 12,\r\n  check: makeStandardCharacterCheck(['dexterity'], -4),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    piercing: makeCharacterRoll(['dexterity'], '1d20'),\r\n    fire: makeCharacterRoll([], '8d2', -8),\r\n  },\r\n  targetTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 2,\r\n      abilitiesModifiers: {\r\n        strength: 0,\r\n        dexterity: 0,\r\n        intelligence: -2,\r\n        vigor: 0,\r\n      },\r\n    },\r\n  ],\r\n}\r\n\r\nexport const VANISH: SkillT = {\r\n  ...makeSkill('Vanish'),\r\n  imgSrc: Vanish,\r\n  focusCost: 8,\r\n  check: makeStandardCharacterCheck(['dexterity']),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {},\r\n  target: false,\r\n  sourceTraits: [\r\n    {\r\n      ...makeTrait(),\r\n      duration: 2,\r\n      statsModifiers: {\r\n        health: 0,\r\n        focus: 0,\r\n        will: 0,\r\n        perception: 2,\r\n        agility: -2,\r\n        accuracy: 0,\r\n        evade: 20,\r\n      },\r\n    },\r\n  ],\r\n}\r\n\r\nexport const SHADOW_STRIKE: SkillT = {\r\n  ...makeSkill('Shadow Strike'),\r\n  imgSrc: ShadowStrike,\r\n  focusCost: 7,\r\n  check: makeStandardCharacterCheck(['evade'], -3),\r\n  combineWeaponDamage: false,\r\n  damageRolls: {\r\n    piercing: makeCharacterRoll(['evade'], '1d6', -6),\r\n  },\r\n}\r\n","import { CharacterT } from '../types/Character'\r\nimport { buildArmor } from './builders/armor/createArmor'\r\nimport { getRandom } from '../util/getRandom'\r\nimport { buildWeapon } from './builders/weapons/createWeapon'\r\nimport { v4 } from 'uuid'\r\nimport { makeSkill, BASIC_ATTACK, INSPECT } from './makeSkill'\r\nimport { makeCharacterRoll } from '../types/Roll2'\r\n/*\r\nimport { Config, adjectives, names } from 'unique-names-generator'\r\n\r\nconst config: Config = {\r\n  dictionaries: [adjectives, names],\r\n  length: 2,\r\n  separator: ' ',\r\n}\r\n*/\r\n\r\nexport const makeCharacter = (name?: string): CharacterT => ({\r\n  name: name || '-- init --', //uniqueNamesGenerator(config),\r\n  id: v4(),\r\n  power: 600,\r\n  resources: {\r\n    characterPoints: 0,\r\n    weaponHands: 1,\r\n    heads: 0,\r\n    bodies: 0,\r\n    hands: 0,\r\n    fingers: 10,\r\n    feet: 0,\r\n  },\r\n  abilities: {\r\n    strength: 10,\r\n    dexterity: 10,\r\n    intelligence: 10,\r\n    vigor: 10,\r\n  },\r\n  damageResistances: {\r\n    slashing: makeCharacterRoll([]),\r\n    piercing: makeCharacterRoll([]),\r\n    fire: makeCharacterRoll([]),\r\n    blood: makeCharacterRoll([]),\r\n    light: makeCharacterRoll([]),\r\n    dark: makeCharacterRoll([]),\r\n  },\r\n\r\n  traits: [],\r\n  skills: [BASIC_ATTACK, INSPECT],\r\n\r\n  equippedItems: [],\r\n  armor: [\r\n    buildArmor(getRandom(['cowl', 'helmet']), 'common'),\r\n    buildArmor(getRandom(['chestplate', 'robe']), 'common'),\r\n    buildArmor('gloves', 'common'),\r\n    buildArmor('boots', 'common'),\r\n  ],\r\n\r\n  weapon: buildWeapon(\r\n    getRandom([\r\n      'axe',\r\n      'greataxe',\r\n      'wand',\r\n      'staff',\r\n      'daggers',\r\n      'katana',\r\n      'sword',\r\n      'greatsword',\r\n      'flail',\r\n      'elementalGreatsword',\r\n      'elementalSword',\r\n    ]),\r\n  ),\r\n\r\n  healthOffset: 0,\r\n  focusOffset: 0,\r\n  dead: false,\r\n  inspected: false,\r\n})\r\n","import { WeaponT, ZERO_WEAPON_TRAIT } from '../../../../types/Weapon'\r\nimport { buildWeapon } from '../createWeapon'\r\nimport { makeTrait } from '../../../util'\r\nimport { makeCharacterRoll } from '../../../../types/Roll2'\r\nimport { v4 } from 'uuid'\r\n\r\nexport const SWORD_OF_BLOOD_AND_FIRE: WeaponT = {\r\n  ...buildWeapon('elementalSword', 'mythic'),\r\n  name: 'Sword of Blood and Fire',\r\n  damageRolls: {\r\n    // getRollValue('2d6')\r\n    slashing: makeCharacterRoll(['strength'], '1d10', -3),\r\n    fire: makeCharacterRoll(['intelligence'], '1d4', -10),\r\n    blood: makeCharacterRoll(['intelligence'], '1d4', -10),\r\n  },\r\n  events: {\r\n    onHit: [\r\n      {\r\n        ...makeTrait(),\r\n        name: 'heal on hit',\r\n        healthOffset: 5,\r\n      },\r\n      {\r\n        ...makeTrait(),\r\n        name: 'restore fp on hit',\r\n        focusOffset: 5,\r\n      },\r\n    ],\r\n    onCrit: [\r\n      {\r\n        ...makeTrait(),\r\n        name: 'add strenth on crit',\r\n        abilitiesModifiers: {\r\n          strength: 2,\r\n          dexterity: 0,\r\n          intelligence: 0,\r\n          vigor: 0,\r\n        },\r\n      },\r\n    ],\r\n  },\r\n}\r\n\r\nexport const SWORD_OF_THE_INFINITE: WeaponT = {\r\n  ...buildWeapon('elementalSword', 'mythic'),\r\n  name: 'Sword of the Infinite',\r\n  damageRolls: {\r\n    // getRollValue('2d6')\r\n    fire: makeCharacterRoll([], '3d6', -3),\r\n    blood: makeCharacterRoll([], '', 6),\r\n    light: makeCharacterRoll(['intelligence'], '', -7),\r\n    dark: makeCharacterRoll(['intelligence'], '1d6', -10),\r\n    slashing: makeCharacterRoll([]),\r\n  },\r\n  events: {\r\n    onHit: [\r\n      {\r\n        ...makeTrait(),\r\n        name: 'heal on hit',\r\n        healthOffset: 5,\r\n      },\r\n    ],\r\n    onCrit: [\r\n      {\r\n        ...makeTrait(),\r\n        name: 'add strenth on crit',\r\n        abilitiesModifiers: {\r\n          strength: 2,\r\n          dexterity: 0,\r\n          intelligence: 0,\r\n          vigor: 0,\r\n        },\r\n      },\r\n    ],\r\n  },\r\n  slotCount: 3,\r\n  slots: [\r\n    {\r\n      id: v4(),\r\n      name: 'Slash Gem',\r\n      rarity: 'mythic',\r\n      traits: [\r\n        {\r\n          ...ZERO_WEAPON_TRAIT,\r\n          accuracyOffset: 2,\r\n          traits: [\r\n            {\r\n              ...makeTrait(),\r\n              statsModifiers: {\r\n                health: 0,\r\n                focus: 2,\r\n                will: 0,\r\n                perception: 0,\r\n                accuracy: 0,\r\n                agility: 0,\r\n                evade: 2,\r\n              },\r\n            },\r\n          ],\r\n          damageRolls: {\r\n            slashing: makeCharacterRoll([], '1d6'),\r\n          },\r\n        },\r\n      ],\r\n    },\r\n  ],\r\n}\r\n\r\nexport const MYTHIC_WEAPONS: WeaponT[] = []\r\n","import { WeaponModT, ZERO_WEAPON_TRAIT } from '../../../types/Weapon'\r\nimport { v4 } from 'uuid'\r\nimport { makeCharacterRoll } from '../../../types/Roll2'\r\n\r\nexport const SLASHING_MOD: WeaponModT = {\r\n  id: v4(),\r\n  name: 'Slashing Mod',\r\n  rarity: 'mythic',\r\n  traits: [\r\n    {\r\n      ...ZERO_WEAPON_TRAIT,\r\n      damageRolls: {\r\n        slashing: makeCharacterRoll([], '1d6'),\r\n      },\r\n    },\r\n  ],\r\n}\r\n","import { PartyT } from '../../types/Party'\r\nimport { StateActionT, StateT, StateCoreT } from '../types'\r\nimport {\r\n  CharacterT,\r\n  canEquip,\r\n  equipItem,\r\n  unequipItem,\r\n} from '../../types/Character'\r\nimport { Dispatch } from 'redux'\r\nimport { v4 } from 'uuid'\r\nimport { makeReducer } from '../util'\r\nimport { useSelector } from 'react-redux'\r\nimport { useActions } from '../../hooks/useActions'\r\nimport { ItemT, EquippableT } from '../../types/Item'\r\nimport { upsertIn, updateIn } from '../../util/updateIn'\r\nimport makeItem from '../../objects/builders/makeItem'\r\nimport { makeCharacter } from '../../objects/makeCharacter'\r\nimport {\r\n  SWORD_OF_BLOOD_AND_FIRE,\r\n  SWORD_OF_THE_INFINITE,\r\n} from '../../objects/builders/weapons/mythics'\r\nimport {\r\n  FIREBALL,\r\n  CRIPPLING_BLOW,\r\n  THUNDERBOLT,\r\n  DARK_BLAST,\r\n  HEALING,\r\n  WRATH,\r\n  CHARGE,\r\n  SKILL_SHOT,\r\n  VANISH,\r\n  SHADOW_STRIKE,\r\n} from '../../objects/makeSkill'\r\nimport { buildWeapon } from '../../objects/builders/weapons/createWeapon'\r\nimport { SLASHING_MOD } from '../../objects/builders/mods'\r\nimport { WeaponModT } from '../../types/Weapon'\r\n\r\nexport const UPSERT_PARTY = '@actions/parties/upsert-party'\r\nexport const UPSERT_CHARACTER = '@actions/parties/upsert-character'\r\nexport const DELETE_CHARACTER = '@actions/parties/delete-character'\r\nexport const UPSERT_ITEM = '@actions/parties/upsert-item'\r\nexport const DELETE_ITEM = '@actions/parties/delete-item'\r\nexport const UPSERT_MOD = '@actions/parties/upsert-mod'\r\nexport const DELETE_MOD = '@actions/parties/delete-mod'\r\n\r\nexport const actionCreators = {\r\n  upsertParty: (party: PartyT): StateActionT => ({\r\n    type: UPSERT_PARTY,\r\n    payload: {\r\n      party,\r\n    },\r\n  }),\r\n  upsertCharacter: (partyId: string, character: CharacterT) => {\r\n    return {\r\n      type: UPSERT_CHARACTER,\r\n      payload: {\r\n        partyId,\r\n        character,\r\n      },\r\n    }\r\n  },\r\n  deleteCharacter: (partyId: string, characterId: string) => {\r\n    return {\r\n      type: DELETE_CHARACTER,\r\n      payload: {\r\n        partyId,\r\n        characterId,\r\n      },\r\n    }\r\n  },\r\n  upsertItem: (partyId: string, item: ItemT) => {\r\n    return {\r\n      type: UPSERT_ITEM,\r\n      payload: {\r\n        partyId,\r\n        item,\r\n      },\r\n    }\r\n  },\r\n  deleteItem: (partyId: string, itemId: string) => {\r\n    return {\r\n      type: DELETE_ITEM,\r\n      payload: {\r\n        partyId,\r\n        itemId,\r\n      },\r\n    }\r\n  },\r\n  upsertMod: (partyId: string, mod: WeaponModT) => {\r\n    return {\r\n      type: UPSERT_MOD,\r\n      payload: {\r\n        partyId,\r\n        mod,\r\n      },\r\n    }\r\n  },\r\n  deleteMod: (partyId: string, modId: string) => {\r\n    return {\r\n      type: DELETE_MOD,\r\n      payload: {\r\n        partyId,\r\n        modId,\r\n      },\r\n    }\r\n  },\r\n}\r\n\r\nexport const actions = {\r\n  upsertParty: (party: PartyT) => (dispatch: Dispatch) => {\r\n    dispatch(actionCreators.upsertParty(party))\r\n  },\r\n  upsertCharacter: (partyId: string, character: CharacterT) => (\r\n    dispatch: Dispatch,\r\n  ) => {\r\n    dispatch(actionCreators.upsertCharacter(partyId, character))\r\n  },\r\n  deleteCharacter: (partyId: string, characterId: string) => (\r\n    dispatch: Dispatch,\r\n  ) => {\r\n    dispatch(actionCreators.deleteCharacter(partyId, characterId))\r\n  },\r\n  upsertItem: (partyId: string, item: ItemT) => (dispatch: Dispatch) => {\r\n    dispatch(actionCreators.upsertItem(partyId, item))\r\n  },\r\n  removeItem: (partyId: string, itemId: string) => (dispatch: Dispatch) => {\r\n    dispatch(actionCreators.deleteItem(partyId, itemId))\r\n  },\r\n  upsertMod: (partyId: string, mod: WeaponModT) => (dispatch: Dispatch) => {\r\n    dispatch(actionCreators.upsertMod(partyId, mod))\r\n  },\r\n  deleteMod: (partyId: string, modId: string) => (dispatch: Dispatch) => {\r\n    dispatch(actionCreators.deleteMod(partyId, modId))\r\n  },\r\n  equipItem: (partyId: string, characterId: string, itemId: string) => (\r\n    dispatch: Dispatch,\r\n    getState: () => StateT,\r\n  ) => {\r\n    const party = getState().parties.find((p) => p.id === partyId)\r\n    if (!party) return\r\n    const character = party.characters.find((c) => c.id === characterId)\r\n    const item = party.items.find((i) => i.id === itemId) as EquippableT\r\n    if (!character || !item) return\r\n    if (!canEquip(character)(item)) return\r\n    dispatch(\r\n      actionCreators.upsertCharacter(partyId, equipItem(character)(item)),\r\n    )\r\n    dispatch(actionCreators.deleteItem(partyId, item.id))\r\n  },\r\n  unequipItem: (partyId: string, characterId: string, itemId: string) => (\r\n    dispatch: Dispatch,\r\n    getState: () => StateT,\r\n  ) => {\r\n    const party = getState().parties.find((p) => p.id === partyId)\r\n    if (!party) return\r\n    const _character = party.characters.find((c) => c.id === characterId)\r\n    if (!_character) return\r\n    const [items, character] = unequipItem(_character)(itemId)\r\n    dispatch(actionCreators.upsertCharacter(partyId, character))\r\n    items.forEach((item) => {\r\n      dispatch(actionCreators.upsertItem(partyId, item))\r\n    })\r\n  },\r\n  equipMod: (partyId: string, characterId: string, modId: string) => (\r\n    dispatch: Dispatch,\r\n    getState: () => StateT,\r\n  ) => {\r\n    const party = getState().parties.find((p) => p.id === partyId)\r\n    if (!party) return\r\n    const character = party.characters.find((c) => c.id === characterId)\r\n    const mod = party.mods.find((m) => m.id === modId)\r\n    if (!character || !mod) return\r\n    const { weapon } = character\r\n    if (!weapon) return\r\n    if (weapon.slotCount > weapon.slots.length) {\r\n      dispatch(\r\n        actionCreators.upsertCharacter(partyId, {\r\n          ...character,\r\n          weapon: { ...weapon, slots: [...weapon.slots, mod] },\r\n        }),\r\n      )\r\n      dispatch(actionCreators.deleteMod(partyId, modId))\r\n    }\r\n  },\r\n  unequipMod: (partyId: string, characterId: string, modId: string) => (\r\n    dispatch: Dispatch,\r\n    getState: () => StateT,\r\n  ) => {\r\n    console.log('unequip mod')\r\n    const party = getState().parties.find((p) => p.id === partyId)\r\n    if (!party) return\r\n    const character = party.characters.find((c) => c.id === characterId)\r\n    if (!character) return\r\n    const { weapon } = character\r\n    if (!weapon) return\r\n    const mod = weapon.slots.find((m) => m.id === modId)\r\n    if (!mod) return\r\n    dispatch(\r\n      actionCreators.upsertCharacter(partyId, {\r\n        ...character,\r\n        weapon: {\r\n          ...weapon,\r\n          slots: weapon.slots.filter((m) => m.id !== modId),\r\n        },\r\n      }),\r\n    )\r\n    dispatch(actionCreators.upsertMod(partyId, mod))\r\n  },\r\n}\r\n\r\nexport const core: StateCoreT<PartyT[]> = {\r\n  [UPSERT_PARTY]: (state, action) => {\r\n    return upsertIn(state, action.payload.party)\r\n  },\r\n  [UPSERT_CHARACTER]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      characters: upsertIn(party.characters, action.payload.character),\r\n    }))\r\n  },\r\n  [DELETE_CHARACTER]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      characters: party.characters.filter(\r\n        (c) => c.id !== action.payload.characterId,\r\n      ),\r\n    }))\r\n  },\r\n  [UPSERT_ITEM]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      items: upsertIn(party.items, action.payload.item),\r\n    }))\r\n  },\r\n  [DELETE_ITEM]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      items: party.items.filter((i) => i.id !== action.payload.itemId),\r\n    }))\r\n  },\r\n  [UPSERT_MOD]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      mods: upsertIn(party.mods, action.payload.mod),\r\n    }))\r\n  },\r\n  [DELETE_MOD]: (state, action) => {\r\n    return updateIn(state, action.payload.partyId, (party) => ({\r\n      ...party,\r\n      mods: party.mods.filter((i) => i.id !== action.payload.modId),\r\n    }))\r\n  },\r\n}\r\n\r\nconst max = makeCharacter('Character One')\r\nconst katie = makeCharacter('Character Two')\r\nconst milo = makeCharacter('Character Three')\r\nexport const PC_PARTY_ID = v4()\r\nexport const INITIAL_STATE: PartyT[] = [\r\n  {\r\n    id: PC_PARTY_ID,\r\n    items: [],\r\n    skills: [\r\n      WRATH,\r\n      CHARGE,\r\n      CRIPPLING_BLOW,\r\n      VANISH,\r\n      SHADOW_STRIKE,\r\n      SKILL_SHOT,\r\n      THUNDERBOLT,\r\n      FIREBALL,\r\n      DARK_BLAST,\r\n      HEALING,\r\n    ],\r\n    mods: [SLASHING_MOD],\r\n    characters: [\r\n      {\r\n        ...max,\r\n        weapon: SWORD_OF_THE_INFINITE,\r\n        skills: [\r\n          ...max.skills,\r\n          WRATH,\r\n          CHARGE,\r\n          CRIPPLING_BLOW,\r\n          VANISH,\r\n          SHADOW_STRIKE,\r\n          SKILL_SHOT,\r\n          THUNDERBOLT,\r\n          FIREBALL,\r\n          DARK_BLAST,\r\n          HEALING,\r\n        ],\r\n      },\r\n      {\r\n        ...katie,\r\n        skills: [\r\n          ...katie.skills,\r\n          WRATH,\r\n          CHARGE,\r\n          CRIPPLING_BLOW,\r\n          VANISH,\r\n          SHADOW_STRIKE,\r\n          SKILL_SHOT,\r\n          THUNDERBOLT,\r\n          FIREBALL,\r\n          DARK_BLAST,\r\n          HEALING,\r\n        ],\r\n        weapon: SWORD_OF_BLOOD_AND_FIRE,\r\n      },\r\n      {\r\n        ...milo,\r\n        skills: [\r\n          ...milo.skills,\r\n          WRATH,\r\n          CHARGE,\r\n          CRIPPLING_BLOW,\r\n          VANISH,\r\n          SHADOW_STRIKE,\r\n          SKILL_SHOT,\r\n          THUNDERBOLT,\r\n          FIREBALL,\r\n          DARK_BLAST,\r\n          HEALING,\r\n        ],\r\n        weapon: buildWeapon('greataxe', 'mythic'),\r\n      },\r\n    ],\r\n  },\r\n]\r\nexport default makeReducer(core, INITIAL_STATE)\r\nexport const useParties = () => useSelector((state: StateT) => state.parties)\r\nexport const usePartiesActions = () =>\r\n  useActions(actions) as {\r\n    upsertParty: (party: PartyT) => void\r\n    upsertCharacter: (partyId: string, character: CharacterT) => void\r\n    deleteCharacter: (partyId: string, characterId: string) => void\r\n    upsertItem: (partyId: string, item: ItemT) => void\r\n    removeItem: (partyId: string, itemId: string) => void\r\n    upsertMod: (partyId: string, mod: WeaponModT) => void\r\n    deleteMod: (partyId: string, modId: string) => void\r\n    equipItem: (partyId: string, characterId: string, itemId: string) => void\r\n    unequipItem: (partyId: string, characterId: string, itemId: string) => void\r\n    equipMod: (partyId: string, characterId: string, modId: string) => void\r\n    unequipMod: (partyId: string, characterId: string, modId: string) => void\r\n  }\r\n","import { useMemo } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { bindActionCreators } from 'redux'\r\n\r\nexport const useActions = (actions: any, deps?: any[]) => {\r\n  const dispatch = useDispatch()\r\n  return useMemo(\r\n    () => bindActionCreators(actions, dispatch),\r\n    deps ? [dispatch, ...deps] : [dispatch],\r\n  )\r\n}\r\n","import React, { useMemo, useContext, useState } from 'react'\r\nimport { PartyT, ProcessedPartyT, processParty } from '../../types/Party'\r\nimport { CharacterT, ProcessedCharacterT } from '../../types/Character'\r\nimport { v4 } from 'uuid'\r\nimport { useParties, PC_PARTY_ID, usePartiesActions } from '../../state/parties'\r\nimport { actionCreators } from '../../state/rolls'\r\nimport { EquippableT } from '../../types/Item'\r\nimport { WeaponModT } from '../../types/Weapon'\r\n\r\nexport interface PartyContextT {\r\n  parties: ProcessedPartyT[]\r\n  rawParties: PartyT[]\r\n  userParty: ProcessedPartyT\r\n  rawUserParty: PartyT\r\n  activeCharacterId: string | null\r\n\r\n  upsertParty: (party: PartyT) => void\r\n  upsertItem: (item: EquippableT) => void\r\n  upsertCharacter: (character: CharacterT, partyId?: string) => void\r\n  deleteCharacter: (characterId: string, partyId?: string) => void\r\n  upsertMod: (mod: WeaponModT, partyId?: string) => void\r\n  deleteMod: (modId: string, partyId?: string) => void\r\n  findCharacter: (\r\n    characterId: string,\r\n    partyId?: string,\r\n  ) => ProcessedCharacterT | undefined\r\n  findRawCharacter: (\r\n    characterId: string,\r\n    partyId?: string,\r\n  ) => CharacterT | undefined\r\n  equipItem: (characterId: string, itemId: string, partyId?: string) => void\r\n  unequipItem: (characterId: string, itemId: string, partyId?: string) => void\r\n  equipMod: (characterId: string, modId: string, partyId?: string) => void\r\n  unequipMod: (characterId: string, modId: string, partyId?: string) => void\r\n  setActiveCharacterId: (id: string | null) => void\r\n}\r\nconst defaultContextValue: PartyContextT = {\r\n  parties: [],\r\n  rawParties: [],\r\n  userParty: {\r\n    id: v4(),\r\n    characters: [],\r\n    processed: true,\r\n    items: [],\r\n    skills: [],\r\n    mods: [],\r\n  },\r\n  rawUserParty: { id: v4(), characters: [], items: [], skills: [], mods: [] },\r\n  activeCharacterId: null,\r\n  upsertParty: (party) => {},\r\n  upsertItem: (item) => {},\r\n  upsertCharacter: (character, partyId) => {},\r\n  deleteCharacter: (characterId, partyId) => {},\r\n  upsertMod: (mod, partyId) => {},\r\n  deleteMod: (modId, partyId) => {},\r\n  findCharacter: (characterId, partyId) => undefined,\r\n  findRawCharacter: (characterId, partyId) => undefined,\r\n  equipItem: (characterId, itemId, partyId) => {},\r\n  unequipItem: (characterId, itemId, partyId) => {},\r\n  equipMod: (characterId, modId, partyId) => {},\r\n  unequipMod: (characterId, modId, partyId) => {},\r\n  setActiveCharacterId: (id) => {},\r\n}\r\nexport const PartyContext = React.createContext<PartyContextT>(\r\n  defaultContextValue,\r\n)\r\n\r\nexport interface PartyContextProviderPropsT {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const PartyContextProvider = (props: PartyContextProviderPropsT) => {\r\n  const { children } = props\r\n  const actions = usePartiesActions()\r\n  const rawParties = useParties()\r\n  const parties = useMemo(() => {\r\n    return rawParties.map((p) => processParty(p))\r\n  }, [rawParties])\r\n  const userParty = parties.find((p) => p.id === PC_PARTY_ID) as ProcessedPartyT\r\n  const rawUserParty = rawParties.find((p) => p.id === PC_PARTY_ID) as PartyT\r\n  const [activeCharacterId, setActiveCharacterId] = useState<string | null>(\r\n    null,\r\n  )\r\n  const upsertParty = (party: PartyT) => {\r\n    if (!party) return\r\n    if ((party as ProcessedPartyT).processed) {\r\n      throw new Error('No Processed Parties Allowed')\r\n    }\r\n    actions.upsertParty(party)\r\n  }\r\n  const upsertItem = (item: EquippableT, partyId: string = PC_PARTY_ID) => {\r\n    actions.upsertItem(partyId, item)\r\n  }\r\n  const upsertCharacter = (\r\n    character: CharacterT,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    if (!character) return\r\n    if ((character as ProcessedCharacterT).processed) {\r\n      throw new Error('No processed Characters Allowed')\r\n    }\r\n    actions.upsertCharacter(partyId, character)\r\n  }\r\n  const deleteCharacter = (\r\n    characterId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    actions.deleteCharacter(partyId, characterId)\r\n  }\r\n  const upsertMod = (mod: WeaponModT, partyId: string = PC_PARTY_ID) => {\r\n    actions.upsertMod(partyId, mod)\r\n  }\r\n  const deleteMod = (modId: string, partyId: string = PC_PARTY_ID) => {\r\n    actions.deleteMod(partyId, modId)\r\n  }\r\n  const equipItem = (\r\n    characterId: string,\r\n    itemId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    actions.equipItem(partyId, characterId, itemId)\r\n  }\r\n  const unequipItem = (\r\n    characterId: string,\r\n    itemId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    actions.unequipItem(partyId, characterId, itemId)\r\n  }\r\n  const equipMod = (\r\n    characterId: string,\r\n    modId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    actions.equipMod(partyId, characterId, modId)\r\n  }\r\n  const unequipMod = (\r\n    characterId: string,\r\n    modId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    actions.unequipMod(partyId, characterId, modId)\r\n  }\r\n  const findCharacter = (\r\n    characterId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    const party = parties.find((p) => p.id === partyId) as ProcessedPartyT\r\n    return party.characters.find((c) => c.id === characterId)\r\n  }\r\n  const findRawCharacter = (\r\n    characterId: string,\r\n    partyId: string = PC_PARTY_ID,\r\n  ) => {\r\n    const party = rawParties.find((p) => p.id === partyId) as PartyT\r\n    return party.characters.find((c) => c.id === characterId)\r\n  }\r\n\r\n  return (\r\n    <PartyContext.Provider\r\n      value={{\r\n        parties,\r\n        rawParties,\r\n        userParty,\r\n        rawUserParty,\r\n        activeCharacterId,\r\n        upsertParty,\r\n        upsertItem,\r\n        upsertCharacter,\r\n        deleteCharacter,\r\n        upsertMod,\r\n        deleteMod,\r\n        equipItem,\r\n        unequipItem,\r\n        equipMod,\r\n        unequipMod,\r\n        findCharacter,\r\n        findRawCharacter,\r\n        setActiveCharacterId,\r\n      }}\r\n    >\r\n      {children}\r\n    </PartyContext.Provider>\r\n  )\r\n}\r\n\r\nexport const usePartyContext = () => useContext(PartyContext)\r\n","import { Dispatch } from 'redux'\r\nimport { StateActionT, StateCoreT, StateT } from '../types'\r\nimport { useSelector } from 'react-redux'\r\nimport { makeReducer } from '../util'\r\nimport { Roll2ResultT, Check2ResultT } from '../../types/Roll2'\r\n\r\nexport const ADD_ROLL = '@state/rolls/ADD_ROLL'\r\n\r\nexport const actionCreators = {\r\n  addRoll: (rollResult: Roll2ResultT | Check2ResultT): StateActionT => ({\r\n    type: ADD_ROLL,\r\n    payload: {\r\n      rollResult,\r\n    },\r\n  }),\r\n}\r\n\r\nexport const actions = {\r\n  addRoll: (dispatch: Dispatch) => (\r\n    rollResult: Roll2ResultT | Check2ResultT,\r\n  ) => {\r\n    dispatch(actionCreators.addRoll(rollResult))\r\n  },\r\n}\r\n\r\nexport const core: StateCoreT<(Roll2ResultT | Check2ResultT)[]> = {\r\n  [ADD_ROLL]: (state, action) => {\r\n    return [...state, action.payload.rollResult]\r\n  },\r\n}\r\n\r\nexport const INITIAL_STATE = []\r\nexport default makeReducer(core, INITIAL_STATE)\r\nexport const useRolls = () => useSelector((state: StateT) => state.rolls)\r\n","import React, { useContext } from 'react'\r\nimport { ProcessedCharacterT, CharacterT } from '../../types/Character'\r\nimport { useCharacterContext } from '../CharacterContext'\r\nimport { useRolls, actionCreators } from '../../state/rolls'\r\nimport { useDispatch } from 'react-redux'\r\nimport {\r\n  Roll2T,\r\n  Check2T,\r\n  Roll2ResultT,\r\n  resolveCharacterRoll,\r\n  CharacterRollT,\r\n  CharacterCheckT,\r\n  resolveCharacterCheck,\r\n  resolveRoll,\r\n  resolveCheck,\r\n  getCheckProbability,\r\n  reduceCharacterCheck,\r\n  Check2ResultT,\r\n} from '../../types/Roll2'\r\n\r\nexport type RollCheckerT<T, R> = (\r\n  roll: T,\r\n  log?: boolean,\r\n  allowNegatives?: boolean,\r\n  label?: string,\r\n) => R\r\nexport interface RollContextT {\r\n  history: Roll2ResultT[]\r\n  execRoll: RollCheckerT<Roll2T | CharacterRollT, Roll2ResultT>\r\n  execCheck: RollCheckerT<Check2T | CharacterCheckT, Check2ResultT>\r\n  rollCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterRollT, Roll2ResultT>\r\n  checkCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterCheckT, Check2ResultT>\r\n  getProbability: (check: CharacterCheckT, log?: boolean) => number\r\n}\r\nexport const RollContext = React.createContext<RollContextT>({\r\n  history: [],\r\n  execRoll: (roll) => ({} as Roll2ResultT),\r\n  execCheck: (roll) => ({} as Check2ResultT),\r\n  rollCharacter: (c) => (roll, log, allowNegatives) =>\r\n    resolveCharacterRoll(roll, c),\r\n  checkCharacter: (c) => (roll, log, allowNegatives) =>\r\n    resolveCharacterCheck(roll, c),\r\n  getProbability: (roll) => 0,\r\n})\r\nexport const useRollContext = () => useContext(RollContext)\r\n\r\nexport interface RollContextProviderPropsT {\r\n  children: any\r\n  rolls: (Roll2ResultT | Check2ResultT)[]\r\n  character?: ProcessedCharacterT\r\n  addRoll: (roll: Roll2ResultT | Check2ResultT, label?: string) => void\r\n}\r\nexport const RollContextProvider = (props: RollContextProviderPropsT) => {\r\n  const { children, rolls, addRoll } = props\r\n  const characterContext = useCharacterContext()\r\n  const character = props.character || characterContext.character\r\n  return (\r\n    <RollContext.Provider\r\n      value={{\r\n        history: rolls,\r\n        execRoll: (roll, log = true, allowNegatives, label) => {\r\n          const result: Roll2ResultT = (roll as CharacterRollT).keys\r\n            ? resolveCharacterRoll(\r\n                roll as CharacterRollT,\r\n                character,\r\n                allowNegatives,\r\n              )\r\n            : resolveRoll(roll, allowNegatives)\r\n          if (log) addRoll(result, label)\r\n          return result\r\n        },\r\n        execCheck: (check, log = true, allowNegatives, label) => {\r\n          const result: Check2ResultT = (check as CharacterCheckT).keys\r\n            ? resolveCharacterCheck(\r\n                check as CharacterCheckT,\r\n                character,\r\n                allowNegatives,\r\n              )\r\n            : resolveCheck(check, allowNegatives)\r\n          if (log) addRoll(result, label)\r\n          return result\r\n        },\r\n        rollCharacter: (\r\n          character,\r\n        ): RollCheckerT<CharacterRollT, Roll2ResultT> => {\r\n          return (\r\n            roll: CharacterRollT,\r\n            log = true,\r\n            allowNegatives = false,\r\n            label,\r\n          ) => {\r\n            const result = resolveCharacterRoll(roll, character, allowNegatives)\r\n            if (log) addRoll(result, label)\r\n            return result\r\n          }\r\n        },\r\n        checkCharacter: (character) => {\r\n          return (\r\n            check: CharacterCheckT,\r\n            log = true,\r\n            allowNegatives = false,\r\n            label,\r\n          ) => {\r\n            const result = resolveCharacterCheck(\r\n              check,\r\n              character,\r\n              allowNegatives,\r\n            )\r\n            if (log) addRoll(result, label)\r\n            return result\r\n          }\r\n        },\r\n        getProbability: (check, log: boolean = false) => {\r\n          return getCheckProbability(reduceCharacterCheck(check, character))\r\n        },\r\n      }}\r\n    >\r\n      {children}\r\n    </RollContext.Provider>\r\n  )\r\n}\r\n\r\nexport interface RollStateContextProviderPropsT {\r\n  children: any\r\n  character?: ProcessedCharacterT\r\n}\r\nexport const RollStateContextProvider = (\r\n  props: RollStateContextProviderPropsT,\r\n) => {\r\n  const { children, character } = props\r\n  const rolls = useRolls()\r\n  const dispatch = useDispatch()\r\n  const addRoll = (roll: Roll2ResultT, label?: string) => {\r\n    dispatch(actionCreators.addRoll({ ...roll, label }))\r\n  }\r\n  return (\r\n    <RollContextProvider rolls={rolls} addRoll={addRoll} character={character}>\r\n      {children}\r\n    </RollContextProvider>\r\n  )\r\n}\r\n","import React, { useContext, useMemo } from 'react'\r\nimport {\r\n  CharacterT,\r\n  ProcessedCharacterT,\r\n  processCharacter,\r\n} from '../../types/Character'\r\nimport { BASE_CHARACTER } from '../../objects/baseCharacter'\r\nimport { usePartyContext } from '../PartyContext'\r\nimport { RollStateContextProvider } from '../RollContext'\r\n\r\nexport interface CharacterContextT {\r\n  character: ProcessedCharacterT\r\n  rawCharacter: CharacterT\r\n  onChange: (character: CharacterT) => void\r\n}\r\nexport const CharacterContext = React.createContext<CharacterContextT>({\r\n  rawCharacter: BASE_CHARACTER,\r\n  character: processCharacter(BASE_CHARACTER),\r\n  onChange: (character) => {},\r\n})\r\nexport const useCharacterContext = () => useContext(CharacterContext)\r\n\r\nexport interface CharacterContextProviderT {\r\n  children: any\r\n  character: CharacterT\r\n  onChange: (character: CharacterT) => void\r\n}\r\nexport const CharacterContextProvider = (props: CharacterContextProviderT) => {\r\n  const { character, children, onChange } = props\r\n  const processedCharacter: ProcessedCharacterT = useMemo(\r\n    () => processCharacter(character),\r\n    [character],\r\n  )\r\n  return (\r\n    <CharacterContext.Provider\r\n      value={{\r\n        character: processedCharacter,\r\n        rawCharacter: character,\r\n        onChange,\r\n      }}\r\n    >\r\n      <RollStateContextProvider>{children}</RollStateContextProvider>\r\n    </CharacterContext.Provider>\r\n  )\r\n}\r\n\r\nexport interface CharacterStateContextProviderPropsT {\r\n  children: any\r\n  characterId?: string\r\n}\r\nexport const CharacterStateContextProvider = (\r\n  props: CharacterStateContextProviderPropsT,\r\n) => {\r\n  const { children, characterId } = props\r\n  const { activeCharacterId, rawUserParty, upsertCharacter } = usePartyContext()\r\n  const character =\r\n    rawUserParty.characters.find((c) => c.id === characterId) ||\r\n    rawUserParty.characters.find((c) => c.id === activeCharacterId) ||\r\n    BASE_CHARACTER\r\n  const onChange = (character: CharacterT) => {\r\n    if (!character) return\r\n    if ((character as ProcessedCharacterT).processed) {\r\n      throw new Error('no process characters allowed')\r\n    }\r\n    upsertCharacter(character)\r\n  }\r\n  return (\r\n    <CharacterContextProvider\r\n      character={character as CharacterT}\r\n      onChange={onChange}\r\n    >\r\n      {children}\r\n    </CharacterContextProvider>\r\n  )\r\n}\r\n","import { styled } from 'styletron-react'\r\n\r\nexport interface FlexContainerPropsT {\r\n  $direction?: 'row' | 'column' | 'column-reverse'\r\n  $full?: boolean\r\n}\r\nexport const FlexContainer = styled('div', (props: FlexContainerPropsT) => ({\r\n  display: 'flex',\r\n  flexDirection: props.$direction || 'row',\r\n  flex: props.$full ? 1 : 'default',\r\n}))\r\nexport const FullContainer = styled('div', () => ({\r\n  flex: 1,\r\n}))\r\n","import { CharacterResourceKeyT } from '../types/Character'\r\nimport WeaponHands from '../icons/svg/delapouite/sword-brandish.svg'\r\nimport CharacterPoints from '../icons/svg/lorc/aura.svg'\r\nimport Heads from '../icons/svg/lorc/barbute.svg'\r\nimport Bodies from '../icons/svg/delapouite/muscular-torso.svg'\r\nimport Hands from '../icons/svg/sbed/hand.svg'\r\nimport Finger from '../icons/svg/delapouite/ring.svg'\r\nimport Feet from '../icons/svg/lorc/footprint.svg'\r\nimport Slashing from '../icons/svg/lorc/quick-slash.svg'\r\nimport Piercing from '../icons/svg/lorc/barbed-arrow.svg'\r\nimport Fire from '../icons/svg/carl-olsen/flame.svg'\r\nimport Blood from '../icons/svg/lorc/bleeding-eye.svg'\r\nimport Light from '../icons/svg/lorc/moebius-trefoil.svg'\r\nimport Dark from '../icons/svg/lorc/triorb.svg'\r\nimport Shield from '../icons/svg/sbed/shield.svg'\r\nimport Tome from '../icons/svg/lorc/book-cover.svg'\r\nimport Fists from '../icons/svg/skoll/fist.svg'\r\nimport Axe from '../icons/svg/lorc/fire-axe.svg'\r\nimport GreatAxe from '../icons/svg/delapouite/war-axe.svg'\r\nimport Sword from '../icons/svg/lorc/stiletto.svg'\r\nimport Greatsword from '../icons/svg/lorc/croc-sword.svg'\r\nimport Flail from '../icons/svg/delapouite/flail.svg'\r\nimport Daggers from '../icons/svg/lorc/crossed-swords.svg'\r\nimport Katana from '../icons/svg/delapouite/katana.svg'\r\nimport Rapier from '../icons/svg/lorc/sword-hilt.svg'\r\nimport Wand from '../icons/svg/willdabeast/orb-wand.svg'\r\nimport Staff from '../icons/svg/lorc/wizard-staff.svg'\r\nimport Pistol from '../icons/svg/skoll/luger.svg'\r\nimport Crossbow from '../icons/svg/carl-olsen/crossbow.svg'\r\nimport FireSword from '../icons/svg/lorc/shard-sword.svg'\r\nimport BloodSword from '../icons/svg/lorc/bloody-sword.svg'\r\nimport LightSword from '../icons/svg/lorc/winged-sword.svg'\r\nimport DarkSword from '../icons/svg/lorc/spiral-thrust.svg'\r\nimport Helmet from '../icons/svg/delapouite/closed-barbute.svg'\r\nimport Cowl from '../icons/svg/lorc/hood.svg'\r\nimport Armor from '../icons/svg/delapouite/shoulder-armor.svg'\r\nimport Robe from '../icons/svg/lorc/robe.svg'\r\nimport Gloves from '../icons/svg/delapouite/gloves.svg'\r\nimport Ring from '../icons/svg/delapouite/power-ring.svg'\r\nimport Boots from '../icons/svg/lorc/boots.svg'\r\nimport { DamageTypeKeyT } from '../types/Damage'\r\nimport { WeaponTypeT, WeaponIconKeyT } from '../types/Weapon'\r\nimport { ArmorTypeT } from '../types/Armor'\r\nimport { ItemTypeT } from '../types/Item'\r\n\r\nexport const IconCharacterResourceMap: Record<CharacterResourceKeyT, string> = {\r\n  weaponHands: WeaponHands,\r\n  characterPoints: CharacterPoints,\r\n  heads: Heads,\r\n  bodies: Bodies,\r\n  hands: Hands,\r\n  fingers: Finger,\r\n  feet: Feet,\r\n}\r\n\r\nexport const IconDamageTypeMap: Record<DamageTypeKeyT, string> = {\r\n  slashing: Slashing,\r\n  piercing: Piercing,\r\n  fire: Fire,\r\n  blood: Blood,\r\n  light: Light,\r\n  dark: Dark,\r\n}\r\n\r\nexport const IconItemTypeMap: Record<ItemTypeT, string> = {\r\n  weapon: '',\r\n  armor: '',\r\n  offhand: '',\r\n}\r\n\r\nexport const IconWeaponTypeMap: Record<WeaponTypeT, string> = {\r\n  fists: Fists,\r\n  axe: Axe,\r\n  greataxe: GreatAxe,\r\n  flail: Flail,\r\n  daggers: Daggers,\r\n  katana: Katana,\r\n  rapier: Rapier,\r\n  wand: Wand,\r\n  staff: Staff,\r\n  elementalSword: FireSword,\r\n  elementalGreatsword: DarkSword,\r\n  sword: Sword,\r\n  greatsword: Greatsword,\r\n  pistol: Pistol,\r\n  crossbow: Crossbow,\r\n}\r\n\r\nexport const IconUniqueWeaponMap: Record<WeaponIconKeyT, string> = {\r\n  'fire-sword': FireSword,\r\n  'blood-sword': BloodSword,\r\n  'light-sword': LightSword,\r\n  'dark-sword': DarkSword,\r\n}\r\n\r\nexport const IconArmorTypeMap: Record<ArmorTypeT, string> = {\r\n  helmet: Helmet,\r\n  cowl: Cowl,\r\n  chestplate: Armor,\r\n  robe: Robe,\r\n  gloves: Gloves,\r\n  ring: Ring,\r\n  boots: Boots,\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\nexport interface IconPropsT {\r\n  src: string\r\n  size: number\r\n  fill?: string\r\n  style?: React.CSSProperties\r\n  onClick?: () => void\r\n}\r\nexport const Icon = ({\r\n  src,\r\n  size,\r\n  style = {},\r\n  fill = 'white',\r\n  onClick,\r\n}: IconPropsT) => {\r\n  const [loading, setLoading] = useState(true)\r\n  const [svg, setSvg] = useState('')\r\n\r\n  useEffect(() => {\r\n    if (src) {\r\n      fetch(src)\r\n        .then((res) => res.text())\r\n        .then((text) => setSvg(text))\r\n        .then(() => setLoading(false))\r\n    }\r\n  }, [src])\r\n\r\n  return !loading ? (\r\n    <div\r\n      onClick={() => {\r\n        if (onClick) onClick()\r\n      }}\r\n      style={{ ...style, height: size, width: size, fill }}\r\n      dangerouslySetInnerHTML={{ __html: svg }}\r\n    />\r\n  ) : (\r\n    <div />\r\n  )\r\n}\r\n","import React, { useState, useLayoutEffect } from 'react'\r\nimport { v4 } from 'uuid'\r\n\r\nexport interface HoverChildrenT {\r\n  isHovering: boolean\r\n}\r\nexport interface HoverPropsT {\r\n  delay?: number\r\n  children: (props: HoverChildrenT) => JSX.Element\r\n}\r\nexport const Hover = (props: HoverPropsT) => {\r\n  const { delay = 500, children } = props\r\n  const [internalHovering, setInternalHovering] = useState<boolean>(false)\r\n  const [isHovering, setIsHovering] = useState<boolean>(false)\r\n  const [guid, setGuid] = useState<string>(v4())\r\n  useLayoutEffect(() => {\r\n    const action = async () => {\r\n      if (internalHovering) {\r\n        setTimeout(() => {\r\n          setGuid(v4())\r\n        }, delay)\r\n      }\r\n    }\r\n    action()\r\n  }, [internalHovering])\r\n  useLayoutEffect(() => {\r\n    if (internalHovering) {\r\n      setIsHovering(true)\r\n    }\r\n  }, [guid])\r\n  const onMouseEnter = (e: React.MouseEvent) => {\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n    setInternalHovering(true)\r\n  }\r\n  const onMouseLeave = (e: React.MouseEvent) => {\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n    setInternalHovering(false)\r\n    setIsHovering(false)\r\n  }\r\n  return (\r\n    <div onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave}>\r\n      {children({ isHovering })}\r\n    </div>\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport { Hover } from '../components/Hover'\r\n\r\nexport interface BoxContainerPropsT extends React.HTMLProps<HTMLDivElement> {\r\n  substyle?: React.CSSProperties\r\n  tag?: any\r\n  to?: string\r\n}\r\nexport const BoxContainer = (props: BoxContainerPropsT) => {\r\n  const {\r\n    style = {},\r\n    substyle = {},\r\n    children,\r\n    tag: Element = 'div',\r\n    ...rest\r\n  } = props\r\n  return (\r\n    <div\r\n      style={{\r\n        border: '1px solid #000',\r\n        display: 'flex',\r\n        boxSizing: 'border-box',\r\n        ...style,\r\n      }}\r\n    >\r\n      <Element\r\n        style={{\r\n          border: substyle.border || '1px solid #555',\r\n          background: 'linear-gradient(0deg, #222222 0%, #2a2a2a 100%)',\r\n          padding: 10,\r\n          color: '#ccc',\r\n          flex: 1,\r\n          boxShadow: 'inset 0px 0px 2px black',\r\n          ...substyle,\r\n        }}\r\n        {...rest}\r\n      >\r\n        {children}\r\n      </Element>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const SmallBox = (props: BoxContainerPropsT) => (\r\n  <BoxContainer\r\n    {...props}\r\n    style={{\r\n      height: 40,\r\n      width: 40,\r\n      ...props.style,\r\n    }}\r\n    substyle={{\r\n      display: 'flex',\r\n      padding: 0,\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      background: '#111',\r\n      ...props.substyle,\r\n    }}\r\n  >\r\n    {props.children}\r\n  </BoxContainer>\r\n)\r\n\r\nexport const BoxButton = (props: BoxContainerPropsT) => {\r\n  return (\r\n    <Hover delay={0}>\r\n      {({ isHovering }) => (\r\n        <BoxContainer\r\n          {...props}\r\n          tag='button'\r\n          style={{\r\n            margin: 0,\r\n            ...(props.style || {}),\r\n          }}\r\n          substyle={{\r\n            borderColor: isHovering && !props.disabled ? '#999' : '#555',\r\n            padding: '4px',\r\n            cursor: props.disabled ? 'default' : 'pointer',\r\n            background: props.disabled ? '#444' : '#111',\r\n            boxShadow: props.disabled ? 'none' : undefined,\r\n            ...(props.substyle || {}),\r\n          }}\r\n        />\r\n      )}\r\n    </Hover>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { CharacterResourceKeyT } from '../../types/Character'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { IconCharacterResourceMap } from '../../icons/maps'\r\nimport { Icon } from '../Icon'\r\nimport { BoxContainer } from '../../elements/box'\r\n\r\nexport interface ResourceScorePropsT {\r\n  id: CharacterResourceKeyT\r\n}\r\nexport const ResourceScore = (props: ResourceScorePropsT) => {\r\n  const { id } = props\r\n  const { character } = useCharacterContext()\r\n  const iconUrl = IconCharacterResourceMap[id]\r\n\r\n  return (\r\n    <BoxContainer\r\n      style={{ flex: 1 }}\r\n      substyle={{\r\n        display: 'flex',\r\n        padding: 4,\r\n        fontFamily: 'monospace',\r\n        fontSize: 16,\r\n        background: '#1a1a1a',\r\n        color: 'rgba(255,255,255,0.6)',\r\n      }}\r\n    >\r\n      <div style={{ flex: 1, marginRight: 10 }}>\r\n        <Icon size={18} src={iconUrl} fill='rgba(255,255,255,0.8)' />\r\n      </div>\r\n      {character.resources[id]}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import { styled } from 'styletron-react'\r\n\r\nexport const Monospace = styled('span', () => ({\r\n  fontFamily: 'Inconsolata, monospace',\r\n  fontWeight: 600,\r\n}))\r\nexport const Monodiv = styled('div', () => ({\r\n  fontFamily: 'Inconsolata, monospace',\r\n  fontWeight: 600,\r\n}))\r\n","import React from 'react'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport {\r\n  CharacterAbilityKeyT,\r\n  CharacterKeyMap3,\r\n  characterAbilityScoreCosts,\r\n  setCharacterAbilityScore,\r\n} from '../../types/Character'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { makeCharacterCheck } from '../../types/Roll2'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { Monospace } from '../../elements/monospace'\r\n\r\nexport interface AbilityScorePropsT {\r\n  id: CharacterAbilityKeyT\r\n  edit?: boolean\r\n}\r\nexport const AbilityScore = (props: AbilityScorePropsT) => {\r\n  const { id, edit = true } = props\r\n  const { character, rawCharacter, onChange } = useCharacterContext()\r\n  const { upsertItem } = usePartyContext()\r\n  const { execCheck } = useRollContext()\r\n  const keyName = CharacterKeyMap3[id]\r\n  const rawValue = rawCharacter.abilities[id]\r\n  const displayValue = character.abilities[id]\r\n  const cost = characterAbilityScoreCosts[id]\r\n  const points = character.resources.characterPoints\r\n\r\n  return (\r\n    <PureAbilityScore\r\n      name={keyName}\r\n      value={displayValue}\r\n      rawValue={rawValue}\r\n      points={points}\r\n      cost={cost}\r\n      edit={edit}\r\n      onClick={() => {\r\n        execCheck(makeCharacterCheck([id]))\r\n      }}\r\n      onIncrement={() => {\r\n        const [char, items] = setCharacterAbilityScore(rawCharacter)(\r\n          id,\r\n          rawValue + 1,\r\n          points - cost,\r\n        )\r\n        onChange(char)\r\n        items.forEach((item) => {\r\n          upsertItem(item)\r\n        })\r\n      }}\r\n      onDecrement={() => {\r\n        const [char, items] = setCharacterAbilityScore(rawCharacter)(\r\n          id,\r\n          rawValue - 1,\r\n          points + cost,\r\n        )\r\n        onChange(char)\r\n        items.forEach((item) => {\r\n          upsertItem(item)\r\n        })\r\n      }}\r\n    />\r\n  )\r\n}\r\n\r\nexport const PureAbilityScore = (props: any) => {\r\n  const {\r\n    name,\r\n    edit,\r\n    rawValue,\r\n    value,\r\n    points,\r\n    cost,\r\n    onClick,\r\n    onIncrement,\r\n    onDecrement,\r\n  } = props\r\n  return (\r\n    <BoxContainer\r\n      substyle={{\r\n        padding: 0,\r\n        display: 'flex',\r\n      }}\r\n    >\r\n      <FlexContainer\r\n        style={{ padding: 8, marginRight: 10, whiteSpace: 'nowrap' }}\r\n        $direction='column'\r\n        $full\r\n      >\r\n        <Monospace\r\n          style={{\r\n            color: 'rgba(255,255,255,0.5)',\r\n            textShadow: '1px 1px 0px black',\r\n          }}\r\n        >\r\n          {name} ({rawValue})\r\n        </Monospace>\r\n        <FullContainer />\r\n        <Monospace\r\n          style={{\r\n            fontSize: 42,\r\n            textShadow: '1px 1px 3px black',\r\n            color:\r\n              value > rawValue\r\n                ? 'lightgreen'\r\n                : value < rawValue\r\n                ? 'lightcoral'\r\n                : 'white',\r\n          }}\r\n        >\r\n          {value}\r\n        </Monospace>\r\n      </FlexContainer>\r\n      {edit && (\r\n        <FlexContainer\r\n          $direction='column'\r\n          style={{\r\n            width: 30,\r\n          }}\r\n        >\r\n          <BoxButton\r\n            style={{ margin: 0 }}\r\n            disabled={points < cost || rawValue === 18}\r\n            onClick={onIncrement}\r\n          >\r\n            +\r\n          </BoxButton>\r\n          <FlexContainer\r\n            $full\r\n            style={{\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n            }}\r\n          >\r\n            <Monospace style={{ fontSize: 12, color: 'rgba(255,255,255,0.4)' }}>\r\n              {cost}\r\n            </Monospace>\r\n          </FlexContainer>\r\n          <BoxButton\r\n            style={{ margin: 0 }}\r\n            disabled={rawValue === 3}\r\n            onClick={onDecrement}\r\n          >\r\n            -\r\n          </BoxButton>\r\n        </FlexContainer>\r\n      )}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { CharacterStatKeyT } from '../../types/Character'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { makeCharacterCheck } from '../../types/Roll2'\r\nimport { Monospace } from '../../elements/monospace'\r\n\r\nexport interface StatScorePropsT {\r\n  id: CharacterStatKeyT\r\n}\r\nexport const StatScore = (props: StatScorePropsT) => {\r\n  const { id } = props\r\n  const { character } = useCharacterContext()\r\n  const { execCheck } = useRollContext()\r\n  const displayName = id //CharacterKeyMap3[id]\r\n  return (\r\n    <BoxContainer\r\n      style={{ flex: 1 }}\r\n      substyle={{\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        background: '#222',\r\n        boxShadow: 'inset 3px 0px 10px black',\r\n        fontSize: 14,\r\n      }}\r\n    >\r\n      <Monospace\r\n        style={{\r\n          color: 'rgba(255,255,255,0.5)',\r\n          textShadow: '1px 1px 0px black',\r\n          display: 'inline-block',\r\n          flex: 1,\r\n          marginRight: 10,\r\n          fontWeight: 600,\r\n        }}\r\n        // onClick={() => execCheck(makeCharacterCheck([id]))}\r\n      >\r\n        {displayName.toLocaleUpperCase()}\r\n      </Monospace>\r\n      <Monospace style={{ fontWeight: 800 }}>{character.stats[id]}</Monospace>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { DamageTypeKeyT, DamageTypeKeyColors } from '../../types/Damage'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { Icon } from '../Icon'\r\nimport { IconDamageTypeMap } from '../../icons/maps'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport {\r\n  CharacterRollT,\r\n  getRollRange,\r\n  reduceCharacterRoll,\r\n} from '../../types/Roll2'\r\nimport { Monodiv, Monospace } from '../../elements/monospace'\r\n\r\nexport interface DamageResistanceScorePropsT {\r\n  id: DamageTypeKeyT\r\n}\r\nexport const DamageResistanceScore = (props: DamageResistanceScorePropsT) => {\r\n  const { id } = props\r\n  const { character } = useCharacterContext()\r\n  const { execRoll } = useRollContext()\r\n  const { damageResistances } = character\r\n  const roll = damageResistances[id] as CharacterRollT\r\n  const rollText = roll\r\n    ? `${getRollRange(reduceCharacterRoll(roll, character))}`\r\n    : ''\r\n  const iconUrl = IconDamageTypeMap[id]\r\n  const fill = DamageTypeKeyColors[id]\r\n\r\n  return (\r\n    <BoxContainer\r\n      style={{ flex: 1 }}\r\n      substyle={{\r\n        display: 'flex',\r\n        whiteSpace: 'nowrap',\r\n        alignItems: 'center',\r\n        background: '#222',\r\n        boxShadow: 'inset -1px 0px 10px black',\r\n        fontSize: 14,\r\n      }}\r\n    >\r\n      <FlexContainer style={{ alignItems: 'center', flex: 1, marginRight: 10 }}>\r\n        <Icon size={18} src={iconUrl} fill={fill} style={{ marginRight: 10 }} />\r\n        <Monospace\r\n          style={{\r\n            color: 'rgba(255,255,255,0.5)',\r\n            textShadow: '1px 1px 0px black',\r\n          }}\r\n          onClick={() => (roll ? execRoll(roll) : null)}\r\n        >\r\n          {id.toLocaleUpperCase()}\r\n        </Monospace>\r\n      </FlexContainer>\r\n      <Monospace style={{ fontWeight: 800 }}>\r\n        {rollText ? rollText : 0}\r\n      </Monospace>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","export type CompareResultT = -1 | 0 | 1\r\nexport type CompareResultFn<T = any> = (...args: [T, T, T]) => T\r\nexport const ZERO_COMPARE: CompareResultFn = (...args) => args[1]\r\nexport const ONE_COMPARE: CompareResultFn = (...args) => args[2]\r\nexport const BASE_ARGS: [string, string, string] = [\r\n  'lightcoral',\r\n  'inherit',\r\n  'lightgreen',\r\n]\r\nexport const compareResult = (result: CompareResultT): CompareResultFn => (\r\n  ...args: any[]\r\n) => {\r\n  return args[result + 1]\r\n}\r\nexport const toCompareResult = (n: number) => (n < 0 ? -1 : n > 0 ? 1 : 0)\r\nexport const getCompareFn = (valueA: number, valueB: number) => {\r\n  return compareResult(toCompareResult(valueA - valueB))\r\n}\r\n","import React from 'react'\r\nimport {\r\n  CharacterTraitT,\r\n  CharacterKeyMap3,\r\n  CharacterSkillCheckKeyT,\r\n  getTraitValue,\r\n} from '../../types/Character'\r\nimport { getSign } from '../../util/getSign'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport { CompareResultFn, ZERO_COMPARE, BASE_ARGS } from '../../util/compare'\r\nimport { Monodiv } from '../../elements/monospace'\r\n\r\nexport interface TraitScorePropsT {\r\n  trait: CharacterTraitT\r\n  compareResult?: (keY: CharacterSkillCheckKeyT) => CompareResultFn\r\n}\r\nexport const TraitScore = (props: TraitScorePropsT) => {\r\n  const {\r\n    trait,\r\n    compareResult = (key: CharacterSkillCheckKeyT) => ZERO_COMPARE,\r\n  } = props\r\n  const { abilitiesModifiers, statsModifiers } = trait\r\n  const abilityKeys = getKeys(abilitiesModifiers).filter(\r\n    (key) => getTraitValue(trait, key) !== 0,\r\n  )\r\n  const statKeys = getKeys(statsModifiers).filter(\r\n    (key) => getTraitValue(trait, key) !== 0,\r\n  )\r\n\r\n  return (\r\n    <Monodiv style={{ fontSize: 14, fontWeight: 600 }}>\r\n      {trait.focusOffset !== 0 && (\r\n        <span>\r\n          {getSign(trait.focusOffset)}\r\n          {Math.abs(trait.focusOffset)} FP\r\n          {trait.healthOffset !== 0 ||\r\n          abilityKeys.length > 0 ||\r\n          statKeys.length > 0\r\n            ? ', '\r\n            : ''}\r\n        </span>\r\n      )}\r\n      {trait.healthOffset !== 0 && (\r\n        <span>\r\n          {getSign(trait.healthOffset)}\r\n          {Math.abs(trait.healthOffset)} HP\r\n          {abilityKeys.length > 0 || statKeys.length > 0 ? ', ' : ''}\r\n        </span>\r\n      )}\r\n      {abilityKeys.map((key, i) => (\r\n        <span key={key}>\r\n          {i > 0 ? ', ' : ''}\r\n          <span\r\n            style={{\r\n              color: compareResult(key)(...BASE_ARGS),\r\n            }}\r\n          >\r\n            {getSign(getTraitValue(trait, key))}\r\n            {Math.abs(getTraitValue(trait, key))} {CharacterKeyMap3[key]}\r\n          </span>\r\n        </span>\r\n      ))}\r\n      {abilityKeys.length > 0 && statKeys.length > 0 && ', '}\r\n      {statKeys.map((key, i) => (\r\n        <span key={key}>\r\n          {i > 0 ? ', ' : ''}\r\n          <span\r\n            style={{\r\n              color: compareResult(key)(...BASE_ARGS),\r\n            }}\r\n          >\r\n            {getSign(getTraitValue(trait, key))}\r\n            {Math.abs(getTraitValue(trait, key))} {CharacterKeyMap3[key]}\r\n          </span>\r\n        </span>\r\n      ))}\r\n    </Monodiv>\r\n  )\r\n}\r\n","import { notZero } from './notZero'\r\n\r\nexport const getValueString = (value: number): string =>\r\n  notZero(value, `${Math.abs(value)}`)\r\n","import React, { useMemo } from 'react'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { CharacterKeyMap3 } from '../../types/Character'\r\nimport { getSign } from '../../util/getSign'\r\nimport { getValueString } from '../../util/getValueString'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { Icon } from '../Icon'\r\nimport Dice6 from '../../icons/svg/delapouite/dice-six-faces-six.svg'\r\nimport { CompareResultFn, ZERO_COMPARE, BASE_ARGS } from '../../util/compare'\r\nimport { CharacterCheckT, ZERO_CHECK } from '../../types/Roll2'\r\nimport { Monodiv } from '../../elements/monospace'\r\n\r\nexport interface CheckPreviewPropsT {\r\n  check: CharacterCheckT\r\n  name?: string\r\n  showCheckButton?: boolean\r\n  compareResult?: CompareResultFn\r\n}\r\nexport const CheckPreview = (props: CheckPreviewPropsT) => {\r\n  const {\r\n    check = { ...ZERO_CHECK, keys: [] },\r\n    name,\r\n    showCheckButton = true,\r\n    compareResult = ZERO_COMPARE,\r\n  } = props\r\n  const { execCheck, getProbability } = useRollContext()\r\n  const value = check.value || 0\r\n  const rollKeys = (check.keys || []).map((k) => CharacterKeyMap3[k])\r\n  const keyStr =\r\n    rollKeys.reduce((str, key, i) => `${str}${i !== 0 ? '+' : ''}${key}`, '') +\r\n    (rollKeys.length === 0 ? '' : getSign(value))\r\n  const rollStr = check.roll.string ? ` {${check.roll.string}} ` : ''\r\n  const probability = useMemo(() => getProbability(check, true), [\r\n    check,\r\n    getProbability,\r\n  ])\r\n\r\n  return (\r\n    <FlexContainer>\r\n      <div\r\n        style={{\r\n          marginRight: 10,\r\n          flex: 1,\r\n          color: compareResult(...BASE_ARGS),\r\n        }}\r\n      >\r\n        {name && <strong>{name}</strong>}\r\n        <Monodiv style={{ whiteSpace: 'nowrap' }}>\r\n          {keyStr}\r\n          {rollStr && getValueString(value)}{' '}\r\n          {!rollStr && ' = ' + getValueString(check.roll.modifier)} (\r\n          {probability}%)\r\n        </Monodiv>\r\n      </div>\r\n      {showCheckButton && (\r\n        <div>\r\n          <button onClick={() => execCheck(check)}>\r\n            <Icon src={Dice6} size={18} fill='4bebc6' />\r\n          </button>\r\n        </div>\r\n      )}\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { Icon } from '../Icon'\r\nimport { IconArmorTypeMap } from '../../icons/maps'\r\nimport { ArmorT } from '../../types/Armor'\r\n\r\nexport interface ArmorIconPropsT {\r\n  item: ArmorT\r\n  size: number\r\n  fill?: string\r\n  style?: React.CSSProperties\r\n}\r\nexport const ArmorIcon = (props: ArmorIconPropsT) => {\r\n  const { item, size, fill, style } = props\r\n  const src = IconArmorTypeMap[item.armorType]\r\n\r\n  return <Icon src={src} size={size} fill={fill} style={style} />\r\n}\r\n","import { CharacterTraitT, CharacterResourceKeyT } from './Character'\r\nimport { DamageTypeRollsT } from './Damage'\r\nimport { CharacterCheckT } from './Roll2'\r\n\r\nexport type ItemRarityT =\r\n  | 'common'\r\n  | 'uncommon'\r\n  | 'rare'\r\n  | 'legendary'\r\n  | 'unique'\r\n  | 'mythic'\r\n  | 'set'\r\nexport interface ItemT {\r\n  id: string\r\n  name: string\r\n  rarity: ItemRarityT\r\n  icon?: string\r\n}\r\nexport type ItemTypeT = 'weapon' | 'armor' | 'offhand'\r\nexport interface EquippableT extends ItemT {\r\n  equippable: true\r\n  type: ItemTypeT\r\n  cost: number\r\n  resource: CharacterResourceKeyT\r\n  requirementCheck: CharacterCheckT\r\n  traits: CharacterTraitT[]\r\n  damageResistances: DamageTypeRollsT\r\n}\r\n\r\nexport const ItemRarityColorMap: Record<ItemRarityT, string> = {\r\n  common: '#fff',\r\n  uncommon: '#9fbd9f',\r\n  rare: '#91b4f2',\r\n  legendary: '#cda5f3',\r\n  unique: '#c2af6b',\r\n  mythic: 'lightsalmon',\r\n  set: '#38f5e2',\r\n}\r\n","import React from 'react'\r\nimport { Icon } from '../Icon'\r\nimport { IconItemTypeMap } from '../../icons/maps'\r\nimport { EquippableT } from '../../types/Item'\r\n\r\nexport interface ItemIconPropsT {\r\n  item: EquippableT\r\n  size: number\r\n  fill?: string\r\n  style?: React.CSSProperties\r\n}\r\nexport const ItemIcon = (props: ItemIconPropsT) => {\r\n  const { item, size, fill, style } = props\r\n  const src = IconItemTypeMap[item.type]\r\n\r\n  return <Icon src={src} size={size} fill={fill} style={style} />\r\n}\r\n","import React, { useState } from 'react'\r\nimport Color from 'color'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport {\r\n  getDamageTypeKeys,\r\n  DamageTypeKeyColors,\r\n  DamageTypeKeyT,\r\n} from '../../types/Damage'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { TraitScore } from '../TraitScore'\r\nimport { CheckPreview } from '../CheckPreview'\r\nimport { CharacterSkillCheckKeyT } from '../../types/Character'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport { IconDamageTypeMap, IconCharacterResourceMap } from '../../icons/maps'\r\nimport { Icon } from '../Icon'\r\nimport { ArmorIcon } from '../ArmorIcon'\r\nimport { ArmorT } from '../../types/Armor'\r\nimport { EquippableT, ItemRarityColorMap } from '../../types/Item'\r\nimport { ItemIcon } from '../ItemIcon'\r\nimport { CompareResultFn, ZERO_COMPARE, BASE_ARGS } from '../../util/compare'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { CharacterRollT, getRollText } from '../../types/Roll2'\r\nimport { Monodiv } from '../../elements/monospace'\r\n\r\nexport interface ItemPreviewPropsT {\r\n  item: EquippableT\r\n  showEquipButton?: boolean\r\n  showRequirementCheck?: boolean\r\n  showCollapseButton?: boolean\r\n  requirementCompare?: CompareResultFn\r\n  traitCompare?: (key: CharacterSkillCheckKeyT) => CompareResultFn\r\n  resistancesCompare?: (key: DamageTypeKeyT) => CompareResultFn\r\n  costComare?: CompareResultFn\r\n}\r\nexport const ItemPreview = (props: ItemPreviewPropsT) => {\r\n  const {\r\n    item,\r\n    showEquipButton = true,\r\n    showRequirementCheck = true,\r\n    showCollapseButton = false,\r\n  } = props\r\n  const { rawCharacter } = useCharacterContext()\r\n  const { unequipItem } = usePartyContext()\r\n  const [collapsed, setCollapsed] = useState(false)\r\n  const requirementCompare = props.requirementCompare || ZERO_COMPARE\r\n  const traitCompare = props.traitCompare || ((key) => ZERO_COMPARE)\r\n  const resistancesCompare = props.resistancesCompare || ((key) => ZERO_COMPARE)\r\n  const costComare = props.costComare || ZERO_COMPARE\r\n  const isArmor = item.type === 'armor'\r\n  const rarityColor = ItemRarityColorMap[item.rarity]\r\n  const borderColor = Color(rarityColor)\r\n    .desaturate(0.5)\r\n    .fade(0.5)\r\n    .rgb()\r\n    .string()\r\n  return (\r\n    <BoxContainer\r\n      style={{ width: 380 }}\r\n      substyle={{ borderColor: borderColor, padding: 0 }}\r\n    >\r\n      <FlexContainer\r\n        style={{\r\n          padding: 8,\r\n          background:\r\n            'linear-gradient(0deg, rgba(34,34,34,1) 0%, rgba(51,51,51,1) 100%)',\r\n          borderBottom: '1px solid #555',\r\n        }}\r\n      >\r\n        {isArmor ? (\r\n          <ArmorIcon\r\n            item={item as ArmorT}\r\n            size={24}\r\n            fill={rarityColor}\r\n            style={{ marginRight: 10 }}\r\n          />\r\n        ) : (\r\n          <ItemIcon\r\n            item={item}\r\n            size={24}\r\n            style={{ marginRight: 10 }}\r\n            fill={rarityColor}\r\n          />\r\n        )}\r\n        <h3\r\n          style={{\r\n            margin: '0 10px 0 0',\r\n            flex: 1,\r\n            whiteSpace: 'nowrap',\r\n            lineHeight: '29px',\r\n          }}\r\n        >\r\n          {item.name}\r\n        </h3>\r\n        {showCollapseButton && (\r\n          <BoxButton\r\n            substyle={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n            }}\r\n            onClick={() => {\r\n              setCollapsed((c) => !c)\r\n            }}\r\n          >\r\n            {collapsed ? 'more' : 'less'}\r\n          </BoxButton>\r\n        )}\r\n        {!showEquipButton && (\r\n          <FlexContainer\r\n            style={{\r\n              margin: '0 0 10px 0',\r\n              fontWeight: 'bold',\r\n              fontSize: 12,\r\n              color: costComare(...BASE_ARGS),\r\n            }}\r\n          >\r\n            <Icon\r\n              src={IconCharacterResourceMap[item.resource]}\r\n              size={12}\r\n              fill={costComare('lightcoral', 'white', 'lightgreen')}\r\n              style={{ margin: '0 8px' }}\r\n            />\r\n            {item.cost}\r\n          </FlexContainer>\r\n        )}\r\n        {showEquipButton && (\r\n          <BoxButton\r\n            substyle={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n            }}\r\n            onClick={() => {\r\n              unequipItem(rawCharacter.id, item.id)\r\n            }}\r\n          >\r\n            <Icon\r\n              src={IconCharacterResourceMap[item.resource]}\r\n              size={12}\r\n              fill='rgba(255,255,255,0.8)'\r\n              style={{ marginRight: 10 }}\r\n            />\r\n            {item.cost}\r\n          </BoxButton>\r\n        )}\r\n      </FlexContainer>\r\n      <div\r\n        style={{\r\n          padding: '8px 16px',\r\n          background: '#222',\r\n          boxShadow: 'inset 0px 0px 15px black',\r\n        }}\r\n      >\r\n        {!collapsed && (\r\n          <>\r\n            {item.requirementCheck.roll.modifier !== 1 && showRequirementCheck && (\r\n              <div style={{ marginTop: 4 }}>\r\n                <CheckPreview\r\n                  name='Requirement'\r\n                  check={item.requirementCheck}\r\n                  showCheckButton={false}\r\n                  compareResult={requirementCompare}\r\n                />\r\n              </div>\r\n            )}\r\n            <FlexContainer $direction='column'>\r\n              {item.traits.map((trait) => (\r\n                <div key={trait.id} style={{ marginTop: 10, marginBottom: 10 }}>\r\n                  <TraitScore trait={trait} compareResult={traitCompare} />\r\n                </div>\r\n              ))}\r\n              {item.damageResistances && (\r\n                <FlexContainer\r\n                  style={{\r\n                    flexWrap: 'wrap',\r\n                    justifyContent: 'space-evenly',\r\n                    marginBottom: 8,\r\n                  }}\r\n                >\r\n                  {getDamageTypeKeys(item.damageResistances)\r\n                    .filter((k) => item.damageResistances[k])\r\n                    .map((key) => (\r\n                      <FlexContainer key={key}>\r\n                        <Icon\r\n                          src={IconDamageTypeMap[key]}\r\n                          size={14}\r\n                          fill={DamageTypeKeyColors[key]}\r\n                          style={{\r\n                            marginRight: 8,\r\n                          }}\r\n                        />\r\n                        <Monodiv\r\n                          style={{\r\n                            fontSize: 16,\r\n                            lineHeight: '16px',\r\n                            color: resistancesCompare(key)(...BASE_ARGS),\r\n                          }}\r\n                        >\r\n                          {getRollText(\r\n                            item.damageResistances[key] as CharacterRollT,\r\n                          ) || 0}\r\n                        </Monodiv>\r\n                      </FlexContainer>\r\n                    ))}\r\n                </FlexContainer>\r\n              )}\r\n            </FlexContainer>\r\n          </>\r\n        )}\r\n      </div>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import { EquippableT } from './Item'\r\n\r\nexport type ArmorTypeT =\r\n  | 'helmet'\r\n  | 'cowl'\r\n  | 'chestplate'\r\n  | 'robe'\r\n  | 'gloves'\r\n  | 'ring'\r\n  | 'boots'\r\nexport interface ArmorT extends EquippableT {\r\n  type: 'armor'\r\n  armorType: ArmorTypeT\r\n}\r\n\r\nexport const ArmorTypeSortKey: Record<ArmorTypeT, number> = {\r\n  helmet: 0,\r\n  cowl: 0,\r\n  chestplate: 1,\r\n  robe: 1,\r\n  gloves: 2,\r\n  ring: 3,\r\n  boots: 4,\r\n}\r\n","import React from 'react'\r\nimport { WeaponT, WeaponIconKeyT } from '../../types/Weapon'\r\nimport { Icon } from '../Icon'\r\nimport { IconUniqueWeaponMap, IconWeaponTypeMap } from '../../icons/maps'\r\n\r\nexport interface WeaponIconPropsT {\r\n  weapon: WeaponT\r\n  size: number\r\n  fill?: string\r\n  style?: React.CSSProperties\r\n}\r\nexport const WeaponIcon = (props: WeaponIconPropsT) => {\r\n  const { weapon, size, fill, style } = props\r\n  const src = weapon.icon\r\n    ? IconUniqueWeaponMap[weapon.icon as WeaponIconKeyT]\r\n    : IconWeaponTypeMap[weapon.weaponType]\r\n\r\n  return <Icon src={src} size={size} fill={fill} style={style} />\r\n}\r\n","import React from 'react'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport {\r\n  DamageTypeKeyT,\r\n  DamageTypeKeyColors,\r\n  DamageTypeRollsT,\r\n} from '../../types/Damage'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { Icon } from '../Icon'\r\nimport { IconDamageTypeMap } from '../../icons/maps'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport { CompareResultFn, ZERO_COMPARE, BASE_ARGS } from '../../util/compare'\r\nimport {\r\n  CharacterRollT,\r\n  getRollText,\r\n  getRollRange,\r\n  reduceCharacterRoll,\r\n  combineCharacterRolls,\r\n} from '../../types/Roll2'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { Monospace } from '../../elements/monospace'\r\n\r\nexport interface HasDamageRollsT {\r\n  damageRolls: DamageTypeRollsT\r\n}\r\nexport interface DamageRollScoresPropsT {\r\n  parent: HasDamageRollsT\r\n  children: (\r\n    values: DamageRollScorePropsT[],\r\n    combinedRoll: CharacterRollT,\r\n  ) => any\r\n}\r\nexport const DamageRollScores = (props: DamageRollScoresPropsT) => {\r\n  const { parent, children } = props\r\n  const { character } = useCharacterContext()\r\n  const { damageRolls } = parent\r\n  const keys: DamageTypeKeyT[] = getKeys(damageRolls).filter(\r\n    (key) => damageRolls[key],\r\n  )\r\n  const rolls = keys\r\n    .map((key) => damageRolls[key])\r\n    .filter((roll) => roll) as CharacterRollT[]\r\n\r\n  const getDamageRange = (roll: CharacterRollT) => {\r\n    return getRollRange(reduceCharacterRoll(roll, character))\r\n  }\r\n\r\n  return (\r\n    <BoxContainer\r\n      style={{ whiteSpace: 'nowrap' }}\r\n      substyle={{\r\n        padding: '4px 10px',\r\n        borderColor: 'rgba(255,255,255,0.3)',\r\n        background: 'rgba(0,0,0,0.75)',\r\n      }}\r\n    >\r\n      {children(\r\n        keys.map((key) => ({\r\n          id: key,\r\n          key,\r\n          damageRangeText: getDamageRange(damageRolls[key] as CharacterRollT),\r\n          damageRollText: getRollText(damageRolls[key] as CharacterRollT),\r\n        })),\r\n        combineCharacterRolls(...rolls),\r\n      )}\r\n    </BoxContainer>\r\n  )\r\n}\r\n\r\nexport interface DamageRollScorePropsT {\r\n  id: DamageTypeKeyT\r\n  damageRangeText: string\r\n  damageRollText: string\r\n  compareResult?: CompareResultFn\r\n}\r\nexport const DamageRollScore = (props: DamageRollScorePropsT) => {\r\n  const {\r\n    id,\r\n    damageRangeText,\r\n    damageRollText,\r\n    compareResult = ZERO_COMPARE,\r\n  } = props\r\n  if (!damageRollText) return null\r\n  return (\r\n    <FlexContainer\r\n      key={id}\r\n      style={{\r\n        alignItems: 'flex-end',\r\n        padding: '4px 0',\r\n        height: 24,\r\n        lineHeight: '24px',\r\n      }}\r\n    >\r\n      <Icon\r\n        src={IconDamageTypeMap[id]}\r\n        size={20}\r\n        fill={DamageTypeKeyColors[id]}\r\n        style={{ marginBottom: 2, marginRight: 10 }}\r\n      />\r\n      <Monospace style={{ margin: 0, fontSize: 18, fontWeight: 600 }}>\r\n        <span\r\n          style={{\r\n            color: compareResult(...BASE_ARGS),\r\n          }}\r\n        >\r\n          ({damageRangeText})\r\n        </span>{' '}\r\n        <span style={{ color: 'rgba(255,255,255, 0.3)' }}>\r\n          {damageRollText}\r\n        </span>\r\n      </Monospace>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport { WeaponModT, combineWeaponTraits } from '../../types/Weapon'\r\nimport { Icon } from '../Icon'\r\nimport Mod from '../../icons/svg/lorc/emerald.svg'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { combineTraits } from '../../types/Character'\r\nimport { DamageRollScores, DamageRollScore } from '../DamageRollScores'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { TraitScore } from '../TraitScore'\r\nimport { getSign } from '../../util/getSign'\r\n\r\nexport interface ModPreviewPropsT {\r\n  mod: WeaponModT\r\n  onEquip?: (modId: string) => void\r\n}\r\nexport const ModPreview = (props: ModPreviewPropsT) => {\r\n  const { mod, onEquip } = props\r\n  const { character } = useCharacterContext()\r\n  const weaponTrait = combineWeaponTraits(...mod.traits)\r\n  const trait = combineTraits(weaponTrait.traits)\r\n  return (\r\n    <BoxContainer>\r\n      <FlexContainer>\r\n        <Icon src={Mod} size={24} />\r\n        <span\r\n          style={{\r\n            margin: '0 10px',\r\n            flex: 1,\r\n            fontWeight: 'bold',\r\n            whiteSpace: 'nowrap',\r\n          }}\r\n        >\r\n          {mod.name}\r\n        </span>\r\n        <BoxButton onClick={() => onEquip && onEquip(mod.id)}>equip</BoxButton>\r\n      </FlexContainer>\r\n      {weaponTrait.accuracyOffset !== 0 && (\r\n        <div style={{ fontFamily: 'monospace', marginTop: 10 }}>\r\n          {getSign(weaponTrait.accuracyOffset)}\r\n          {Math.abs(weaponTrait.accuracyOffset)} to hit\r\n        </div>\r\n      )}\r\n      <div style={{ marginBottom: 10 }}>\r\n        <TraitScore trait={trait} />\r\n      </div>\r\n      <DamageRollScores parent={weaponTrait}>\r\n        {(values, combinedRoll) =>\r\n          values.map((value) => (\r\n            <DamageRollScore\r\n              key={value.id}\r\n              id={value.id}\r\n              damageRangeText={value.damageRangeText}\r\n              damageRollText={value.damageRollText}\r\n            />\r\n          ))\r\n        }\r\n      </DamageRollScores>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport BaseTooltip, { TooltipProps } from 'react-tooltip-lite'\r\nimport { Hover } from '../Hover'\r\n\r\ninterface PropsT extends TooltipProps {\r\n  children: JSX.Element\r\n}\r\nexport const Tooltip = (props: PropsT) => {\r\n  const { ...rest } = props\r\n  return (\r\n    <BaseTooltip\r\n      direction='up'\r\n      tagName='div'\r\n      padding='0'\r\n      arrow={false}\r\n      {...rest}\r\n    />\r\n  )\r\n}\r\n\r\nexport const HoverToolTip = (props: PropsT) => {\r\n  return (\r\n    <Hover>\r\n      {({ isHovering }) => <Tooltip {...props} isOpen={isHovering} />}\r\n    </Hover>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport Color from 'color'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { CheckPreview } from '../CheckPreview'\r\nimport { TraitScore } from '../TraitScore'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport { DamageRollScores, DamageRollScore } from '../DamageRollScores'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { WeaponIcon } from '../WeaponIcon'\r\nimport {\r\n  combineTraits,\r\n  CharacterSkillCheckKeyT,\r\n  CharacterTraitT,\r\n} from '../../types/Character'\r\nimport { CompareResultFn, ZERO_COMPARE, BASE_ARGS } from '../../util/compare'\r\nimport { DamageTypeKeyT } from '../../types/Damage'\r\nimport { Icon } from '../Icon'\r\nimport { IconCharacterResourceMap } from '../../icons/maps'\r\nimport { FISTS } from '../../objects/fists'\r\nimport { ItemRarityColorMap } from '../../types/Item'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport {\r\n  getRollText,\r\n  getRollRange,\r\n  reduceCharacterRoll,\r\n} from '../../types/Roll2'\r\nimport { EventsTypeMap } from '../../types/Events'\r\nimport { ModPreview } from '../ModPreview'\r\nimport Mod from '../../icons/svg/lorc/emerald.svg'\r\nimport { Hover } from '../Hover'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { HoverToolTip } from '../Tooltip'\r\nimport { Monospace } from '../../elements/monospace'\r\n\r\nexport interface WeaponPreviewPropsT {\r\n  weapon?: WeaponT\r\n  showEquipButton?: boolean\r\n  showRequirement?: boolean\r\n  requirementCompare?: CompareResultFn\r\n  accuracyCompare?: CompareResultFn\r\n  traitCompare?: (key: CharacterSkillCheckKeyT) => CompareResultFn\r\n  damageCompare?: (key: DamageTypeKeyT) => CompareResultFn\r\n  costComare?: CompareResultFn\r\n}\r\nexport const WeaponPreview = (props: WeaponPreviewPropsT) => {\r\n  const { character, rawCharacter, onChange } = useCharacterContext()\r\n  const { unequipItem, unequipMod } = usePartyContext()\r\n  const { showEquipButton = true, showRequirement = true } = props\r\n  const weapon = props.weapon || character.weapon\r\n  const rarityColor = ItemRarityColorMap[weapon.rarity]\r\n  const borderColor = Color(rarityColor)\r\n    .desaturate(0.5)\r\n    .fade(0.5)\r\n    .rgb()\r\n    .string()\r\n  const requirementCompare = props.requirementCompare || ZERO_COMPARE\r\n  const accuracyCompare = props.accuracyCompare || ZERO_COMPARE\r\n  const traitCompare = props.traitCompare || ((key) => ZERO_COMPARE)\r\n  const damageCompare = props.damageCompare || ((key) => ZERO_COMPARE)\r\n  const costComare = props.costComare || ZERO_COMPARE\r\n  const trait = combineTraits(weapon.traits)\r\n  return (\r\n    <BoxContainer\r\n      style={{ width: 380 }}\r\n      substyle={{ borderColor: borderColor, padding: 0 }}\r\n    >\r\n      <FlexContainer\r\n        style={{\r\n          padding: 8,\r\n          background: 'linear-gradient(0deg, #222222 0%, #2a2a2a 100%)',\r\n          borderBottom: '1px solid #555',\r\n        }}\r\n      >\r\n        <WeaponIcon weapon={weapon} size={24} fill={rarityColor} />\r\n        <h3 style={{ margin: '0 0 0 10px', flex: 1, lineHeight: '29px' }}>\r\n          {weapon.name}\r\n        </h3>\r\n        {weapon.id !== FISTS.id && showEquipButton ? (\r\n          <BoxButton\r\n            substyle={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n            }}\r\n            onClick={() => unequipItem(rawCharacter.id, weapon.id)}\r\n          >\r\n            <Icon\r\n              src={IconCharacterResourceMap[weapon.resource]}\r\n              size={12}\r\n              fill='rgba(255,255,255,0.8)'\r\n              style={{ marginRight: 10 }}\r\n            />\r\n            {weapon.cost}\r\n          </BoxButton>\r\n        ) : (\r\n          <FlexContainer\r\n            style={{\r\n              margin: '0 0 10px 0',\r\n              fontWeight: 'bold',\r\n              fontSize: 12,\r\n              color: costComare(...BASE_ARGS),\r\n            }}\r\n          >\r\n            <Icon\r\n              src={IconCharacterResourceMap.weaponHands}\r\n              size={12}\r\n              style={{ margin: '0 8px' }}\r\n              fill={costComare('lightcoral', 'white', 'lightgreen')}\r\n            />\r\n            {weapon.cost}\r\n          </FlexContainer>\r\n        )}\r\n      </FlexContainer>\r\n      <div\r\n        style={{\r\n          padding: 8,\r\n          background: '#222',\r\n          boxShadow: 'inset 0px 0px 15px black',\r\n        }}\r\n      >\r\n        <div style={{ padding: '8px 8px 0px 8px' }}>\r\n          <FlexContainer style={{ marginBottom: 10 }}>\r\n            {showRequirement && (\r\n              <FullContainer>\r\n                <CheckPreview\r\n                  showCheckButton={false}\r\n                  check={weapon.requirementCheck}\r\n                  compareResult={requirementCompare}\r\n                />\r\n              </FullContainer>\r\n            )}\r\n            <FullContainer>\r\n              <CheckPreview\r\n                showCheckButton={false}\r\n                check={weapon.accuracyCheck}\r\n                compareResult={accuracyCompare}\r\n              />\r\n            </FullContainer>\r\n          </FlexContainer>\r\n          <div style={{ marginBottom: 10 }}>\r\n            <TraitScore trait={trait} compareResult={traitCompare} />\r\n          </div>\r\n          <div style={{ marginBottom: 10 }}>\r\n            {getKeys(weapon.events || {}).map(\r\n              (key) =>\r\n                (weapon.events[key] || []).length > 0 && (\r\n                  <FlexContainer key={key} style={{ alignItems: 'center' }}>\r\n                    <Monospace\r\n                      style={{\r\n                        fontSize: 12,\r\n                        marginRight: 10,\r\n                        color: 'rgba(255,255,255,0.4)',\r\n                      }}\r\n                    >\r\n                      {EventsTypeMap[key]}:\r\n                    </Monospace>\r\n                    <TraitScore\r\n                      trait={combineTraits(\r\n                        weapon.events[key] as CharacterTraitT[],\r\n                      )}\r\n                    />\r\n                  </FlexContainer>\r\n                ),\r\n            )}\r\n          </div>\r\n        </div>\r\n        {weapon.slotCount > 0 && (\r\n          <FlexContainer\r\n            style={{\r\n              justifyContent: 'center',\r\n              padding: 8,\r\n              margin: '8px 0 4px 0',\r\n            }}\r\n          >\r\n            <FullContainer>\r\n              <hr\r\n                style={{\r\n                  borderColor: 'rgba(255,255,255,0.3)',\r\n                  borderBottomWidth: 0,\r\n                }}\r\n              />\r\n            </FullContainer>\r\n            <FlexContainer style={{ padding: '0 20px' }}>\r\n              {Array(weapon.slotCount)\r\n                .fill(null)\r\n                .map((_, i) => {\r\n                  const mod = weapon.slots[i]\r\n                  if (mod) {\r\n                    return (\r\n                      <HoverToolTip content={<ModPreview mod={mod} />}>\r\n                        <Icon\r\n                          src={Mod}\r\n                          size={20}\r\n                          fill={ItemRarityColorMap[mod.rarity]}\r\n                          style={{\r\n                            padding: '0 8px',\r\n                            cursor: 'pointer',\r\n                          }}\r\n                          onClick={() => {\r\n                            unequipMod(character.id, mod.id)\r\n                          }}\r\n                        />\r\n                      </HoverToolTip>\r\n                    )\r\n                  } else {\r\n                    return (\r\n                      <Icon\r\n                        src={Mod}\r\n                        size={20}\r\n                        fill='rgba(255,255,255,0.4)'\r\n                        style={{ padding: '0 8px' }}\r\n                      />\r\n                    )\r\n                  }\r\n                })}\r\n            </FlexContainer>\r\n            <FullContainer>\r\n              <hr\r\n                style={{\r\n                  borderColor: 'rgba(255,255,255,0.3)',\r\n                  borderBottomWidth: 0,\r\n                }}\r\n              />\r\n            </FullContainer>\r\n          </FlexContainer>\r\n        )}\r\n        <DamageRollScores parent={weapon}>\r\n          {(values, combinedRoll) => (\r\n            <>\r\n              <Monospace\r\n                style={{\r\n                  fontSize: 12,\r\n                  color: 'rgba(255,255,255,0.25)',\r\n                }}\r\n              >\r\n                TOTAL DAMAGE: (\r\n                {getRollRange(reduceCharacterRoll(combinedRoll, character))})\r\n              </Monospace>\r\n              {values.map((value) => (\r\n                <DamageRollScore\r\n                  key={value.id}\r\n                  id={value.id}\r\n                  damageRangeText={value.damageRangeText}\r\n                  damageRollText={value.damageRollText}\r\n                  compareResult={damageCompare(value.id)}\r\n                />\r\n              ))}\r\n            </>\r\n          )}\r\n        </DamageRollScores>\r\n      </div>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { useState, useMemo } from 'react'\r\nimport Color from 'color'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { EquippableT, ItemRarityColorMap } from '../../types/Item'\r\nimport { ArmorIcon } from '../ArmorIcon'\r\nimport { ArmorT } from '../../types/Armor'\r\nimport { ItemPreview } from '../ItemPreview'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { WeaponIcon } from '../WeaponIcon'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport { WeaponPreview } from '../WeaponPreview'\r\nimport { BASE_EQUIPPABLE } from '../../objects/util'\r\nimport { Hover } from '../Hover'\r\n\r\nexport interface ItemPreviewSmallPropsT {\r\n  item: EquippableT\r\n  size?: number\r\n  onClick?: (item: EquippableT) => void\r\n}\r\nexport const ItemPreviewSmall = (props: ItemPreviewSmallPropsT) => {\r\n  const { item = {} as EquippableT, size = 38, onClick } = props\r\n  const isEmpty = item.type === undefined\r\n  const rarityColor = ItemRarityColorMap[item ? item.rarity : 'common']\r\n  const borderColor = Color(rarityColor)\r\n    .desaturate(0.5)\r\n    .fade(0.5)\r\n    .rgb()\r\n    .string()\r\n\r\n  const isArmor = item.type === 'armor'\r\n  const isWeapon = item.type === 'weapon'\r\n  const icon = useMemo(() => {\r\n    if (!item) return null\r\n    if (isWeapon) {\r\n      return (\r\n        <WeaponIcon\r\n          weapon={item as WeaponT}\r\n          size={size - 16}\r\n          fill={rarityColor}\r\n        />\r\n      )\r\n    }\r\n    if (isArmor) {\r\n      return (\r\n        <ArmorIcon item={item as ArmorT} size={size - 16} fill={rarityColor} />\r\n      )\r\n    }\r\n  }, [item, isArmor, isWeapon, rarityColor])\r\n  if (!item) return null\r\n  return (\r\n    <Hover>\r\n      {({ isHovering }) => (\r\n        <Tooltip\r\n          isOpen={isHovering}\r\n          direction='bottom'\r\n          tagName='div'\r\n          padding='0'\r\n          arrow={false}\r\n          content={\r\n            item.type === 'armor' ? (\r\n              <ItemPreview\r\n                item={item}\r\n                showEquipButton={false}\r\n                showCollapseButton={false}\r\n                showRequirementCheck={false}\r\n              />\r\n            ) : (\r\n              <WeaponPreview weapon={item as WeaponT} showEquipButton={false} />\r\n            )\r\n          }\r\n        >\r\n          <BoxContainer\r\n            style={{\r\n              height: size,\r\n              width: size,\r\n              cursor: item && onClick ? 'pointer' : 'default',\r\n            }}\r\n            substyle={{\r\n              background: isEmpty ? '#111' : '#222',\r\n              boxShadow: 'inset 0 0 3px black',\r\n              border: `1px solid ${!isEmpty ? borderColor : '#555'}`,\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              padding: 0,\r\n            }}\r\n            onClick={() => onClick && onClick(item)}\r\n          >\r\n            {icon}\r\n          </BoxContainer>\r\n        </Tooltip>\r\n      )}\r\n    </Hover>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { ItemPreview } from '../ItemPreview'\r\nimport { ArmorTypeSortKey } from '../../types/Armor'\r\nimport { ItemPreviewSmall } from '../ItemPreviewSmall'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { v4 } from 'uuid'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\n\r\nexport interface ArmorScoreListPropsT {}\r\nexport const ArmorScoreList = (props: ArmorScoreListPropsT) => {\r\n  const { character, rawCharacter } = useCharacterContext()\r\n  const { unequipItem } = usePartyContext()\r\n  const { armor } = character\r\n  const rings = armor.filter((i) => i.armorType === 'ring')\r\n  const arr = Array(10 - rings.length).fill(undefined)\r\n  return (\r\n    <div>\r\n      <FlexContainer>\r\n        {[...arr, ...rings].map((item) => (\r\n          <ItemPreviewSmall\r\n            key={item ? item.id : v4()}\r\n            item={item}\r\n            onClick={(item) => unequipItem(rawCharacter.id, item.id)}\r\n          />\r\n        ))}\r\n      </FlexContainer>\r\n      {armor\r\n        .filter((i) => i.armorType !== 'ring')\r\n        .sort(\r\n          (a, b) =>\r\n            ArmorTypeSortKey[a.armorType] - ArmorTypeSortKey[b.armorType],\r\n        )\r\n        .map((item) => (\r\n          <ItemPreview\r\n            key={item.id}\r\n            item={item}\r\n            showRequirementCheck={false}\r\n            showCollapseButton={false}\r\n          />\r\n        ))}\r\n    </div>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport Color from 'color'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { HoverToolTip } from '../Tooltip'\r\nimport { Monodiv } from '../../elements/monospace'\r\n\r\nexport interface GaugePropsT {\r\n  name?: string\r\n  color: string\r\n  height?: number\r\n  max: number\r\n  value: number\r\n  children?: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const Gauge = (props: GaugePropsT) => {\r\n  const { name = '', value, max, color, height = 30, children } = props\r\n  const p = (value / max) * 100\r\n  const percentage = p > 100 ? 100 : p\r\n  return (\r\n    <HoverToolTip\r\n      direction='right'\r\n      content={<BoxContainer>{`${name} (${value} / ${max})`}</BoxContainer>}\r\n    >\r\n      <BoxContainer\r\n        substyle={{\r\n          padding: 0,\r\n          background: '#555',\r\n          height: height - 2,\r\n          position: 'relative',\r\n        }}\r\n      >\r\n        <FlexContainer\r\n          style={{\r\n            position: 'absolute',\r\n            left: 0,\r\n            boxSizing: 'border-box',\r\n            height: height - 2,\r\n            maxWidth: `${percentage}%`,\r\n            minWidth: `${percentage}%`,\r\n            border:\r\n              percentage > 0\r\n                ? `1px solid ${Color(color).lighten(0.5)}`\r\n                : 'none',\r\n            boxShadow: 'inset 1px 1px 0px rgba(0,0,0,0.5)',\r\n            textShadow: '1px 1px 1px black',\r\n            backgroundColor: color,\r\n            color: 'white',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            transition: 'all 0.5s',\r\n          }}\r\n        ></FlexContainer>\r\n        <FullContainer\r\n          style={{\r\n            position: 'absolute',\r\n            height,\r\n            lineHeight: `${height - 2}px`,\r\n            right: 4,\r\n            top: 0,\r\n            fontSize: 14,\r\n            fontWeight: 'bold',\r\n            overflow: 'hidden',\r\n            textShadow: '0px 0px 3px black',\r\n          }}\r\n        >\r\n          <Monodiv>{children}</Monodiv>\r\n        </FullContainer>\r\n      </BoxContainer>\r\n    </HoverToolTip>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { AbilityScore } from '../AbilityScore'\r\nimport { StatScore } from '../StatScore'\r\nimport { DamageResistanceScore } from '../DamageResistanceScore'\r\nimport { WeaponPreview } from '../WeaponPreview'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\n\r\nexport const CharacterInspect = () => {\r\n  const { character } = useCharacterContext()\r\n  return (\r\n    <FlexContainer>\r\n      <FlexContainer $direction='column'>\r\n        <AbilityScore id='strength' edit={false} />\r\n        <AbilityScore id='dexterity' edit={false} />\r\n        <AbilityScore id='intelligence' edit={false} />\r\n        <AbilityScore id='vigor' edit={false} />\r\n      </FlexContainer>\r\n      <FlexContainer $direction='column'>\r\n        <StatScore id='health' />\r\n        <StatScore id='focus' />\r\n        <StatScore id='will' />\r\n        <StatScore id='perception' />\r\n        <StatScore id='agility' />\r\n        <StatScore id='accuracy' />\r\n        <StatScore id='evade' />\r\n      </FlexContainer>\r\n      <FlexContainer $direction='column'>\r\n        <DamageResistanceScore id='slashing' />\r\n        <DamageResistanceScore id='piercing' />\r\n        <DamageResistanceScore id='fire' />\r\n        <DamageResistanceScore id='blood' />\r\n        <DamageResistanceScore id='light' />\r\n        <DamageResistanceScore id='dark' />\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { SkillT } from '../../types/Skill'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { makeSkill } from '../../objects/makeSkill'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { CheckPreview } from '../CheckPreview'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport { EventsTypeMap } from '../../types/Events'\r\nimport { TraitScore } from '../TraitScore'\r\nimport { combineTraits, CharacterTraitT } from '../../types/Character'\r\nimport { DamageRollScores, DamageRollScore } from '../DamageRollScores'\r\nimport {\r\n  getRollRange,\r\n  reduceCharacterRoll,\r\n  getRollText,\r\n} from '../../types/Roll2'\r\nimport { Monospace } from '../../elements/monospace'\r\n\r\nexport interface SkillPreviewPropsT {\r\n  skillId: string\r\n  skill?: SkillT\r\n  showRequirementCheck?: boolean\r\n}\r\nexport const SkillPreview = (props: SkillPreviewPropsT) => {\r\n  const { skillId, showRequirementCheck } = props\r\n  const { character } = useCharacterContext()\r\n  const skill =\r\n    props.skill || character.skills.find((s) => s.id === skillId) || makeSkill()\r\n  return (\r\n    <BoxContainer\r\n      style={{\r\n        width: 380,\r\n        background: `url(${skill.imgSrc}) no-repeat center center`,\r\n        backgroundSize: 'cover',\r\n      }}\r\n      substyle={{\r\n        background: 'rgba(0,0,0,0.8)',\r\n        borderColor: 'rgba(255,255,255,0.4)',\r\n      }}\r\n    >\r\n      <FlexContainer style={{ marginBottom: 10 }}>\r\n        <h3 style={{ margin: '0 10px 0 0', flex: 1 }}>{skill.name}</h3>\r\n      </FlexContainer>\r\n\r\n      <FlexContainer style={{ marginBottom: 10, fontSize: 14 }}>\r\n        <strong style={{ marginRight: 10 }}>Cost</strong>\r\n        <span>{skill.focusCost}</span>\r\n      </FlexContainer>\r\n      <FlexContainer style={{ marginBottom: 10 }}>\r\n        {showRequirementCheck && (\r\n          <FullContainer>\r\n            <CheckPreview\r\n              name='Requirement'\r\n              showCheckButton={false}\r\n              check={skill.requirementCheck}\r\n            />\r\n          </FullContainer>\r\n        )}\r\n        {skill.check && (\r\n          <FullContainer>\r\n            <CheckPreview\r\n              name='Skill Check'\r\n              showCheckButton={false}\r\n              check={skill.check}\r\n            />\r\n          </FullContainer>\r\n        )}\r\n        {skill.combineWeaponDamage && (\r\n          <FullContainer>\r\n            <CheckPreview\r\n              showCheckButton={false}\r\n              check={character.weapon.accuracyCheck}\r\n            />\r\n          </FullContainer>\r\n        )}\r\n      </FlexContainer>\r\n      {skill.targetTraits.length > 0 && (\r\n        <FlexContainer style={{ marginBottom: 10 }}>\r\n          <strong\r\n            style={{\r\n              fontFamily: 'monospace',\r\n              marginRight: 10,\r\n              color: 'rgba(255,255,255,0.5)',\r\n            }}\r\n          >\r\n            target:\r\n          </strong>\r\n          <TraitScore trait={combineTraits(skill.targetTraits)} />\r\n        </FlexContainer>\r\n      )}\r\n      {skill.sourceTraits.length > 0 && (\r\n        <FlexContainer style={{ marginBottom: 10 }}>\r\n          <strong\r\n            style={{\r\n              fontFamily: 'monospace',\r\n              marginRight: 10,\r\n              color: 'rgba(255,255,255,0.5)',\r\n            }}\r\n          >\r\n            self:\r\n          </strong>\r\n          <TraitScore trait={combineTraits(skill.sourceTraits)} />\r\n        </FlexContainer>\r\n      )}\r\n      <div style={{ marginBottom: 10 }}>\r\n        {getKeys(skill.events).map((key) => (\r\n          <FlexContainer key={key} style={{ alignItems: 'center' }}>\r\n            <strong\r\n              style={{\r\n                fontFamily: 'monospace',\r\n                marginRight: 10,\r\n                color: 'rgba(255,255,255,0.5)',\r\n              }}\r\n            >\r\n              {EventsTypeMap[key]}:\r\n            </strong>\r\n            <TraitScore\r\n              trait={combineTraits(skill.events[key] as CharacterTraitT[])}\r\n            />\r\n          </FlexContainer>\r\n        ))}\r\n      </div>\r\n      {skill.combineWeaponDamage && (\r\n        <div style={{ marginBottom: 10 }}>\r\n          {getKeys(character.weapon.events).map((key) => (\r\n            <FlexContainer key={key} style={{ alignItems: 'center' }}>\r\n              <strong\r\n                style={{\r\n                  fontFamily: 'monospace',\r\n                  marginRight: 10,\r\n                  color: 'rgba(255,255,255,0.5)',\r\n                }}\r\n              >\r\n                {EventsTypeMap[key]}:\r\n              </strong>\r\n              <TraitScore\r\n                trait={combineTraits(\r\n                  character.weapon.events[key] as CharacterTraitT[],\r\n                )}\r\n              />\r\n            </FlexContainer>\r\n          ))}\r\n        </div>\r\n      )}\r\n      {(skill.combineWeaponDamage ||\r\n        Object.keys(skill.damageRolls).length > 0) && (\r\n        <DamageRollScores\r\n          parent={skill.combineWeaponDamage ? character.weapon : skill}\r\n        >\r\n          {(values, combinedRoll) => (\r\n            <>\r\n              <Monospace\r\n                style={{\r\n                  fontSize: 12,\r\n                  color: 'rgba(255,255,255,0.25)',\r\n                }}\r\n              >\r\n                TOTAL DAMAGE: (\r\n                {getRollRange(reduceCharacterRoll(combinedRoll, character))})\r\n              </Monospace>\r\n              {values.map((value) => (\r\n                <DamageRollScore\r\n                  key={value.id}\r\n                  id={value.id}\r\n                  damageRangeText={value.damageRangeText}\r\n                  damageRollText={value.damageRollText}\r\n                />\r\n              ))}\r\n            </>\r\n          )}\r\n        </DamageRollScores>\r\n      )}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { CSSProperties } from 'react'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { SkillT } from '../../types/Skill'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { BASIC_ATTACK, INSPECT } from '../../objects/makeSkill'\r\nimport { SkillPreview } from '../SkillPreview'\r\nimport { Hover } from '../Hover'\r\nimport { FlexContainer } from '../../elements/flex'\r\n\r\nconst size = 34\r\nexport interface CombatCharacterSkillsPropsT {\r\n  activeSkillId?: string\r\n  skills: SkillT[]\r\n  onClick: (skillId: string) => void\r\n}\r\nexport const CombatCharacterSkills = (props: CombatCharacterSkillsPropsT) => {\r\n  const { activeSkillId = BASIC_ATTACK.id, skills, onClick } = props\r\n  const { character } = useCharacterContext()\r\n  const active = (skillId: string) => activeSkillId === skillId\r\n  const disabled = (skill: SkillT) =>\r\n    character.dead ||\r\n    character.stats.focus - character.focusOffset < skill.focusCost\r\n\r\n  return (\r\n    <FlexContainer style={{ marginBottom: 2 }}>\r\n      {skills.map((skill) => (\r\n        <CombatCharacterSkill\r\n          key={skill.id}\r\n          skill={skill}\r\n          disabled={disabled(skill)}\r\n          onClick={() => onClick(skill.id)}\r\n          style={{\r\n            padding: 0,\r\n            height: size + 2,\r\n            maxWidth: size + 2,\r\n            margin: 0,\r\n            borderColor: 'transparent',\r\n            opacity: disabled(skill) ? 0.2 : active(skill.id) ? 1 : 0.7,\r\n            ...(active(skill.id) ? { borderColor: 'turquoise' } : {}),\r\n          }}\r\n        />\r\n      ))}\r\n    </FlexContainer>\r\n  )\r\n}\r\n\r\nexport interface CombatCharacterSkillPropsT {\r\n  skill: SkillT\r\n  disabled: boolean\r\n  style: CSSProperties\r\n  onClick: (skillId: string) => void\r\n}\r\nexport const CombatCharacterSkill = (props: CombatCharacterSkillPropsT) => {\r\n  const { skill, disabled, style, onClick } = props\r\n  const isDefault = skill.id === INSPECT.id\r\n  return (\r\n    <Hover>\r\n      {({ isHovering }) => (\r\n        <Tooltip\r\n          isOpen={isHovering}\r\n          direction='down'\r\n          tagName='div'\r\n          padding='0'\r\n          arrow={false}\r\n          content={\r\n            isDefault ? (\r\n              <BoxContainer>{skill.name}</BoxContainer>\r\n            ) : (\r\n              <SkillPreview skillId={skill.id} skill={skill} />\r\n            )\r\n          }\r\n        >\r\n          <BoxContainer\r\n            onClick={() => !disabled && onClick(skill.id)}\r\n            substyle={{\r\n              borderColor: isHovering ? '#999' : '#555',\r\n              padding: '4px',\r\n              cursor: disabled ? 'default' : 'pointer',\r\n              background: disabled ? '#444' : '#111',\r\n              ...style,\r\n            }}\r\n            style={{ border: 'none' }}\r\n          >\r\n            {skill.imgSrc && (\r\n              <img\r\n                src={skill.imgSrc}\r\n                height={size}\r\n                width={size}\r\n                style={{\r\n                  height: size,\r\n                  maxWidth: size,\r\n                  boxSizing: 'border-box',\r\n                  border: '1px solid black',\r\n                }}\r\n              />\r\n            )}\r\n          </BoxContainer>\r\n        </Tooltip>\r\n      )}\r\n    </Hover>\r\n  )\r\n}\r\n","import { NpcT } from '../types/Npc'\r\nimport { v4 } from 'uuid'\r\n\r\nimport {\r\n  uniqueNamesGenerator,\r\n  Config,\r\n  adjectives,\r\n  animals,\r\n} from 'unique-names-generator'\r\nimport { CharacterResourcesT, CharacterAbilitiesT } from '../types/Character'\r\nimport { DamageTypeRollsT } from '../types/Damage'\r\nimport { buildWeapon } from './builders/weapons/createWeapon'\r\nimport { getRandom } from '../util/getRandom'\r\nimport { buildArmor } from './builders/armor/createArmor'\r\nimport { BASIC_ATTACK } from './makeSkill'\r\nimport { makeCharacterRoll } from '../types/Roll2'\r\n\r\nconst randomNameConfig: Config = {\r\n  dictionaries: [adjectives, animals],\r\n  length: 2,\r\n  separator: ' ',\r\n}\r\n\r\nexport const makeNpc = (\r\n  abilities: Partial<CharacterAbilitiesT> = {},\r\n  damageResistances: Partial<DamageTypeRollsT> = {},\r\n  resources: Partial<CharacterResourcesT> = {},\r\n): NpcT => {\r\n  return {\r\n    id: v4(),\r\n    npc: true,\r\n    name: uniqueNamesGenerator(randomNameConfig),\r\n    power: 600,\r\n    resources: {\r\n      characterPoints: 250,\r\n      weaponHands: 2,\r\n      heads: 1,\r\n      bodies: 1,\r\n      hands: 2,\r\n      fingers: 10,\r\n      feet: 2,\r\n      ...resources,\r\n    },\r\n    abilities: {\r\n      strength: 10,\r\n      dexterity: 10,\r\n      intelligence: 10,\r\n      vigor: 10,\r\n      ...abilities,\r\n    },\r\n    damageResistances: {\r\n      slashing: makeCharacterRoll([]),\r\n      piercing: makeCharacterRoll([]),\r\n      fire: makeCharacterRoll([]),\r\n      blood: makeCharacterRoll([]),\r\n      light: makeCharacterRoll([]),\r\n      dark: makeCharacterRoll([]),\r\n      ...damageResistances,\r\n    },\r\n\r\n    weapon: buildWeapon(\r\n      getRandom([\r\n        'axe',\r\n        'greataxe',\r\n        'wand',\r\n        'staff',\r\n        'daggers',\r\n        'katana',\r\n        'sword',\r\n        'greatsword',\r\n        'flail',\r\n        'elementalGreatsword',\r\n        'elementalSword',\r\n      ]),\r\n    ),\r\n\r\n    traits: [],\r\n    skills: [BASIC_ATTACK],\r\n    equippedItems: [],\r\n    armor: [\r\n      buildArmor('cowl'),\r\n      buildArmor('chestplate'),\r\n      buildArmor('gloves'),\r\n      buildArmor('boots'),\r\n    ],\r\n\r\n    healthOffset: 0,\r\n    focusOffset: 0,\r\n    dead: false,\r\n    inspected: false,\r\n  }\r\n}\r\n","import { PartyT } from '../types/Party'\r\nimport { v4 } from 'uuid'\r\nimport { makeNpc } from './makeNpc'\r\n\r\nexport const makeParty = (id: string = v4()): PartyT => {\r\n  return {\r\n    id,\r\n    items: [],\r\n    skills: [],\r\n    mods: [],\r\n    characters: [makeNpc(), makeNpc(), makeNpc(), makeNpc(), makeNpc()].map(\r\n      (c) => ({\r\n        ...c,\r\n        partyId: id,\r\n      }),\r\n    ),\r\n  }\r\n}\r\n","import React from 'react'\r\nimport { AttackResultT, isUser, isEnemy } from './util'\r\nimport { ProcessedCharacterT, CharacterT } from '../../types/Character'\r\nimport { BASIC_ATTACK } from '../../objects/makeSkill'\r\nimport { getKeys } from '../../util/getKeys'\r\n\r\nexport const Span = (color: string, text: string, bold: boolean = true) => (\r\n  <span style={{ color, fontWeight: bold ? 'bold' : 'normal' }}>{text}</span>\r\n)\r\nexport const NameSpan = (character: CharacterT) =>\r\n  isUser(character)\r\n    ? Span('lightgreen', character.name)\r\n    : Span('lightsalmon', character.name)\r\n\r\nexport const logResult = (\r\n  attackResult: AttackResultT,\r\n  source: ProcessedCharacterT,\r\n  target: ProcessedCharacterT,\r\n  addLine: (line: React.ReactNode) => void,\r\n) => {\r\n  if (attackResult.skill.id !== BASIC_ATTACK.id) {\r\n    addLine(\r\n      <span>\r\n        {NameSpan(source)} casts {Span('#cda5f3', attackResult.skill.name)}\r\n        {attackResult.skill.target && <span> on {NameSpan(target)}.</span>}\r\n      </span>,\r\n    )\r\n  }\r\n  if (attackResult.hitSuccess) {\r\n    if (attackResult.skill.id === BASIC_ATTACK.id) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(source)} attacks {NameSpan(target)} for{' '}\r\n          {Span('white', `${attackResult.totalDamage} damage`)}.\r\n        </span>,\r\n      )\r\n    } else {\r\n      if (attackResult.rawDamage > 0) {\r\n        addLine(\r\n          <span>\r\n            {Span('#cda5f3', attackResult.skill.name)} deals{' '}\r\n            {Span('white', `${attackResult.totalDamage} damage`)}.\r\n          </span>,\r\n        )\r\n      }\r\n      if (\r\n        attackResult.targetTraits.length > 0 ||\r\n        attackResult.sourceTraits.length > 0\r\n      ) {\r\n        LogAddedTraits(attackResult, source, target, addLine)\r\n      }\r\n    }\r\n    if (attackResult.criticalSuccess) {\r\n      addLine(<span style={{ color: 'khaki' }}>Critical hit!</span>)\r\n    }\r\n  } else {\r\n    if (attackResult.skill.id === BASIC_ATTACK.id) {\r\n      addLine(<span>{NameSpan(source)}'s attack missed.</span>)\r\n    } else {\r\n      addLine(\r\n        <span>\r\n          {Span('#cda5f3', attackResult.skill.name)}{' '}\r\n          {attackResult.skill.target ? 'missed' : 'failed'}.\r\n        </span>,\r\n      )\r\n    }\r\n  }\r\n  if (attackResult.dodgeSuccess) {\r\n    addLine(\r\n      <span>\r\n        {NameSpan(target)} dodged {NameSpan(source)}'s attack\r\n      </span>,\r\n    )\r\n  }\r\n  if (target.stats.health <= target.healthOffset + attackResult.totalDamage) {\r\n    addLine(Span('lightcoral', `${target.name} died`))\r\n  }\r\n}\r\n\r\nexport const cz = (v: number) => v !== 0\r\nexport const gv = (v: number) => (v > 0 ? 'gained' : 'lost')\r\nexport const LogAddedTraits = (\r\n  attackResult: AttackResultT,\r\n  source: ProcessedCharacterT,\r\n  target: ProcessedCharacterT,\r\n  addLine: (line: React.ReactNode) => void,\r\n) => {\r\n  attackResult.targetTraits.forEach((trait) => {\r\n    const gfo = target.focusOffset - trait.focusOffset\r\n    const focusOffset = gfo < 0 ? trait.focusOffset + gfo : trait.focusOffset\r\n    if (cz(focusOffset)) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(target)} {gv(focusOffset)} {focusOffset} FP.\r\n        </span>,\r\n      )\r\n    }\r\n    getKeys(trait.abilitiesModifiers).forEach((key) => {\r\n      if (cz(trait.abilitiesModifiers[key])) {\r\n        addLine(\r\n          <span>\r\n            {NameSpan(target)} {gv(trait.abilitiesModifiers[key])}{' '}\r\n            {trait.abilitiesModifiers[key]} {key}.{' '}\r\n            {trait.duration > 1 && `(${trait.duration - 1}`}\r\n          </span>,\r\n        )\r\n      }\r\n    })\r\n    getKeys(trait.statsModifiers).forEach((key) => {\r\n      if (cz(trait.statsModifiers[key])) {\r\n        addLine(\r\n          <span>\r\n            {NameSpan(target)} {gv(trait.statsModifiers[key])}{' '}\r\n            {trait.statsModifiers[key]} {key}.{' '}\r\n            {trait.duration > 1 && `(${trait.duration - 1})`}\r\n          </span>,\r\n        )\r\n      }\r\n    })\r\n  })\r\n  attackResult.sourceTraits.forEach((trait) => {\r\n    const gfo = source.focusOffset - trait.focusOffset\r\n    const focusOffset = gfo < 0 ? trait.focusOffset + gfo : trait.focusOffset\r\n    if (cz(focusOffset)) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(source)} {gv(focusOffset)} {focusOffset} FP.\r\n        </span>,\r\n      )\r\n    }\r\n    const gho = source.healthOffset - trait.healthOffset\r\n    const healthOffset = gho < 0 ? trait.healthOffset + gho : trait.healthOffset\r\n    if (cz(healthOffset)) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(source)} {gv(healthOffset)} {healthOffset} HP.\r\n        </span>,\r\n      )\r\n    }\r\n    getKeys(trait.abilitiesModifiers).forEach((key) => {\r\n      if (cz(trait.abilitiesModifiers[key])) {\r\n        addLine(\r\n          <span>\r\n            {NameSpan(source)} {gv(trait.abilitiesModifiers[key])}{' '}\r\n            {trait.abilitiesModifiers[key]} {key}.{' '}\r\n            {trait.duration > 1 && `(${trait.duration - 1})`}\r\n          </span>,\r\n        )\r\n      }\r\n    })\r\n    getKeys(trait.statsModifiers).forEach((key) => {\r\n      if (cz(trait.statsModifiers[key])) {\r\n        addLine(\r\n          <span>\r\n            {NameSpan(source)} {gv(trait.statsModifiers[key])}{' '}\r\n            {trait.statsModifiers[key]} {key}.{' '}\r\n            {trait.duration > 1 && `(${trait.duration - 1})`}\r\n          </span>,\r\n        )\r\n      }\r\n    })\r\n  })\r\n}\r\n","import React from 'react'\r\nimport { ProcessedPartyT, PartyT, processParty } from '../../types/Party'\r\nimport { getRandom } from '../../util/getRandom'\r\nimport {\r\n  ProcessedCharacterT,\r\n  CharacterT,\r\n  processCharacter,\r\n  combineTraits,\r\n  commitTrait,\r\n  CharacterTraitT,\r\n} from '../../types/Character'\r\nimport { RollCheckerT } from '../RollContext'\r\nimport {\r\n  rollDamage,\r\n  getDamageTypeKeys,\r\n  DamageTypeRollsT,\r\n} from '../../types/Damage'\r\nimport { noneg } from '../../util/noneg'\r\nimport { v4 } from 'uuid'\r\nimport { PC_PARTY_ID } from '../../state/parties'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport { BASIC_ATTACK } from '../../objects/makeSkill'\r\nimport { NameSpan, logResult, gv } from './log'\r\nimport {\r\n  combineCharacterRolls,\r\n  ZERO_ROLL,\r\n  CharacterRollT,\r\n  CharacterCheckT,\r\n  makeCharacterCheck,\r\n  Check2ResultT,\r\n  Roll2ResultT,\r\n} from '../../types/Roll2'\r\nimport { SkillT } from '../../types/Skill'\r\nimport { EventTypeT, checkEvent } from '../../types/Events'\r\n\r\nexport interface AttackResultT {\r\n  id: string\r\n  sourceId: string\r\n  targetId: string\r\n  skill: SkillT\r\n  index: number\r\n  hitSuccess: boolean\r\n  criticalSuccess: boolean\r\n  dodgeSuccess: boolean\r\n  rawDamage: number\r\n  blockedDamage: number\r\n  totalDamage: number\r\n  targetTraits: CharacterTraitT[]\r\n  sourceTraits: CharacterTraitT[]\r\n}\r\nexport const ZERO_RESULT: AttackResultT = {\r\n  id: 'zero',\r\n  sourceId: '',\r\n  targetId: '',\r\n  skill: BASIC_ATTACK,\r\n  index: 0,\r\n  hitSuccess: false,\r\n  criticalSuccess: false,\r\n  dodgeSuccess: false,\r\n  rawDamage: 0,\r\n  blockedDamage: 0,\r\n  totalDamage: 0,\r\n  targetTraits: [],\r\n  sourceTraits: [],\r\n}\r\n\r\nexport type CombatRoundT = Record<string, AttackResultT>\r\n\r\nexport const getCombatRecordBuilder = (\r\n  characterSkills: { [characterId: string]: string | undefined },\r\n  characterTargets: { [characterId: string]: string | undefined },\r\n  checkCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterCheckT, Check2ResultT>,\r\n  rollCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterRollT, Roll2ResultT>,\r\n) => (\r\n  userParty: ProcessedPartyT,\r\n  enemyParty: ProcessedPartyT,\r\n  rawParties: PartyT[],\r\n): CombatRoundT => {\r\n  const characters = [...userParty.characters, ...enemyParty.characters]\r\n  let result: CombatRoundT = {}\r\n  characters\r\n    .filter((c) => !c.dead)\r\n    .sort((a, b) => b.stats.agility - a.stats.agility)\r\n    .forEach((source, index) => {\r\n      const partyA = rawParties.find((p) => p.id === source.partyId)\r\n      // this line is volitile\r\n      const partyB = rawParties.find((p) => p.id !== source.partyId)\r\n      if (!partyA || !partyB) return\r\n      const bCharacters = processParty(partyB).characters.filter((c) => !c.dead)\r\n      const target =\r\n        bCharacters.find((c) => c.id === characterTargets[source.id]) ||\r\n        getRandom(bCharacters)\r\n      if (target) {\r\n        result = {\r\n          ...result,\r\n          [source.name]: {\r\n            ...execSkill(\r\n              characterSkills,\r\n              checkCharacter,\r\n              rollCharacter,\r\n            )(target, source),\r\n            index,\r\n          },\r\n        }\r\n      }\r\n    })\r\n  return result\r\n}\r\n\r\nconst cr = (roll?: CharacterRollT): CharacterRollT =>\r\n  roll || { ...ZERO_ROLL, keys: [] }\r\nexport const getSkillDamageRolls = (\r\n  skill: SkillT,\r\n  weapon: WeaponT,\r\n): DamageTypeRollsT => {\r\n  if (skill.combineWeaponDamage) {\r\n    return {\r\n      slashing: combineCharacterRolls(\r\n        cr(skill.damageRolls.slashing),\r\n        cr(weapon.damageRolls.slashing),\r\n      ),\r\n      piercing: combineCharacterRolls(\r\n        cr(skill.damageRolls.piercing),\r\n        cr(weapon.damageRolls.piercing),\r\n      ),\r\n      fire: combineCharacterRolls(\r\n        cr(skill.damageRolls.fire),\r\n        cr(weapon.damageRolls.fire),\r\n      ),\r\n      blood: combineCharacterRolls(\r\n        cr(skill.damageRolls.blood),\r\n        cr(weapon.damageRolls.blood),\r\n      ),\r\n      light: combineCharacterRolls(\r\n        cr(skill.damageRolls.light),\r\n        cr(weapon.damageRolls.light),\r\n      ),\r\n      dark: combineCharacterRolls(\r\n        cr(skill.damageRolls.dark),\r\n        cr(weapon.damageRolls.dark),\r\n      ),\r\n    }\r\n  } else {\r\n    return skill.damageRolls\r\n  }\r\n}\r\n\r\nexport const getSkillCheck = (\r\n  skill: SkillT,\r\n  weapon: WeaponT,\r\n): CharacterCheckT => {\r\n  if (skill.combineWeaponDamage) {\r\n    return weapon.accuracyCheck\r\n  } else {\r\n    return skill.check || makeCharacterCheck([], undefined, 0, 18)\r\n  }\r\n}\r\n\r\nexport const execSkill = (\r\n  characterSkills: { [characterId: string]: string | undefined },\r\n  checkCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterCheckT, Check2ResultT>,\r\n  rollCharacter: (\r\n    c: ProcessedCharacterT,\r\n  ) => RollCheckerT<CharacterRollT, Roll2ResultT>,\r\n) => (\r\n  target: ProcessedCharacterT,\r\n  source: ProcessedCharacterT,\r\n): AttackResultT => {\r\n  let attackResult = {\r\n    ...ZERO_RESULT,\r\n    id: v4(),\r\n    targetId: target.id,\r\n    sourceId: source.id,\r\n  }\r\n  const skill =\r\n    source.skills.find((skill) => skill.id === characterSkills[source.id]) ||\r\n    BASIC_ATTACK\r\n\r\n  attackResult.skill = skill\r\n  const { weapon } = source\r\n  const damageRolls = getSkillDamageRolls(skill, weapon)\r\n  const skillCheck = getSkillCheck(skill, weapon)\r\n  const skillCheckResult = checkCharacter(source)(skillCheck)\r\n  if (skillCheckResult.result) {\r\n    const criticalSuccess = skillCheckResult.criticalSuccess\r\n    attackResult.hitSuccess = true\r\n    attackResult.criticalSuccess = criticalSuccess\r\n    const rr = rollCharacter(source)\r\n    const damageRollsResult = rollDamage(rr)(\r\n      damageRolls,\r\n      criticalSuccess,\r\n      `${source.name} damage`,\r\n    )\r\n    attackResult.rawDamage = damageRollsResult.total\r\n    const dodgeRoll = checkCharacter(target)(\r\n      makeCharacterCheck(['evade'], undefined),\r\n    )\r\n    attackResult.dodgeSuccess = dodgeRoll.result || false\r\n    if (!dodgeRoll.result) {\r\n      const { damageResistances } = target\r\n      const damageKeys = getDamageTypeKeys(\r\n        damageRollsResult.rollResults,\r\n      ).filter((k) => damageRollsResult.rollResults[k])\r\n      damageKeys.forEach((key) => {\r\n        const damageResult = damageRollsResult.rollResults[key] as Roll2ResultT\r\n        const resistanceCheck = damageResistances[key] as CharacterRollT\r\n        const resistanceRoll = rollCharacter(source)(resistanceCheck, true)\r\n        const blockedDamage = criticalSuccess ? 0 : resistanceRoll.total\r\n        const damageTotal = damageResult.total - blockedDamage\r\n        attackResult.blockedDamage += damageResult.total > 0 ? blockedDamage : 0\r\n        attackResult.totalDamage += noneg(damageTotal)\r\n      })\r\n    }\r\n    if (skill.checkDodgeForTraits) {\r\n      if (!dodgeRoll.result) {\r\n        attackResult.targetTraits = skill.targetTraits\r\n        attackResult.sourceTraits = skill.sourceTraits\r\n      }\r\n    } else {\r\n      attackResult.targetTraits = skill.targetTraits\r\n      attackResult.sourceTraits = skill.sourceTraits\r\n    }\r\n  }\r\n\r\n  return attackResult\r\n}\r\n\r\nexport const resolveRound = (\r\n  rounds: CombatRoundT[],\r\n  rawUserParty: PartyT,\r\n  rawEnemyParty: PartyT,\r\n  addLine: (line: React.ReactNode) => void,\r\n  updateCharacter: (character: CharacterT, partyId?: string) => void,\r\n): ProcessedCharacterT[] => {\r\n  if (rounds.length === 0) return []\r\n  if (!rawUserParty || !rawEnemyParty) return []\r\n  let rawCharacters = [...rawUserParty.characters, ...rawEnemyParty.characters]\r\n  const getCharacters = () => rawCharacters.map((c) => processCharacter(c))\r\n  const localUpdate = (\r\n    id: string,\r\n    updater: (character: CharacterT) => CharacterT,\r\n  ) => {\r\n    rawCharacters = rawCharacters.map((c) => (c.id === id ? updater(c) : c))\r\n  }\r\n  const round = rounds[rounds.length - 1]\r\n  addLine(\r\n    <strong\r\n      style={{\r\n        color: 'lightblue',\r\n        fontSize: 20,\r\n        display: 'inline-block',\r\n        marginTop: 4,\r\n      }}\r\n    >{`ROUND ${rounds.length}`}</strong>,\r\n  )\r\n  Object.values(round)\r\n    .sort((a, b) => a.index - b.index)\r\n    .forEach((attackResult) => {\r\n      const characters = getCharacters()\r\n      const source = characters.find((c) => c.id === attackResult.sourceId)\r\n      const target = characters.find((c) => c.id === attackResult.targetId)\r\n      const rawSource = rawCharacters.find(\r\n        (c) => c.id === attackResult.sourceId,\r\n      )\r\n      const rawTarget = rawCharacters.find(\r\n        (c) => c.id === attackResult.targetId,\r\n      )\r\n      if (!rawSource || !source || !rawTarget || !target) return\r\n      if (!source.dead && !target.dead) {\r\n        logResult(attackResult, source, target, addLine)\r\n        const skill = attackResult.skill\r\n        const healthOffset = rawTarget.healthOffset + attackResult.totalDamage\r\n        const focusOffset = rawSource.focusOffset + skill.focusCost\r\n        const getTraitUpdates = (\r\n          c: CharacterT,\r\n          traits: CharacterTraitT[],\r\n        ): CharacterT => {\r\n          if (attackResult.hitSuccess) {\r\n            return {\r\n              ...commitTrait(c)(combineTraits(traits)),\r\n              traits: [\r\n                ...c.traits,\r\n                ...traits.map((t) => ({\r\n                  ...t,\r\n                  healthOffset: 0,\r\n                  focusOffset: 0,\r\n                })),\r\n              ],\r\n            }\r\n          }\r\n          return c\r\n        }\r\n        localUpdate(target.id, (c) => ({\r\n          ...c,\r\n          ...getTraitUpdates(c, skill.targetTraits),\r\n          inspected: skill.inspected || c.inspected,\r\n          healthOffset,\r\n        }))\r\n        localUpdate(source.id, (c) => ({\r\n          ...c,\r\n          ...getTraitUpdates(c, skill.sourceTraits),\r\n          focusOffset,\r\n        }))\r\n\r\n        if (skill.combineWeaponDamage && attackResult.hitSuccess) {\r\n          processEvent('onHit', source, rawSource, skill, addLine, localUpdate)\r\n        }\r\n        if (skill.combineWeaponDamage && attackResult.criticalSuccess) {\r\n          processEvent('onCrit', source, rawSource, skill, addLine, localUpdate)\r\n        }\r\n      }\r\n    })\r\n  rawCharacters.forEach((c) => {\r\n    const pc = processCharacter(c)\r\n    updateCharacter(\r\n      {\r\n        ...c,\r\n        traits: pc.dead\r\n          ? c.traits\r\n          : c.traits\r\n              .map((t) => ({ ...t, duration: t.duration - 1 }))\r\n              .filter((t) => t.duration !== 0),\r\n      },\r\n      c.partyId,\r\n    )\r\n  })\r\n  return rawCharacters.map((c) => processCharacter(c))\r\n}\r\n\r\nexport const processEvent = (\r\n  event: EventTypeT,\r\n  source: ProcessedCharacterT,\r\n  rawSource: CharacterT,\r\n  skill: SkillT,\r\n  addLine: (line: React.ReactNode) => void,\r\n  localUpdate: (\r\n    id: string,\r\n    updater: (character: CharacterT) => CharacterT,\r\n  ) => void,\r\n) => {\r\n  const addedTraits = checkEvent(rawSource, skill)(event)\r\n  const name =\r\n    skill.combineWeaponDamage && !skill.events[event]\r\n      ? source.weapon.name\r\n      : skill.name\r\n  if (addedTraits) {\r\n    const combinedTrait = combineTraits(addedTraits)\r\n    const gho = source.healthOffset - combinedTrait.healthOffset\r\n    const healthOffset =\r\n      gho <= 0 ? combinedTrait.healthOffset + gho : combinedTrait.healthOffset\r\n    if (healthOffset !== 0) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(source)} {gv(healthOffset)} {healthOffset} HP from {name}.\r\n        </span>,\r\n      )\r\n    }\r\n    const gfo = source.focusOffset - combinedTrait.focusOffset\r\n    const focusOffset =\r\n      gfo < 0 ? combinedTrait.focusOffset + gfo : combinedTrait.focusOffset\r\n    if (focusOffset !== 0) {\r\n      addLine(\r\n        <span>\r\n          {NameSpan(source)} {gv(focusOffset)} {focusOffset} FP from {name}.\r\n        </span>,\r\n      )\r\n    }\r\n    getKeys(combinedTrait.abilitiesModifiers).forEach((key) => {\r\n      const value = combinedTrait.abilitiesModifiers[key]\r\n      if (value !== 0) {\r\n        addLine(\r\n          <span>\r\n            {NameSpan(source)} {gv(value)} {value} {key} from {name}.\r\n          </span>,\r\n        )\r\n      }\r\n    })\r\n    localUpdate(rawSource.id, (c) => ({\r\n      ...commitTrait(c)(combinedTrait),\r\n      traits: [\r\n        ...c.traits,\r\n        ...addedTraits.map((t) => ({ ...t, healthOffset: 0 })),\r\n      ],\r\n    }))\r\n  }\r\n}\r\n\r\nexport const checkParty = (party: ProcessedPartyT) => {\r\n  return (\r\n    party &&\r\n    party.characters.filter((c) => c.healthOffset < c.stats.health).length === 0\r\n  )\r\n}\r\n\r\nexport const checkCharacterActiveSkills = (\r\n  characters: ProcessedCharacterT[],\r\n  characterSkills: { [characterId: string]: string | undefined },\r\n  setCharacterSkill: (characterId: string, skillId?: string) => void,\r\n) => {\r\n  characters.forEach((character) => {\r\n    const activeSkill =\r\n      character.skills.find((s) => s.id === characterSkills[character.id]) ||\r\n      BASIC_ATTACK\r\n    const focus = character.stats.focus - character.focusOffset\r\n    if (activeSkill.focusCost > focus) {\r\n      setCharacterSkill(character.id, BASIC_ATTACK.id)\r\n    }\r\n  })\r\n}\r\n\r\nexport const checkCharacterActiveTargets = (\r\n  characters: ProcessedCharacterT[],\r\n  characterTargets: { [characterId: string]: string | undefined },\r\n  setCharacterTarget: (characterId: string, targetId?: string) => void,\r\n) => {\r\n  characters.forEach((character) => {\r\n    const activeTarget = characters.find(\r\n      (c) => c.id === characterTargets[character.id],\r\n    )\r\n    if (activeTarget) {\r\n      if (activeTarget.dead) {\r\n        setCharacterTarget(character.id, undefined)\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nexport const ENEMY_PARTY_ID = v4()\r\nexport const isUser = (character: CharacterT) =>\r\n  character.partyId === PC_PARTY_ID\r\nexport const isEnemy = (character: CharacterT) =>\r\n  character.partyId === ENEMY_PARTY_ID\r\n","import React, { useContext, useState } from 'react'\r\n\r\nexport interface CombatLogContextT {\r\n  lines: React.ReactNode[]\r\n  addLine: (line: React.ReactNode) => void\r\n  clear: () => void\r\n}\r\nexport const CombatLogContext = React.createContext<CombatLogContextT>({\r\n  lines: [],\r\n  addLine: (line: React.ReactNode) => {},\r\n  clear: () => {},\r\n})\r\nexport const useCombatLogContext = () => useContext(CombatLogContext)\r\n\r\nexport interface CombatLogContextProviderPropsT {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const CombatLogContextProvider = (\r\n  props: CombatLogContextProviderPropsT,\r\n) => {\r\n  const { children } = props\r\n  const [lines, setLines] = useState<React.ReactNode[]>([])\r\n  const clear = () => setLines([])\r\n\r\n  return (\r\n    <CombatLogContext.Provider\r\n      value={{\r\n        lines,\r\n        addLine: (line) => setLines((log) => [...log, line]),\r\n        clear,\r\n      }}\r\n    >\r\n      {children}\r\n    </CombatLogContext.Provider>\r\n  )\r\n}\r\n","import { CSSProperties } from 'react'\r\n\r\nexport interface ModalContextStateT {\r\n  isOpen: boolean\r\n  contents: React.FC | null\r\n  callback: ((payload?: any) => void) | null\r\n  payload: any | null\r\n  blocking: boolean\r\n  style: CSSProperties\r\n}\r\nexport const initialState: ModalContextStateT = {\r\n  isOpen: false,\r\n  contents: null,\r\n  callback: null,\r\n  payload: null,\r\n  blocking: false,\r\n  style: {},\r\n}\r\n\r\nexport const OPEN = 'modalContext/OPEN'\r\nexport const CLOSE = 'modalContext/CLOSE'\r\nexport const SET_CONTENTS = 'modalContext/SET_CONTENTS'\r\nexport const SET_CALLBACK = 'modalContext/SET_CALLBACK'\r\nexport const SET_PAYLOAD = 'modalContext/SET_PAYLOAD'\r\nexport const SET_BLOCKING = 'modalContext/SET_BLOCKING'\r\nexport const SET_STYLE = 'modalContext/SET_STYLE'\r\n\r\nexport const actions = {\r\n  open: (contents?: React.FC, style?: CSSProperties, blocking?: boolean) => ({\r\n    type: OPEN,\r\n    contents,\r\n    style,\r\n    blocking,\r\n  }),\r\n  close: () => ({ type: CLOSE }),\r\n  setPayload: (payload: any) => ({ type: SET_PAYLOAD, payload }),\r\n  setContents: (contents: React.FC | null) => ({\r\n    type: SET_CONTENTS,\r\n    contents,\r\n  }),\r\n  setCallback: (callback: (() => void) | null) => ({\r\n    type: SET_CALLBACK,\r\n    callback,\r\n  }),\r\n  setBlocking: (blocking: boolean) => ({ type: SET_BLOCKING, blocking }),\r\n  setStyle: (style: CSSProperties) => ({ type: SET_STYLE, style }),\r\n}\r\n\r\nconst core: Record<\r\n  string,\r\n  (state: ModalContextStateT, action: any) => ModalContextStateT\r\n> = {\r\n  [OPEN]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    isOpen: true,\r\n    contents: action.contents ? action.contents : state.contents,\r\n    style: action.style ? action.style : state.style || {},\r\n    blocking: action.blocking || false,\r\n  }),\r\n  [CLOSE]: (state: ModalContextStateT) => ({\r\n    ...state,\r\n    isOpen: false,\r\n  }),\r\n  [SET_PAYLOAD]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    payload: action.payload,\r\n  }),\r\n  [SET_CONTENTS]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    callback: null,\r\n    payload: null,\r\n    contents: action.contents,\r\n    blocking: false,\r\n    style: {},\r\n  }),\r\n  [SET_CALLBACK]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    callback: action.callback,\r\n  }),\r\n  [SET_BLOCKING]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    blocking: action.blocking,\r\n  }),\r\n  [SET_STYLE]: (state: ModalContextStateT, action: any) => ({\r\n    ...state,\r\n    style: action.style,\r\n  }),\r\n}\r\n\r\nexport const reducer = (\r\n  state: ModalContextStateT = initialState,\r\n  action: any,\r\n) => {\r\n  const coreFunction = core[action.type]\r\n  return coreFunction ? coreFunction(state, action) : state\r\n}\r\n","import React, { useContext, useReducer, useMemo, CSSProperties } from 'react'\r\nimport Modal from 'react-modal'\r\nimport { actions, reducer, initialState, ModalContextStateT } from './reducer'\r\n\r\nconst overlayStyles = () => ({\r\n  zIndex: 700,\r\n})\r\nconst contentStyles = (styles: CSSProperties): CSSProperties => ({\r\n  width: '50vw',\r\n  maxHeight: 'calc(100vh - 128px)',\r\n  marginLeft: 'auto',\r\n  marginRight: 'auto',\r\n  ...styles,\r\n})\r\n\r\nexport interface ModalContextT {\r\n  open: (contents?: React.FC, style?: CSSProperties, blocking?: boolean) => void\r\n  close: (payload?: any) => void\r\n  setPayload: (payload: any) => void\r\n  setBlocking: (blocking: boolean) => void\r\n  setContents: (contents: React.FC) => void\r\n  setCallback: (callback: (payload?: any) => void) => void\r\n  setStyle: (style: CSSProperties) => void\r\n}\r\nconst defaultContext: ModalContextT = {\r\n  open: () => null,\r\n  close: () => null,\r\n  setBlocking: () => null,\r\n  setPayload: () => null,\r\n  setContents: () => null,\r\n  setCallback: () => null,\r\n  setStyle: () => null,\r\n}\r\nexport const ModalContext = React.createContext<ModalContextT>(defaultContext)\r\nexport const useModalContext = () => useContext(ModalContext)\r\n\r\nconst getContextValue = (\r\n  state: ModalContextStateT,\r\n  dispatch: React.Dispatch<any>,\r\n) => ({\r\n  isOpen: state.isOpen,\r\n  open: (contents?: React.FC, style?: CSSProperties, blocking?: boolean) =>\r\n    dispatch(actions.open(contents, style, blocking)),\r\n  close: (payload?: any) => {\r\n    if (state.callback) state.callback(payload || state.payload)\r\n    dispatch(actions.close())\r\n  },\r\n  setPayload: (payload: any) => dispatch(actions.setPayload(payload)),\r\n  setContents: (contents: React.FC) => dispatch(actions.setContents(contents)),\r\n  setCallback: (callback: (payload?: any) => void) =>\r\n    dispatch(actions.setCallback(callback)),\r\n  setBlocking: (blocking: boolean) => dispatch(actions.setBlocking(blocking)),\r\n  setStyle: (style: CSSProperties) => dispatch(actions.setStyle(style)),\r\n})\r\n\r\nModal.setAppElement('#root')\r\nexport interface ModalContextProviderPropsT {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const ModalContextProvider = (props: ModalContextProviderPropsT) => {\r\n  const { children } = props\r\n  const reducerValue = useReducer(reducer, initialState)\r\n  const [state] = reducerValue\r\n  const context = useMemo(() => getContextValue(...reducerValue), [\r\n    reducerValue,\r\n  ])\r\n\r\n  return (\r\n    <ModalContext.Provider value={context}>\r\n      {children}\r\n      <Modal\r\n        parentSelector={() =>\r\n          document.querySelector('#content-root') as HTMLElement\r\n        }\r\n        isOpen={state.isOpen}\r\n        onRequestClose={() => {\r\n          if (!state.blocking) context.close()\r\n        }}\r\n        style={{\r\n          content: {\r\n            backgroundColor: '#111',\r\n            color: 'white',\r\n            width: 400,\r\n            margin: '0 auto',\r\n            bottom: 'unset',\r\n            borderColor: '#555',\r\n          },\r\n          overlay: {\r\n            backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n          },\r\n        }}\r\n      >\r\n        {state.contents && <state.contents />}\r\n      </Modal>\r\n    </ModalContext.Provider>\r\n  )\r\n}\r\n","import { EquippableT, ItemTypeT, ItemRarityT } from '../../types/Item'\r\nimport { getRandom } from '../../util/getRandom'\r\nimport { WeaponTypeT, WeaponT } from '../../types/Weapon'\r\nimport { getKeys } from '../../util/getKeys'\r\nimport { ArmorT, ArmorTypeT } from '../../types/Armor'\r\nimport { FISTS } from '../fists'\r\nimport { CharacterSkillCheckKeyT } from '../../types/Character'\r\n\r\nimport { buildArmor } from './armor/createArmor'\r\nimport { buildWeapon } from './weapons/createWeapon'\r\nimport { BASE_EQUIPPABLE } from '../util'\r\n\r\ntype _ItemModifierValuesT = Record<CharacterSkillCheckKeyT, number>\r\nexport type ItemModifierValuesT = Partial<_ItemModifierValuesT>\r\n\r\nexport const getTotal = (rollResults: ItemModifierValuesT): number => {\r\n  return getKeys(rollResults as _ItemModifierValuesT)\r\n    .map((key) => rollResults[key] as number)\r\n    .reduce((sum, current) => sum + current, 0)\r\n}\r\n\r\nconst ITEM_TYPES: ItemTypeT[] = [\r\n  'weapon',\r\n  'weapon',\r\n  'armor',\r\n  'armor',\r\n  'armor',\r\n  'armor',\r\n]\r\nexport type ItemMakerMapT = Record<ItemTypeT, () => EquippableT>\r\nexport const makeItem = (core: ItemMakerMapT): EquippableT => {\r\n  return core[getRandom<ItemTypeT>(ITEM_TYPES)]()\r\n}\r\n\r\nexport type WeaponMakerMapT = Partial<Record<WeaponTypeT, () => WeaponT>>\r\nexport const makeWeapon = (core: WeaponMakerMapT): WeaponT => {\r\n  const keys = getKeys(core)\r\n  const randomKey = getRandom<WeaponTypeT>(keys)\r\n  const maker = core[randomKey] || (() => FISTS)\r\n  return maker()\r\n}\r\n\r\nexport type ArmorMakerMapT = Partial<Record<ArmorTypeT, () => ArmorT>>\r\nexport const makeArmor = (core: ArmorMakerMapT): ArmorT => {\r\n  const keys = getKeys(core)\r\n  const randomKey = getRandom<ArmorTypeT>(keys)\r\n  const maker = core[randomKey] || (() => buildArmor('ring'))\r\n  return maker()\r\n}\r\n\r\nconst rarityArray: ItemRarityT[] = [\r\n  'common',\r\n  'uncommon',\r\n  'rare',\r\n  'legendary',\r\n  'unique',\r\n  'mythic',\r\n]\r\nexport const getRarity = (index: number): ItemRarityT => {\r\n  if (index < 0) return 'common'\r\n  if (index >= rarityArray.length) return 'mythic'\r\n  return rarityArray[index]\r\n}\r\n\r\nconst itemCore: ItemMakerMapT = {\r\n  weapon: () =>\r\n    makeWeapon({\r\n      // fists: () => FISTS,\r\n      // S\r\n      axe: () => buildWeapon('axe'),\r\n      greataxe: () => buildWeapon('greataxe'),\r\n      flail: () => buildWeapon('flail'),\r\n      // D\r\n      daggers: () => buildWeapon('daggers'),\r\n      katana: () => buildWeapon('katana'),\r\n      rapier: () => buildWeapon('rapier'),\r\n      // I\r\n      wand: () => buildWeapon('wand'),\r\n      staff: () => buildWeapon('staff'),\r\n      // S+I\r\n      elementalSword: () => buildWeapon('elementalSword'),\r\n      elementalGreatsword: () => buildWeapon('elementalGreatsword'),\r\n      // S+D\r\n      sword: () => buildWeapon('sword'),\r\n      greatsword: () => buildWeapon('greatsword'),\r\n      // D+I\r\n      pistol: () => buildWeapon('pistol'),\r\n      crossbow: () => buildWeapon('crossbow'),\r\n    }),\r\n  armor: () =>\r\n    makeArmor({\r\n      helmet: () => buildArmor('helmet'),\r\n      cowl: () => buildArmor('cowl'),\r\n      chestplate: () => buildArmor('chestplate'),\r\n      robe: () => buildArmor('robe'),\r\n      ring: () => buildArmor('ring'),\r\n      boots: () => buildArmor('boots'),\r\n      gloves: () => buildArmor('gloves'),\r\n    }),\r\n  offhand: () => BASE_EQUIPPABLE('offhand'),\r\n}\r\n\r\nexport default (): EquippableT => makeItem(itemCore)\r\n","import React, { useMemo, useState } from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { BoxButton } from '../../elements/box'\r\nimport { useModalContext } from '../../contexts/ModalContext'\r\nimport makeItem from '../../objects/builders/makeItem'\r\nimport { ItemPreviewSmall } from '../ItemPreviewSmall'\r\n\r\nexport interface CombatVictoryModalPropsT {\r\n  reset: (done: boolean) => void\r\n}\r\nexport const CombatVictoryModal = (props: CombatVictoryModalPropsT) => {\r\n  const { reset } = props\r\n  const { close } = useModalContext()\r\n\r\n  const [chosenItemId, setChosenItemId] = useState<string | undefined>()\r\n  const rewardChoices = useMemo(() => {\r\n    return [makeItem(), makeItem(), makeItem(), makeItem(), makeItem()]\r\n  }, [])\r\n\r\n  const onNextClick = () => {\r\n    reset(false)\r\n    close(rewardChoices.find((i) => i.id === chosenItemId))\r\n  }\r\n\r\n  console.log(rewardChoices)\r\n  return (\r\n    <FlexContainer $direction='column'>\r\n      <h1 style={{ textAlign: 'center', marginTop: 0 }}>Victory!</h1>\r\n      <FlexContainer $direction='column' style={{ alignItems: 'center' }}>\r\n        <span style={{ marginBottom: 20, fontFamily: 'monospace' }}>\r\n          Each character gained 5 XP\r\n        </span>\r\n        <span>Choose a Reward</span>\r\n        <FlexContainer>\r\n          {rewardChoices.map((item) => (\r\n            <div\r\n              style={{\r\n                border: '2px solid transparent',\r\n                borderColor: chosenItemId === item.id ? 'white' : 'transparent',\r\n              }}\r\n            >\r\n              <ItemPreviewSmall\r\n                item={item}\r\n                size={60}\r\n                onClick={() => setChosenItemId(item.id)}\r\n              />\r\n            </div>\r\n          ))}\r\n        </FlexContainer>\r\n      </FlexContainer>\r\n      <FlexContainer style={{ marginTop: 20, alignItems: 'center' }}>\r\n        <BoxButton disabled={chosenItemId === undefined} onClick={onNextClick}>\r\n          Next Battle\r\n        </BoxButton>\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { BoxButton } from '../../elements/box'\r\nimport { useModalContext } from '../../contexts/ModalContext'\r\nimport { useHistory } from 'react-router'\r\n\r\nexport interface CombatLossModalPropsT {\r\n  wins: number\r\n}\r\nexport const CombatLossModal = (props: CombatLossModalPropsT) => {\r\n  const { wins } = props\r\n  const history = useHistory()\r\n  const { close } = useModalContext()\r\n\r\n  const onNextClick = () => {\r\n    close()\r\n    history.push('/characters/')\r\n  }\r\n  return (\r\n    <FlexContainer $direction='column'>\r\n      <h1 style={{ textAlign: 'center', marginTop: 0 }}>You Died...</h1>\r\n      <span>But you won {wins} times.</span>\r\n      <FlexContainer>\r\n        <BoxButton onClick={onNextClick}>Back to Characters</BoxButton>\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React, { createContext, useContext, useEffect, useState } from 'react'\r\nimport { ProcessedPartyT, PartyT } from '../../types/Party'\r\nimport { usePartyContext } from '../PartyContext'\r\nimport { makeParty } from '../../objects/makeParty'\r\nimport { v4 } from 'uuid'\r\nimport { PC_PARTY_ID } from '../../state/parties'\r\nimport { useRollContext } from '../RollContext'\r\nimport {\r\n  getCombatRecordBuilder,\r\n  CombatRoundT,\r\n  ENEMY_PARTY_ID,\r\n  checkParty,\r\n  resolveRound,\r\n  checkCharacterActiveSkills,\r\n  checkCharacterActiveTargets,\r\n} from './util'\r\nimport { useCombatLogContext } from '../CombatLogContext'\r\nimport { useModalContext } from '../ModalContext'\r\nimport { useHistory } from 'react-router'\r\nimport { CombatVictoryModal } from '../../components/CombatVictoryModal'\r\nimport { CombatLossModal } from '../../components/CombatLossModal'\r\n\r\nexport interface CombatContextT {\r\n  rounds: CombatRoundT[]\r\n  userParty: ProcessedPartyT\r\n  rawUserParty: PartyT\r\n  enemyParty: ProcessedPartyT\r\n  rawEnemyParty: PartyT\r\n  parties: ProcessedPartyT[]\r\n  done: boolean\r\n  characterSkills: { [characterId: string]: string | undefined }\r\n  characterTargets: { [characterId: string]: string | undefined }\r\n  setCharacterSkill: (characterId: string, skillId?: string) => void\r\n  setCharacterTarget: (characterId: string, targetId?: string) => void\r\n  next: () => void\r\n  reset: (done: boolean) => void\r\n}\r\nconst defaultContextValue: CombatContextT = {\r\n  rounds: [],\r\n  userParty: {\r\n    id: v4(),\r\n    characters: [],\r\n    processed: true,\r\n    items: [],\r\n    skills: [],\r\n    mods: [],\r\n  },\r\n  rawUserParty: { id: v4(), characters: [], items: [], skills: [], mods: [] },\r\n  enemyParty: {\r\n    id: v4(),\r\n    characters: [],\r\n    processed: true,\r\n    items: [],\r\n    skills: [],\r\n    mods: [],\r\n  },\r\n  rawEnemyParty: { id: v4(), characters: [], items: [], skills: [], mods: [] },\r\n  parties: [],\r\n  done: false,\r\n  characterSkills: {},\r\n  characterTargets: {},\r\n  setCharacterSkill: (characterId, skillId) => {},\r\n  setCharacterTarget: (characterId, targetId) => {},\r\n  next: () => {},\r\n  reset: (done: boolean) => {},\r\n}\r\nexport const CombatContext = createContext<CombatContextT>(defaultContextValue)\r\nexport const useCombatContext = () => useContext(CombatContext)\r\n\r\nexport interface CombatContextProviderPropsT {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const CombatContextProvider = (props: CombatContextProviderPropsT) => {\r\n  const { children } = props\r\n  const {\r\n    parties,\r\n    rawParties,\r\n    userParty,\r\n    rawUserParty,\r\n    upsertParty,\r\n    upsertCharacter,\r\n    upsertItem,\r\n  } = usePartyContext()\r\n  const { checkCharacter, rollCharacter } = useRollContext()\r\n  const { addLine, clear } = useCombatLogContext()\r\n  const [rounds, setRounds] = useState<CombatRoundT[]>([])\r\n  const [wins, setWins] = useState<number>(0)\r\n  const [characterSkills, setCharacterSkills] = useState<{\r\n    [characterId: string]: string | undefined\r\n  }>({})\r\n  const [characterTargets, setCharacterTargets] = useState<{\r\n    [characterId: string]: string | undefined\r\n  }>({})\r\n  const setCharacterSkill = (\r\n    characterId: string,\r\n    skillId: string | undefined,\r\n  ) => setCharacterSkills((skills) => ({ ...skills, [characterId]: skillId }))\r\n  const setCharacterTarget = (characterId: string, targetId?: string) =>\r\n    setCharacterTargets((targets) => ({ ...targets, [characterId]: targetId }))\r\n  const [done, setDone] = useState(false)\r\n  const [started, setStarted] = useState(false)\r\n  const rawEnemyParty = rawParties.filter((p) => p.id === ENEMY_PARTY_ID)[0]\r\n  const enemyParty = parties.filter((p) => p.id === ENEMY_PARTY_ID)[0]\r\n  const { open, setCallback } = useModalContext()\r\n  const history = useHistory()\r\n\r\n  const next = () => {\r\n    if (!enemyParty || !userParty) return\r\n    const builder = getCombatRecordBuilder(\r\n      characterSkills,\r\n      characterTargets,\r\n      checkCharacter,\r\n      rollCharacter,\r\n    )\r\n    const round = builder(userParty, enemyParty, rawParties)\r\n    setRounds((r) => [...r, round])\r\n  }\r\n\r\n  const reset = (done: boolean = false) => {\r\n    clear()\r\n    if (!done) {\r\n      setDone(false)\r\n      setRounds([])\r\n      upsertParty(makeParty(ENEMY_PARTY_ID))\r\n      upsertParty({\r\n        ...rawUserParty,\r\n        characters: rawUserParty.characters.map((c) => ({\r\n          ...c,\r\n          traits: [],\r\n          partyId: PC_PARTY_ID,\r\n          //dead: false,\r\n          //healthOffset: 0,\r\n          //focusOffset: 0,\r\n        })),\r\n      })\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    upsertParty(makeParty(ENEMY_PARTY_ID))\r\n    upsertParty({\r\n      ...rawUserParty,\r\n      characters: rawUserParty.characters.map((c) => ({\r\n        ...c,\r\n        partyId: PC_PARTY_ID,\r\n        dead: false,\r\n        healthOffset: 0,\r\n        focusOffset: 0,\r\n        traits: [],\r\n      })),\r\n    })\r\n    setStarted(true)\r\n    return () => {\r\n      reset(true)\r\n    }\r\n  }, [])\r\n\r\n  const finish = (didWin: boolean) => {\r\n    setDone(true)\r\n    if (didWin) {\r\n      open(() => <CombatVictoryModal reset={reset} />, {}, true)\r\n      setCallback((item) => {\r\n        upsertItem(item)\r\n        rawUserParty.characters.forEach((c) => {\r\n          upsertCharacter({\r\n            ...c,\r\n            resources: {\r\n              ...c.resources,\r\n              characterPoints: c.resources.characterPoints + 5,\r\n            },\r\n          })\r\n        })\r\n      })\r\n    } else {\r\n      open(() => <CombatLossModal wins={wins} />, {}, true)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!started) return\r\n    if (checkParty(userParty) && !done) {\r\n      setCallback(() => {\r\n        history.push('/characters')\r\n      })\r\n      finish(false)\r\n    } else {\r\n      if (checkParty(enemyParty) && !done) {\r\n        finish(true)\r\n        setWins((w) => w + 1)\r\n      }\r\n    }\r\n  }, [userParty, enemyParty])\r\n\r\n  useEffect(() => {\r\n    if (rounds.length > 0) {\r\n      const characters = resolveRound(\r\n        rounds,\r\n        rawUserParty,\r\n        rawEnemyParty,\r\n        addLine,\r\n        upsertCharacter,\r\n      )\r\n      checkCharacterActiveSkills(characters, characterSkills, setCharacterSkill)\r\n      checkCharacterActiveTargets(\r\n        characters,\r\n        characterTargets,\r\n        setCharacterTarget,\r\n      )\r\n    }\r\n  }, [rounds])\r\n\r\n  return (\r\n    <CombatContext.Provider\r\n      value={{\r\n        rounds,\r\n        userParty,\r\n        rawUserParty,\r\n        enemyParty,\r\n        rawEnemyParty,\r\n        parties,\r\n        done,\r\n        characterSkills,\r\n        characterTargets,\r\n        setCharacterSkill,\r\n        setCharacterTarget,\r\n        reset,\r\n        next,\r\n      }}\r\n    >\r\n      {children}\r\n    </CombatContext.Provider>\r\n  )\r\n}\r\n","import React, { CSSProperties, useState } from 'react'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { useCombatContext } from '../../contexts/CombatContext'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport Dice6 from '../../icons/svg/delapouite/dice-six-faces-six.svg'\r\nimport { Icon } from '../Icon'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport Roll from '../../assets/img/roll.png'\r\nimport { Hover } from '../Hover'\r\nimport { BASE_CHARACTER } from '../../objects/baseCharacter'\r\n\r\nconst size = 34\r\nexport interface CombatCharacterTargetsPropsT {\r\n  activeTargetId?: string\r\n  showRandom?: boolean\r\n  onClick: (targetId?: string) => void\r\n}\r\nexport const CombatCharacterTargets = (props: CombatCharacterTargetsPropsT) => {\r\n  const { activeTargetId, showRandom = true, onClick } = props\r\n  const { enemyParty } = useCombatContext()\r\n  const cc = useCharacterContext()\r\n  const active = (targetId?: string) => activeTargetId === targetId\r\n  const characters = enemyParty ? enemyParty.characters : []\r\n  return (\r\n    <FlexContainer>\r\n      {showRandom && (\r\n        <BoxButton\r\n          disabled={cc.character.id !== BASE_CHARACTER.id && cc.character.dead}\r\n          onClick={() => !cc.character.dead && onClick(undefined)}\r\n          style={{ border: 'none' }}\r\n          substyle={{\r\n            cursor: cc.character.dead ? 'default' : 'pointer',\r\n            background: cc.character.dead ? '#444' : '#111',\r\n            padding: 0,\r\n            height: size + 2,\r\n            width: size + 2,\r\n            boxSizing: 'border-box',\r\n            borderColor: 'transparent',\r\n            opacity: activeTargetId === undefined ? 1 : 0.5,\r\n            margin: 0,\r\n            ...(active(undefined) ? { borderColor: 'turquoise' } : {}),\r\n          }}\r\n          // style={{ marginRight: 16 }}\r\n        >\r\n          <img\r\n            alt='random'\r\n            src={Roll}\r\n            height={size}\r\n            width={size}\r\n            style={{\r\n              height: size,\r\n              width: size,\r\n              boxSizing: 'border-box',\r\n              border: '1px solid black',\r\n            }}\r\n          />\r\n        </BoxButton>\r\n      )}\r\n      {characters.map((character) => (\r\n        <CombatCharacterTarget\r\n          key={character.id}\r\n          name={character.name}\r\n          onClick={() => onClick(character.id)}\r\n          disabled={\r\n            (cc.character.id !== BASE_CHARACTER.id && cc.character.dead) ||\r\n            character.dead\r\n          }\r\n          style={{\r\n            padding: 0,\r\n            height: size + 2,\r\n            width: size + 2,\r\n            boxSizing: 'border-box',\r\n            margin: 0,\r\n            borderColor: 'transparent',\r\n            opacity:\r\n              (cc.character.id !== BASE_CHARACTER.id && cc.character.dead) ||\r\n              character.dead\r\n                ? 0.5\r\n                : active(character.id)\r\n                ? 1\r\n                : 0.7,\r\n            ...(active(character.id) ? { borderColor: 'turquoise' } : {}),\r\n          }}\r\n        />\r\n      ))}\r\n      <FlexContainer $full />\r\n    </FlexContainer>\r\n  )\r\n}\r\n\r\nexport interface CombatCharacterTargetPropsT {\r\n  name: string\r\n  disabled: boolean\r\n  style: CSSProperties\r\n  onClick: () => void\r\n}\r\nexport const CombatCharacterTarget = (props: CombatCharacterTargetPropsT) => {\r\n  const { name, disabled, style, onClick } = props\r\n  return (\r\n    <Hover>\r\n      {({ isHovering }) => (\r\n        <Tooltip\r\n          isOpen={isHovering}\r\n          direction='up'\r\n          tagName='div'\r\n          padding='0'\r\n          arrow={false}\r\n          content={<BoxContainer>{name}</BoxContainer>}\r\n        >\r\n          <BoxContainer\r\n            onClick={() => !disabled && onClick()}\r\n            disabled={disabled}\r\n            substyle={{\r\n              borderColor: isHovering ? '#999' : '#555',\r\n              padding: '4px',\r\n              cursor: disabled ? 'default' : 'pointer',\r\n              background: disabled ? '#444' : '#111',\r\n              ...style,\r\n            }}\r\n            style={{ border: 'none' }}\r\n          >\r\n            <img\r\n              alt='profile'\r\n              src={`https://picsum.photos/seed/${name}/60/60`}\r\n              style={{\r\n                height: size,\r\n                width: size,\r\n                boxSizing: 'border-box',\r\n                border: '1px solid black',\r\n              }}\r\n            />\r\n          </BoxContainer>\r\n        </Tooltip>\r\n      )}\r\n    </Hover>\r\n  )\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport Inspect from '../../icons/svg/lorc/magnifying-glass.svg'\r\nimport WeaponHands from '../../icons/svg/delapouite/sword-brandish.svg'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { BoxContainer, SmallBox, BoxButton } from '../../elements/box'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { Gauge } from '../Gauge'\r\nimport { CharacterInspect } from '../CharacterInspect'\r\nimport { Icon } from '../Icon'\r\nimport { ProcessedCharacterT } from '../../types/Character'\r\nimport { WeaponPreview } from '../WeaponPreview'\r\nimport Tombstone from '../../icons/svg/lorc/tombstone.svg'\r\nimport Pencil from '../../icons/svg/delapouite/pencil.svg'\r\nimport Save from '../../icons/svg/delapouite/save.svg'\r\nimport Delete from '../../icons/svg/delapouite/trash-can.svg'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { noneg } from '../../util/noneg'\r\nimport { CombatCharacterSkills } from '../CombatCharacterSkills'\r\nimport { CombatCharacterTargets } from '../CombatCharacterTargets'\r\nimport { useCombatContext } from '../../contexts/CombatContext'\r\nimport { HoverToolTip } from '../Tooltip'\r\nimport { Monospace } from '../../elements/monospace'\r\n\r\nexport interface CharacterDetailsPropsT {\r\n  character?: ProcessedCharacterT\r\n  showInspect?: boolean\r\n  showWeaponInspect?: boolean\r\n  showEdit?: boolean\r\n  showSkills?: boolean\r\n  width?: number\r\n}\r\nexport const CharacterDetails = (props: CharacterDetailsPropsT) => {\r\n  const {\r\n    showEdit = false,\r\n    showInspect = false,\r\n    showWeaponInspect = false,\r\n    showSkills = false,\r\n    width,\r\n  } = props\r\n  const characterContext = useCharacterContext()\r\n  const { deleteCharacter } = usePartyContext()\r\n  const {\r\n    characterSkills,\r\n    setCharacterSkill,\r\n    characterTargets,\r\n    setCharacterTarget,\r\n  } = useCombatContext()\r\n  const { rawCharacter, onChange } = characterContext\r\n  const character = props.character || characterContext.character\r\n  const [isEditing, setIsEditing] = useState(false)\r\n  const [name, setName] = useState<string>(character.name)\r\n  const health = noneg(character.stats.health - character.healthOffset)\r\n  const focus = noneg(character.stats.focus - character.focusOffset)\r\n  useEffect(() => {\r\n    setName(character.name)\r\n  }, [character.name])\r\n  return (\r\n    <BoxContainer\r\n      style={{\r\n        minWidth: width || 350,\r\n        transition: 'all 1s',\r\n        border: '2px solid black',\r\n      }}\r\n      substyle={{\r\n        padding: 0,\r\n      }}\r\n    >\r\n      <FlexContainer $direction='column'>\r\n        <FlexContainer\r\n          style={{\r\n            padding: 4,\r\n            background:\r\n              'linear-gradient(0deg, rgba(34,34,34,1) 0%, rgba(51,51,51,1) 100%)',\r\n          }}\r\n        >\r\n          <FlexContainer $full>\r\n            <BoxContainer\r\n              style={{\r\n                marginRight: 10,\r\n                height: 64,\r\n                width: 64,\r\n              }}\r\n              substyle={{\r\n                padding: 0,\r\n                backgroundColor: '#111',\r\n                border: 'none',\r\n              }}\r\n            >\r\n              {character.dead ? (\r\n                <FlexContainer\r\n                  style={{\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    height: 60,\r\n                  }}\r\n                >\r\n                  <Icon src={Tombstone} size={48} />\r\n                </FlexContainer>\r\n              ) : (\r\n                <img\r\n                  alt='profile'\r\n                  src={`https://picsum.photos/seed/${character.name}/60/60`}\r\n                  style={{\r\n                    height: 60,\r\n                    width: 60,\r\n                    border: '1px solid rgba(255,255,255,0.5)',\r\n                  }}\r\n                />\r\n              )}\r\n            </BoxContainer>\r\n\r\n            {isEditing ? (\r\n              <div>\r\n                <input value={name} onChange={(e) => setName(e.target.value)} />\r\n              </div>\r\n            ) : (\r\n              <FlexContainer $direction='column'>\r\n                <h2\r\n                  style={{\r\n                    margin: 0,\r\n                    textShadow: '1px 1px 1px black',\r\n                    fontSize: 18,\r\n                  }}\r\n                >\r\n                  {character.name}\r\n                </h2>\r\n                <FullContainer />\r\n                <Monospace\r\n                  style={{\r\n                    fontSize: 10,\r\n                    color: 'rgba(255,255,255,0.24)',\r\n                  }}\r\n                >\r\n                  {character.abilities.strength} {character.abilities.dexterity}{' '}\r\n                  {character.abilities.intelligence} {character.abilities.vigor}\r\n                </Monospace>\r\n                <Monospace\r\n                  style={{\r\n                    fontSize: 10,\r\n                    color: 'rgba(255,255,255,0.24)',\r\n                  }}\r\n                >\r\n                  {character.stats.will} {character.stats.perception}{' '}\r\n                  {character.stats.agility} {character.stats.accuracy}{' '}\r\n                  {character.stats.evade}\r\n                </Monospace>\r\n              </FlexContainer>\r\n            )}\r\n          </FlexContainer>\r\n          {showWeaponInspect && (\r\n            <HoverToolTip\r\n              direction='right'\r\n              content={\r\n                <WeaponPreview\r\n                  showRequirement={false}\r\n                  showEquipButton={false}\r\n                  weapon={character.weapon}\r\n                />\r\n              }\r\n            >\r\n              <SmallBox>\r\n                <Icon src={WeaponHands} size={18} />\r\n              </SmallBox>\r\n            </HoverToolTip>\r\n          )}\r\n          {showInspect && (\r\n            <HoverToolTip direction='right' content={<CharacterInspect />}>\r\n              <SmallBox>\r\n                <Icon src={Inspect} size={18} />\r\n              </SmallBox>\r\n            </HoverToolTip>\r\n          )}\r\n          {showEdit && !isEditing && (\r\n            <BoxButton\r\n              style={{ height: 42, width: 42, margin: 0 }}\r\n              substyle={{\r\n                padding: 0,\r\n                display: 'flex',\r\n                justifyContent: 'center',\r\n                alignItems: 'center',\r\n              }}\r\n              onClick={() => setIsEditing((e) => !e)}\r\n            >\r\n              <Icon src={Pencil} size={18} />\r\n            </BoxButton>\r\n          )}\r\n          {isEditing && (\r\n            <>\r\n              <BoxButton\r\n                style={{ height: 42, width: 42, margin: 0 }}\r\n                substyle={{\r\n                  padding: 0,\r\n                  display: 'flex',\r\n                  justifyContent: 'center',\r\n                  alignItems: 'center',\r\n                }}\r\n                onClick={() => {\r\n                  onChange({ ...rawCharacter, name })\r\n                  setIsEditing((e) => !e)\r\n                }}\r\n              >\r\n                <Icon src={Save} size={18} />\r\n              </BoxButton>\r\n              <BoxButton\r\n                style={{ height: 42, width: 42, margin: 0 }}\r\n                substyle={{\r\n                  padding: 0,\r\n                  display: 'flex',\r\n                  justifyContent: 'center',\r\n                  alignItems: 'center',\r\n                }}\r\n                onClick={() => {\r\n                  deleteCharacter(character.id)\r\n                }}\r\n              >\r\n                <Icon src={Delete} size={18} />\r\n              </BoxButton>\r\n            </>\r\n          )}\r\n        </FlexContainer>\r\n        {showSkills && (\r\n          <FlexContainer\r\n            $direction='column'\r\n            style={{\r\n              backgroundColor: '#1a1a1a',\r\n              boxShadow: 'inset 0px 0px 15px black',\r\n              width: 'calc(100% - 16px)',\r\n              padding: '4px 8px',\r\n              borderTop: '1px solid #555',\r\n            }}\r\n          >\r\n            <Monospace\r\n              style={{\r\n                color: 'rgba(255,255,255,0.24)',\r\n                marginBottom: 2,\r\n                fontSize: 12,\r\n                fontWeight: 'normal',\r\n              }}\r\n            >\r\n              SKILLS\r\n            </Monospace>\r\n            <CombatCharacterSkills\r\n              activeSkillId={characterSkills[character.id]}\r\n              skills={character.skills}\r\n              onClick={(skillId) => setCharacterSkill(character.id, skillId)}\r\n            />\r\n            <Monospace\r\n              style={{\r\n                color: 'rgba(255,255,255,0.24)',\r\n                marginBottom: 2,\r\n                marginTop: 4,\r\n                fontSize: 12,\r\n                fontWeight: 'normal',\r\n              }}\r\n            >\r\n              TARGETS\r\n            </Monospace>\r\n            <CombatCharacterTargets\r\n              activeTargetId={characterTargets[character.id]}\r\n              onClick={(targetId) => setCharacterTarget(character.id, targetId)}\r\n            />\r\n          </FlexContainer>\r\n        )}\r\n        <Gauge\r\n          name='Health'\r\n          color='#8f4e4d'\r\n          max={character.stats.health}\r\n          value={health}\r\n          height={15}\r\n        >\r\n          {health}/{character.stats.health}\r\n        </Gauge>\r\n        <Gauge\r\n          name='Focus'\r\n          color='#517e4e'\r\n          max={character.stats.focus}\r\n          value={focus}\r\n          height={15}\r\n        >\r\n          {focus}/{character.stats.focus}\r\n        </Gauge>\r\n      </FlexContainer>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { useContext, useState } from 'react'\r\n\r\nexport interface UIContextT {\r\n  logKey: string | undefined\r\n  sidebarKey: string | undefined\r\n\r\n  setLogKey: (key?: string) => void\r\n  setSidebarKey: (key?: string) => void\r\n}\r\nconst defaultValue: UIContextT = {\r\n  logKey: undefined,\r\n  sidebarKey: undefined,\r\n  setLogKey: () => {},\r\n  setSidebarKey: () => {},\r\n}\r\nexport const UIContext = React.createContext<UIContextT>(defaultValue)\r\nexport const useUIContext = () => useContext(UIContext)\r\n\r\nexport interface UIContextProviderPropsT {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport const UIContextProvider = (props: UIContextProviderPropsT) => {\r\n  const { children } = props\r\n  const [logKey, setLogKey] = useState<string | undefined>()\r\n  const [sidebarKey, setSidebarKey] = useState<string | undefined>()\r\n\r\n  return (\r\n    <UIContext.Provider\r\n      value={{\r\n        logKey,\r\n        sidebarKey,\r\n        setLogKey,\r\n        setSidebarKey,\r\n      }}\r\n    >\r\n      {children}\r\n    </UIContext.Provider>\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { SkillT } from '../../types/Skill'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { SkillPreview } from '../SkillPreview'\r\nimport { Hover } from '../Hover'\r\n\r\nconst size = 60\r\nexport interface SkillPreviewAltPropsT {\r\n  skill: SkillT\r\n}\r\nexport const SkillPreviewAlt = (props: SkillPreviewAltPropsT) => {\r\n  const { skill } = props\r\n\r\n  return (\r\n    <BoxContainer\r\n      style={{\r\n        height: size + 4,\r\n        width: size + 4,\r\n      }}\r\n      substyle={{ padding: 0 }}\r\n    >\r\n      <Hover>\r\n        {({ isHovering }) => (\r\n          <Tooltip\r\n            isOpen={isHovering}\r\n            direction='down'\r\n            tagName='div'\r\n            padding='0'\r\n            arrow={false}\r\n            content={<SkillPreview skillId={skill.id} skill={skill} />}\r\n          >\r\n            <img src={skill.imgSrc} height={size} width={size} />\r\n          </Tooltip>\r\n        )}\r\n      </Hover>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { CSSProperties } from 'react'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { Link, useLocation } from 'react-router-dom'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { sortById } from '../../util/sortById'\r\nimport { Monospace } from '../../elements/monospace'\r\n\r\nconst activeStyles: CSSProperties = {\r\n  background: '#111',\r\n  boxShadow: 'inset 0 0 3px black',\r\n}\r\nconst inactiveStyles: CSSProperties = {\r\n  background: '#555',\r\n}\r\n\r\nexport const CharacterHeader = () => {\r\n  const { character } = useCharacterContext()\r\n  const { userParty } = usePartyContext()\r\n  const check = (id: string): CSSProperties =>\r\n    character.id === id ? activeStyles : inactiveStyles\r\n  return (\r\n    <BoxContainer\r\n      style={{ borderLeft: 'none', borderRight: 'none' }}\r\n      substyle={{\r\n        height: 61,\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        padding: '0px 8px',\r\n        borderColor: 'rgba(255,255,255,0.4)',\r\n        borderTop: 'none',\r\n        borderLeft: 'none',\r\n        borderRight: 'none',\r\n        background: 'rgba(255,255,255,0.4)',\r\n      }}\r\n    >\r\n      {sortById(userParty.characters).map((c) => (\r\n        <BoxContainer\r\n          tag={Link}\r\n          to={`/characters/${c.id}`}\r\n          style={{ marginRight: 4 }}\r\n          substyle={{\r\n            padding: '10px',\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            alignItems: 'center',\r\n            textShadow: '1px 1px 2px black',\r\n            ...check(c.id),\r\n          }}\r\n        >\r\n          <Monospace>{c.name}</Monospace>\r\n        </BoxContainer>\r\n      ))}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","export interface HasIdT {\r\n  id: string\r\n}\r\nexport const sortById = <T extends HasIdT>(list: T[]): T[] => {\r\n  return list.sort((a, b) => a.id.localeCompare(b.id))\r\n}\r\n","import React, { useMemo, useEffect } from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { ResourceScore } from '../../components/ResourceScore'\r\nimport { AbilityScore } from '../../components/AbilityScore'\r\nimport { StatScore } from '../../components/StatScore'\r\nimport { DamageResistanceScore } from '../../components/DamageResistanceScore'\r\nimport { ArmorScoreList } from '../../components/ArmorScoreList'\r\nimport { ItemPreview } from '../../components/ItemPreview'\r\nimport { WeaponPreview } from '../../components/WeaponPreview'\r\nimport { CharacterDetails } from '../../components/CharacterDetails'\r\nimport { CharacterStateContextProvider } from '../../contexts/CharacterContext'\r\nimport { RollStateContextProvider } from '../../contexts/RollContext'\r\nimport { useParams, useHistory } from 'react-router'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { useUIContext } from '../../contexts/UIContext'\r\nimport { SkillPreviewAlt } from '../../components/SkillPreviewAlt'\r\nimport { BASIC_ATTACK, INSPECT } from '../../objects/makeSkill'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { CharacterHeader } from '../../components/CharacterHeader'\r\nimport BG from '../../assets/img/forest-931706_1920.jpg'\r\nimport { Monospace } from '../../elements/monospace'\r\n\r\nexport const Character = () => {\r\n  const { id } = useParams()\r\n  const history = useHistory()\r\n  const { rawUserParty, setActiveCharacterId } = usePartyContext()\r\n  const { setLogKey, setSidebarKey } = useUIContext()\r\n  const character = useMemo(() => {\r\n    return rawUserParty.characters.find((c) => c.id === id)\r\n  }, [id, rawUserParty])\r\n  useEffect(() => {\r\n    if (!character) {\r\n      history.push(`/characters/${rawUserParty.characters[0].id}`)\r\n    } else {\r\n      setActiveCharacterId(character.id)\r\n    }\r\n  }, [id])\r\n\r\n  useEffect(() => {\r\n    setLogKey('items')\r\n    return () => {\r\n      setLogKey(undefined)\r\n      setActiveCharacterId(null)\r\n    }\r\n  }, [])\r\n\r\n  if (!character) return null\r\n  return (\r\n    <CharacterStateContextProvider>\r\n      <RollStateContextProvider>\r\n        <FlexContainer\r\n          $direction='column'\r\n          $full\r\n          style={{\r\n            background: `url(${BG}) center center`,\r\n            backgroundSize: 'cover',\r\n          }}\r\n        >\r\n          <CharacterHeader />\r\n          <FlexContainer style={{ margin: 10, flex: 1 }}>\r\n            <FlexContainer $direction='column' style={{ marginRight: 10 }}>\r\n              <CharacterDetails showEdit={true} />\r\n              <FlexContainer>\r\n                <ResourceScore id='characterPoints' />\r\n                <ResourceScore id='weaponHands' />\r\n                <ResourceScore id='fingers' />\r\n                <ResourceScore id='heads' />\r\n                <ResourceScore id='bodies' />\r\n                <ResourceScore id='hands' />\r\n                <ResourceScore id='feet' />\r\n              </FlexContainer>\r\n              <FlexContainer>\r\n                <FlexContainer $direction='column'>\r\n                  <AbilityScore id='strength' />\r\n                  <AbilityScore id='dexterity' />\r\n                  <AbilityScore id='intelligence' />\r\n                  <AbilityScore id='vigor' />\r\n                </FlexContainer>\r\n                <FlexContainer $direction='column'>\r\n                  <StatScore id='health' />\r\n                  <StatScore id='focus' />\r\n                  <StatScore id='will' />\r\n                  <StatScore id='perception' />\r\n                  <StatScore id='agility' />\r\n                  <StatScore id='accuracy' />\r\n                  <StatScore id='evade' />\r\n                </FlexContainer>\r\n                <FlexContainer $direction='column'>\r\n                  <DamageResistanceScore id='slashing' />\r\n                  <DamageResistanceScore id='piercing' />\r\n                  <DamageResistanceScore id='fire' />\r\n                  <DamageResistanceScore id='blood' />\r\n                  <DamageResistanceScore id='light' />\r\n                  <DamageResistanceScore id='dark' />\r\n                </FlexContainer>\r\n              </FlexContainer>\r\n              <BoxContainer\r\n                substyle={{\r\n                  width: 320,\r\n                  padding: '4px 8px',\r\n                  boxShadow: 'inset 0px 0px 10px black',\r\n                }}\r\n              >\r\n                <Monospace\r\n                  style={{\r\n                    fontWeight: 'bold',\r\n                    color: 'rgba(255,255,255,0.24)',\r\n                    background: '#222',\r\n                    marginBottom: 2,\r\n                    fontSize: 14,\r\n                  }}\r\n                >\r\n                  SKILLS\r\n                </Monospace>\r\n                <FlexContainer style={{ flexWrap: 'wrap' }}>\r\n                  {character.skills\r\n                    .filter(\r\n                      (s) => s.id !== BASIC_ATTACK.id && s.id !== INSPECT.id,\r\n                    )\r\n                    .map((skill) => (\r\n                      <div style={{ padding: 2.5 }}>\r\n                        <SkillPreviewAlt key={skill.id} skill={skill} />\r\n                      </div>\r\n                    ))}\r\n                </FlexContainer>\r\n              </BoxContainer>\r\n            </FlexContainer>\r\n            <FlexContainer>\r\n              <div style={{ marginRight: 10 }}>\r\n                <WeaponPreview showEquipButton={true} showRequirement={false} />\r\n                {character.equippedItems.map((item) => (\r\n                  <ItemPreview\r\n                    key={item.id}\r\n                    item={item}\r\n                    showRequirementCheck={false}\r\n                    showCollapseButton={false}\r\n                  />\r\n                ))}\r\n              </div>\r\n              <ArmorScoreList />\r\n            </FlexContainer>\r\n          </FlexContainer>\r\n        </FlexContainer>\r\n      </RollStateContextProvider>\r\n    </CharacterStateContextProvider>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { Roll2ResultT, Check2ResultT } from '../../types/Roll2'\r\nimport { Span } from '../../contexts/CombatContext/log'\r\n\r\nexport const RollResult = (props: any) => {\r\n  const roll: Roll2ResultT | Check2ResultT = props.roll\r\n  const check = roll as Check2ResultT\r\n  const isCheck = check.goal !== undefined\r\n  const result = isCheck ? check.result : undefined\r\n  return (\r\n    <div style={{ fontFamily: 'monospace' }}>\r\n      {isCheck && result && Span('lightgreen', '[PASSED] ')}\r\n      {isCheck && !result && Span('lightcoral', '[FAILED] ')}\r\n      {!isCheck && Span('turquoise', '[STATIC] ')}\r\n      {isCheck && <span>({check.goal}) </span>}\r\n      <span>{roll.output}</span>\r\n    </div>\r\n  )\r\n}\r\n","import React, { useContext } from 'react'\r\nimport { useRollContext } from '../RollContext'\r\nimport { getCompareFn, CompareResultFn, ZERO_COMPARE } from '../../util/compare'\r\nimport { CharacterRollT, CharacterCheckT } from '../../types/Roll2'\r\n\r\nexport type CompareKeyT = 'a' | 'b'\r\nexport interface CompareContextT<T> extends Record<CompareKeyT, T> {\r\n  compareChecks: (\r\n    checkA: CharacterCheckT,\r\n    checkB: CharacterCheckT,\r\n  ) => CompareResultFn\r\n  compareRolls: (\r\n    rollA: CharacterRollT,\r\n    rollB: CharacterRollT,\r\n  ) => CompareResultFn\r\n  compareValues: (valueA: number, valueB: number) => CompareResultFn\r\n}\r\nexport const CompareContext = React.createContext<CompareContextT<any>>({\r\n  a: null,\r\n  b: null,\r\n  compareChecks: (checkA: CharacterCheckT, checkB: CharacterCheckT) =>\r\n    ZERO_COMPARE,\r\n  compareRolls: (rollA: CharacterRollT, rollB: CharacterRollT) => ZERO_COMPARE,\r\n  compareValues: (valueA: number, valueB: number) => ZERO_COMPARE,\r\n})\r\n\r\nexport function useCompareContext<T>(): CompareContextT<T> {\r\n  return useContext(CompareContext)\r\n}\r\n\r\nexport interface CompareContextProviderProps<T> extends Record<CompareKeyT, T> {\r\n  children: React.ReactNode | React.ReactNode[]\r\n}\r\nexport function CompareContextProvider<T>(\r\n  props: CompareContextProviderProps<T>,\r\n) {\r\n  const { a, b, children } = props\r\n  const { execRoll, getProbability } = useRollContext()\r\n  const compareChecks = (checkA: CharacterCheckT, checkB: CharacterCheckT) => {\r\n    const a = getProbability(checkA)\r\n    const b = getProbability(checkB)\r\n    return getCompareFn(a, b)\r\n  }\r\n  const compareRolls = (rollA: CharacterRollT, rollB: CharacterRollT) => {\r\n    const a = execRoll(rollA, false).averageTotal as number\r\n    const b = execRoll(rollB, false).averageTotal as number\r\n    return getCompareFn(a, b < 0 ? 0 : b)\r\n  }\r\n  const compareValues = (valueA: number, valueB: number) =>\r\n    getCompareFn(valueA, valueB)\r\n  return (\r\n    <CompareContext.Provider\r\n      value={{ a, b, compareChecks, compareRolls, compareValues }}\r\n    >\r\n      {children}\r\n    </CompareContext.Provider>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { ONE_COMPARE } from '../../util/compare'\r\nimport { DamageTypeKeyT } from '../../types/Damage'\r\nimport {\r\n  CharacterSkillCheckKeyT,\r\n  combineTraits,\r\n  getTraitValue,\r\n} from '../../types/Character'\r\nimport {\r\n  CompareContextProvider,\r\n  useCompareContext,\r\n} from '../../contexts/CompareContext'\r\nimport { WeaponPreview } from '../WeaponPreview'\r\nimport { FISTS } from '../../objects/fists'\r\nimport { CharacterRollT } from '../../types/Roll2'\r\n\r\nexport interface EquipedWeaponComparePropsT {\r\n  weapon: WeaponT\r\n}\r\nexport const EquipedWeaponCompare = (props: EquipedWeaponComparePropsT) => {\r\n  const { weapon } = props\r\n  const { character } = useCharacterContext()\r\n  return (\r\n    <CompareContextProvider<WeaponT> a={weapon} b={character.weapon}>\r\n      <WeaponCompareItem />\r\n    </CompareContextProvider>\r\n  )\r\n}\r\n\r\nexport interface WeaponCompareItemPropsT {}\r\nexport const WeaponCompareItem = (props: WeaponCompareItemPropsT) => {\r\n  const context = useCompareContext<WeaponT>()\r\n  const { compareChecks, compareRolls, compareValues } = context\r\n  const a: WeaponT = context['a'] || FISTS\r\n  const b: WeaponT = context['b'] || FISTS\r\n\r\n  const requirementCompare = compareChecks(\r\n    a.requirementCheck,\r\n    b.requirementCheck,\r\n  )\r\n  const accuracyCompare = compareChecks(a.accuracyCheck, b.accuracyCheck)\r\n  const damageCompare = (key: DamageTypeKeyT) => {\r\n    const weaponRoll = a.damageRolls[key] as CharacterRollT\r\n    const testRoll = b.damageRolls[key] as CharacterRollT\r\n    if (!testRoll) return ONE_COMPARE\r\n    return compareRolls(weaponRoll, testRoll)\r\n  }\r\n  const traitCompare = (key: CharacterSkillCheckKeyT) => {\r\n    const weaponValue = getTraitValue(combineTraits(a.traits), key)\r\n    const testValue = getTraitValue(combineTraits(b.traits), key)\r\n    return compareValues(weaponValue, testValue)\r\n  }\r\n  const costComapre = compareValues(b.cost, a.cost)\r\n\r\n  return (\r\n    <WeaponPreview\r\n      weapon={a}\r\n      showEquipButton={false}\r\n      requirementCompare={requirementCompare}\r\n      accuracyCompare={accuracyCompare}\r\n      damageCompare={damageCompare}\r\n      traitCompare={traitCompare}\r\n      costComare={costComapre}\r\n    />\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport { ONE_COMPARE } from '../../util/compare'\r\nimport { DamageTypeKeyT } from '../../types/Damage'\r\nimport {\r\n  CharacterSkillCheckKeyT,\r\n  combineTraits,\r\n  getTraitValue,\r\n} from '../../types/Character'\r\nimport {\r\n  CompareContextProvider,\r\n  useCompareContext,\r\n} from '../../contexts/CompareContext'\r\nimport { EquippableT } from '../../types/Item'\r\nimport { BASE_EQUIPPABLE } from '../../objects/util'\r\nimport { ItemPreview } from '../ItemPreview'\r\nimport { ArmorT } from '../../types/Armor'\r\nimport { CharacterRollT } from '../../types/Roll2'\r\n\r\nexport interface EquipedItemComparePropsT {\r\n  item: EquippableT\r\n}\r\nexport const EquipeItemCompare = (props: EquipedItemComparePropsT) => {\r\n  const { item } = props\r\n  const { character } = useCharacterContext()\r\n  if ((item as ArmorT).armorType === 'ring')\r\n    return (\r\n      <ItemPreview\r\n        item={item}\r\n        showEquipButton={false}\r\n        showRequirementCheck={true}\r\n        showCollapseButton={false}\r\n      />\r\n    )\r\n  const testItem = [...character.armor, ...character.equippedItems].find(\r\n    (i) => {\r\n      if (item.type === 'armor') {\r\n        return i.type === 'armor' && i.resource === item.resource\r\n      } else {\r\n        return i.type !== 'armor' && i.resource === item.resource\r\n      }\r\n    },\r\n  )\r\n  return (\r\n    <CompareContextProvider<EquippableT>\r\n      a={item}\r\n      b={testItem || BASE_EQUIPPABLE('armor')}\r\n    >\r\n      <ItemCompareItem />\r\n    </CompareContextProvider>\r\n  )\r\n}\r\n\r\nexport interface ItemCompareItemPropsT {}\r\nexport const ItemCompareItem = (props: ItemCompareItemPropsT) => {\r\n  const context = useCompareContext<EquippableT>()\r\n  const { compareChecks, compareRolls, compareValues } = context\r\n  const a: EquippableT = context['a'] || BASE_EQUIPPABLE('armor')\r\n  const b: EquippableT = context['b'] || BASE_EQUIPPABLE('armor')\r\n\r\n  const requirementCompare = compareChecks(\r\n    a.requirementCheck,\r\n    b.requirementCheck,\r\n  )\r\n  const resistancesCompare = (key: DamageTypeKeyT) => {\r\n    const itemRoll = a.damageResistances[key] as CharacterRollT\r\n    const testRoll = b.damageResistances[key] as CharacterRollT\r\n    if (!testRoll) return ONE_COMPARE\r\n    return compareRolls(itemRoll, testRoll)\r\n  }\r\n  const traitCompare = (key: CharacterSkillCheckKeyT) => {\r\n    const itemValue = getTraitValue(combineTraits(a.traits), key)\r\n    const testValue = getTraitValue(combineTraits(b.traits), key)\r\n    return compareValues(itemValue, testValue)\r\n  }\r\n  const costComapre = compareValues(b.cost, a.cost)\r\n\r\n  return (\r\n    <ItemPreview\r\n      item={a}\r\n      showEquipButton={false}\r\n      requirementCompare={requirementCompare}\r\n      resistancesCompare={resistancesCompare}\r\n      traitCompare={traitCompare}\r\n      costComare={costComapre}\r\n    />\r\n  )\r\n}\r\n","import React from 'react'\r\nimport Color from 'color'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { ItemRarityT, ItemRarityColorMap, ItemTypeT } from '../../types/Item'\r\nimport { FlexContainer } from '../../elements/flex'\r\n\r\nexport interface CharacterItemFilters {\r\n  onClick: (rarity?: ItemRarityT, type?: ItemTypeT) => void\r\n}\r\nexport const CharacterItemFilters = (props: CharacterItemFilters) => {\r\n  const { onClick } = props\r\n  return (\r\n    <FlexContainer>\r\n      <CharacterItemFilterButton rarity='common' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='uncommon' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='rare' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='legendary' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='unique' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='mythic' onClick={onClick} />\r\n      <CharacterItemFilterButton rarity='set' onClick={onClick} />\r\n      <CharacterItemFilterButton type='weapon' onClick={onClick}>\r\n        W\r\n      </CharacterItemFilterButton>\r\n      <CharacterItemFilterButton type='armor' onClick={onClick}>\r\n        A\r\n      </CharacterItemFilterButton>\r\n      <CharacterItemFilterButton onClick={onClick}>R</CharacterItemFilterButton>\r\n    </FlexContainer>\r\n  )\r\n}\r\n\r\nexport interface CharacterItemFilterButtonPropsT {\r\n  rarity?: ItemRarityT\r\n  type?: ItemTypeT\r\n  children?: React.ReactNode | React.ReactNode[]\r\n  onClick: (rarity?: ItemRarityT, type?: ItemTypeT) => void\r\n}\r\nexport const CharacterItemFilterButton = (\r\n  props: CharacterItemFilterButtonPropsT,\r\n) => {\r\n  const { rarity, type, children, onClick } = props\r\n  const backgroundColor = rarity\r\n    ? Color(ItemRarityColorMap[rarity]).fade(0.75).hsl().toString()\r\n    : '#222'\r\n  const borderColor = rarity\r\n    ? Color(ItemRarityColorMap[rarity]).fade(0.5).hsl().toString()\r\n    : '#555'\r\n  return (\r\n    <BoxContainer\r\n      tag='button'\r\n      style={{ width: 40, height: 40 }}\r\n      substyle={{\r\n        background: backgroundColor,\r\n        cursor: 'pointer',\r\n        borderColor: borderColor,\r\n        boxShadow: 'inset 0 0 3px black',\r\n        display: 'flex',\r\n        padding: 0,\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        margin: 0,\r\n      }}\r\n      onClick={() => onClick(rarity, type)}\r\n    >\r\n      {children}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { useMemo, useState } from 'react'\r\nimport Color from 'color'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\nimport {\r\n  ItemT,\r\n  EquippableT,\r\n  ItemRarityColorMap,\r\n  ItemTypeT,\r\n  ItemRarityT,\r\n} from '../../types/Item'\r\nimport { CharacterT, canEquip } from '../../types/Character'\r\nimport { WeaponIcon } from '../WeaponIcon'\r\nimport { WeaponT } from '../../types/Weapon'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport Tooltip from 'react-tooltip-lite'\r\nimport { ArmorIcon } from '../ArmorIcon'\r\nimport { ArmorT } from '../../types/Armor'\r\nimport { EquipedWeaponCompare } from '../WeaponCompare'\r\nimport { ItemIcon } from '../ItemIcon'\r\nimport { EquipeItemCompare } from '../ItemCompare'\r\nimport { CharacterItemFilters } from '../CharacterItemFilters'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\n\r\nexport const CharacterItems = () => {\r\n  const { rawCharacter } = useCharacterContext()\r\n  const { userParty, equipItem } = usePartyContext()\r\n  const [itemType, setItemType] = useState<ItemTypeT | undefined>()\r\n  const [itemRarity, setItemRarity] = useState<ItemRarityT | undefined>()\r\n\r\n  const filter = (i: EquippableT) => {\r\n    if (itemType) return i.type === itemType\r\n    if (itemRarity) return i.rarity === itemRarity\r\n    return true\r\n  }\r\n\r\n  const other = userParty.items\r\n    .filter((i) => i.type !== 'armor' && i.type !== 'weapon')\r\n    .filter(filter)\r\n  const weapons = userParty.items\r\n    .filter((i) => i.type === 'weapon')\r\n    .filter(filter)\r\n  const armors = userParty.items\r\n    .filter((i) => i.type === 'armor')\r\n    .filter(filter)\r\n  return (\r\n    <FlexContainer style={{}} $direction='column'>\r\n      <CharacterItemFilters\r\n        onClick={(r, t) => {\r\n          if (r) setItemRarity(r)\r\n          if (t) setItemType(t)\r\n          if (!r && !t) {\r\n            setItemRarity(undefined)\r\n            setItemType(undefined)\r\n          }\r\n        }}\r\n      />\r\n      <div style={{ marginTop: 10 }}>\r\n        {weapons.length > 0 && (\r\n          <span\r\n            style={{\r\n              fontFamily: 'monospace',\r\n              fontWeight: 'bold',\r\n              color: 'rgba(255,255,255,0.24)',\r\n              marginBottom: 2,\r\n            }}\r\n          >\r\n            WEAPONS\r\n          </span>\r\n        )}\r\n        <FlexContainer\r\n          style={{\r\n            flexWrap: 'wrap',\r\n            width: 400,\r\n          }}\r\n        >\r\n          {weapons.map((item) => (\r\n            <Item\r\n              key={item.id}\r\n              item={item}\r\n              rawCharacter={rawCharacter}\r\n              onEquip={(id) => equipItem(rawCharacter.id, id)}\r\n            />\r\n          ))}\r\n        </FlexContainer>\r\n        {armors.length > 0 && (\r\n          <span\r\n            style={{\r\n              fontFamily: 'monospace',\r\n              fontWeight: 'bold',\r\n              color: 'rgba(255,255,255,0.24)',\r\n              marginBottom: 2,\r\n            }}\r\n          >\r\n            ARMOR\r\n          </span>\r\n        )}\r\n        <FlexContainer\r\n          style={{\r\n            flexWrap: 'wrap',\r\n            width: 400,\r\n          }}\r\n        >\r\n          {armors.map((item) => (\r\n            <Item\r\n              key={item.id}\r\n              item={item}\r\n              rawCharacter={rawCharacter}\r\n              onEquip={(id) => equipItem(rawCharacter.id, id)}\r\n            />\r\n          ))}\r\n        </FlexContainer>\r\n        {other.length > 0 && (\r\n          <span\r\n            style={{\r\n              fontFamily: 'monospace',\r\n              fontWeight: 'bold',\r\n              color: 'rgba(255,255,255,0.24)',\r\n              marginBottom: 2,\r\n            }}\r\n          >\r\n            OTHER\r\n          </span>\r\n        )}\r\n        <FlexContainer\r\n          style={{\r\n            flexWrap: 'wrap',\r\n            width: 400,\r\n          }}\r\n        >\r\n          {other.map((item) => (\r\n            <Item\r\n              key={item.id}\r\n              item={item}\r\n              rawCharacter={rawCharacter}\r\n              onEquip={(id) => equipItem(rawCharacter.id, id)}\r\n            />\r\n          ))}\r\n        </FlexContainer>\r\n      </div>\r\n    </FlexContainer>\r\n  )\r\n}\r\n\r\nexport interface ItemPropsT {\r\n  item: ItemT\r\n  rawCharacter: CharacterT\r\n  onEquip: (itemId: string) => void\r\n}\r\nconst Item = (props: ItemPropsT) => {\r\n  const { item, rawCharacter, onEquip } = props\r\n  const [isHovering, setIsHovering] = useState(false)\r\n  const type = (item as EquippableT).type\r\n  const isEquipable = (item as EquippableT).equippable\r\n  const isArmor = type === 'armor'\r\n  const isWeapon = type === 'weapon'\r\n  const canEquipItem = useMemo(\r\n    () => canEquip(rawCharacter)(item as EquippableT, !isWeapon),\r\n    [item, rawCharacter, isWeapon],\r\n  )\r\n  const iconSize = 18\r\n  const rarityColor = ItemRarityColorMap[item.rarity]\r\n  const icon = useMemo(() => {\r\n    if (isWeapon) {\r\n      return (\r\n        <WeaponIcon\r\n          weapon={item as WeaponT}\r\n          size={iconSize}\r\n          fill={rarityColor}\r\n        />\r\n      )\r\n    }\r\n    if (isArmor) {\r\n      return (\r\n        <ArmorIcon item={item as ArmorT} size={iconSize} fill={rarityColor} />\r\n      )\r\n    }\r\n    if (isEquipable) {\r\n      return (\r\n        <ItemIcon\r\n          item={item as EquippableT}\r\n          size={iconSize}\r\n          fill={rarityColor}\r\n        />\r\n      )\r\n    }\r\n  }, [item, isArmor, isEquipable, isWeapon, rarityColor])\r\n\r\n  return (\r\n    <div\r\n      onMouseEnter={() => setIsHovering(true)}\r\n      onMouseLeave={() => setIsHovering(false)}\r\n    >\r\n      <Tooltip\r\n        isOpen={isHovering}\r\n        direction='bottom'\r\n        tagName='div'\r\n        padding='0'\r\n        arrow={false}\r\n        content={\r\n          isWeapon ? (\r\n            <EquipedWeaponCompare weapon={item as WeaponT} />\r\n          ) : isEquipable ? (\r\n            <EquipeItemCompare item={item as EquippableT} />\r\n          ) : (\r\n            'item'\r\n          )\r\n        }\r\n      >\r\n        <BoxContainer\r\n          style={{\r\n            width: 40,\r\n            height: 40,\r\n            background: !canEquipItem ? '#333' : '#222',\r\n            boxShadow: `inset 0 0 ${!canEquipItem ? '3px' : '12px'} ${\r\n              item.rarity !== 'common' && canEquipItem\r\n                ? Color(rarityColor).fade(0.5).hsl().toString()\r\n                : 'black'\r\n            }`,\r\n          }}\r\n          substyle={{\r\n            background: 'transparent',\r\n            cursor: canEquipItem ? 'pointer' : 'default',\r\n            borderColor: isHovering\r\n              ? rarityColor\r\n              : item.rarity === 'common'\r\n              ? '#555'\r\n              : Color(rarityColor).fade(0.5).hsl().toString(),\r\n            boxShadow: canEquipItem ? 'inset 0 0 3px black' : 'none',\r\n            display: 'flex',\r\n            padding: 0,\r\n            justifyContent: 'center',\r\n            alignItems: 'center',\r\n            margin: 0,\r\n            opacity: canEquipItem ? 1 : 0.5,\r\n          }}\r\n          onClick={(event) => {\r\n            event.preventDefault()\r\n            event.stopPropagation()\r\n            if (isEquipable) {\r\n              onEquip(item.id)\r\n            }\r\n          }}\r\n        >\r\n          {icon}\r\n        </BoxContainer>\r\n      </Tooltip>\r\n    </div>\r\n  )\r\n}\r\n","import React, { useMemo } from 'react'\r\nimport { BoxContainer } from '../../elements/box'\r\n\r\nimport { Icon } from '../Icon'\r\nimport { FlexContainer } from '../../elements/flex'\r\n\r\nexport interface SidebarOptionT {\r\n  key: string\r\n  icon: string\r\n  Component: React.FC\r\n}\r\n\r\nexport interface SidebarPropsT {\r\n  activeKey: string | undefined\r\n  setActiveKey: (key?: string) => void\r\n  options: SidebarOptionT[]\r\n  direction?: 'right' | 'left'\r\n}\r\nexport const Sidebar = (props: SidebarPropsT) => {\r\n  const { activeKey, setActiveKey, options, direction = 'right' } = props\r\n  const activeOption = useMemo(() => options.find((o) => o.key === activeKey), [\r\n    activeKey,\r\n  ])\r\n  return (\r\n    <BoxContainer\r\n      substyle={{\r\n        display: 'flex',\r\n        flexDirection: direction === 'right' ? 'row' : 'row-reverse',\r\n        padding: 0,\r\n      }}\r\n    >\r\n      <FlexContainer\r\n        $direction='column'\r\n        style={{\r\n          width: 60,\r\n        }}\r\n      >\r\n        {options.map((option, i) => (\r\n          <div\r\n            key={option.key}\r\n            style={{\r\n              height: 60,\r\n              width: 60,\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              cursor: 'pointer',\r\n              boxSizing: 'border-box',\r\n              backgroundColor:\r\n                activeKey === option.key ? '#111' : 'transparent',\r\n              borderTop: i === 0 ? 'none' : '1px solid #555',\r\n              borderBottom: '1px solid black',\r\n              borderRight:\r\n                direction === 'right'\r\n                  ? activeKey && activeKey !== option.key\r\n                    ? '1px solid #555'\r\n                    : 'none'\r\n                  : 'none',\r\n              borderLeft:\r\n                direction === 'left'\r\n                  ? activeKey && activeKey !== option.key\r\n                    ? '1px solid #555'\r\n                    : 'none'\r\n                  : 'none',\r\n            }}\r\n            onClick={(e) => {\r\n              e.preventDefault()\r\n              e.stopPropagation()\r\n              setActiveKey(activeKey === option.key ? undefined : option.key)\r\n            }}\r\n          >\r\n            <Icon src={option.icon} size={24} />\r\n          </div>\r\n        ))}\r\n        <FlexContainer\r\n          $full\r\n          style={{\r\n            borderTop: '1px solid #555',\r\n            borderRight:\r\n              direction === 'right'\r\n                ? activeKey !== undefined\r\n                  ? '1px solid #555'\r\n                  : 'none'\r\n                : 'none',\r\n            borderLeft:\r\n              direction === 'left'\r\n                ? activeKey !== undefined\r\n                  ? '1px solid #555'\r\n                  : 'none'\r\n                : 'none',\r\n          }}\r\n        />\r\n      </FlexContainer>\r\n      {activeOption && (\r\n        <div\r\n          style={{\r\n            padding: 8,\r\n            backgroundColor: '#111',\r\n            overflow: 'auto',\r\n          }}\r\n        >\r\n          <activeOption.Component />\r\n        </div>\r\n      )}\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { RollLog } from '../RollLog'\r\nimport Dice6 from '../../icons/svg/delapouite/dice-six-faces-six.svg'\r\nimport Attack from '../../icons/svg/cathelineau/swordman.svg'\r\nimport Items from '../../icons/svg/lorc/swap-bag.svg'\r\nimport Skills from '../../icons/svg/delapouite/skills.svg'\r\nimport Mods from '../../icons/svg/delapouite/crystal-shrine.svg'\r\nimport { CharacterItems } from '../CharacterItems'\r\nimport { AttackLog } from '../AttackLog'\r\nimport { useUIContext } from '../../contexts/UIContext'\r\nimport { SidebarOptionT, Sidebar } from '../Sidebar'\r\nimport { PartySkills } from '../PartySkills'\r\nimport { PartyMods } from '../PartyMods'\r\n\r\nexport const options: SidebarOptionT[] = [\r\n  {\r\n    key: 'roll-log',\r\n    icon: Dice6,\r\n    Component: RollLog,\r\n  },\r\n  {\r\n    key: 'attack-log',\r\n    icon: Attack,\r\n    Component: AttackLog,\r\n  },\r\n  {\r\n    key: 'items',\r\n    icon: Items,\r\n    Component: CharacterItems,\r\n  },\r\n  {\r\n    key: 'skills',\r\n    icon: Skills,\r\n    Component: PartySkills,\r\n  },\r\n  {\r\n    key: 'mods',\r\n    icon: Mods,\r\n    Component: PartyMods,\r\n  },\r\n]\r\n\r\nexport interface AppLogPropsT {}\r\nexport const AppLog = (props: AppLogPropsT) => {\r\n  const { logKey, setLogKey } = useUIContext()\r\n  return (\r\n    <Sidebar\r\n      activeKey={logKey}\r\n      setActiveKey={setLogKey}\r\n      options={options}\r\n      direction='left'\r\n    />\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport { useRollContext } from '../../contexts/RollContext'\r\nimport { RollResult } from '../RollResult'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { Icon } from '../Icon'\r\nimport Dice6 from '../../icons/svg/delapouite/dice-six-faces-six.svg'\r\n\r\nexport interface RollLogPropsT {}\r\nexport const RollLog = (props: RollLogPropsT) => {\r\n  const { history, execRoll } = useRollContext()\r\n  const [text, setText] = useState('')\r\n  const [submitLog, setSubmitLog] = useState<string[]>([])\r\n  const [index, setIndex] = useState(0)\r\n  const submit = () => {\r\n    try {\r\n      execRoll({ string: text, keys: [], modifier: 0 }, true, true)\r\n      setSubmitLog([...submitLog, text])\r\n      setIndex(submitLog.length)\r\n    } catch (e) {\r\n      alert(e)\r\n    } finally {\r\n      setText('')\r\n    }\r\n  }\r\n  return (\r\n    <FlexContainer $direction='column' $full style={{ width: 400 }}>\r\n      {history.length > 0 ? (\r\n        <FlexContainer\r\n          $full\r\n          $direction='column'\r\n          style={{ overflow: 'auto', padding: 10 }}\r\n        >\r\n          {history.map((roll) => (\r\n            <React.Fragment key={roll.id}>\r\n              <RollResult key={roll.id} roll={roll} />\r\n            </React.Fragment>\r\n          ))}\r\n        </FlexContainer>\r\n      ) : (\r\n        <FlexContainer $full />\r\n      )}\r\n      <FlexContainer>\r\n        <input\r\n          value={text}\r\n          style={{ flex: 1 }}\r\n          onChange={(e) => setText(e.target.value)}\r\n          onKeyDown={(e) => {\r\n            if (e.keyCode === 13) {\r\n              submit()\r\n            }\r\n            if (e.keyCode === 38) {\r\n              setText(submitLog[index] || '')\r\n              setIndex(index - 1)\r\n            }\r\n          }}\r\n        />\r\n        <button onClick={submit}>\r\n          <Icon src={Dice6} size={18} fill='#4bebc6' />\r\n        </button>\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React, { useRef, useEffect } from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { useCombatLogContext } from '../../contexts/CombatLogContext'\r\n\r\nexport const AttackLog = () => {\r\n  // const { attackResults, clear } = useAttackContext()\r\n  const { lines, clear } = useCombatLogContext()\r\n  const scrollRef = useRef<HTMLDivElement>(null)\r\n  useEffect(() => {\r\n    if (scrollRef.current) {\r\n      scrollRef.current.scrollIntoView({ behavior: 'smooth' })\r\n    }\r\n  }, [lines])\r\n  return (\r\n    <FlexContainer\r\n      $direction='column'\r\n      $full\r\n      style={{ overflow: 'auto', padding: 10, overflowY: 'auto' }}\r\n    >\r\n      <button onClick={clear} style={{ marginBottom: 20 }}>\r\n        Clear Log\r\n      </button>\r\n      <FlexContainer\r\n        $direction='column'\r\n        $full\r\n        style={{\r\n          color: 'rgba(200,200,200, 1)',\r\n          background: '#111',\r\n          width: 380,\r\n          overflowX: 'auto',\r\n        }}\r\n      >\r\n        {lines.map((l, i) => (\r\n          <pre key={i}>{l}</pre>\r\n        ))}\r\n        <div ref={scrollRef} />\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { SkillPreviewAlt } from '../SkillPreviewAlt'\r\n\r\nexport const PartySkills = () => {\r\n  const { userParty } = usePartyContext()\r\n  return (\r\n    <FlexContainer style={{ width: 320, flexWrap: 'wrap' }}>\r\n      {userParty.skills.map((skill) => (\r\n        <SkillPreviewAlt skill={skill} />\r\n      ))}\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { ModPreview } from '../ModPreview'\r\nimport { useCharacterContext } from '../../contexts/CharacterContext'\r\n\r\nexport const PartyMods = () => {\r\n  const { rawCharacter } = useCharacterContext()\r\n  const { userParty, equipMod } = usePartyContext()\r\n  return (\r\n    <FlexContainer $direction='column'>\r\n      {userParty.mods.map((mod) => (\r\n        <ModPreview\r\n          key={mod.id}\r\n          mod={mod}\r\n          onEquip={(modId) => {\r\n            equipMod(rawCharacter.id, modId)\r\n          }}\r\n        />\r\n      ))}\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { Route } from 'react-router-dom'\r\n\r\nexport const makeRoute = (path: string, Component: React.FC) => (\r\n  <Route path={path}>\r\n    <Component />\r\n  </Route>\r\n)\r\n","import React from 'react'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { ProcessedCharacterT } from '../../types/Character'\r\nimport { BoxButton } from '../../elements/box'\r\n\r\nimport CharactersIcon from '../../icons/svg/lorc/two-shadows.svg'\r\nimport { FlexContainer } from '../../elements/flex'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport { makeCharacter } from '../../objects/makeCharacter'\r\nimport { Sidebar, SidebarOptionT } from '../Sidebar'\r\nimport { useUIContext } from '../../contexts/UIContext'\r\n\r\nexport const MAIN_OPTIONS: SidebarOptionT[] = [\r\n  {\r\n    key: 'characters',\r\n    icon: CharactersIcon,\r\n    Component: () => <AppSidebarCharacters />,\r\n  },\r\n]\r\n\r\nexport interface AppSidebarPropsT {}\r\nexport const AppSidebar = (props: AppSidebarPropsT) => {\r\n  const { sidebarKey, setSidebarKey } = useUIContext()\r\n  return (\r\n    <Sidebar\r\n      options={MAIN_OPTIONS}\r\n      direction='right'\r\n      activeKey={sidebarKey}\r\n      setActiveKey={setSidebarKey}\r\n    />\r\n  )\r\n}\r\n\r\nconst AppSidebarCharacters = () => {\r\n  const { userParty, upsertCharacter } = usePartyContext()\r\n  const history = useHistory()\r\n  return (\r\n    <FlexContainer $direction='column'>\r\n      {userParty.characters.map((character: ProcessedCharacterT) => (\r\n        <Link\r\n          key={character.id}\r\n          to={`/characters/${character.id}`}\r\n          style={{\r\n            padding: 8,\r\n          }}\r\n        >\r\n          {character.name}\r\n        </Link>\r\n      ))}\r\n      {userParty.characters.length < 3 && (\r\n        <BoxButton\r\n          onClick={() => {\r\n            const newCharacter = makeCharacter('new character')\r\n            upsertCharacter(newCharacter)\r\n            history.push(`/characters/${newCharacter.id}`)\r\n          }}\r\n        >\r\n          Add New Character\r\n        </BoxButton>\r\n      )}\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { PartyT } from '../../types/Party'\r\nimport {\r\n  CharacterContextProvider,\r\n  useCharacterContext,\r\n} from '../../contexts/CharacterContext'\r\nimport { usePartyContext } from '../../contexts/PartyContext'\r\nimport { CharacterDetails } from '../CharacterDetails'\r\nimport { useCombatContext } from '../../contexts/CombatContext'\r\nimport { PC_PARTY_ID } from '../../state/parties'\r\nimport { processCharacter, ProcessedCharacterT } from '../../types/Character'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { getSkillRange } from '../../types/Skill'\r\nimport { BASIC_ATTACK } from '../../objects/makeSkill'\r\nimport {\r\n  ZERO_CHECK,\r\n  reduceCharacterCheck,\r\n  getCheckProbability,\r\n  makeCharacterCheck,\r\n} from '../../types/Roll2'\r\n\r\nexport interface CombatPartyPropsT {\r\n  party: PartyT\r\n}\r\nexport const CombatParty = (props: CombatPartyPropsT) => {\r\n  const { party } = props\r\n  const { upsertCharacter } = usePartyContext()\r\n  const {\r\n    userParty,\r\n    enemyParty,\r\n    characterSkills,\r\n    characterTargets,\r\n  } = useCombatContext()\r\n  if (!party || !userParty || !enemyParty) return <div>Loading...</div>\r\n\r\n  const characters = [...userParty.characters, ...enemyParty.characters]\r\n  return (\r\n    <div>\r\n      {party.characters.map((character) => (\r\n        <CharacterContextProvider\r\n          key={character.id}\r\n          character={character}\r\n          onChange={(c) => upsertCharacter(c, party.id)}\r\n        >\r\n          <FlexContainer\r\n            style={{\r\n              position: 'relative',\r\n              opacity: processCharacter(character).dead ? 0.5 : 1,\r\n            }}\r\n          >\r\n            <FlexContainer\r\n              $direction='column'\r\n              $full\r\n              style={{\r\n                marginBottom: 10,\r\n              }}\r\n            >\r\n              <CharacterDetails\r\n                width={450}\r\n                showInspect={\r\n                  character.inspected ||\r\n                  character.partyId === PC_PARTY_ID ||\r\n                  processCharacter(character).dead\r\n                }\r\n                showWeaponInspect={\r\n                  character.inspected ||\r\n                  character.partyId === PC_PARTY_ID ||\r\n                  processCharacter(character).dead\r\n                }\r\n                showSkills={party.id === PC_PARTY_ID}\r\n              />\r\n            </FlexContainer>\r\n            {character.partyId === PC_PARTY_ID && (\r\n              <FlexContainer\r\n                $direction='column'\r\n                style={{\r\n                  fontFamily: 'monospace',\r\n                  width: 80,\r\n                }}\r\n              >\r\n                <FullContainer />\r\n                <SelectedDamageRange\r\n                  skillId={characterSkills[character.id]}\r\n                  targetId={characterTargets[character.id]}\r\n                  characters={characters}\r\n                />\r\n                <FullContainer />\r\n              </FlexContainer>\r\n            )}\r\n          </FlexContainer>\r\n        </CharacterContextProvider>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\ninterface SelectedDamageRangePropsT {\r\n  skillId?: string\r\n  targetId?: string\r\n  characters: ProcessedCharacterT[]\r\n}\r\nconst SelectedDamageRange = (props: SelectedDamageRangePropsT) => {\r\n  const { skillId, targetId, characters } = props\r\n  const { character } = useCharacterContext()\r\n  const skill = character.skills.find((s) => s.id === skillId) || BASIC_ATTACK\r\n  const target = characters.find((c) => c.id === targetId)\r\n  if (!target && skill.target) return null\r\n  const range = getSkillRange(skill, character, target)\r\n  const prob = getCheckProbability(\r\n    reduceCharacterCheck(\r\n      skill.combineWeaponDamage\r\n        ? character.weapon.accuracyCheck\r\n        : skill.check || { ...ZERO_CHECK, keys: [] },\r\n      character,\r\n    ),\r\n  )\r\n  const dodgeProb =\r\n    skill.target && target\r\n      ? getCheckProbability(\r\n          reduceCharacterCheck(makeCharacterCheck(['evade']), target),\r\n        )\r\n      : 0\r\n  return (\r\n    <BoxContainer\r\n      style={{ textAlign: 'center', fontWeight: 'bold', borderLeft: 'none' }}\r\n      substyle={{ borderLeft: 'none', background: '#111' }}\r\n    >\r\n      {range && range !== '0' && (\r\n        <div style={{ marginBottom: 5 }}>({range})</div>\r\n      )}\r\n      <div style={{ fontSize: 20 }}>{Math.floor(prob - dodgeProb)}%</div>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import {\r\n  CharacterCheckT,\r\n  CharacterRollT,\r\n  Roll2ResultT,\r\n  resolveCharacterRoll,\r\n} from './Roll2'\r\nimport { DamageTypeRollsT, rollDamage, getDamageTypeKeys } from './Damage'\r\nimport { CharacterTraitT, ProcessedCharacterT } from './Character'\r\nimport { EventsT } from './Events'\r\nimport { getSkillDamageRolls } from '../contexts/CombatContext/util'\r\nimport { noneg } from '../util/noneg'\r\n\r\nexport interface SkillT {\r\n  id: string\r\n  name: string\r\n  imgSrc: string\r\n  check?: CharacterCheckT\r\n  requirementCheck: CharacterCheckT\r\n  damageRolls: DamageTypeRollsT\r\n  targetTraits: CharacterTraitT[]\r\n  sourceTraits: CharacterTraitT[]\r\n  events: EventsT\r\n  combineWeaponDamage: boolean\r\n  checkDodgeForTraits: boolean\r\n  focusCost: number\r\n  inspected?: true\r\n  target: boolean\r\n}\r\n\r\nexport const getSkillRange = (\r\n  skill: SkillT,\r\n  source: ProcessedCharacterT,\r\n  target?: ProcessedCharacterT,\r\n): string | undefined => {\r\n  if (!target) return undefined\r\n  let min = 0\r\n  let max = 0\r\n  const damageRolls = getSkillDamageRolls(skill, source.weapon)\r\n  const rr = (r: CharacterRollT) => resolveCharacterRoll(r, source)\r\n  const damageRollsResult = rollDamage(rr)(damageRolls, false)\r\n  const damageResults = damageRollsResult.rollResults\r\n  const { damageResistances } = target\r\n  const damageKeys = getDamageTypeKeys(damageResults).filter(\r\n    (k) => damageResults[k],\r\n  )\r\n  damageKeys.forEach((key) => {\r\n    const damageResult = damageResults[key] as Roll2ResultT\r\n    const resistanceCheck = damageResistances[key] as CharacterRollT\r\n    const resistanceResult = resolveCharacterRoll(resistanceCheck, source, true)\r\n    min += noneg(damageResult.minTotal - resistanceResult.maxTotal)\r\n    max += noneg(damageResult.maxTotal - resistanceResult.minTotal)\r\n  })\r\n  if (min === max) return `${max}`\r\n  return `${min}-${max}`\r\n}\r\n","import React, { useEffect, useMemo } from 'react'\r\nimport { useCombatContext } from '../../contexts/CombatContext'\r\nimport { FlexContainer, FullContainer } from '../../elements/flex'\r\nimport { CombatParty } from '../../components/CombatParty'\r\nimport { useUIContext } from '../../contexts/UIContext'\r\nimport { BoxContainer, BoxButton } from '../../elements/box'\r\nimport BG from '../../assets/img/23761.jpg'\r\nimport { CombatCharacterTargets } from '../../components/CombatCharacterTargets'\r\n\r\nexport const Combat = () => {\r\n  const {\r\n    rawUserParty,\r\n    rawEnemyParty,\r\n    done,\r\n    rounds,\r\n    characterTargets,\r\n    setCharacterTarget,\r\n    next,\r\n  } = useCombatContext()\r\n  const { setLogKey } = useUIContext()\r\n  const targetId = useMemo(() => {\r\n    let _targetId: string | undefined =\r\n      characterTargets[rawUserParty.characters[0].id]\r\n    if (\r\n      rawUserParty.characters.every((c) => {\r\n        return characterTargets[c.id] === _targetId\r\n      })\r\n    ) {\r\n      return _targetId\r\n    }\r\n    return undefined\r\n  }, [characterTargets])\r\n\r\n  const setAllIds = (tid?: string) => {\r\n    rawUserParty.characters.forEach((c) => {\r\n      setCharacterTarget(c.id, tid)\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    setLogKey('attack-log')\r\n    return () => {\r\n      setLogKey(undefined)\r\n    }\r\n  }, [])\r\n\r\n  return (\r\n    <FlexContainer\r\n      $full\r\n      $direction='column'\r\n      style={{\r\n        background: `url(${BG}) center center`,\r\n        backgroundSize: 'cover',\r\n      }}\r\n    >\r\n      <BoxContainer\r\n        style={{ borderLeft: 'none', borderRight: 'none' }}\r\n        substyle={{\r\n          height: 61,\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          padding: '0px 8px',\r\n          borderColor: 'rgba(255,255,255,0.4)',\r\n          borderTop: 'none',\r\n          borderLeft: 'none',\r\n          borderRight: 'none',\r\n          background: 'rgba(255,255,255,0.12)',\r\n        }}\r\n      >\r\n        <FullContainer>\r\n          <FlexContainer>\r\n            {!done && (\r\n              <BoxButton onClick={() => next()} substyle={{ padding: 8 }}>\r\n                Next Round\r\n              </BoxButton>\r\n            )}\r\n          </FlexContainer>\r\n          <FullContainer />\r\n        </FullContainer>\r\n        <FlexContainer\r\n          style={{\r\n            textTransform: 'uppercase',\r\n            fontFamily: 'monospace',\r\n            fontWeight: 'bolder',\r\n            fontSize: 24,\r\n          }}\r\n        >\r\n          Round {rounds.length + 1}\r\n        </FlexContainer>\r\n        <FullContainer style={{ display: 'flex' }}>\r\n          <FullContainer />\r\n          <FlexContainer style={{ alignItems: 'center' }}>\r\n            <span\r\n              style={{\r\n                fontFamily: 'monospace',\r\n                color: 'rgba(255,255,255,0.4)',\r\n                fontWeight: 'bold',\r\n                marginRight: 10,\r\n              }}\r\n            >\r\n              ALL TARGET\r\n            </span>\r\n            <CombatCharacterTargets\r\n              activeTargetId={targetId}\r\n              showRandom={false}\r\n              onClick={(targetId) => {\r\n                setAllIds(targetId)\r\n              }}\r\n            />\r\n          </FlexContainer>\r\n        </FullContainer>\r\n      </BoxContainer>\r\n      <FlexContainer id='Combat' $full style={{ padding: 10 }}>\r\n        <CombatParty party={rawUserParty} />\r\n        <FlexContainer $full $direction='column'></FlexContainer>\r\n        <CombatParty party={rawEnemyParty} />\r\n      </FlexContainer>\r\n    </FlexContainer>\r\n  )\r\n}\r\n","import React, { CSSProperties } from 'react'\r\nimport { BoxContainer } from '../../elements/box'\r\nimport { Link, useLocation } from 'react-router-dom'\r\nimport { Monodiv } from '../../elements/monospace'\r\n\r\nconst activeStyles: CSSProperties = {\r\n  background: '#111',\r\n  boxShadow: 'inset 0 0 3px black',\r\n}\r\nconst inactiveStyles: CSSProperties = {\r\n  backgroundColor: '#333',\r\n}\r\n\r\nexport const AppHeader = () => {\r\n  const location = useLocation()\r\n  const { pathname } = location\r\n  const chunks = pathname.split('/')\r\n  const check = (paths: string[]): CSSProperties =>\r\n    paths.includes(chunks[1]) ? activeStyles : inactiveStyles\r\n  return (\r\n    <BoxContainer\r\n      substyle={{\r\n        height: 64,\r\n        padding: 0,\r\n        alignItems: 'center',\r\n        display: 'flex',\r\n      }}\r\n    >\r\n      <Monodiv\r\n        style={{\r\n          fontSize: 24,\r\n          margin: '0 30px',\r\n        }}\r\n      >\r\n        rpgjs\r\n      </Monodiv>\r\n      <BoxContainer\r\n        tag={Link}\r\n        to=''\r\n        style={{\r\n          height: '100%',\r\n        }}\r\n        substyle={{\r\n          padding: '0 20px',\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          ...check(['', 'characters']),\r\n        }}\r\n      >\r\n        edit characters\r\n      </BoxContainer>\r\n      <BoxContainer\r\n        tag={Link}\r\n        to='/battle'\r\n        style={{\r\n          height: '100%',\r\n        }}\r\n        substyle={{\r\n          padding: '0 20px',\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          ...check(['battle']),\r\n        }}\r\n      >\r\n        enter combat\r\n      </BoxContainer>\r\n    </BoxContainer>\r\n  )\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { Switch } from 'react-router-dom'\r\n\r\nimport { CharacterStateContextProvider } from './contexts/CharacterContext'\r\n\r\nimport { Character } from './domain'\r\n\r\nimport { FlexContainer } from './elements/flex'\r\nimport { AppLog } from './components/ApplicationLog'\r\nimport { makeRoute } from './routes'\r\nimport { PartyContextProvider } from './contexts/PartyContext'\r\nimport { AppSidebar, MAIN_OPTIONS } from './components/AppSidebar'\r\nimport { Combat } from './domain/Combat'\r\nimport { CombatContextProvider } from './contexts/CombatContext'\r\nimport { AppHeader } from './components/AppHeader'\r\nimport { CombatLogContextProvider } from './contexts/CombatLogContext'\r\nimport { ModalContextProvider } from './contexts/ModalContext'\r\nimport { UIContextProvider } from './contexts/UIContext'\r\n\r\nexport const App = () => {\r\n  return (\r\n    <div\r\n      style={{\r\n        height: '100%',\r\n        width: '100%',\r\n        display: 'flex',\r\n      }}\r\n    >\r\n      <UIContextProvider>\r\n        <ModalContextProvider>\r\n          <PartyContextProvider>\r\n            <CharacterStateContextProvider>\r\n              <CombatLogContextProvider>\r\n                <FlexContainer $full $direction='column' id='content-root'>\r\n                  <AppHeader />\r\n                  <FlexContainer\r\n                    $full\r\n                    style={{\r\n                      height: 'calc(100% - 70px)',\r\n                      width: '100vw',\r\n                      overflow: 'auto',\r\n                    }}\r\n                  >\r\n                    <AppSidebar />\r\n                    <FlexContainer $full style={{ overflow: 'auto' }}>\r\n                      <Switch>\r\n                        {makeRoute('/battle', () => (\r\n                          <CombatContextProvider>\r\n                            <Combat />\r\n                          </CombatContextProvider>\r\n                        ))}\r\n                        {makeRoute('/characters/:id', () => (\r\n                          <Character />\r\n                        ))}\r\n                        {makeRoute('/', () => (\r\n                          <Character />\r\n                        ))}\r\n                      </Switch>\r\n                    </FlexContainer>\r\n                    <AppLog />\r\n                  </FlexContainer>\r\n                </FlexContainer>\r\n              </CombatLogContextProvider>\r\n            </CharacterStateContextProvider>\r\n          </PartyContextProvider>\r\n        </ModalContextProvider>\r\n      </UIContextProvider>\r\n    </div>\r\n  )\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { App } from './App'\nimport * as serviceWorker from './serviceWorker'\nimport './index.css'\n\nimport { Provider as StyletronProvider, DebugEngine } from 'styletron-react'\nimport { Client as Styletron } from 'styletron-engine-atomic'\n\nimport { Provider as ReduxProvider } from 'react-redux'\nimport { makeStore } from './state'\n\nimport { BrowserRouter as Router } from 'react-router-dom'\n\nconst debug = process.env.NODE_ENV === 'production' ? void 0 : new DebugEngine()\nconst engine: Styletron = new Styletron()\nconst store = makeStore()\n\nReactDOM.render(\n  <React.StrictMode>\n    <ReduxProvider store={store}>\n      <StyletronProvider value={engine} debug={debug} debugAfterHydration>\n        <Router>\n          <App />\n        </Router>\n      </StyletronProvider>\n    </ReduxProvider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n","import { createStore, combineReducers, compose, applyMiddleware } from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport rolls from './rolls'\r\nimport parties from './parties'\r\n\r\nexport const makeStore = () =>\r\n  createStore(\r\n    combineReducers({ rolls, parties }),\r\n    compose(applyMiddleware(thunk)),\r\n  )\r\n"],"sourceRoot":""}